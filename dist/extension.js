"use strict";var pG=Object.create;var Jv=Object.defineProperty;var fG=Object.getOwnPropertyDescriptor;var mG=Object.getOwnPropertyNames;var hG=Object.getPrototypeOf,gG=Object.prototype.hasOwnProperty;var fM=(t,e)=>()=>(t&&(e=t(t=0)),e);var g=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ui=(t,e)=>{for(var r in e)Jv(t,r,{get:e[r],enumerable:!0})},mM=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of mG(e))!gG.call(t,o)&&o!==r&&Jv(t,o,{get:()=>e[o],enumerable:!(n=fG(e,o))||n.enumerable});return t};var it=(t,e,r)=>(r=t!=null?pG(hG(t)):{},mM(e||!t||!t.__esModule?Jv(r,"default",{value:t,enumerable:!0}):r,t)),C=t=>mM(Jv({},"__esModule",{value:!0}),t);var vm=g(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.regexpCode=tt.getEsmExportName=tt.getProperty=tt.safeStringify=tt.stringify=tt.strConcat=tt.addCodeArg=tt.str=tt._=tt.nil=tt._Code=tt.Name=tt.IDENTIFIER=tt._CodeOrName=void 0;var gm=class{};tt._CodeOrName=gm;tt.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Wa=class extends gm{constructor(e){if(super(),!tt.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};tt.Name=Wa;var no=class extends gm{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Wa&&(r[n.str]=(r[n.str]||0)+1),r),{})}};tt._Code=no;tt.nil=new no("");function E4(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Z1(r,e[n]),r.push(t[++n]);return new no(r)}tt._=E4;var V1=new no("+");function O4(t,...e){let r=[ym(t[0])],n=0;for(;n<e.length;)r.push(V1),Z1(r,e[n]),r.push(V1,ym(t[++n]));return eY(r),new no(r)}tt.str=O4;function Z1(t,e){e instanceof no?t.push(...e._items):e instanceof Wa?t.push(e):t.push(nY(e))}tt.addCodeArg=Z1;function eY(t){let e=1;for(;e<t.length-1;){if(t[e]===V1){let r=tY(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function tY(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Wa||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Wa))return`"${t}${e.slice(1)}`}function rY(t,e){return e.emptyStr()?t:t.emptyStr()?e:O4`${t}${e}`}tt.strConcat=rY;function nY(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:ym(Array.isArray(t)?t.join(","):t)}function oY(t){return new no(ym(t))}tt.stringify=oY;function ym(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}tt.safeStringify=ym;function iY(t){return typeof t=="string"&&tt.IDENTIFIER.test(t)?new no(`.${t}`):E4`[${t}]`}tt.getProperty=iY;function sY(t){if(typeof t=="string"&&tt.IDENTIFIER.test(t))return new no(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}tt.getEsmExportName=sY;function aY(t){return new no(t.toString())}tt.regexpCode=aY});var W1=g(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.ValueScope=hn.ValueScopeName=hn.Scope=hn.varKinds=hn.UsedValueState=void 0;var mn=vm(),H1=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},gb;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(gb||(hn.UsedValueState=gb={}));hn.varKinds={const:new mn.Name("const"),let:new mn.Name("let"),var:new mn.Name("var")};var yb=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof mn.Name?e:this.name(e)}name(e){return new mn.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};hn.Scope=yb;var vb=class extends mn.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,mn._)`.${new mn.Name(r)}[${n}]`}};hn.ValueScopeName=vb;var cY=(0,mn._)`\n`,G1=class extends yb{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?cY:mn.nil}}get(){return this._scope}name(e){return new vb(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:i}=o,s=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[i];if(a){let u=a.get(s);if(u)return u}else a=this._values[i]=new Map;a.set(s,o);let c=this._scope[i]||(this._scope[i]=[]),l=c.length;return c[l]=r.ref,o.setValue(r,{property:i,itemIndex:l}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,mn._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let i=mn.nil;for(let s in e){let a=e[s];if(!a)continue;let c=n[s]=n[s]||new Map;a.forEach(l=>{if(c.has(l))return;c.set(l,gb.Started);let u=r(l);if(u){let d=this.opts.es5?hn.varKinds.var:hn.varKinds.const;i=(0,mn._)`${i}${d} ${l} = ${u};${this.opts._n}`}else if(u=o?.(l))i=(0,mn._)`${i}${u}${this.opts._n}`;else throw new H1(l);c.set(l,gb.Completed)})}return i}};hn.ValueScope=G1});var Ne=g(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.or=Oe.and=Oe.not=Oe.CodeGen=Oe.operators=Oe.varKinds=Oe.ValueScopeName=Oe.ValueScope=Oe.Scope=Oe.Name=Oe.regexpCode=Oe.stringify=Oe.getProperty=Oe.nil=Oe.strConcat=Oe.str=Oe._=void 0;var Ze=vm(),Eo=W1(),Hs=vm();Object.defineProperty(Oe,"_",{enumerable:!0,get:function(){return Hs._}});Object.defineProperty(Oe,"str",{enumerable:!0,get:function(){return Hs.str}});Object.defineProperty(Oe,"strConcat",{enumerable:!0,get:function(){return Hs.strConcat}});Object.defineProperty(Oe,"nil",{enumerable:!0,get:function(){return Hs.nil}});Object.defineProperty(Oe,"getProperty",{enumerable:!0,get:function(){return Hs.getProperty}});Object.defineProperty(Oe,"stringify",{enumerable:!0,get:function(){return Hs.stringify}});Object.defineProperty(Oe,"regexpCode",{enumerable:!0,get:function(){return Hs.regexpCode}});Object.defineProperty(Oe,"Name",{enumerable:!0,get:function(){return Hs.Name}});var xb=W1();Object.defineProperty(Oe,"Scope",{enumerable:!0,get:function(){return xb.Scope}});Object.defineProperty(Oe,"ValueScope",{enumerable:!0,get:function(){return xb.ValueScope}});Object.defineProperty(Oe,"ValueScopeName",{enumerable:!0,get:function(){return xb.ValueScopeName}});Object.defineProperty(Oe,"varKinds",{enumerable:!0,get:function(){return xb.varKinds}});Oe.operators={GT:new Ze._Code(">"),GTE:new Ze._Code(">="),LT:new Ze._Code("<"),LTE:new Ze._Code("<="),EQ:new Ze._Code("==="),NEQ:new Ze._Code("!=="),NOT:new Ze._Code("!"),OR:new Ze._Code("||"),AND:new Ze._Code("&&"),ADD:new Ze._Code("+")};var Ji=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},K1=class extends Ji{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Eo.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=$u(this.rhs,e,r)),this}get names(){return this.rhs instanceof Ze._CodeOrName?this.rhs.names:{}}},_b=class extends Ji{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof Ze.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=$u(this.rhs,e,r),this}get names(){let e=this.lhs instanceof Ze.Name?{}:{...this.lhs.names};return wb(e,this.rhs)}},J1=class extends _b{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Y1=class extends Ji{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},X1=class extends Ji{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},Q1=class extends Ji{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},eC=class extends Ji{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=$u(this.code,e,r),this}get names(){return this.code instanceof Ze._CodeOrName?this.code.names:{}}},_m=class extends Ji{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let i=n[o];i.optimizeNames(e,r)||(lY(e,i.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Ya(e,r.names),{})}},Yi=class extends _m{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},tC=class extends _m{},ku=class extends Yi{};ku.kind="else";var Ka=class t extends Yi{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new ku(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(j4(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=$u(this.condition,e,r),this}get names(){let e=super.names;return wb(e,this.condition),this.else&&Ya(e,this.else.names),e}};Ka.kind="if";var Ja=class extends Yi{};Ja.kind="for";var rC=class extends Ja{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=$u(this.iteration,e,r),this}get names(){return Ya(super.names,this.iteration.names)}},nC=class extends Ja{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?Eo.varKinds.var:this.varKind,{name:n,from:o,to:i}=this;return`for(${r} ${n}=${o}; ${n}<${i}; ${n}++)`+super.render(e)}get names(){let e=wb(super.names,this.from);return wb(e,this.to)}},bb=class extends Ja{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=$u(this.iterable,e,r),this}get names(){return Ya(super.names,this.iterable.names)}},bm=class extends Yi{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};bm.kind="func";var wm=class extends _m{render(e){return"return "+super.render(e)}};wm.kind="return";var oC=class extends Yi{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Ya(e,this.catch.names),this.finally&&Ya(e,this.finally.names),e}},xm=class extends Yi{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};xm.kind="catch";var Sm=class extends Yi{render(e){return"finally"+super.render(e)}};Sm.kind="finally";var iC=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new Eo.Scope({parent:e}),this._nodes=[new tC]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let i=this._scope.toName(r);return n!==void 0&&o&&(this._constants[i.str]=n),this._leafNode(new K1(e,i,n)),i}const(e,r,n){return this._def(Eo.varKinds.const,e,r,n)}let(e,r,n){return this._def(Eo.varKinds.let,e,r,n)}var(e,r,n){return this._def(Eo.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new _b(e,r,n))}add(e,r){return this._leafNode(new J1(e,Oe.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==Ze.nil&&this._leafNode(new eC(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,Ze.addCodeArg)(r,o));return r.push("}"),new Ze._Code(r)}if(e,r,n){if(this._blockNode(new Ka(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Ka(e))}else(){return this._elseNode(new ku)}endIf(){return this._endBlockNode(Ka,ku)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new rC(e),r)}forRange(e,r,n,o,i=this.opts.es5?Eo.varKinds.var:Eo.varKinds.let){let s=this._scope.toName(e);return this._for(new nC(i,s,r,n),()=>o(s))}forOf(e,r,n,o=Eo.varKinds.const){let i=this._scope.toName(e);if(this.opts.es5){let s=r instanceof Ze.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,Ze._)`${s}.length`,a=>{this.var(i,(0,Ze._)`${s}[${a}]`),n(i)})}return this._for(new bb("of",o,i,r),()=>n(i))}forIn(e,r,n,o=this.opts.es5?Eo.varKinds.var:Eo.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,Ze._)`Object.keys(${r})`,n);let i=this._scope.toName(e);return this._for(new bb("in",o,i,r),()=>n(i))}endFor(){return this._endBlockNode(Ja)}label(e){return this._leafNode(new Y1(e))}break(e){return this._leafNode(new X1(e))}return(e){let r=new wm;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(wm)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new oC;if(this._blockNode(o),this.code(e),r){let i=this.name("e");this._currNode=o.catch=new xm(i),r(i)}return n&&(this._currNode=o.finally=new Sm,this.code(n)),this._endBlockNode(xm,Sm)}throw(e){return this._leafNode(new Q1(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=Ze.nil,n,o){return this._blockNode(new bm(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(bm)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Ka))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Oe.CodeGen=iC;function Ya(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function wb(t,e){return e instanceof Ze._CodeOrName?Ya(t,e.names):t}function $u(t,e,r){if(t instanceof Ze.Name)return n(t);if(!o(t))return t;return new Ze._Code(t._items.reduce((i,s)=>(s instanceof Ze.Name&&(s=n(s)),s instanceof Ze._Code?i.push(...s._items):i.push(s),i),[]));function n(i){let s=r[i.str];return s===void 0||e[i.str]!==1?i:(delete e[i.str],s)}function o(i){return i instanceof Ze._Code&&i._items.some(s=>s instanceof Ze.Name&&e[s.str]===1&&r[s.str]!==void 0)}}function lY(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function j4(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,Ze._)`!${sC(t)}`}Oe.not=j4;var uY=N4(Oe.operators.AND);function dY(...t){return t.reduce(uY)}Oe.and=dY;var pY=N4(Oe.operators.OR);function fY(...t){return t.reduce(pY)}Oe.or=fY;function N4(t){return(e,r)=>e===Ze.nil?r:r===Ze.nil?e:(0,Ze._)`${sC(e)} ${t} ${sC(r)}`}function sC(t){return t instanceof Ze.Name?t:(0,Ze._)`(${t})`}});var rt=g(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.checkStrictMode=ze.getErrorPath=ze.Type=ze.useFunc=ze.setEvaluated=ze.evaluatedPropsToName=ze.mergeEvaluated=ze.eachItem=ze.unescapeJsonPointer=ze.escapeJsonPointer=ze.escapeFragment=ze.unescapeFragment=ze.schemaRefOrVal=ze.schemaHasRulesButRef=ze.schemaHasRules=ze.checkUnknownRules=ze.alwaysValidSchema=ze.toHash=void 0;var bt=Ne(),mY=vm();function hY(t){let e={};for(let r of t)e[r]=!0;return e}ze.toHash=hY;function gY(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(M4(t,e),!q4(e,t.self.RULES.all))}ze.alwaysValidSchema=gY;function M4(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let i in e)o[i]||U4(t,`unknown keyword: "${i}"`)}ze.checkUnknownRules=M4;function q4(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}ze.schemaHasRules=q4;function yY(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}ze.schemaHasRulesButRef=yY;function vY({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,bt._)`${r}`}return(0,bt._)`${t}${e}${(0,bt.getProperty)(n)}`}ze.schemaRefOrVal=vY;function _Y(t){return D4(decodeURIComponent(t))}ze.unescapeFragment=_Y;function bY(t){return encodeURIComponent(cC(t))}ze.escapeFragment=bY;function cC(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}ze.escapeJsonPointer=cC;function D4(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}ze.unescapeJsonPointer=D4;function wY(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}ze.eachItem=wY;function z4({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,i,s,a)=>{let c=s===void 0?i:s instanceof bt.Name?(i instanceof bt.Name?t(o,i,s):e(o,i,s),s):i instanceof bt.Name?(e(o,s,i),i):r(i,s);return a===bt.Name&&!(c instanceof bt.Name)?n(o,c):c}}ze.mergeEvaluated={props:z4({mergeNames:(t,e,r)=>t.if((0,bt._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,bt._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,bt._)`${r} || {}`).code((0,bt._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,bt._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,bt._)`${r} || {}`),lC(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:B4}),items:z4({mergeNames:(t,e,r)=>t.if((0,bt._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,bt._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,bt._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,bt._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function B4(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,bt._)`{}`);return e!==void 0&&lC(t,r,e),r}ze.evaluatedPropsToName=B4;function lC(t,e,r){Object.keys(r).forEach(n=>t.assign((0,bt._)`${e}${(0,bt.getProperty)(n)}`,!0))}ze.setEvaluated=lC;var R4={};function xY(t,e){return t.scopeValue("func",{ref:e,code:R4[e.code]||(R4[e.code]=new mY._Code(e.code))})}ze.useFunc=xY;var aC;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(aC||(ze.Type=aC={}));function SY(t,e,r){if(t instanceof bt.Name){let n=e===aC.Num;return r?n?(0,bt._)`"[" + ${t} + "]"`:(0,bt._)`"['" + ${t} + "']"`:n?(0,bt._)`"/" + ${t}`:(0,bt._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,bt.getProperty)(t).toString():"/"+cC(t)}ze.getErrorPath=SY;function U4(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}ze.checkStrictMode=U4});var Xi=g(uC=>{"use strict";Object.defineProperty(uC,"__esModule",{value:!0});var Ur=Ne(),kY={data:new Ur.Name("data"),valCxt:new Ur.Name("valCxt"),instancePath:new Ur.Name("instancePath"),parentData:new Ur.Name("parentData"),parentDataProperty:new Ur.Name("parentDataProperty"),rootData:new Ur.Name("rootData"),dynamicAnchors:new Ur.Name("dynamicAnchors"),vErrors:new Ur.Name("vErrors"),errors:new Ur.Name("errors"),this:new Ur.Name("this"),self:new Ur.Name("self"),scope:new Ur.Name("scope"),json:new Ur.Name("json"),jsonPos:new Ur.Name("jsonPos"),jsonLen:new Ur.Name("jsonLen"),jsonPart:new Ur.Name("jsonPart")};uC.default=kY});var km=g(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.extendErrors=Lr.resetErrorsCount=Lr.reportExtraError=Lr.reportError=Lr.keyword$DataError=Lr.keywordError=void 0;var Ke=Ne(),Sb=rt(),nn=Xi();Lr.keywordError={message:({keyword:t})=>(0,Ke.str)`must pass "${t}" keyword validation`};Lr.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Ke.str)`"${t}" keyword must be ${e} ($data)`:(0,Ke.str)`"${t}" keyword is invalid ($data)`};function $Y(t,e=Lr.keywordError,r,n){let{it:o}=t,{gen:i,compositeRule:s,allErrors:a}=o,c=V4(t,e,r);n??(s||a)?L4(i,c):F4(o,(0,Ke._)`[${c}]`)}Lr.reportError=$Y;function AY(t,e=Lr.keywordError,r){let{it:n}=t,{gen:o,compositeRule:i,allErrors:s}=n,a=V4(t,e,r);L4(o,a),i||s||F4(n,nn.default.vErrors)}Lr.reportExtraError=AY;function PY(t,e){t.assign(nn.default.errors,e),t.if((0,Ke._)`${nn.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Ke._)`${nn.default.vErrors}.length`,e),()=>t.assign(nn.default.vErrors,null)))}Lr.resetErrorsCount=PY;function CY({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:i}){if(o===void 0)throw new Error("ajv implementation error");let s=t.name("err");t.forRange("i",o,nn.default.errors,a=>{t.const(s,(0,Ke._)`${nn.default.vErrors}[${a}]`),t.if((0,Ke._)`${s}.instancePath === undefined`,()=>t.assign((0,Ke._)`${s}.instancePath`,(0,Ke.strConcat)(nn.default.instancePath,i.errorPath))),t.assign((0,Ke._)`${s}.schemaPath`,(0,Ke.str)`${i.errSchemaPath}/${e}`),i.opts.verbose&&(t.assign((0,Ke._)`${s}.schema`,r),t.assign((0,Ke._)`${s}.data`,n))})}Lr.extendErrors=CY;function L4(t,e){let r=t.const("err",e);t.if((0,Ke._)`${nn.default.vErrors} === null`,()=>t.assign(nn.default.vErrors,(0,Ke._)`[${r}]`),(0,Ke._)`${nn.default.vErrors}.push(${r})`),t.code((0,Ke._)`${nn.default.errors}++`)}function F4(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,Ke._)`new ${t.ValidationError}(${e})`):(r.assign((0,Ke._)`${n}.errors`,e),r.return(!1))}var Xa={keyword:new Ke.Name("keyword"),schemaPath:new Ke.Name("schemaPath"),params:new Ke.Name("params"),propertyName:new Ke.Name("propertyName"),message:new Ke.Name("message"),schema:new Ke.Name("schema"),parentSchema:new Ke.Name("parentSchema")};function V4(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Ke._)`{}`:IY(t,e,r)}function IY(t,e,r={}){let{gen:n,it:o}=t,i=[TY(o,r),EY(t,r)];return OY(t,e,i),n.object(...i)}function TY({errorPath:t},{instancePath:e}){let r=e?(0,Ke.str)`${t}${(0,Sb.getErrorPath)(e,Sb.Type.Str)}`:t;return[nn.default.instancePath,(0,Ke.strConcat)(nn.default.instancePath,r)]}function EY({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,Ke.str)`${e}/${t}`;return r&&(o=(0,Ke.str)`${o}${(0,Sb.getErrorPath)(r,Sb.Type.Str)}`),[Xa.schemaPath,o]}function OY(t,{params:e,message:r},n){let{keyword:o,data:i,schemaValue:s,it:a}=t,{opts:c,propertyName:l,topSchemaRef:u,schemaPath:d}=a;n.push([Xa.keyword,o],[Xa.params,typeof e=="function"?e(t):e||(0,Ke._)`{}`]),c.messages&&n.push([Xa.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Xa.schema,s],[Xa.parentSchema,(0,Ke._)`${u}${d}`],[nn.default.data,i]),l&&n.push([Xa.propertyName,l])}});var H4=g(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});Au.boolOrEmptySchema=Au.topBoolOrEmptySchema=void 0;var jY=km(),NY=Ne(),zY=Xi(),RY={message:"boolean schema is false"};function MY(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Z4(t,!1):typeof r=="object"&&r.$async===!0?e.return(zY.default.data):(e.assign((0,NY._)`${n}.errors`,null),e.return(!0))}Au.topBoolOrEmptySchema=MY;function qY(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Z4(t)):r.var(e,!0)}Au.boolOrEmptySchema=qY;function Z4(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,jY.reportError)(o,RY,void 0,e)}});var dC=g(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.getRules=Pu.isJSONType=void 0;var DY=["string","number","integer","boolean","null","object","array"],BY=new Set(DY);function UY(t){return typeof t=="string"&&BY.has(t)}Pu.isJSONType=UY;function LY(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Pu.getRules=LY});var pC=g(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.shouldUseRule=Gs.shouldUseGroup=Gs.schemaHasRulesForType=void 0;function FY({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&G4(t,n)}Gs.schemaHasRulesForType=FY;function G4(t,e){return e.rules.some(r=>W4(t,r))}Gs.shouldUseGroup=G4;function W4(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Gs.shouldUseRule=W4});var $m=g(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.reportTypeError=Fr.checkDataTypes=Fr.checkDataType=Fr.coerceAndCheckDataType=Fr.getJSONTypes=Fr.getSchemaTypes=Fr.DataType=void 0;var VY=dC(),ZY=pC(),HY=km(),Ae=Ne(),K4=rt(),Cu;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Cu||(Fr.DataType=Cu={}));function GY(t){let e=J4(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Fr.getSchemaTypes=GY;function J4(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(VY.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Fr.getJSONTypes=J4;function WY(t,e){let{gen:r,data:n,opts:o}=t,i=KY(e,o.coerceTypes),s=e.length>0&&!(i.length===0&&e.length===1&&(0,ZY.schemaHasRulesForType)(t,e[0]));if(s){let a=mC(e,n,o.strictNumbers,Cu.Wrong);r.if(a,()=>{i.length?JY(t,e,i):hC(t)})}return s}Fr.coerceAndCheckDataType=WY;var Y4=new Set(["string","number","integer","boolean","null"]);function KY(t,e){return e?t.filter(r=>Y4.has(r)||e==="array"&&r==="array"):[]}function JY(t,e,r){let{gen:n,data:o,opts:i}=t,s=n.let("dataType",(0,Ae._)`typeof ${o}`),a=n.let("coerced",(0,Ae._)`undefined`);i.coerceTypes==="array"&&n.if((0,Ae._)`${s} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,Ae._)`${o}[0]`).assign(s,(0,Ae._)`typeof ${o}`).if(mC(e,o,i.strictNumbers),()=>n.assign(a,o))),n.if((0,Ae._)`${a} !== undefined`);for(let l of r)(Y4.has(l)||l==="array"&&i.coerceTypes==="array")&&c(l);n.else(),hC(t),n.endIf(),n.if((0,Ae._)`${a} !== undefined`,()=>{n.assign(o,a),YY(t,a)});function c(l){switch(l){case"string":n.elseIf((0,Ae._)`${s} == "number" || ${s} == "boolean"`).assign(a,(0,Ae._)`"" + ${o}`).elseIf((0,Ae._)`${o} === null`).assign(a,(0,Ae._)`""`);return;case"number":n.elseIf((0,Ae._)`${s} == "boolean" || ${o} === null
              || (${s} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,Ae._)`+${o}`);return;case"integer":n.elseIf((0,Ae._)`${s} === "boolean" || ${o} === null
              || (${s} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,Ae._)`+${o}`);return;case"boolean":n.elseIf((0,Ae._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,Ae._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,Ae._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,Ae._)`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${o} === null`).assign(a,(0,Ae._)`[${o}]`)}}}function YY({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,Ae._)`${e} !== undefined`,()=>t.assign((0,Ae._)`${e}[${r}]`,n))}function fC(t,e,r,n=Cu.Correct){let o=n===Cu.Correct?Ae.operators.EQ:Ae.operators.NEQ,i;switch(t){case"null":return(0,Ae._)`${e} ${o} null`;case"array":i=(0,Ae._)`Array.isArray(${e})`;break;case"object":i=(0,Ae._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=s((0,Ae._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=s();break;default:return(0,Ae._)`typeof ${e} ${o} ${t}`}return n===Cu.Correct?i:(0,Ae.not)(i);function s(a=Ae.nil){return(0,Ae.and)((0,Ae._)`typeof ${e} == "number"`,a,r?(0,Ae._)`isFinite(${e})`:Ae.nil)}}Fr.checkDataType=fC;function mC(t,e,r,n){if(t.length===1)return fC(t[0],e,r,n);let o,i=(0,K4.toHash)(t);if(i.array&&i.object){let s=(0,Ae._)`typeof ${e} != "object"`;o=i.null?s:(0,Ae._)`!${e} || ${s}`,delete i.null,delete i.array,delete i.object}else o=Ae.nil;i.number&&delete i.integer;for(let s in i)o=(0,Ae.and)(o,fC(s,e,r,n));return o}Fr.checkDataTypes=mC;var XY={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,Ae._)`{type: ${t}}`:(0,Ae._)`{type: ${e}}`};function hC(t){let e=QY(t);(0,HY.reportError)(e,XY)}Fr.reportTypeError=hC;function QY(t){let{gen:e,data:r,schema:n}=t,o=(0,K4.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var Q4=g(kb=>{"use strict";Object.defineProperty(kb,"__esModule",{value:!0});kb.assignDefaults=void 0;var Iu=Ne(),eX=rt();function tX(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)X4(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,i)=>X4(t,i,o.default))}kb.assignDefaults=tX;function X4(t,e,r){let{gen:n,compositeRule:o,data:i,opts:s}=t;if(r===void 0)return;let a=(0,Iu._)`${i}${(0,Iu.getProperty)(e)}`;if(o){(0,eX.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,Iu._)`${a} === undefined`;s.useDefaults==="empty"&&(c=(0,Iu._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,Iu._)`${a} = ${(0,Iu.stringify)(r)}`)}});var oo=g(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.validateUnion=mt.validateArray=mt.usePattern=mt.callValidateCode=mt.schemaProperties=mt.allSchemaProperties=mt.noPropertyInData=mt.propertyInData=mt.isOwnProperty=mt.hasPropFunc=mt.reportMissingProp=mt.checkMissingProp=mt.checkReportMissingProp=void 0;var jt=Ne(),gC=rt(),Ws=Xi(),rX=rt();function nX(t,e){let{gen:r,data:n,it:o}=t;r.if(vC(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,jt._)`${e}`},!0),t.error()})}mt.checkReportMissingProp=nX;function oX({gen:t,data:e,it:{opts:r}},n,o){return(0,jt.or)(...n.map(i=>(0,jt.and)(vC(t,e,i,r.ownProperties),(0,jt._)`${o} = ${i}`)))}mt.checkMissingProp=oX;function iX(t,e){t.setParams({missingProperty:e},!0),t.error()}mt.reportMissingProp=iX;function e2(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,jt._)`Object.prototype.hasOwnProperty`})}mt.hasPropFunc=e2;function yC(t,e,r){return(0,jt._)`${e2(t)}.call(${e}, ${r})`}mt.isOwnProperty=yC;function sX(t,e,r,n){let o=(0,jt._)`${e}${(0,jt.getProperty)(r)} !== undefined`;return n?(0,jt._)`${o} && ${yC(t,e,r)}`:o}mt.propertyInData=sX;function vC(t,e,r,n){let o=(0,jt._)`${e}${(0,jt.getProperty)(r)} === undefined`;return n?(0,jt.or)(o,(0,jt.not)(yC(t,e,r))):o}mt.noPropertyInData=vC;function t2(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}mt.allSchemaProperties=t2;function aX(t,e){return t2(e).filter(r=>!(0,gC.alwaysValidSchema)(t,e[r]))}mt.schemaProperties=aX;function cX({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:i},it:s},a,c,l){let u=l?(0,jt._)`${t}, ${e}, ${n}${o}`:e,d=[[Ws.default.instancePath,(0,jt.strConcat)(Ws.default.instancePath,i)],[Ws.default.parentData,s.parentData],[Ws.default.parentDataProperty,s.parentDataProperty],[Ws.default.rootData,Ws.default.rootData]];s.opts.dynamicRef&&d.push([Ws.default.dynamicAnchors,Ws.default.dynamicAnchors]);let p=(0,jt._)`${u}, ${r.object(...d)}`;return c!==jt.nil?(0,jt._)`${a}.call(${c}, ${p})`:(0,jt._)`${a}(${p})`}mt.callValidateCode=cX;var lX=(0,jt._)`new RegExp`;function uX({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,i=o(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,jt._)`${o.code==="new RegExp"?lX:(0,rX.useFunc)(t,o)}(${r}, ${n})`})}mt.usePattern=uX;function dX(t){let{gen:e,data:r,keyword:n,it:o}=t,i=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return s(()=>e.assign(a,!1)),a}return e.var(i,!0),s(()=>e.break()),i;function s(a){let c=e.const("len",(0,jt._)`${r}.length`);e.forRange("i",0,c,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:gC.Type.Num},i),e.if((0,jt.not)(i),a)})}}mt.validateArray=dX;function pX(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,gC.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let s=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,l)=>{let u=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(s,(0,jt._)`${s} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,jt.not)(s))})),t.result(s,()=>t.reset(),()=>t.error(!0))}mt.validateUnion=pX});var o2=g(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.validateKeywordUsage=ui.validSchemaType=ui.funcKeywordCode=ui.macroKeywordCode=void 0;var on=Ne(),Qa=Xi(),fX=oo(),mX=km();function hX(t,e){let{gen:r,keyword:n,schema:o,parentSchema:i,it:s}=t,a=e.macro.call(s.self,o,i,s),c=n2(r,n,a);s.opts.validateSchema!==!1&&s.self.validateSchema(a,!0);let l=r.name("valid");t.subschema({schema:a,schemaPath:on.nil,errSchemaPath:`${s.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}ui.macroKeywordCode=hX;function gX(t,e){var r;let{gen:n,keyword:o,schema:i,parentSchema:s,$data:a,it:c}=t;vX(c,e);let l=!a&&e.compile?e.compile.call(c.self,i,s,c):e.validate,u=n2(n,o,l),d=n.let("valid");t.block$data(d,p),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function p(){if(e.errors===!1)m(),e.modifying&&r2(t),y(()=>t.error());else{let v=e.async?f():h();e.modifying&&r2(t),y(()=>yX(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>m((0,on._)`await `),w=>n.assign(d,!1).if((0,on._)`${w} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,on._)`${w}.errors`),()=>n.throw(w))),v}function h(){let v=(0,on._)`${u}.errors`;return n.assign(v,null),m(on.nil),v}function m(v=e.async?(0,on._)`await `:on.nil){let w=c.opts.passContext?Qa.default.this:Qa.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,on._)`${v}${(0,fX.callValidateCode)(t,u,w,$)}`,e.modifying)}function y(v){var w;n.if((0,on.not)((w=e.valid)!==null&&w!==void 0?w:d),v)}}ui.funcKeywordCode=gX;function r2(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,on._)`${n.parentData}[${n.parentDataProperty}]`))}function yX(t,e){let{gen:r}=t;r.if((0,on._)`Array.isArray(${e})`,()=>{r.assign(Qa.default.vErrors,(0,on._)`${Qa.default.vErrors} === null ? ${e} : ${Qa.default.vErrors}.concat(${e})`).assign(Qa.default.errors,(0,on._)`${Qa.default.vErrors}.length`),(0,mX.extendErrors)(t)},()=>t.error())}function vX({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function n2(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,on.stringify)(r)})}function _X(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}ui.validSchemaType=_X;function bX({schema:t,opts:e,self:r,errSchemaPath:n},o,i){if(Array.isArray(o.keyword)?!o.keyword.includes(i):o.keyword!==i)throw new Error("ajv implementation error");let s=o.dependencies;if(s?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[i])){let c=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}ui.validateKeywordUsage=bX});var s2=g(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.extendSubschemaMode=Ks.extendSubschemaData=Ks.getSubschema=void 0;var di=Ne(),i2=rt();function wX(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:i,topSchemaRef:s}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,di._)`${t.schemaPath}${(0,di.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,di._)`${t.schemaPath}${(0,di.getProperty)(e)}${(0,di.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,i2.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||i===void 0||s===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:s,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}Ks.getSubschema=wX;function xX(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:i,propertyName:s}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:l,dataPathArr:u,opts:d}=e,p=a.let("data",(0,di._)`${e.data}${(0,di.getProperty)(r)}`,!0);c(p),t.errorPath=(0,di.str)`${l}${(0,i2.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,di._)`${r}`,t.dataPathArr=[...u,t.parentDataProperty]}if(o!==void 0){let l=o instanceof di.Name?o:a.let("data",o,!0);c(l),s!==void 0&&(t.propertyName=s)}i&&(t.dataTypes=i);function c(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}Ks.extendSubschemaData=xX;function SX(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:i}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}Ks.extendSubschemaMode=SX});var Am=g((ske,a2)=>{"use strict";a2.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;o--!==0;){var s=i[o];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}});var l2=g((ake,c2)=>{"use strict";var Js=c2.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};$b(e,n,o,t,"",t)};Js.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Js.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Js.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Js.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function $b(t,e,r,n,o,i,s,a,c,l){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,i,s,a,c,l);for(var u in n){var d=n[u];if(Array.isArray(d)){if(u in Js.arrayKeywords)for(var p=0;p<d.length;p++)$b(t,e,r,d[p],o+"/"+u+"/"+p,i,o,u,n,p)}else if(u in Js.propsKeywords){if(d&&typeof d=="object")for(var f in d)$b(t,e,r,d[f],o+"/"+u+"/"+kX(f),i,o,u,n,f)}else(u in Js.keywords||t.allKeys&&!(u in Js.skipKeywords))&&$b(t,e,r,d,o+"/"+u,i,o,u,n)}r(n,o,i,s,a,c,l)}}function kX(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Pm=g(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.getSchemaRefs=gn.resolveUrl=gn.normalizeId=gn._getFullPath=gn.getFullPath=gn.inlineRef=void 0;var $X=rt(),AX=Am(),PX=l2(),CX=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function IX(t,e=!0){return typeof t=="boolean"?!0:e===!0?!_C(t):e?u2(t)<=e:!1}gn.inlineRef=IX;var TX=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function _C(t){for(let e in t){if(TX.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(_C)||typeof r=="object"&&_C(r))return!0}return!1}function u2(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!CX.has(r)&&(typeof t[r]=="object"&&(0,$X.eachItem)(t[r],n=>e+=u2(n)),e===1/0))return 1/0}return e}function d2(t,e="",r){r!==!1&&(e=Tu(e));let n=t.parse(e);return p2(t,n)}gn.getFullPath=d2;function p2(t,e){return t.serialize(e).split("#")[0]+"#"}gn._getFullPath=p2;var EX=/#\/?$/;function Tu(t){return t?t.replace(EX,""):""}gn.normalizeId=Tu;function OX(t,e,r){return r=Tu(r),t.resolve(e,r)}gn.resolveUrl=OX;var jX=/^[a-z_][-a-z0-9._]*$/i;function NX(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=Tu(t[r]||e),i={"":o},s=d2(n,o,!1),a={},c=new Set;return PX(t,{allKeys:!0},(d,p,f,h)=>{if(h===void 0)return;let m=s+p,y=i[h];typeof d[r]=="string"&&(y=v.call(this,d[r])),w.call(this,d.$anchor),w.call(this,d.$dynamicAnchor),i[p]=y;function v($){let R=this.opts.uriResolver.resolve;if($=Tu(y?R(y,$):$),c.has($))throw u($);c.add($);let P=this.refs[$];return typeof P=="string"&&(P=this.refs[P]),typeof P=="object"?l(d,P.schema,$):$!==Tu(m)&&($[0]==="#"?(l(d,a[$],$),a[$]=d):this.refs[$]=m),$}function w($){if(typeof $=="string"){if(!jX.test($))throw new Error(`invalid anchor "${$}"`);v.call(this,`#${$}`)}}}),a;function l(d,p,f){if(p!==void 0&&!AX(d,p))throw u(f)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}gn.getSchemaRefs=NX});var Tm=g(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.getData=Ys.KeywordCxt=Ys.validateFunctionCode=void 0;var y2=H4(),f2=$m(),wC=pC(),Ab=$m(),zX=Q4(),Im=o2(),bC=s2(),oe=Ne(),ve=Xi(),RX=Pm(),Qi=rt(),Cm=km();function MX(t){if(b2(t)&&(w2(t),_2(t))){BX(t);return}v2(t,()=>(0,y2.topBoolOrEmptySchema)(t))}Ys.validateFunctionCode=MX;function v2({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},i){o.code.es5?t.func(e,(0,oe._)`${ve.default.data}, ${ve.default.valCxt}`,n.$async,()=>{t.code((0,oe._)`"use strict"; ${m2(r,o)}`),DX(t,o),t.code(i)}):t.func(e,(0,oe._)`${ve.default.data}, ${qX(o)}`,n.$async,()=>t.code(m2(r,o)).code(i))}function qX(t){return(0,oe._)`{${ve.default.instancePath}="", ${ve.default.parentData}, ${ve.default.parentDataProperty}, ${ve.default.rootData}=${ve.default.data}${t.dynamicRef?(0,oe._)`, ${ve.default.dynamicAnchors}={}`:oe.nil}}={}`}function DX(t,e){t.if(ve.default.valCxt,()=>{t.var(ve.default.instancePath,(0,oe._)`${ve.default.valCxt}.${ve.default.instancePath}`),t.var(ve.default.parentData,(0,oe._)`${ve.default.valCxt}.${ve.default.parentData}`),t.var(ve.default.parentDataProperty,(0,oe._)`${ve.default.valCxt}.${ve.default.parentDataProperty}`),t.var(ve.default.rootData,(0,oe._)`${ve.default.valCxt}.${ve.default.rootData}`),e.dynamicRef&&t.var(ve.default.dynamicAnchors,(0,oe._)`${ve.default.valCxt}.${ve.default.dynamicAnchors}`)},()=>{t.var(ve.default.instancePath,(0,oe._)`""`),t.var(ve.default.parentData,(0,oe._)`undefined`),t.var(ve.default.parentDataProperty,(0,oe._)`undefined`),t.var(ve.default.rootData,ve.default.data),e.dynamicRef&&t.var(ve.default.dynamicAnchors,(0,oe._)`{}`)})}function BX(t){let{schema:e,opts:r,gen:n}=t;v2(t,()=>{r.$comment&&e.$comment&&S2(t),ZX(t),n.let(ve.default.vErrors,null),n.let(ve.default.errors,0),r.unevaluated&&UX(t),x2(t),WX(t)})}function UX(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,oe._)`${r}.evaluated`),e.if((0,oe._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,oe._)`${t.evaluated}.props`,(0,oe._)`undefined`)),e.if((0,oe._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,oe._)`${t.evaluated}.items`,(0,oe._)`undefined`))}function m2(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,oe._)`/*# sourceURL=${r} */`:oe.nil}function LX(t,e){if(b2(t)&&(w2(t),_2(t))){FX(t,e);return}(0,y2.boolOrEmptySchema)(t,e)}function _2({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function b2(t){return typeof t.schema!="boolean"}function FX(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&S2(t),HX(t),GX(t);let i=n.const("_errs",ve.default.errors);x2(t,i),n.var(e,(0,oe._)`${i} === ${ve.default.errors}`)}function w2(t){(0,Qi.checkUnknownRules)(t),VX(t)}function x2(t,e){if(t.opts.jtd)return h2(t,[],!1,e);let r=(0,f2.getSchemaTypes)(t.schema),n=(0,f2.coerceAndCheckDataType)(t,r);h2(t,r,!n,e)}function VX(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Qi.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function ZX(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Qi.checkStrictMode)(t,"default is ignored in the schema root")}function HX(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,RX.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function GX(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function S2({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let i=r.$comment;if(o.$comment===!0)t.code((0,oe._)`${ve.default.self}.logger.log(${i})`);else if(typeof o.$comment=="function"){let s=(0,oe.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,oe._)`${ve.default.self}.opts.$comment(${i}, ${s}, ${a}.schema)`)}}function WX(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:i}=t;r.$async?e.if((0,oe._)`${ve.default.errors} === 0`,()=>e.return(ve.default.data),()=>e.throw((0,oe._)`new ${o}(${ve.default.vErrors})`)):(e.assign((0,oe._)`${n}.errors`,ve.default.vErrors),i.unevaluated&&KX(t),e.return((0,oe._)`${ve.default.errors} === 0`))}function KX({gen:t,evaluated:e,props:r,items:n}){r instanceof oe.Name&&t.assign((0,oe._)`${e}.props`,r),n instanceof oe.Name&&t.assign((0,oe._)`${e}.items`,n)}function h2(t,e,r,n){let{gen:o,schema:i,data:s,allErrors:a,opts:c,self:l}=t,{RULES:u}=l;if(i.$ref&&(c.ignoreKeywordsWithRef||!(0,Qi.schemaHasRulesButRef)(i,u))){o.block(()=>$2(t,"$ref",u.all.$ref.definition));return}c.jtd||JX(t,e),o.block(()=>{for(let p of u.rules)d(p);d(u.post)});function d(p){(0,wC.shouldUseGroup)(i,p)&&(p.type?(o.if((0,Ab.checkDataType)(p.type,s,c.strictNumbers)),g2(t,p),e.length===1&&e[0]===p.type&&r&&(o.else(),(0,Ab.reportTypeError)(t)),o.endIf()):g2(t,p),a||o.if((0,oe._)`${ve.default.errors} === ${n||0}`))}}function g2(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,zX.assignDefaults)(t,e.type),r.block(()=>{for(let i of e.rules)(0,wC.shouldUseRule)(n,i)&&$2(t,i.keyword,i.definition,e.type)})}function JX(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(YX(t,e),t.opts.allowUnionTypes||XX(t,e),QX(t,t.dataTypes))}function YX(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{k2(t.dataTypes,r)||xC(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),tQ(t,e)}}function XX(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&xC(t,"use allowUnionTypes to allow union type keyword")}function QX(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,wC.shouldUseRule)(t.schema,o)){let{type:i}=o.definition;i.length&&!i.some(s=>eQ(e,s))&&xC(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function eQ(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function k2(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function tQ(t,e){let r=[];for(let n of t.dataTypes)k2(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function xC(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Qi.checkStrictMode)(t,e,t.opts.strictTypes)}var Pb=class{constructor(e,r,n){if((0,Im.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Qi.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",A2(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Im.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",ve.default.errors))}result(e,r,n){this.failResult((0,oe.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,oe.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,oe._)`${r} !== undefined && (${(0,oe.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?Cm.reportExtraError:Cm.reportError)(this,this.def.error,r)}$dataError(){(0,Cm.reportError)(this,this.def.$dataError||Cm.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Cm.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=oe.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=oe.nil,r=oe.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:i,def:s}=this;n.if((0,oe.or)((0,oe._)`${o} === undefined`,r)),e!==oe.nil&&n.assign(e,!0),(i.length||s.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==oe.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:i}=this;return(0,oe.or)(s(),a());function s(){if(n.length){if(!(r instanceof oe.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,oe._)`${(0,Ab.checkDataTypes)(c,r,i.opts.strictNumbers,Ab.DataType.Wrong)}`}return oe.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,oe._)`!${c}(${r})`}return oe.nil}}subschema(e,r){let n=(0,bC.getSubschema)(this.it,e);(0,bC.extendSubschemaData)(n,this.it,e),(0,bC.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return LX(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Qi.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Qi.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,oe.Name)),!0}};Ys.KeywordCxt=Pb;function $2(t,e,r,n){let o=new Pb(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,Im.funcKeywordCode)(o,r):"macro"in r?(0,Im.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,Im.funcKeywordCode)(o,r)}var rQ=/^\/(?:[^~]|~0|~1)*$/,nQ=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function A2(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,i;if(t==="")return ve.default.rootData;if(t[0]==="/"){if(!rQ.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,i=ve.default.rootData}else{let l=nQ.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);let u=+l[1];if(o=l[2],o==="#"){if(u>=e)throw new Error(c("property/index",u));return n[e-u]}if(u>e)throw new Error(c("data",u));if(i=r[e-u],!o)return i}let s=i,a=o.split("/");for(let l of a)l&&(i=(0,oe._)`${i}${(0,oe.getProperty)((0,Qi.unescapeJsonPointer)(l))}`,s=(0,oe._)`${s} && ${i}`);return s;function c(l,u){return`Cannot access ${l} ${u} levels up, current level is ${e}`}}Ys.getData=A2});var Cb=g(kC=>{"use strict";Object.defineProperty(kC,"__esModule",{value:!0});var SC=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};kC.default=SC});var Em=g(PC=>{"use strict";Object.defineProperty(PC,"__esModule",{value:!0});var $C=Pm(),AC=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,$C.resolveUrl)(e,r,n),this.missingSchema=(0,$C.normalizeId)((0,$C.getFullPath)(e,this.missingRef))}};PC.default=AC});var Tb=g(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.resolveSchema=io.getCompilingSchema=io.resolveRef=io.compileSchema=io.SchemaEnv=void 0;var Oo=Ne(),oQ=Cb(),ec=Xi(),jo=Pm(),P2=rt(),iQ=Tm(),Eu=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,jo.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};io.SchemaEnv=Eu;function IC(t){let e=C2.call(this,t);if(e)return e;let r=(0,jo.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:i}=this.opts,s=new Oo.CodeGen(this.scope,{es5:n,lines:o,ownProperties:i}),a;t.$async&&(a=s.scopeValue("Error",{ref:oQ.default,code:(0,Oo._)`require("ajv/dist/runtime/validation_error").default`}));let c=s.scopeName("validate");t.validateName=c;let l={gen:s,allErrors:this.opts.allErrors,data:ec.default.data,parentData:ec.default.parentData,parentDataProperty:ec.default.parentDataProperty,dataNames:[ec.default.data],dataPathArr:[Oo.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:s.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Oo.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Oo.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Oo._)`""`,opts:this.opts,self:this},u;try{this._compilations.add(t),(0,iQ.validateFunctionCode)(l),s.optimize(this.opts.code.optimize);let d=s.toString();u=`${s.scopeRefs(ec.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));let f=new Function(`${ec.default.self}`,`${ec.default.scope}`,u)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:s._values}),this.opts.unevaluated){let{props:h,items:m}=l;f.evaluated={props:h instanceof Oo.Name?void 0:h,items:m instanceof Oo.Name?void 0:m,dynamicProps:h instanceof Oo.Name,dynamicItems:m instanceof Oo.Name},f.source&&(f.source.evaluated=(0,Oo.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}io.compileSchema=IC;function sQ(t,e,r){var n;r=(0,jo.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let i=lQ.call(this,t,r);if(i===void 0){let s=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;s&&(i=new Eu({schema:s,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=aQ.call(this,i)}io.resolveRef=sQ;function aQ(t){return(0,jo.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:IC.call(this,t)}function C2(t){for(let e of this._compilations)if(cQ(e,t))return e}io.getCompilingSchema=C2;function cQ(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function lQ(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Ib.call(this,t,e)}function Ib(t,e){let r=this.opts.uriResolver.parse(e),n=(0,jo._getFullPath)(this.opts.uriResolver,r),o=(0,jo.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return CC.call(this,r,t);let i=(0,jo.normalizeId)(n),s=this.refs[i]||this.schemas[i];if(typeof s=="string"){let a=Ib.call(this,t,s);return typeof a?.schema!="object"?void 0:CC.call(this,r,a)}if(typeof s?.schema=="object"){if(s.validate||IC.call(this,s),i===(0,jo.normalizeId)(e)){let{schema:a}=s,{schemaId:c}=this.opts,l=a[c];return l&&(o=(0,jo.resolveUrl)(this.opts.uriResolver,o,l)),new Eu({schema:a,schemaId:c,root:t,baseId:o})}return CC.call(this,r,s)}}io.resolveSchema=Ib;var uQ=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function CC(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,P2.unescapeFragment)(a)];if(c===void 0)return;r=c;let l=typeof r=="object"&&r[this.opts.schemaId];!uQ.has(a)&&l&&(e=(0,jo.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,P2.schemaHasRulesButRef)(r,this.RULES)){let a=(0,jo.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=Ib.call(this,n,a)}let{schemaId:s}=this.opts;if(i=i||new Eu({schema:r,schemaId:s,root:n,baseId:e}),i.schema!==i.root.schema)return i}});var I2=g((fke,dQ)=>{dQ.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var EC=g((mke,j2)=>{"use strict";var pQ=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),E2=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function TC(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var fQ=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function T2(t){return t.length=0,!0}function mQ(t,e,r){if(t.length){let n=TC(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function hQ(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],i=!1,s=!1,a=mQ;for(let c=0;c<t.length;c++){let l=t[c];if(!(l==="["||l==="]"))if(l===":"){if(i===!0&&(s=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(i=!0),n.push(":");continue}else if(l==="%"){if(!a(o,n,r))break;a=T2}else{o.push(l);continue}}return o.length&&(a===T2?r.zone=o.join(""):s?n.push(o.join("")):n.push(TC(o))),r.address=n.join(""),r}function O2(t){if(gQ(t,":")<2)return{host:t,isIPV6:!1};let e=hQ(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function gQ(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function yQ(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function vQ(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function _Q(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!E2(r)){let n=O2(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}j2.exports={nonSimpleDomain:fQ,recomposeAuthority:_Q,normalizeComponentEncoding:vQ,removeDotSegments:yQ,isIPv4:E2,isUUID:pQ,normalizeIPv6:O2,stringArrayToHexStripped:TC}});var q2=g((hke,M2)=>{"use strict";var{isUUID:bQ}=EC(),wQ=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,xQ=["http","https","ws","wss","urn","urn:uuid"];function SQ(t){return xQ.indexOf(t)!==-1}function OC(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function N2(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function z2(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function kQ(t){return t.secure=OC(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function $Q(t){if((t.port===(OC(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function AQ(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(wQ);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,i=jC(o);t.path=void 0,i&&(t=i.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function PQ(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,i=jC(o);i&&(t=i.serialize(t,e));let s=t,a=t.nss;return s.path=`${n||e.nid}:${a}`,e.skipEscape=!0,s}function CQ(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!bQ(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function IQ(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var R2={scheme:"http",domainHost:!0,parse:N2,serialize:z2},TQ={scheme:"https",domainHost:R2.domainHost,parse:N2,serialize:z2},Eb={scheme:"ws",domainHost:!0,parse:kQ,serialize:$Q},EQ={scheme:"wss",domainHost:Eb.domainHost,parse:Eb.parse,serialize:Eb.serialize},OQ={scheme:"urn",parse:AQ,serialize:PQ,skipNormalize:!0},jQ={scheme:"urn:uuid",parse:CQ,serialize:IQ,skipNormalize:!0},Ob={http:R2,https:TQ,ws:Eb,wss:EQ,urn:OQ,"urn:uuid":jQ};Object.setPrototypeOf(Ob,null);function jC(t){return t&&(Ob[t]||Ob[t.toLowerCase()])||void 0}M2.exports={wsIsSecure:OC,SCHEMES:Ob,isValidSchemeName:SQ,getSchemeHandler:jC}});var zC=g((gke,Nb)=>{"use strict";var{normalizeIPv6:NQ,removeDotSegments:Om,recomposeAuthority:zQ,normalizeComponentEncoding:jb,isIPv4:RQ,nonSimpleDomain:MQ}=EC(),{SCHEMES:qQ,getSchemeHandler:D2}=q2();function DQ(t,e){return typeof t=="string"?t=pi(es(t,e),e):typeof t=="object"&&(t=es(pi(t,e),e)),t}function BQ(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=B2(es(t,n),es(e,n),n,!0);return n.skipEscape=!0,pi(o,n)}function B2(t,e,r,n){let o={};return n||(t=es(pi(t,r),r),e=es(pi(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=Om(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=Om(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=Om(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=Om(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function UQ(t,e,r){return typeof t=="string"?(t=unescape(t),t=pi(jb(es(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=pi(jb(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=pi(jb(es(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=pi(jb(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function pi(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],i=D2(n.scheme||r.scheme);i&&i.serialize&&i.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let s=zQ(r);if(s!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(s),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!i||!i.absolutePath)&&(a=Om(a)),s===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var LQ=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function es(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let i=t.match(LQ);if(i){if(n.scheme=i[1],n.userinfo=i[3],n.host=i[4],n.port=parseInt(i[5],10),n.path=i[6]||"",n.query=i[7],n.fragment=i[8],isNaN(n.port)&&(n.port=i[5]),n.host)if(RQ(n.host)===!1){let c=NQ(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let s=D2(r.scheme||n.scheme);if(!r.unicodeSupport&&(!s||!s.unicodeSupport)&&n.host&&(r.domainHost||s&&s.domainHost)&&o===!1&&MQ(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!s||s&&!s.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),s&&s.parse&&s.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var NC={SCHEMES:qQ,normalize:DQ,resolve:BQ,resolveComponent:B2,equal:UQ,serialize:pi,parse:es};Nb.exports=NC;Nb.exports.default=NC;Nb.exports.fastUri=NC});var L2=g(RC=>{"use strict";Object.defineProperty(RC,"__esModule",{value:!0});var U2=zC();U2.code='require("ajv/dist/runtime/uri").default';RC.default=U2});var J2=g(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.CodeGen=Tr.Name=Tr.nil=Tr.stringify=Tr.str=Tr._=Tr.KeywordCxt=void 0;var FQ=Tm();Object.defineProperty(Tr,"KeywordCxt",{enumerable:!0,get:function(){return FQ.KeywordCxt}});var Ou=Ne();Object.defineProperty(Tr,"_",{enumerable:!0,get:function(){return Ou._}});Object.defineProperty(Tr,"str",{enumerable:!0,get:function(){return Ou.str}});Object.defineProperty(Tr,"stringify",{enumerable:!0,get:function(){return Ou.stringify}});Object.defineProperty(Tr,"nil",{enumerable:!0,get:function(){return Ou.nil}});Object.defineProperty(Tr,"Name",{enumerable:!0,get:function(){return Ou.Name}});Object.defineProperty(Tr,"CodeGen",{enumerable:!0,get:function(){return Ou.CodeGen}});var VQ=Cb(),G2=Em(),ZQ=dC(),jm=Tb(),HQ=Ne(),Nm=Pm(),zb=$m(),qC=rt(),F2=I2(),GQ=L2(),W2=(t,e)=>new RegExp(t,e);W2.code="new RegExp";var WQ=["removeAdditional","useDefaults","coerceTypes"],KQ=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),JQ={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},YQ={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},V2=200;function XQ(t){var e,r,n,o,i,s,a,c,l,u,d,p,f,h,m,y,v,w,$,R,P,ce,Te,be,et;let Ge=t.strict,ar=(e=t.code)===null||e===void 0?void 0:e.optimize,Xr=ar===!0||ar===void 0?1:ar||0,Wt=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:W2,ii=(o=t.uriResolver)!==null&&o!==void 0?o:GQ.default;return{strictSchema:(s=(i=t.strictSchema)!==null&&i!==void 0?i:Ge)!==null&&s!==void 0?s:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:Ge)!==null&&c!==void 0?c:!0,strictTypes:(u=(l=t.strictTypes)!==null&&l!==void 0?l:Ge)!==null&&u!==void 0?u:"log",strictTuples:(p=(d=t.strictTuples)!==null&&d!==void 0?d:Ge)!==null&&p!==void 0?p:"log",strictRequired:(h=(f=t.strictRequired)!==null&&f!==void 0?f:Ge)!==null&&h!==void 0?h:!1,code:t.code?{...t.code,optimize:Xr,regExp:Wt}:{optimize:Xr,regExp:Wt},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:V2,loopEnum:(y=t.loopEnum)!==null&&y!==void 0?y:V2,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(w=t.messages)!==null&&w!==void 0?w:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(R=t.schemaId)!==null&&R!==void 0?R:"$id",addUsedSchema:(P=t.addUsedSchema)!==null&&P!==void 0?P:!0,validateSchema:(ce=t.validateSchema)!==null&&ce!==void 0?ce:!0,validateFormats:(Te=t.validateFormats)!==null&&Te!==void 0?Te:!0,unicodeRegExp:(be=t.unicodeRegExp)!==null&&be!==void 0?be:!0,int32range:(et=t.int32range)!==null&&et!==void 0?et:!0,uriResolver:ii}}var zm=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...XQ(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new HQ.ValueScope({scope:{},prefixes:KQ,es5:r,lines:n}),this.logger=oee(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,ZQ.getRules)(),Z2.call(this,JQ,e,"NOT SUPPORTED"),Z2.call(this,YQ,e,"DEPRECATED","warn"),this._metaOpts=ree.call(this),e.formats&&eee.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&tee.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),QQ.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=F2;n==="id"&&(o={...F2},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(u,d){await i.call(this,u.$schema);let p=this._addSchema(u,d);return p.validate||s.call(this,p)}async function i(u){u&&!this.getSchema(u)&&await o.call(this,{$ref:u},!0)}async function s(u){try{return this._compileSchemaEnv(u)}catch(d){if(!(d instanceof G2.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),s.call(this,u)}}function a({missingSchema:u,missingRef:d}){if(this.refs[u])throw new Error(`AnySchema ${u} is loaded but ${d} cannot be resolved`)}async function c(u){let d=await l.call(this,u);this.refs[u]||await i.call(this,d.$schema),this.refs[u]||this.addSchema(d,u,r)}async function l(u){let d=this._loading[u];if(d)return d;try{return await(this._loading[u]=n(u))}finally{delete this._loading[u]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let s of e)this.addSchema(s,void 0,n,o);return this}let i;if(typeof e=="object"){let{schemaId:s}=this.opts;if(i=e[s],i!==void 0&&typeof i!="string")throw new Error(`schema ${s} must be string`)}return r=(0,Nm.normalizeId)(r||i),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let i="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(i);else throw new Error(i)}return o}getSchema(e){let r;for(;typeof(r=H2.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new jm.SchemaEnv({schema:{},schemaId:n});if(r=jm.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=H2.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,Nm.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(see.call(this,n,r),!r)return(0,qC.eachItem)(n,i=>MC.call(this,i)),this;cee.call(this,r);let o={...r,type:(0,zb.getJSONTypes)(r.type),schemaType:(0,zb.getJSONTypes)(r.schemaType)};return(0,qC.eachItem)(n,o.type.length===0?i=>MC.call(this,i,o):i=>o.type.forEach(s=>MC.call(this,i,o,s))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(i=>i.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,i)=>o+r+i)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let i=o.split("/").slice(1),s=e;for(let a of i)s=s[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:l}=c.definition,u=s[a];l&&u&&(s[a]=K2(u))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,i=this.opts.addUsedSchema){let s,{schemaId:a}=this.opts;if(typeof e=="object")s=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,Nm.normalizeId)(s||n);let l=Nm.getSchemaRefs.call(this,e,n);return c=new jm.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:l}),this._cache.set(c.schema,c),i&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):jm.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{jm.compileSchema.call(this,e)}finally{this.opts=r}}};zm.ValidationError=VQ.default;zm.MissingRefError=G2.default;Tr.default=zm;function Z2(t,e,r,n="error"){for(let o in t){let i=o;i in e&&this.logger[n](`${r}: option ${o}. ${t[i]}`)}}function H2(t){return t=(0,Nm.normalizeId)(t),this.schemas[t]||this.refs[t]}function QQ(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function eee(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function tee(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function ree(){let t={...this.opts};for(let e of WQ)delete t[e];return t}var nee={log(){},warn(){},error(){}};function oee(t){if(t===!1)return nee;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var iee=/^[a-z_$][a-z0-9_$:-]*$/i;function see(t,e){let{RULES:r}=this;if((0,qC.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!iee.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function MC(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:i}=this,s=o?i.post:i.rules.find(({type:c})=>c===r);if(s||(s={type:r,rules:[]},i.rules.push(s)),i.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,zb.getJSONTypes)(e.type),schemaType:(0,zb.getJSONTypes)(e.schemaType)}};e.before?aee.call(this,s,a,e.before):s.rules.push(a),i.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function aee(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function cee(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=K2(e)),t.validateSchema=this.compile(e,!0))}var lee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function K2(t){return{anyOf:[t,lee]}}});var Y2=g(DC=>{"use strict";Object.defineProperty(DC,"__esModule",{value:!0});var uee={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};DC.default=uee});var tB=g(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.callRef=tc.getValidate=void 0;var dee=Em(),X2=oo(),yn=Ne(),ju=Xi(),Q2=Tb(),Rb=rt(),pee={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:i,validateName:s,opts:a,self:c}=n,{root:l}=i;if((r==="#"||r==="#/")&&o===l.baseId)return d();let u=Q2.resolveRef.call(c,l,o,r);if(u===void 0)throw new dee.default(n.opts.uriResolver,o,r);if(u instanceof Q2.SchemaEnv)return p(u);return f(u);function d(){if(i===l)return Mb(t,s,i,i.$async);let h=e.scopeValue("root",{ref:l});return Mb(t,(0,yn._)`${h}.validate`,l,l.$async)}function p(h){let m=eB(t,h);Mb(t,m,h,h.$async)}function f(h){let m=e.scopeValue("schema",a.code.source===!0?{ref:h,code:(0,yn.stringify)(h)}:{ref:h}),y=e.name("valid"),v=t.subschema({schema:h,dataTypes:[],schemaPath:yn.nil,topSchemaRef:m,errSchemaPath:r},y);t.mergeEvaluated(v),t.ok(y)}}};function eB(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,yn._)`${r.scopeValue("wrapper",{ref:e})}.validate`}tc.getValidate=eB;function Mb(t,e,r,n){let{gen:o,it:i}=t,{allErrors:s,schemaEnv:a,opts:c}=i,l=c.passContext?ju.default.this:yn.nil;n?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");let h=o.let("valid");o.try(()=>{o.code((0,yn._)`await ${(0,X2.callValidateCode)(t,e,l)}`),f(e),s||o.assign(h,!0)},m=>{o.if((0,yn._)`!(${m} instanceof ${i.ValidationError})`,()=>o.throw(m)),p(m),s||o.assign(h,!1)}),t.ok(h)}function d(){t.result((0,X2.callValidateCode)(t,e,l),()=>f(e),()=>p(e))}function p(h){let m=(0,yn._)`${h}.errors`;o.assign(ju.default.vErrors,(0,yn._)`${ju.default.vErrors} === null ? ${m} : ${ju.default.vErrors}.concat(${m})`),o.assign(ju.default.errors,(0,yn._)`${ju.default.vErrors}.length`)}function f(h){var m;if(!i.opts.unevaluated)return;let y=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(i.props!==!0)if(y&&!y.dynamicProps)y.props!==void 0&&(i.props=Rb.mergeEvaluated.props(o,y.props,i.props));else{let v=o.var("props",(0,yn._)`${h}.evaluated.props`);i.props=Rb.mergeEvaluated.props(o,v,i.props,yn.Name)}if(i.items!==!0)if(y&&!y.dynamicItems)y.items!==void 0&&(i.items=Rb.mergeEvaluated.items(o,y.items,i.items));else{let v=o.var("items",(0,yn._)`${h}.evaluated.items`);i.items=Rb.mergeEvaluated.items(o,v,i.items,yn.Name)}}}tc.callRef=Mb;tc.default=pee});var rB=g(BC=>{"use strict";Object.defineProperty(BC,"__esModule",{value:!0});var fee=Y2(),mee=tB(),hee=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",fee.default,mee.default];BC.default=hee});var nB=g(UC=>{"use strict";Object.defineProperty(UC,"__esModule",{value:!0});var qb=Ne(),Xs=qb.operators,Db={maximum:{okStr:"<=",ok:Xs.LTE,fail:Xs.GT},minimum:{okStr:">=",ok:Xs.GTE,fail:Xs.LT},exclusiveMaximum:{okStr:"<",ok:Xs.LT,fail:Xs.GTE},exclusiveMinimum:{okStr:">",ok:Xs.GT,fail:Xs.LTE}},gee={message:({keyword:t,schemaCode:e})=>(0,qb.str)`must be ${Db[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,qb._)`{comparison: ${Db[t].okStr}, limit: ${e}}`},yee={keyword:Object.keys(Db),type:"number",schemaType:"number",$data:!0,error:gee,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,qb._)`${r} ${Db[e].fail} ${n} || isNaN(${r})`)}};UC.default=yee});var oB=g(LC=>{"use strict";Object.defineProperty(LC,"__esModule",{value:!0});var Rm=Ne(),vee={message:({schemaCode:t})=>(0,Rm.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Rm._)`{multipleOf: ${t}}`},_ee={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:vee,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,i=o.opts.multipleOfPrecision,s=e.let("res"),a=i?(0,Rm._)`Math.abs(Math.round(${s}) - ${s}) > 1e-${i}`:(0,Rm._)`${s} !== parseInt(${s})`;t.fail$data((0,Rm._)`(${n} === 0 || (${s} = ${r}/${n}, ${a}))`)}};LC.default=_ee});var sB=g(FC=>{"use strict";Object.defineProperty(FC,"__esModule",{value:!0});function iB(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}FC.default=iB;iB.code='require("ajv/dist/runtime/ucs2length").default'});var aB=g(VC=>{"use strict";Object.defineProperty(VC,"__esModule",{value:!0});var rc=Ne(),bee=rt(),wee=sB(),xee={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,rc.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,rc._)`{limit: ${t}}`},See={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:xee,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,i=e==="maxLength"?rc.operators.GT:rc.operators.LT,s=o.opts.unicode===!1?(0,rc._)`${r}.length`:(0,rc._)`${(0,bee.useFunc)(t.gen,wee.default)}(${r})`;t.fail$data((0,rc._)`${s} ${i} ${n}`)}};VC.default=See});var cB=g(ZC=>{"use strict";Object.defineProperty(ZC,"__esModule",{value:!0});var kee=oo(),Bb=Ne(),$ee={message:({schemaCode:t})=>(0,Bb.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Bb._)`{pattern: ${t}}`},Aee={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:$ee,code(t){let{data:e,$data:r,schema:n,schemaCode:o,it:i}=t,s=i.opts.unicodeRegExp?"u":"",a=r?(0,Bb._)`(new RegExp(${o}, ${s}))`:(0,kee.usePattern)(t,n);t.fail$data((0,Bb._)`!${a}.test(${e})`)}};ZC.default=Aee});var lB=g(HC=>{"use strict";Object.defineProperty(HC,"__esModule",{value:!0});var Mm=Ne(),Pee={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Mm.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Mm._)`{limit: ${t}}`},Cee={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Pee,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?Mm.operators.GT:Mm.operators.LT;t.fail$data((0,Mm._)`Object.keys(${r}).length ${o} ${n}`)}};HC.default=Cee});var uB=g(GC=>{"use strict";Object.defineProperty(GC,"__esModule",{value:!0});var qm=oo(),Dm=Ne(),Iee=rt(),Tee={message:({params:{missingProperty:t}})=>(0,Dm.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Dm._)`{missingProperty: ${t}}`},Eee={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Tee,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:i,it:s}=t,{opts:a}=s;if(!i&&r.length===0)return;let c=r.length>=a.loopRequired;if(s.allErrors?l():u(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:h}=t.it;for(let m of r)if(f?.[m]===void 0&&!h.has(m)){let y=s.schemaEnv.baseId+s.errSchemaPath,v=`required property "${m}" is not defined at "${y}" (strictRequired)`;(0,Iee.checkStrictMode)(s,v,s.opts.strictRequired)}}function l(){if(c||i)t.block$data(Dm.nil,d);else for(let f of r)(0,qm.checkReportMissingProp)(t,f)}function u(){let f=e.let("missing");if(c||i){let h=e.let("valid",!0);t.block$data(h,()=>p(f,h)),t.ok(h)}else e.if((0,qm.checkMissingProp)(t,r,f)),(0,qm.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,qm.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function p(f,h){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(h,(0,qm.propertyInData)(e,o,f,a.ownProperties)),e.if((0,Dm.not)(h),()=>{t.error(),e.break()})},Dm.nil)}}};GC.default=Eee});var dB=g(WC=>{"use strict";Object.defineProperty(WC,"__esModule",{value:!0});var Bm=Ne(),Oee={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,Bm.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,Bm._)`{limit: ${t}}`},jee={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Oee,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?Bm.operators.GT:Bm.operators.LT;t.fail$data((0,Bm._)`${r}.length ${o} ${n}`)}};WC.default=jee});var Ub=g(KC=>{"use strict";Object.defineProperty(KC,"__esModule",{value:!0});var pB=Am();pB.code='require("ajv/dist/runtime/equal").default';KC.default=pB});var fB=g(YC=>{"use strict";Object.defineProperty(YC,"__esModule",{value:!0});var JC=$m(),Er=Ne(),Nee=rt(),zee=Ub(),Ree={message:({params:{i:t,j:e}})=>(0,Er.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Er._)`{i: ${t}, j: ${e}}`},Mee={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Ree,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:i,schemaCode:s,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),l=i.items?(0,JC.getSchemaTypes)(i.items):[];t.block$data(c,u,(0,Er._)`${s} === false`),t.ok(c);function u(){let h=e.let("i",(0,Er._)`${r}.length`),m=e.let("j");t.setParams({i:h,j:m}),e.assign(c,!0),e.if((0,Er._)`${h} > 1`,()=>(d()?p:f)(h,m))}function d(){return l.length>0&&!l.some(h=>h==="object"||h==="array")}function p(h,m){let y=e.name("item"),v=(0,JC.checkDataTypes)(l,y,a.opts.strictNumbers,JC.DataType.Wrong),w=e.const("indices",(0,Er._)`{}`);e.for((0,Er._)`;${h}--;`,()=>{e.let(y,(0,Er._)`${r}[${h}]`),e.if(v,(0,Er._)`continue`),l.length>1&&e.if((0,Er._)`typeof ${y} == "string"`,(0,Er._)`${y} += "_"`),e.if((0,Er._)`typeof ${w}[${y}] == "number"`,()=>{e.assign(m,(0,Er._)`${w}[${y}]`),t.error(),e.assign(c,!1).break()}).code((0,Er._)`${w}[${y}] = ${h}`)})}function f(h,m){let y=(0,Nee.useFunc)(e,zee.default),v=e.name("outer");e.label(v).for((0,Er._)`;${h}--;`,()=>e.for((0,Er._)`${m} = ${h}; ${m}--;`,()=>e.if((0,Er._)`${y}(${r}[${h}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};YC.default=Mee});var mB=g(QC=>{"use strict";Object.defineProperty(QC,"__esModule",{value:!0});var XC=Ne(),qee=rt(),Dee=Ub(),Bee={message:"must be equal to constant",params:({schemaCode:t})=>(0,XC._)`{allowedValue: ${t}}`},Uee={keyword:"const",$data:!0,error:Bee,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,XC._)`!${(0,qee.useFunc)(e,Dee.default)}(${r}, ${o})`):t.fail((0,XC._)`${i} !== ${r}`)}};QC.default=Uee});var hB=g(eI=>{"use strict";Object.defineProperty(eI,"__esModule",{value:!0});var Um=Ne(),Lee=rt(),Fee=Ub(),Vee={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Um._)`{allowedValues: ${t}}`},Zee={keyword:"enum",schemaType:"array",$data:!0,error:Vee,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:i,it:s}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=s.opts.loopEnum,c,l=()=>c??(c=(0,Lee.useFunc)(e,Fee.default)),u;if(a||n)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",i);u=(0,Um.or)(...o.map((h,m)=>p(f,m)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",i,f=>e.if((0,Um._)`${l()}(${r}, ${f})`,()=>e.assign(u,!0).break()))}function p(f,h){let m=o[h];return typeof m=="object"&&m!==null?(0,Um._)`${l()}(${r}, ${f}[${h}])`:(0,Um._)`${r} === ${m}`}}};eI.default=Zee});var gB=g(tI=>{"use strict";Object.defineProperty(tI,"__esModule",{value:!0});var Hee=nB(),Gee=oB(),Wee=aB(),Kee=cB(),Jee=lB(),Yee=uB(),Xee=dB(),Qee=fB(),ete=mB(),tte=hB(),rte=[Hee.default,Gee.default,Wee.default,Kee.default,Jee.default,Yee.default,Xee.default,Qee.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},ete.default,tte.default];tI.default=rte});var nI=g(Lm=>{"use strict";Object.defineProperty(Lm,"__esModule",{value:!0});Lm.validateAdditionalItems=void 0;var nc=Ne(),rI=rt(),nte={message:({params:{len:t}})=>(0,nc.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,nc._)`{limit: ${t}}`},ote={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:nte,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,rI.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}yB(t,n)}};function yB(t,e){let{gen:r,schema:n,data:o,keyword:i,it:s}=t;s.items=!0;let a=r.const("len",(0,nc._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,nc._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,rI.alwaysValidSchema)(s,n)){let l=r.var("valid",(0,nc._)`${a} <= ${e.length}`);r.if((0,nc.not)(l),()=>c(l)),t.ok(l)}function c(l){r.forRange("i",e.length,a,u=>{t.subschema({keyword:i,dataProp:u,dataPropType:rI.Type.Num},l),s.allErrors||r.if((0,nc.not)(l),()=>r.break())})}}Lm.validateAdditionalItems=yB;Lm.default=ote});var oI=g(Fm=>{"use strict";Object.defineProperty(Fm,"__esModule",{value:!0});Fm.validateTuple=void 0;var vB=Ne(),Lb=rt(),ite=oo(),ste={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return _B(t,"additionalItems",e);r.items=!0,!(0,Lb.alwaysValidSchema)(r,e)&&t.ok((0,ite.validateArray)(t))}};function _B(t,e,r=t.schema){let{gen:n,parentSchema:o,data:i,keyword:s,it:a}=t;u(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Lb.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),l=n.const("len",(0,vB._)`${i}.length`);r.forEach((d,p)=>{(0,Lb.alwaysValidSchema)(a,d)||(n.if((0,vB._)`${l} > ${p}`,()=>t.subschema({keyword:s,schemaProp:p,dataProp:p},c)),t.ok(c))});function u(d){let{opts:p,errSchemaPath:f}=a,h=r.length,m=h===d.minItems&&(h===d.maxItems||d[e]===!1);if(p.strictTuples&&!m){let y=`"${s}" is ${h}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Lb.checkStrictMode)(a,y,p.strictTuples)}}}Fm.validateTuple=_B;Fm.default=ste});var bB=g(iI=>{"use strict";Object.defineProperty(iI,"__esModule",{value:!0});var ate=oI(),cte={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,ate.validateTuple)(t,"items")};iI.default=cte});var xB=g(sI=>{"use strict";Object.defineProperty(sI,"__esModule",{value:!0});var wB=Ne(),lte=rt(),ute=oo(),dte=nI(),pte={message:({params:{len:t}})=>(0,wB.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,wB._)`{limit: ${t}}`},fte={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:pte,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,lte.alwaysValidSchema)(n,e)&&(o?(0,dte.validateAdditionalItems)(t,o):t.ok((0,ute.validateArray)(t)))}};sI.default=fte});var SB=g(aI=>{"use strict";Object.defineProperty(aI,"__esModule",{value:!0});var so=Ne(),Fb=rt(),mte={message:({params:{min:t,max:e}})=>e===void 0?(0,so.str)`must contain at least ${t} valid item(s)`:(0,so.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,so._)`{minContains: ${t}}`:(0,so._)`{minContains: ${t}, maxContains: ${e}}`},hte={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:mte,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:i}=t,s,a,{minContains:c,maxContains:l}=n;i.opts.next?(s=c===void 0?1:c,a=l):s=1;let u=e.const("len",(0,so._)`${o}.length`);if(t.setParams({min:s,max:a}),a===void 0&&s===0){(0,Fb.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&s>a){(0,Fb.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Fb.alwaysValidSchema)(i,r)){let m=(0,so._)`${u} >= ${s}`;a!==void 0&&(m=(0,so._)`${m} && ${u} <= ${a}`),t.pass(m);return}i.items=!0;let d=e.name("valid");a===void 0&&s===1?f(d,()=>e.if(d,()=>e.break())):s===0?(e.let(d,!0),a!==void 0&&e.if((0,so._)`${o}.length > 0`,p)):(e.let(d,!1),p()),t.result(d,()=>t.reset());function p(){let m=e.name("_valid"),y=e.let("count",0);f(m,()=>e.if(m,()=>h(y)))}function f(m,y){e.forRange("i",0,u,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:Fb.Type.Num,compositeRule:!0},m),y()})}function h(m){e.code((0,so._)`${m}++`),a===void 0?e.if((0,so._)`${m} >= ${s}`,()=>e.assign(d,!0).break()):(e.if((0,so._)`${m} > ${a}`,()=>e.assign(d,!1).break()),s===1?e.assign(d,!0):e.if((0,so._)`${m} >= ${s}`,()=>e.assign(d,!0)))}}};aI.default=hte});var AB=g(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.validateSchemaDeps=fi.validatePropertyDeps=fi.error=void 0;var cI=Ne(),gte=rt(),Vm=oo();fi.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,cI.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,cI._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var yte={keyword:"dependencies",type:"object",schemaType:"object",error:fi.error,code(t){let[e,r]=vte(t);kB(t,e),$B(t,r)}};function vte({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function kB(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let i=r.let("missing");for(let s in e){let a=e[s];if(a.length===0)continue;let c=(0,Vm.propertyInData)(r,n,s,o.opts.ownProperties);t.setParams({property:s,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let l of a)(0,Vm.checkReportMissingProp)(t,l)}):(r.if((0,cI._)`${c} && (${(0,Vm.checkMissingProp)(t,a,i)})`),(0,Vm.reportMissingProp)(t,i),r.else())}}fi.validatePropertyDeps=kB;function $B(t,e=t.schema){let{gen:r,data:n,keyword:o,it:i}=t,s=r.name("valid");for(let a in e)(0,gte.alwaysValidSchema)(i,e[a])||(r.if((0,Vm.propertyInData)(r,n,a,i.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},s);t.mergeValidEvaluated(c,s)},()=>r.var(s,!0)),t.ok(s))}fi.validateSchemaDeps=$B;fi.default=yte});var CB=g(lI=>{"use strict";Object.defineProperty(lI,"__esModule",{value:!0});var PB=Ne(),_te=rt(),bte={message:"property name must be valid",params:({params:t})=>(0,PB._)`{propertyName: ${t.propertyName}}`},wte={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:bte,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,_te.alwaysValidSchema)(o,r))return;let i=e.name("valid");e.forIn("key",n,s=>{t.setParams({propertyName:s}),t.subschema({keyword:"propertyNames",data:s,dataTypes:["string"],propertyName:s,compositeRule:!0},i),e.if((0,PB.not)(i),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(i)}};lI.default=wte});var dI=g(uI=>{"use strict";Object.defineProperty(uI,"__esModule",{value:!0});var Vb=oo(),No=Ne(),xte=Xi(),Zb=rt(),Ste={message:"must NOT have additional properties",params:({params:t})=>(0,No._)`{additionalProperty: ${t.additionalProperty}}`},kte={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Ste,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:i,it:s}=t;if(!i)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=s;if(s.props=!0,c.removeAdditional!=="all"&&(0,Zb.alwaysValidSchema)(s,r))return;let l=(0,Vb.allSchemaProperties)(n.properties),u=(0,Vb.allSchemaProperties)(n.patternProperties);d(),t.ok((0,No._)`${i} === ${xte.default.errors}`);function d(){e.forIn("key",o,y=>{!l.length&&!u.length?h(y):e.if(p(y),()=>h(y))})}function p(y){let v;if(l.length>8){let w=(0,Zb.schemaRefOrVal)(s,n.properties,"properties");v=(0,Vb.isOwnProperty)(e,w,y)}else l.length?v=(0,No.or)(...l.map(w=>(0,No._)`${y} === ${w}`)):v=No.nil;return u.length&&(v=(0,No.or)(v,...u.map(w=>(0,No._)`${(0,Vb.usePattern)(t,w)}.test(${y})`))),(0,No.not)(v)}function f(y){e.code((0,No._)`delete ${o}[${y}]`)}function h(y){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(y);return}if(r===!1){t.setParams({additionalProperty:y}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Zb.alwaysValidSchema)(s,r)){let v=e.name("valid");c.removeAdditional==="failing"?(m(y,v,!1),e.if((0,No.not)(v),()=>{t.reset(),f(y)})):(m(y,v),a||e.if((0,No.not)(v),()=>e.break()))}}function m(y,v,w){let $={keyword:"additionalProperties",dataProp:y,dataPropType:Zb.Type.Str};w===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,v)}}};uI.default=kte});var EB=g(fI=>{"use strict";Object.defineProperty(fI,"__esModule",{value:!0});var $te=Tm(),IB=oo(),pI=rt(),TB=dI(),Ate={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&TB.default.code(new $te.KeywordCxt(i,TB.default,"additionalProperties"));let s=(0,IB.allSchemaProperties)(r);for(let d of s)i.definedProperties.add(d);i.opts.unevaluated&&s.length&&i.props!==!0&&(i.props=pI.mergeEvaluated.props(e,(0,pI.toHash)(s),i.props));let a=s.filter(d=>!(0,pI.alwaysValidSchema)(i,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)l(d)?u(d):(e.if((0,IB.propertyInData)(e,o,d,i.opts.ownProperties)),u(d),i.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};fI.default=Ate});var zB=g(mI=>{"use strict";Object.defineProperty(mI,"__esModule",{value:!0});var OB=oo(),Hb=Ne(),jB=rt(),NB=rt(),Pte={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:i}=t,{opts:s}=i,a=(0,OB.allSchemaProperties)(r),c=a.filter(m=>(0,jB.alwaysValidSchema)(i,r[m]));if(a.length===0||c.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;let l=s.strictSchema&&!s.allowMatchingProperties&&o.properties,u=e.name("valid");i.props!==!0&&!(i.props instanceof Hb.Name)&&(i.props=(0,NB.evaluatedPropsToName)(e,i.props));let{props:d}=i;p();function p(){for(let m of a)l&&f(m),i.allErrors?h(m):(e.var(u,!0),h(m),e.if(u))}function f(m){for(let y in l)new RegExp(m).test(y)&&(0,jB.checkStrictMode)(i,`property ${y} matches pattern ${m} (use allowMatchingProperties)`)}function h(m){e.forIn("key",n,y=>{e.if((0,Hb._)`${(0,OB.usePattern)(t,m)}.test(${y})`,()=>{let v=c.includes(m);v||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:y,dataPropType:NB.Type.Str},u),i.opts.unevaluated&&d!==!0?e.assign((0,Hb._)`${d}[${y}]`,!0):!v&&!i.allErrors&&e.if((0,Hb.not)(u),()=>e.break())})})}}};mI.default=Pte});var RB=g(hI=>{"use strict";Object.defineProperty(hI,"__esModule",{value:!0});var Cte=rt(),Ite={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Cte.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};hI.default=Ite});var MB=g(gI=>{"use strict";Object.defineProperty(gI,"__esModule",{value:!0});var Tte=oo(),Ete={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Tte.validateUnion,error:{message:"must match a schema in anyOf"}};gI.default=Ete});var qB=g(yI=>{"use strict";Object.defineProperty(yI,"__esModule",{value:!0});var Gb=Ne(),Ote=rt(),jte={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Gb._)`{passingSchemas: ${t.passing}}`},Nte={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:jte,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let i=r,s=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(s,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((u,d)=>{let p;(0,Ote.alwaysValidSchema)(o,u)?e.var(c,!0):p=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,Gb._)`${c} && ${s}`).assign(s,!1).assign(a,(0,Gb._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(s,!0),e.assign(a,d),p&&t.mergeEvaluated(p,Gb.Name)})})}}};yI.default=Nte});var DB=g(vI=>{"use strict";Object.defineProperty(vI,"__esModule",{value:!0});var zte=rt(),Rte={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((i,s)=>{if((0,zte.alwaysValidSchema)(n,i))return;let a=t.subschema({keyword:"allOf",schemaProp:s},o);t.ok(o),t.mergeEvaluated(a)})}};vI.default=Rte});var LB=g(_I=>{"use strict";Object.defineProperty(_I,"__esModule",{value:!0});var Wb=Ne(),UB=rt(),Mte={message:({params:t})=>(0,Wb.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Wb._)`{failingKeyword: ${t.ifClause}}`},qte={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Mte,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,UB.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=BB(n,"then"),i=BB(n,"else");if(!o&&!i)return;let s=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&i){let u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,l("then",u),l("else",u))}else o?e.if(a,l("then")):e.if((0,Wb.not)(a),l("else"));t.pass(s,()=>t.error(!0));function c(){let u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function l(u,d){return()=>{let p=t.subschema({keyword:u},a);e.assign(s,a),t.mergeValidEvaluated(p,s),d?e.assign(d,(0,Wb._)`${u}`):t.setParams({ifClause:u})}}}};function BB(t,e){let r=t.schema[e];return r!==void 0&&!(0,UB.alwaysValidSchema)(t,r)}_I.default=qte});var FB=g(bI=>{"use strict";Object.defineProperty(bI,"__esModule",{value:!0});var Dte=rt(),Bte={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Dte.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};bI.default=Bte});var VB=g(wI=>{"use strict";Object.defineProperty(wI,"__esModule",{value:!0});var Ute=nI(),Lte=bB(),Fte=oI(),Vte=xB(),Zte=SB(),Hte=AB(),Gte=CB(),Wte=dI(),Kte=EB(),Jte=zB(),Yte=RB(),Xte=MB(),Qte=qB(),ere=DB(),tre=LB(),rre=FB();function nre(t=!1){let e=[Yte.default,Xte.default,Qte.default,ere.default,tre.default,rre.default,Gte.default,Wte.default,Hte.default,Kte.default,Jte.default];return t?e.push(Lte.default,Vte.default):e.push(Ute.default,Fte.default),e.push(Zte.default),e}wI.default=nre});var ZB=g(xI=>{"use strict";Object.defineProperty(xI,"__esModule",{value:!0});var tr=Ne(),ore={message:({schemaCode:t})=>(0,tr.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,tr._)`{format: ${t}}`},ire={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:ore,code(t,e){let{gen:r,data:n,$data:o,schema:i,schemaCode:s,it:a}=t,{opts:c,errSchemaPath:l,schemaEnv:u,self:d}=a;if(!c.validateFormats)return;o?p():f();function p(){let h=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,tr._)`${h}[${s}]`),y=r.let("fType"),v=r.let("format");r.if((0,tr._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(y,(0,tr._)`${m}.type || "string"`).assign(v,(0,tr._)`${m}.validate`),()=>r.assign(y,(0,tr._)`"string"`).assign(v,m)),t.fail$data((0,tr.or)(w(),$()));function w(){return c.strictSchema===!1?tr.nil:(0,tr._)`${s} && !${v}`}function $(){let R=u.$async?(0,tr._)`(${m}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,tr._)`${v}(${n})`,P=(0,tr._)`(typeof ${v} == "function" ? ${R} : ${v}.test(${n}))`;return(0,tr._)`${v} && ${v} !== true && ${y} === ${e} && !${P}`}}function f(){let h=d.formats[i];if(!h){w();return}if(h===!0)return;let[m,y,v]=$(h);m===e&&t.pass(R());function w(){if(c.strictSchema===!1){d.logger.warn(P());return}throw new Error(P());function P(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function $(P){let ce=P instanceof RegExp?(0,tr.regexpCode)(P):c.code.formats?(0,tr._)`${c.code.formats}${(0,tr.getProperty)(i)}`:void 0,Te=r.scopeValue("formats",{key:i,ref:P,code:ce});return typeof P=="object"&&!(P instanceof RegExp)?[P.type||"string",P.validate,(0,tr._)`${Te}.validate`]:["string",P,Te]}function R(){if(typeof h=="object"&&!(h instanceof RegExp)&&h.async){if(!u.$async)throw new Error("async format in sync schema");return(0,tr._)`await ${v}(${n})`}return typeof y=="function"?(0,tr._)`${v}(${n})`:(0,tr._)`${v}.test(${n})`}}}};xI.default=ire});var HB=g(SI=>{"use strict";Object.defineProperty(SI,"__esModule",{value:!0});var sre=ZB(),are=[sre.default];SI.default=are});var GB=g(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.contentVocabulary=Nu.metadataVocabulary=void 0;Nu.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Nu.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var KB=g(kI=>{"use strict";Object.defineProperty(kI,"__esModule",{value:!0});var cre=rB(),lre=gB(),ure=VB(),dre=HB(),WB=GB(),pre=[cre.default,lre.default,(0,ure.default)(),dre.default,WB.metadataVocabulary,WB.contentVocabulary];kI.default=pre});var YB=g(Kb=>{"use strict";Object.defineProperty(Kb,"__esModule",{value:!0});Kb.DiscrError=void 0;var JB;(function(t){t.Tag="tag",t.Mapping="mapping"})(JB||(Kb.DiscrError=JB={}))});var QB=g(AI=>{"use strict";Object.defineProperty(AI,"__esModule",{value:!0});var zu=Ne(),$I=YB(),XB=Tb(),fre=Em(),mre=rt(),hre={message:({params:{discrError:t,tagName:e}})=>t===$I.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,zu._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},gre={keyword:"discriminator",type:"object",schemaType:"object",error:hre,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:i}=t,{oneOf:s}=o;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!s)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),l=e.const("tag",(0,zu._)`${r}${(0,zu.getProperty)(a)}`);e.if((0,zu._)`typeof ${l} == "string"`,()=>u(),()=>t.error(!1,{discrError:$I.DiscrError.Tag,tag:l,tagName:a})),t.ok(c);function u(){let f=p();e.if(!1);for(let h in f)e.elseIf((0,zu._)`${l} === ${h}`),e.assign(c,d(f[h]));e.else(),t.error(!1,{discrError:$I.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){let h=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},h);return t.mergeEvaluated(m,zu.Name),h}function p(){var f;let h={},m=v(o),y=!0;for(let R=0;R<s.length;R++){let P=s[R];if(P?.$ref&&!(0,mre.schemaHasRulesButRef)(P,i.self.RULES)){let Te=P.$ref;if(P=XB.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,Te),P instanceof XB.SchemaEnv&&(P=P.schema),P===void 0)throw new fre.default(i.opts.uriResolver,i.baseId,Te)}let ce=(f=P?.properties)===null||f===void 0?void 0:f[a];if(typeof ce!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);y=y&&(m||v(P)),w(ce,R)}if(!y)throw new Error(`discriminator: "${a}" must be required`);return h;function v({required:R}){return Array.isArray(R)&&R.includes(a)}function w(R,P){if(R.const)$(R.const,P);else if(R.enum)for(let ce of R.enum)$(ce,P);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(R,P){if(typeof R!="string"||R in h)throw new Error(`discriminator: "${a}" values must be unique strings`);h[R]=P}}}};AI.default=gre});var eU=g((o$e,yre)=>{yre.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var rU=g((Nt,PI)=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.MissingRefError=Nt.ValidationError=Nt.CodeGen=Nt.Name=Nt.nil=Nt.stringify=Nt.str=Nt._=Nt.KeywordCxt=Nt.Ajv=void 0;var vre=J2(),_re=KB(),bre=QB(),tU=eU(),wre=["/properties"],Jb="http://json-schema.org/draft-07/schema",Ru=class extends vre.default{_addVocabularies(){super._addVocabularies(),_re.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(bre.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(tU,wre):tU;this.addMetaSchema(e,Jb,!1),this.refs["http://json-schema.org/schema"]=Jb}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Jb)?Jb:void 0)}};Nt.Ajv=Ru;PI.exports=Nt=Ru;PI.exports.Ajv=Ru;Object.defineProperty(Nt,"__esModule",{value:!0});Nt.default=Ru;var xre=Tm();Object.defineProperty(Nt,"KeywordCxt",{enumerable:!0,get:function(){return xre.KeywordCxt}});var Mu=Ne();Object.defineProperty(Nt,"_",{enumerable:!0,get:function(){return Mu._}});Object.defineProperty(Nt,"str",{enumerable:!0,get:function(){return Mu.str}});Object.defineProperty(Nt,"stringify",{enumerable:!0,get:function(){return Mu.stringify}});Object.defineProperty(Nt,"nil",{enumerable:!0,get:function(){return Mu.nil}});Object.defineProperty(Nt,"Name",{enumerable:!0,get:function(){return Mu.Name}});Object.defineProperty(Nt,"CodeGen",{enumerable:!0,get:function(){return Mu.CodeGen}});var Sre=Cb();Object.defineProperty(Nt,"ValidationError",{enumerable:!0,get:function(){return Sre.default}});var kre=Em();Object.defineProperty(Nt,"MissingRefError",{enumerable:!0,get:function(){return kre.default}})});var uU=g(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.formatNames=hi.fastFormats=hi.fullFormats=void 0;function mi(t,e){return{validate:t,compare:e}}hi.fullFormats={date:mi(sU,EI),time:mi(II(!0),OI),"date-time":mi(nU(!0),cU),"iso-time":mi(II(),aU),"iso-date-time":mi(nU(),lU),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Tre,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Mre,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Ere,int32:{type:"number",validate:Nre},int64:{type:"number",validate:zre},float:{type:"number",validate:iU},double:{type:"number",validate:iU},password:!0,binary:!0};hi.fastFormats={...hi.fullFormats,date:mi(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,EI),time:mi(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,OI),"date-time":mi(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,cU),"iso-time":mi(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,aU),"iso-date-time":mi(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,lU),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};hi.formatNames=Object.keys(hi.fullFormats);function $re(t){return t%4===0&&(t%100!==0||t%400===0)}var Are=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Pre=[0,31,28,31,30,31,30,31,31,30,31,30,31];function sU(t){let e=Are.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&$re(r)?29:Pre[n])}function EI(t,e){if(t&&e)return t>e?1:t<e?-1:0}var CI=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function II(t){return function(r){let n=CI.exec(r);if(!n)return!1;let o=+n[1],i=+n[2],s=+n[3],a=n[4],c=n[5]==="-"?-1:1,l=+(n[6]||0),u=+(n[7]||0);if(l>23||u>59||t&&!a)return!1;if(o<=23&&i<=59&&s<60)return!0;let d=i-u*c,p=o-l*c-(d<0?1:0);return(p===23||p===-1)&&(d===59||d===-1)&&s<61}}function OI(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function aU(t,e){if(!(t&&e))return;let r=CI.exec(t),n=CI.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var TI=/t|\s/i;function nU(t){let e=II(t);return function(n){let o=n.split(TI);return o.length===2&&sU(o[0])&&e(o[1])}}function cU(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function lU(t,e){if(!(t&&e))return;let[r,n]=t.split(TI),[o,i]=e.split(TI),s=EI(r,o);if(s!==void 0)return s||OI(n,i)}var Cre=/\/|:/,Ire=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Tre(t){return Cre.test(t)&&Ire.test(t)}var oU=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Ere(t){return oU.lastIndex=0,oU.test(t)}var Ore=-(2**31),jre=2**31-1;function Nre(t){return Number.isInteger(t)&&t<=jre&&t>=Ore}function zre(t){return Number.isInteger(t)}function iU(){return!0}var Rre=/[^\\]\\Z/;function Mre(t){if(Rre.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Gm=g(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.regexpCode=nt.getEsmExportName=nt.getProperty=nt.safeStringify=nt.stringify=nt.strConcat=nt.addCodeArg=nt.str=nt._=nt.nil=nt._Code=nt.Name=nt.IDENTIFIER=nt._CodeOrName=void 0;var Zm=class{};nt._CodeOrName=Zm;nt.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var oc=class extends Zm{constructor(e){if(super(),!nt.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};nt.Name=oc;var ao=class extends Zm{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof oc&&(r[n.str]=(r[n.str]||0)+1),r),{})}};nt._Code=ao;nt.nil=new ao("");function dU(t,...e){let r=[t[0]],n=0;for(;n<e.length;)NI(r,e[n]),r.push(t[++n]);return new ao(r)}nt._=dU;var jI=new ao("+");function pU(t,...e){let r=[Hm(t[0])],n=0;for(;n<e.length;)r.push(jI),NI(r,e[n]),r.push(jI,Hm(t[++n]));return qre(r),new ao(r)}nt.str=pU;function NI(t,e){e instanceof ao?t.push(...e._items):e instanceof oc?t.push(e):t.push(Ure(e))}nt.addCodeArg=NI;function qre(t){let e=1;for(;e<t.length-1;){if(t[e]===jI){let r=Dre(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function Dre(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof oc||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof oc))return`"${t}${e.slice(1)}`}function Bre(t,e){return e.emptyStr()?t:t.emptyStr()?e:pU`${t}${e}`}nt.strConcat=Bre;function Ure(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Hm(Array.isArray(t)?t.join(","):t)}function Lre(t){return new ao(Hm(t))}nt.stringify=Lre;function Hm(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}nt.safeStringify=Hm;function Fre(t){return typeof t=="string"&&nt.IDENTIFIER.test(t)?new ao(`.${t}`):dU`[${t}]`}nt.getProperty=Fre;function Vre(t){if(typeof t=="string"&&nt.IDENTIFIER.test(t))return new ao(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}nt.getEsmExportName=Vre;function Zre(t){return new ao(t.toString())}nt.regexpCode=Zre});var MI=g(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.ValueScope=_n.ValueScopeName=_n.Scope=_n.varKinds=_n.UsedValueState=void 0;var vn=Gm(),zI=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Yb;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Yb||(_n.UsedValueState=Yb={}));_n.varKinds={const:new vn.Name("const"),let:new vn.Name("let"),var:new vn.Name("var")};var Xb=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof vn.Name?e:this.name(e)}name(e){return new vn.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};_n.Scope=Xb;var Qb=class extends vn.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,vn._)`.${new vn.Name(r)}[${n}]`}};_n.ValueScopeName=Qb;var Hre=(0,vn._)`\n`,RI=class extends Xb{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?Hre:vn.nil}}get(){return this._scope}name(e){return new Qb(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:i}=o,s=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[i];if(a){let u=a.get(s);if(u)return u}else a=this._values[i]=new Map;a.set(s,o);let c=this._scope[i]||(this._scope[i]=[]),l=c.length;return c[l]=r.ref,o.setValue(r,{property:i,itemIndex:l}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,vn._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let i=vn.nil;for(let s in e){let a=e[s];if(!a)continue;let c=n[s]=n[s]||new Map;a.forEach(l=>{if(c.has(l))return;c.set(l,Yb.Started);let u=r(l);if(u){let d=this.opts.es5?_n.varKinds.var:_n.varKinds.const;i=(0,vn._)`${i}${d} ${l} = ${u};${this.opts._n}`}else if(u=o?.(l))i=(0,vn._)`${i}${u}${this.opts._n}`;else throw new zI(l);c.set(l,Yb.Completed)})}return i}};_n.ValueScope=RI});var Ie=g(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.or=je.and=je.not=je.CodeGen=je.operators=je.varKinds=je.ValueScopeName=je.ValueScope=je.Scope=je.Name=je.regexpCode=je.stringify=je.getProperty=je.nil=je.strConcat=je.str=je._=void 0;var He=Gm(),zo=MI(),Qs=Gm();Object.defineProperty(je,"_",{enumerable:!0,get:function(){return Qs._}});Object.defineProperty(je,"str",{enumerable:!0,get:function(){return Qs.str}});Object.defineProperty(je,"strConcat",{enumerable:!0,get:function(){return Qs.strConcat}});Object.defineProperty(je,"nil",{enumerable:!0,get:function(){return Qs.nil}});Object.defineProperty(je,"getProperty",{enumerable:!0,get:function(){return Qs.getProperty}});Object.defineProperty(je,"stringify",{enumerable:!0,get:function(){return Qs.stringify}});Object.defineProperty(je,"regexpCode",{enumerable:!0,get:function(){return Qs.regexpCode}});Object.defineProperty(je,"Name",{enumerable:!0,get:function(){return Qs.Name}});var nw=MI();Object.defineProperty(je,"Scope",{enumerable:!0,get:function(){return nw.Scope}});Object.defineProperty(je,"ValueScope",{enumerable:!0,get:function(){return nw.ValueScope}});Object.defineProperty(je,"ValueScopeName",{enumerable:!0,get:function(){return nw.ValueScopeName}});Object.defineProperty(je,"varKinds",{enumerable:!0,get:function(){return nw.varKinds}});je.operators={GT:new He._Code(">"),GTE:new He._Code(">="),LT:new He._Code("<"),LTE:new He._Code("<="),EQ:new He._Code("==="),NEQ:new He._Code("!=="),NOT:new He._Code("!"),OR:new He._Code("||"),AND:new He._Code("&&"),ADD:new He._Code("+")};var ts=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},qI=class extends ts{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?zo.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=Du(this.rhs,e,r)),this}get names(){return this.rhs instanceof He._CodeOrName?this.rhs.names:{}}},ew=class extends ts{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof He.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Du(this.rhs,e,r),this}get names(){let e=this.lhs instanceof He.Name?{}:{...this.lhs.names};return rw(e,this.rhs)}},DI=class extends ew{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},BI=class extends ts{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},UI=class extends ts{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},LI=class extends ts{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},FI=class extends ts{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Du(this.code,e,r),this}get names(){return this.code instanceof He._CodeOrName?this.code.names:{}}},Wm=class extends ts{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let i=n[o];i.optimizeNames(e,r)||(Gre(e,i.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>ac(e,r.names),{})}},rs=class extends Wm{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},VI=class extends Wm{},qu=class extends rs{};qu.kind="else";var ic=class t extends rs{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new qu(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(fU(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Du(this.condition,e,r),this}get names(){let e=super.names;return rw(e,this.condition),this.else&&ac(e,this.else.names),e}};ic.kind="if";var sc=class extends rs{};sc.kind="for";var ZI=class extends sc{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=Du(this.iteration,e,r),this}get names(){return ac(super.names,this.iteration.names)}},HI=class extends sc{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?zo.varKinds.var:this.varKind,{name:n,from:o,to:i}=this;return`for(${r} ${n}=${o}; ${n}<${i}; ${n}++)`+super.render(e)}get names(){let e=rw(super.names,this.from);return rw(e,this.to)}},tw=class extends sc{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=Du(this.iterable,e,r),this}get names(){return ac(super.names,this.iterable.names)}},Km=class extends rs{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Km.kind="func";var Jm=class extends Wm{render(e){return"return "+super.render(e)}};Jm.kind="return";var GI=class extends rs{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&ac(e,this.catch.names),this.finally&&ac(e,this.finally.names),e}},Ym=class extends rs{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Ym.kind="catch";var Xm=class extends rs{render(e){return"finally"+super.render(e)}};Xm.kind="finally";var WI=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new zo.Scope({parent:e}),this._nodes=[new VI]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let i=this._scope.toName(r);return n!==void 0&&o&&(this._constants[i.str]=n),this._leafNode(new qI(e,i,n)),i}const(e,r,n){return this._def(zo.varKinds.const,e,r,n)}let(e,r,n){return this._def(zo.varKinds.let,e,r,n)}var(e,r,n){return this._def(zo.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new ew(e,r,n))}add(e,r){return this._leafNode(new DI(e,je.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==He.nil&&this._leafNode(new FI(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,He.addCodeArg)(r,o));return r.push("}"),new He._Code(r)}if(e,r,n){if(this._blockNode(new ic(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new ic(e))}else(){return this._elseNode(new qu)}endIf(){return this._endBlockNode(ic,qu)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ZI(e),r)}forRange(e,r,n,o,i=this.opts.es5?zo.varKinds.var:zo.varKinds.let){let s=this._scope.toName(e);return this._for(new HI(i,s,r,n),()=>o(s))}forOf(e,r,n,o=zo.varKinds.const){let i=this._scope.toName(e);if(this.opts.es5){let s=r instanceof He.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,He._)`${s}.length`,a=>{this.var(i,(0,He._)`${s}[${a}]`),n(i)})}return this._for(new tw("of",o,i,r),()=>n(i))}forIn(e,r,n,o=this.opts.es5?zo.varKinds.var:zo.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,He._)`Object.keys(${r})`,n);let i=this._scope.toName(e);return this._for(new tw("in",o,i,r),()=>n(i))}endFor(){return this._endBlockNode(sc)}label(e){return this._leafNode(new BI(e))}break(e){return this._leafNode(new UI(e))}return(e){let r=new Jm;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Jm)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new GI;if(this._blockNode(o),this.code(e),r){let i=this.name("e");this._currNode=o.catch=new Ym(i),r(i)}return n&&(this._currNode=o.finally=new Xm,this.code(n)),this._endBlockNode(Ym,Xm)}throw(e){return this._leafNode(new LI(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=He.nil,n,o){return this._blockNode(new Km(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Km)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof ic))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};je.CodeGen=WI;function ac(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function rw(t,e){return e instanceof He._CodeOrName?ac(t,e.names):t}function Du(t,e,r){if(t instanceof He.Name)return n(t);if(!o(t))return t;return new He._Code(t._items.reduce((i,s)=>(s instanceof He.Name&&(s=n(s)),s instanceof He._Code?i.push(...s._items):i.push(s),i),[]));function n(i){let s=r[i.str];return s===void 0||e[i.str]!==1?i:(delete e[i.str],s)}function o(i){return i instanceof He._Code&&i._items.some(s=>s instanceof He.Name&&e[s.str]===1&&r[s.str]!==void 0)}}function Gre(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function fU(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,He._)`!${KI(t)}`}je.not=fU;var Wre=mU(je.operators.AND);function Kre(...t){return t.reduce(Wre)}je.and=Kre;var Jre=mU(je.operators.OR);function Yre(...t){return t.reduce(Jre)}je.or=Yre;function mU(t){return(e,r)=>e===He.nil?r:r===He.nil?e:(0,He._)`${KI(e)} ${t} ${KI(r)}`}function KI(t){return t instanceof He.Name?t:(0,He._)`(${t})`}});var ot=g(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.checkStrictMode=Re.getErrorPath=Re.Type=Re.useFunc=Re.setEvaluated=Re.evaluatedPropsToName=Re.mergeEvaluated=Re.eachItem=Re.unescapeJsonPointer=Re.escapeJsonPointer=Re.escapeFragment=Re.unescapeFragment=Re.schemaRefOrVal=Re.schemaHasRulesButRef=Re.schemaHasRules=Re.checkUnknownRules=Re.alwaysValidSchema=Re.toHash=void 0;var wt=Ie(),Xre=Gm();function Qre(t){let e={};for(let r of t)e[r]=!0;return e}Re.toHash=Qre;function ene(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(yU(t,e),!vU(e,t.self.RULES.all))}Re.alwaysValidSchema=ene;function yU(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let i in e)o[i]||wU(t,`unknown keyword: "${i}"`)}Re.checkUnknownRules=yU;function vU(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}Re.schemaHasRules=vU;function tne(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}Re.schemaHasRulesButRef=tne;function rne({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,wt._)`${r}`}return(0,wt._)`${t}${e}${(0,wt.getProperty)(n)}`}Re.schemaRefOrVal=rne;function nne(t){return _U(decodeURIComponent(t))}Re.unescapeFragment=nne;function one(t){return encodeURIComponent(YI(t))}Re.escapeFragment=one;function YI(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}Re.escapeJsonPointer=YI;function _U(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}Re.unescapeJsonPointer=_U;function ine(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}Re.eachItem=ine;function hU({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,i,s,a)=>{let c=s===void 0?i:s instanceof wt.Name?(i instanceof wt.Name?t(o,i,s):e(o,i,s),s):i instanceof wt.Name?(e(o,s,i),i):r(i,s);return a===wt.Name&&!(c instanceof wt.Name)?n(o,c):c}}Re.mergeEvaluated={props:hU({mergeNames:(t,e,r)=>t.if((0,wt._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,wt._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,wt._)`${r} || {}`).code((0,wt._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,wt._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,wt._)`${r} || {}`),XI(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:bU}),items:hU({mergeNames:(t,e,r)=>t.if((0,wt._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,wt._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,wt._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,wt._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function bU(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,wt._)`{}`);return e!==void 0&&XI(t,r,e),r}Re.evaluatedPropsToName=bU;function XI(t,e,r){Object.keys(r).forEach(n=>t.assign((0,wt._)`${e}${(0,wt.getProperty)(n)}`,!0))}Re.setEvaluated=XI;var gU={};function sne(t,e){return t.scopeValue("func",{ref:e,code:gU[e.code]||(gU[e.code]=new Xre._Code(e.code))})}Re.useFunc=sne;var JI;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(JI||(Re.Type=JI={}));function ane(t,e,r){if(t instanceof wt.Name){let n=e===JI.Num;return r?n?(0,wt._)`"[" + ${t} + "]"`:(0,wt._)`"['" + ${t} + "']"`:n?(0,wt._)`"/" + ${t}`:(0,wt._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,wt.getProperty)(t).toString():"/"+YI(t)}Re.getErrorPath=ane;function wU(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}Re.checkStrictMode=wU});var ns=g(QI=>{"use strict";Object.defineProperty(QI,"__esModule",{value:!0});var Vr=Ie(),cne={data:new Vr.Name("data"),valCxt:new Vr.Name("valCxt"),instancePath:new Vr.Name("instancePath"),parentData:new Vr.Name("parentData"),parentDataProperty:new Vr.Name("parentDataProperty"),rootData:new Vr.Name("rootData"),dynamicAnchors:new Vr.Name("dynamicAnchors"),vErrors:new Vr.Name("vErrors"),errors:new Vr.Name("errors"),this:new Vr.Name("this"),self:new Vr.Name("self"),scope:new Vr.Name("scope"),json:new Vr.Name("json"),jsonPos:new Vr.Name("jsonPos"),jsonLen:new Vr.Name("jsonLen"),jsonPart:new Vr.Name("jsonPart")};QI.default=cne});var Qm=g(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.extendErrors=Zr.resetErrorsCount=Zr.reportExtraError=Zr.reportError=Zr.keyword$DataError=Zr.keywordError=void 0;var Je=Ie(),ow=ot(),sn=ns();Zr.keywordError={message:({keyword:t})=>(0,Je.str)`must pass "${t}" keyword validation`};Zr.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Je.str)`"${t}" keyword must be ${e} ($data)`:(0,Je.str)`"${t}" keyword is invalid ($data)`};function lne(t,e=Zr.keywordError,r,n){let{it:o}=t,{gen:i,compositeRule:s,allErrors:a}=o,c=kU(t,e,r);n??(s||a)?xU(i,c):SU(o,(0,Je._)`[${c}]`)}Zr.reportError=lne;function une(t,e=Zr.keywordError,r){let{it:n}=t,{gen:o,compositeRule:i,allErrors:s}=n,a=kU(t,e,r);xU(o,a),i||s||SU(n,sn.default.vErrors)}Zr.reportExtraError=une;function dne(t,e){t.assign(sn.default.errors,e),t.if((0,Je._)`${sn.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Je._)`${sn.default.vErrors}.length`,e),()=>t.assign(sn.default.vErrors,null)))}Zr.resetErrorsCount=dne;function pne({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:i}){if(o===void 0)throw new Error("ajv implementation error");let s=t.name("err");t.forRange("i",o,sn.default.errors,a=>{t.const(s,(0,Je._)`${sn.default.vErrors}[${a}]`),t.if((0,Je._)`${s}.instancePath === undefined`,()=>t.assign((0,Je._)`${s}.instancePath`,(0,Je.strConcat)(sn.default.instancePath,i.errorPath))),t.assign((0,Je._)`${s}.schemaPath`,(0,Je.str)`${i.errSchemaPath}/${e}`),i.opts.verbose&&(t.assign((0,Je._)`${s}.schema`,r),t.assign((0,Je._)`${s}.data`,n))})}Zr.extendErrors=pne;function xU(t,e){let r=t.const("err",e);t.if((0,Je._)`${sn.default.vErrors} === null`,()=>t.assign(sn.default.vErrors,(0,Je._)`[${r}]`),(0,Je._)`${sn.default.vErrors}.push(${r})`),t.code((0,Je._)`${sn.default.errors}++`)}function SU(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,Je._)`new ${t.ValidationError}(${e})`):(r.assign((0,Je._)`${n}.errors`,e),r.return(!1))}var cc={keyword:new Je.Name("keyword"),schemaPath:new Je.Name("schemaPath"),params:new Je.Name("params"),propertyName:new Je.Name("propertyName"),message:new Je.Name("message"),schema:new Je.Name("schema"),parentSchema:new Je.Name("parentSchema")};function kU(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Je._)`{}`:fne(t,e,r)}function fne(t,e,r={}){let{gen:n,it:o}=t,i=[mne(o,r),hne(t,r)];return gne(t,e,i),n.object(...i)}function mne({errorPath:t},{instancePath:e}){let r=e?(0,Je.str)`${t}${(0,ow.getErrorPath)(e,ow.Type.Str)}`:t;return[sn.default.instancePath,(0,Je.strConcat)(sn.default.instancePath,r)]}function hne({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,Je.str)`${e}/${t}`;return r&&(o=(0,Je.str)`${o}${(0,ow.getErrorPath)(r,ow.Type.Str)}`),[cc.schemaPath,o]}function gne(t,{params:e,message:r},n){let{keyword:o,data:i,schemaValue:s,it:a}=t,{opts:c,propertyName:l,topSchemaRef:u,schemaPath:d}=a;n.push([cc.keyword,o],[cc.params,typeof e=="function"?e(t):e||(0,Je._)`{}`]),c.messages&&n.push([cc.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([cc.schema,s],[cc.parentSchema,(0,Je._)`${u}${d}`],[sn.default.data,i]),l&&n.push([cc.propertyName,l])}});var AU=g(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.boolOrEmptySchema=Bu.topBoolOrEmptySchema=void 0;var yne=Qm(),vne=Ie(),_ne=ns(),bne={message:"boolean schema is false"};function wne(t){let{gen:e,schema:r,validateName:n}=t;r===!1?$U(t,!1):typeof r=="object"&&r.$async===!0?e.return(_ne.default.data):(e.assign((0,vne._)`${n}.errors`,null),e.return(!0))}Bu.topBoolOrEmptySchema=wne;function xne(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),$U(t)):r.var(e,!0)}Bu.boolOrEmptySchema=xne;function $U(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,yne.reportError)(o,bne,void 0,e)}});var eT=g(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.getRules=Uu.isJSONType=void 0;var Sne=["string","number","integer","boolean","null","object","array"],kne=new Set(Sne);function $ne(t){return typeof t=="string"&&kne.has(t)}Uu.isJSONType=$ne;function Ane(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Uu.getRules=Ane});var tT=g(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.shouldUseRule=ea.shouldUseGroup=ea.schemaHasRulesForType=void 0;function Pne({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&PU(t,n)}ea.schemaHasRulesForType=Pne;function PU(t,e){return e.rules.some(r=>CU(t,r))}ea.shouldUseGroup=PU;function CU(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}ea.shouldUseRule=CU});var eh=g(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.reportTypeError=Hr.checkDataTypes=Hr.checkDataType=Hr.coerceAndCheckDataType=Hr.getJSONTypes=Hr.getSchemaTypes=Hr.DataType=void 0;var Cne=eT(),Ine=tT(),Tne=Qm(),Pe=Ie(),IU=ot(),Lu;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Lu||(Hr.DataType=Lu={}));function Ene(t){let e=TU(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Hr.getSchemaTypes=Ene;function TU(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(Cne.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Hr.getJSONTypes=TU;function One(t,e){let{gen:r,data:n,opts:o}=t,i=jne(e,o.coerceTypes),s=e.length>0&&!(i.length===0&&e.length===1&&(0,Ine.schemaHasRulesForType)(t,e[0]));if(s){let a=nT(e,n,o.strictNumbers,Lu.Wrong);r.if(a,()=>{i.length?Nne(t,e,i):oT(t)})}return s}Hr.coerceAndCheckDataType=One;var EU=new Set(["string","number","integer","boolean","null"]);function jne(t,e){return e?t.filter(r=>EU.has(r)||e==="array"&&r==="array"):[]}function Nne(t,e,r){let{gen:n,data:o,opts:i}=t,s=n.let("dataType",(0,Pe._)`typeof ${o}`),a=n.let("coerced",(0,Pe._)`undefined`);i.coerceTypes==="array"&&n.if((0,Pe._)`${s} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,Pe._)`${o}[0]`).assign(s,(0,Pe._)`typeof ${o}`).if(nT(e,o,i.strictNumbers),()=>n.assign(a,o))),n.if((0,Pe._)`${a} !== undefined`);for(let l of r)(EU.has(l)||l==="array"&&i.coerceTypes==="array")&&c(l);n.else(),oT(t),n.endIf(),n.if((0,Pe._)`${a} !== undefined`,()=>{n.assign(o,a),zne(t,a)});function c(l){switch(l){case"string":n.elseIf((0,Pe._)`${s} == "number" || ${s} == "boolean"`).assign(a,(0,Pe._)`"" + ${o}`).elseIf((0,Pe._)`${o} === null`).assign(a,(0,Pe._)`""`);return;case"number":n.elseIf((0,Pe._)`${s} == "boolean" || ${o} === null
              || (${s} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,Pe._)`+${o}`);return;case"integer":n.elseIf((0,Pe._)`${s} === "boolean" || ${o} === null
              || (${s} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,Pe._)`+${o}`);return;case"boolean":n.elseIf((0,Pe._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,Pe._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,Pe._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,Pe._)`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${o} === null`).assign(a,(0,Pe._)`[${o}]`)}}}function zne({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,Pe._)`${e} !== undefined`,()=>t.assign((0,Pe._)`${e}[${r}]`,n))}function rT(t,e,r,n=Lu.Correct){let o=n===Lu.Correct?Pe.operators.EQ:Pe.operators.NEQ,i;switch(t){case"null":return(0,Pe._)`${e} ${o} null`;case"array":i=(0,Pe._)`Array.isArray(${e})`;break;case"object":i=(0,Pe._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=s((0,Pe._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=s();break;default:return(0,Pe._)`typeof ${e} ${o} ${t}`}return n===Lu.Correct?i:(0,Pe.not)(i);function s(a=Pe.nil){return(0,Pe.and)((0,Pe._)`typeof ${e} == "number"`,a,r?(0,Pe._)`isFinite(${e})`:Pe.nil)}}Hr.checkDataType=rT;function nT(t,e,r,n){if(t.length===1)return rT(t[0],e,r,n);let o,i=(0,IU.toHash)(t);if(i.array&&i.object){let s=(0,Pe._)`typeof ${e} != "object"`;o=i.null?s:(0,Pe._)`!${e} || ${s}`,delete i.null,delete i.array,delete i.object}else o=Pe.nil;i.number&&delete i.integer;for(let s in i)o=(0,Pe.and)(o,rT(s,e,r,n));return o}Hr.checkDataTypes=nT;var Rne={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,Pe._)`{type: ${t}}`:(0,Pe._)`{type: ${e}}`};function oT(t){let e=Mne(t);(0,Tne.reportError)(e,Rne)}Hr.reportTypeError=oT;function Mne(t){let{gen:e,data:r,schema:n}=t,o=(0,IU.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var jU=g(iw=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});iw.assignDefaults=void 0;var Fu=Ie(),qne=ot();function Dne(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)OU(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,i)=>OU(t,i,o.default))}iw.assignDefaults=Dne;function OU(t,e,r){let{gen:n,compositeRule:o,data:i,opts:s}=t;if(r===void 0)return;let a=(0,Fu._)`${i}${(0,Fu.getProperty)(e)}`;if(o){(0,qne.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,Fu._)`${a} === undefined`;s.useDefaults==="empty"&&(c=(0,Fu._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,Fu._)`${a} = ${(0,Fu.stringify)(r)}`)}});var co=g(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.validateUnion=ht.validateArray=ht.usePattern=ht.callValidateCode=ht.schemaProperties=ht.allSchemaProperties=ht.noPropertyInData=ht.propertyInData=ht.isOwnProperty=ht.hasPropFunc=ht.reportMissingProp=ht.checkMissingProp=ht.checkReportMissingProp=void 0;var zt=Ie(),iT=ot(),ta=ns(),Bne=ot();function Une(t,e){let{gen:r,data:n,it:o}=t;r.if(aT(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,zt._)`${e}`},!0),t.error()})}ht.checkReportMissingProp=Une;function Lne({gen:t,data:e,it:{opts:r}},n,o){return(0,zt.or)(...n.map(i=>(0,zt.and)(aT(t,e,i,r.ownProperties),(0,zt._)`${o} = ${i}`)))}ht.checkMissingProp=Lne;function Fne(t,e){t.setParams({missingProperty:e},!0),t.error()}ht.reportMissingProp=Fne;function NU(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,zt._)`Object.prototype.hasOwnProperty`})}ht.hasPropFunc=NU;function sT(t,e,r){return(0,zt._)`${NU(t)}.call(${e}, ${r})`}ht.isOwnProperty=sT;function Vne(t,e,r,n){let o=(0,zt._)`${e}${(0,zt.getProperty)(r)} !== undefined`;return n?(0,zt._)`${o} && ${sT(t,e,r)}`:o}ht.propertyInData=Vne;function aT(t,e,r,n){let o=(0,zt._)`${e}${(0,zt.getProperty)(r)} === undefined`;return n?(0,zt.or)(o,(0,zt.not)(sT(t,e,r))):o}ht.noPropertyInData=aT;function zU(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}ht.allSchemaProperties=zU;function Zne(t,e){return zU(e).filter(r=>!(0,iT.alwaysValidSchema)(t,e[r]))}ht.schemaProperties=Zne;function Hne({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:i},it:s},a,c,l){let u=l?(0,zt._)`${t}, ${e}, ${n}${o}`:e,d=[[ta.default.instancePath,(0,zt.strConcat)(ta.default.instancePath,i)],[ta.default.parentData,s.parentData],[ta.default.parentDataProperty,s.parentDataProperty],[ta.default.rootData,ta.default.rootData]];s.opts.dynamicRef&&d.push([ta.default.dynamicAnchors,ta.default.dynamicAnchors]);let p=(0,zt._)`${u}, ${r.object(...d)}`;return c!==zt.nil?(0,zt._)`${a}.call(${c}, ${p})`:(0,zt._)`${a}(${p})`}ht.callValidateCode=Hne;var Gne=(0,zt._)`new RegExp`;function Wne({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,i=o(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,zt._)`${o.code==="new RegExp"?Gne:(0,Bne.useFunc)(t,o)}(${r}, ${n})`})}ht.usePattern=Wne;function Kne(t){let{gen:e,data:r,keyword:n,it:o}=t,i=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return s(()=>e.assign(a,!1)),a}return e.var(i,!0),s(()=>e.break()),i;function s(a){let c=e.const("len",(0,zt._)`${r}.length`);e.forRange("i",0,c,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:iT.Type.Num},i),e.if((0,zt.not)(i),a)})}}ht.validateArray=Kne;function Jne(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,iT.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let s=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,l)=>{let u=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(s,(0,zt._)`${s} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,zt.not)(s))})),t.result(s,()=>t.reset(),()=>t.error(!0))}ht.validateUnion=Jne});var qU=g(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.validateKeywordUsage=gi.validSchemaType=gi.funcKeywordCode=gi.macroKeywordCode=void 0;var an=Ie(),lc=ns(),Yne=co(),Xne=Qm();function Qne(t,e){let{gen:r,keyword:n,schema:o,parentSchema:i,it:s}=t,a=e.macro.call(s.self,o,i,s),c=MU(r,n,a);s.opts.validateSchema!==!1&&s.self.validateSchema(a,!0);let l=r.name("valid");t.subschema({schema:a,schemaPath:an.nil,errSchemaPath:`${s.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}gi.macroKeywordCode=Qne;function eoe(t,e){var r;let{gen:n,keyword:o,schema:i,parentSchema:s,$data:a,it:c}=t;roe(c,e);let l=!a&&e.compile?e.compile.call(c.self,i,s,c):e.validate,u=MU(n,o,l),d=n.let("valid");t.block$data(d,p),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function p(){if(e.errors===!1)m(),e.modifying&&RU(t),y(()=>t.error());else{let v=e.async?f():h();e.modifying&&RU(t),y(()=>toe(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>m((0,an._)`await `),w=>n.assign(d,!1).if((0,an._)`${w} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,an._)`${w}.errors`),()=>n.throw(w))),v}function h(){let v=(0,an._)`${u}.errors`;return n.assign(v,null),m(an.nil),v}function m(v=e.async?(0,an._)`await `:an.nil){let w=c.opts.passContext?lc.default.this:lc.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,an._)`${v}${(0,Yne.callValidateCode)(t,u,w,$)}`,e.modifying)}function y(v){var w;n.if((0,an.not)((w=e.valid)!==null&&w!==void 0?w:d),v)}}gi.funcKeywordCode=eoe;function RU(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,an._)`${n.parentData}[${n.parentDataProperty}]`))}function toe(t,e){let{gen:r}=t;r.if((0,an._)`Array.isArray(${e})`,()=>{r.assign(lc.default.vErrors,(0,an._)`${lc.default.vErrors} === null ? ${e} : ${lc.default.vErrors}.concat(${e})`).assign(lc.default.errors,(0,an._)`${lc.default.vErrors}.length`),(0,Xne.extendErrors)(t)},()=>t.error())}function roe({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function MU(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,an.stringify)(r)})}function noe(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}gi.validSchemaType=noe;function ooe({schema:t,opts:e,self:r,errSchemaPath:n},o,i){if(Array.isArray(o.keyword)?!o.keyword.includes(i):o.keyword!==i)throw new Error("ajv implementation error");let s=o.dependencies;if(s?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[i])){let c=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}gi.validateKeywordUsage=ooe});var BU=g(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.extendSubschemaMode=ra.extendSubschemaData=ra.getSubschema=void 0;var yi=Ie(),DU=ot();function ioe(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:i,topSchemaRef:s}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,yi._)`${t.schemaPath}${(0,yi.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,yi._)`${t.schemaPath}${(0,yi.getProperty)(e)}${(0,yi.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,DU.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||i===void 0||s===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:s,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}ra.getSubschema=ioe;function soe(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:i,propertyName:s}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:l,dataPathArr:u,opts:d}=e,p=a.let("data",(0,yi._)`${e.data}${(0,yi.getProperty)(r)}`,!0);c(p),t.errorPath=(0,yi.str)`${l}${(0,DU.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,yi._)`${r}`,t.dataPathArr=[...u,t.parentDataProperty]}if(o!==void 0){let l=o instanceof yi.Name?o:a.let("data",o,!0);c(l),s!==void 0&&(t.propertyName=s)}i&&(t.dataTypes=i);function c(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}ra.extendSubschemaData=soe;function aoe(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:i}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}ra.extendSubschemaMode=aoe});var LU=g((b$e,UU)=>{"use strict";var na=UU.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};sw(e,n,o,t,"",t)};na.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};na.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};na.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};na.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function sw(t,e,r,n,o,i,s,a,c,l){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,i,s,a,c,l);for(var u in n){var d=n[u];if(Array.isArray(d)){if(u in na.arrayKeywords)for(var p=0;p<d.length;p++)sw(t,e,r,d[p],o+"/"+u+"/"+p,i,o,u,n,p)}else if(u in na.propsKeywords){if(d&&typeof d=="object")for(var f in d)sw(t,e,r,d[f],o+"/"+u+"/"+coe(f),i,o,u,n,f)}else(u in na.keywords||t.allKeys&&!(u in na.skipKeywords))&&sw(t,e,r,d,o+"/"+u,i,o,u,n)}r(n,o,i,s,a,c,l)}}function coe(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var th=g(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.getSchemaRefs=bn.resolveUrl=bn.normalizeId=bn._getFullPath=bn.getFullPath=bn.inlineRef=void 0;var loe=ot(),uoe=Am(),doe=LU(),poe=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function foe(t,e=!0){return typeof t=="boolean"?!0:e===!0?!cT(t):e?FU(t)<=e:!1}bn.inlineRef=foe;var moe=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function cT(t){for(let e in t){if(moe.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(cT)||typeof r=="object"&&cT(r))return!0}return!1}function FU(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!poe.has(r)&&(typeof t[r]=="object"&&(0,loe.eachItem)(t[r],n=>e+=FU(n)),e===1/0))return 1/0}return e}function VU(t,e="",r){r!==!1&&(e=Vu(e));let n=t.parse(e);return ZU(t,n)}bn.getFullPath=VU;function ZU(t,e){return t.serialize(e).split("#")[0]+"#"}bn._getFullPath=ZU;var hoe=/#\/?$/;function Vu(t){return t?t.replace(hoe,""):""}bn.normalizeId=Vu;function goe(t,e,r){return r=Vu(r),t.resolve(e,r)}bn.resolveUrl=goe;var yoe=/^[a-z_][-a-z0-9._]*$/i;function voe(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=Vu(t[r]||e),i={"":o},s=VU(n,o,!1),a={},c=new Set;return doe(t,{allKeys:!0},(d,p,f,h)=>{if(h===void 0)return;let m=s+p,y=i[h];typeof d[r]=="string"&&(y=v.call(this,d[r])),w.call(this,d.$anchor),w.call(this,d.$dynamicAnchor),i[p]=y;function v($){let R=this.opts.uriResolver.resolve;if($=Vu(y?R(y,$):$),c.has($))throw u($);c.add($);let P=this.refs[$];return typeof P=="string"&&(P=this.refs[P]),typeof P=="object"?l(d,P.schema,$):$!==Vu(m)&&($[0]==="#"?(l(d,a[$],$),a[$]=d):this.refs[$]=m),$}function w($){if(typeof $=="string"){if(!yoe.test($))throw new Error(`invalid anchor "${$}"`);v.call(this,`#${$}`)}}}),a;function l(d,p,f){if(p!==void 0&&!uoe(d,p))throw u(f)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}bn.getSchemaRefs=voe});var oh=g(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.getData=oa.KeywordCxt=oa.validateFunctionCode=void 0;var JU=AU(),HU=eh(),uT=tT(),aw=eh(),_oe=jU(),nh=qU(),lT=BU(),ie=Ie(),_e=ns(),boe=th(),os=ot(),rh=Qm();function woe(t){if(QU(t)&&(eL(t),XU(t))){koe(t);return}YU(t,()=>(0,JU.topBoolOrEmptySchema)(t))}oa.validateFunctionCode=woe;function YU({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},i){o.code.es5?t.func(e,(0,ie._)`${_e.default.data}, ${_e.default.valCxt}`,n.$async,()=>{t.code((0,ie._)`"use strict"; ${GU(r,o)}`),Soe(t,o),t.code(i)}):t.func(e,(0,ie._)`${_e.default.data}, ${xoe(o)}`,n.$async,()=>t.code(GU(r,o)).code(i))}function xoe(t){return(0,ie._)`{${_e.default.instancePath}="", ${_e.default.parentData}, ${_e.default.parentDataProperty}, ${_e.default.rootData}=${_e.default.data}${t.dynamicRef?(0,ie._)`, ${_e.default.dynamicAnchors}={}`:ie.nil}}={}`}function Soe(t,e){t.if(_e.default.valCxt,()=>{t.var(_e.default.instancePath,(0,ie._)`${_e.default.valCxt}.${_e.default.instancePath}`),t.var(_e.default.parentData,(0,ie._)`${_e.default.valCxt}.${_e.default.parentData}`),t.var(_e.default.parentDataProperty,(0,ie._)`${_e.default.valCxt}.${_e.default.parentDataProperty}`),t.var(_e.default.rootData,(0,ie._)`${_e.default.valCxt}.${_e.default.rootData}`),e.dynamicRef&&t.var(_e.default.dynamicAnchors,(0,ie._)`${_e.default.valCxt}.${_e.default.dynamicAnchors}`)},()=>{t.var(_e.default.instancePath,(0,ie._)`""`),t.var(_e.default.parentData,(0,ie._)`undefined`),t.var(_e.default.parentDataProperty,(0,ie._)`undefined`),t.var(_e.default.rootData,_e.default.data),e.dynamicRef&&t.var(_e.default.dynamicAnchors,(0,ie._)`{}`)})}function koe(t){let{schema:e,opts:r,gen:n}=t;YU(t,()=>{r.$comment&&e.$comment&&rL(t),Ioe(t),n.let(_e.default.vErrors,null),n.let(_e.default.errors,0),r.unevaluated&&$oe(t),tL(t),Ooe(t)})}function $oe(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,ie._)`${r}.evaluated`),e.if((0,ie._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,ie._)`${t.evaluated}.props`,(0,ie._)`undefined`)),e.if((0,ie._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,ie._)`${t.evaluated}.items`,(0,ie._)`undefined`))}function GU(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,ie._)`/*# sourceURL=${r} */`:ie.nil}function Aoe(t,e){if(QU(t)&&(eL(t),XU(t))){Poe(t,e);return}(0,JU.boolOrEmptySchema)(t,e)}function XU({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function QU(t){return typeof t.schema!="boolean"}function Poe(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&rL(t),Toe(t),Eoe(t);let i=n.const("_errs",_e.default.errors);tL(t,i),n.var(e,(0,ie._)`${i} === ${_e.default.errors}`)}function eL(t){(0,os.checkUnknownRules)(t),Coe(t)}function tL(t,e){if(t.opts.jtd)return WU(t,[],!1,e);let r=(0,HU.getSchemaTypes)(t.schema),n=(0,HU.coerceAndCheckDataType)(t,r);WU(t,r,!n,e)}function Coe(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,os.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function Ioe(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,os.checkStrictMode)(t,"default is ignored in the schema root")}function Toe(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,boe.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function Eoe(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function rL({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let i=r.$comment;if(o.$comment===!0)t.code((0,ie._)`${_e.default.self}.logger.log(${i})`);else if(typeof o.$comment=="function"){let s=(0,ie.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,ie._)`${_e.default.self}.opts.$comment(${i}, ${s}, ${a}.schema)`)}}function Ooe(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:i}=t;r.$async?e.if((0,ie._)`${_e.default.errors} === 0`,()=>e.return(_e.default.data),()=>e.throw((0,ie._)`new ${o}(${_e.default.vErrors})`)):(e.assign((0,ie._)`${n}.errors`,_e.default.vErrors),i.unevaluated&&joe(t),e.return((0,ie._)`${_e.default.errors} === 0`))}function joe({gen:t,evaluated:e,props:r,items:n}){r instanceof ie.Name&&t.assign((0,ie._)`${e}.props`,r),n instanceof ie.Name&&t.assign((0,ie._)`${e}.items`,n)}function WU(t,e,r,n){let{gen:o,schema:i,data:s,allErrors:a,opts:c,self:l}=t,{RULES:u}=l;if(i.$ref&&(c.ignoreKeywordsWithRef||!(0,os.schemaHasRulesButRef)(i,u))){o.block(()=>oL(t,"$ref",u.all.$ref.definition));return}c.jtd||Noe(t,e),o.block(()=>{for(let p of u.rules)d(p);d(u.post)});function d(p){(0,uT.shouldUseGroup)(i,p)&&(p.type?(o.if((0,aw.checkDataType)(p.type,s,c.strictNumbers)),KU(t,p),e.length===1&&e[0]===p.type&&r&&(o.else(),(0,aw.reportTypeError)(t)),o.endIf()):KU(t,p),a||o.if((0,ie._)`${_e.default.errors} === ${n||0}`))}}function KU(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,_oe.assignDefaults)(t,e.type),r.block(()=>{for(let i of e.rules)(0,uT.shouldUseRule)(n,i)&&oL(t,i.keyword,i.definition,e.type)})}function Noe(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(zoe(t,e),t.opts.allowUnionTypes||Roe(t,e),Moe(t,t.dataTypes))}function zoe(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{nL(t.dataTypes,r)||dT(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),Doe(t,e)}}function Roe(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&dT(t,"use allowUnionTypes to allow union type keyword")}function Moe(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,uT.shouldUseRule)(t.schema,o)){let{type:i}=o.definition;i.length&&!i.some(s=>qoe(e,s))&&dT(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function qoe(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function nL(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function Doe(t,e){let r=[];for(let n of t.dataTypes)nL(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function dT(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,os.checkStrictMode)(t,e,t.opts.strictTypes)}var cw=class{constructor(e,r,n){if((0,nh.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,os.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",iL(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,nh.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",_e.default.errors))}result(e,r,n){this.failResult((0,ie.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,ie.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,ie._)`${r} !== undefined && (${(0,ie.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?rh.reportExtraError:rh.reportError)(this,this.def.error,r)}$dataError(){(0,rh.reportError)(this,this.def.$dataError||rh.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,rh.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=ie.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=ie.nil,r=ie.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:i,def:s}=this;n.if((0,ie.or)((0,ie._)`${o} === undefined`,r)),e!==ie.nil&&n.assign(e,!0),(i.length||s.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==ie.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:i}=this;return(0,ie.or)(s(),a());function s(){if(n.length){if(!(r instanceof ie.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,ie._)`${(0,aw.checkDataTypes)(c,r,i.opts.strictNumbers,aw.DataType.Wrong)}`}return ie.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,ie._)`!${c}(${r})`}return ie.nil}}subschema(e,r){let n=(0,lT.getSubschema)(this.it,e);(0,lT.extendSubschemaData)(n,this.it,e),(0,lT.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return Aoe(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=os.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=os.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,ie.Name)),!0}};oa.KeywordCxt=cw;function oL(t,e,r,n){let o=new cw(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,nh.funcKeywordCode)(o,r):"macro"in r?(0,nh.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,nh.funcKeywordCode)(o,r)}var Boe=/^\/(?:[^~]|~0|~1)*$/,Uoe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function iL(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,i;if(t==="")return _e.default.rootData;if(t[0]==="/"){if(!Boe.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,i=_e.default.rootData}else{let l=Uoe.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);let u=+l[1];if(o=l[2],o==="#"){if(u>=e)throw new Error(c("property/index",u));return n[e-u]}if(u>e)throw new Error(c("data",u));if(i=r[e-u],!o)return i}let s=i,a=o.split("/");for(let l of a)l&&(i=(0,ie._)`${i}${(0,ie.getProperty)((0,os.unescapeJsonPointer)(l))}`,s=(0,ie._)`${s} && ${i}`);return s;function c(l,u){return`Cannot access ${l} ${u} levels up, current level is ${e}`}}oa.getData=iL});var lw=g(fT=>{"use strict";Object.defineProperty(fT,"__esModule",{value:!0});var pT=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};fT.default=pT});var ih=g(gT=>{"use strict";Object.defineProperty(gT,"__esModule",{value:!0});var mT=th(),hT=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,mT.resolveUrl)(e,r,n),this.missingSchema=(0,mT.normalizeId)((0,mT.getFullPath)(e,this.missingRef))}};gT.default=hT});var dw=g(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.resolveSchema=lo.getCompilingSchema=lo.resolveRef=lo.compileSchema=lo.SchemaEnv=void 0;var Ro=Ie(),Loe=lw(),uc=ns(),Mo=th(),sL=ot(),Foe=oh(),Zu=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Mo.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};lo.SchemaEnv=Zu;function vT(t){let e=aL.call(this,t);if(e)return e;let r=(0,Mo.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:i}=this.opts,s=new Ro.CodeGen(this.scope,{es5:n,lines:o,ownProperties:i}),a;t.$async&&(a=s.scopeValue("Error",{ref:Loe.default,code:(0,Ro._)`require("ajv/dist/runtime/validation_error").default`}));let c=s.scopeName("validate");t.validateName=c;let l={gen:s,allErrors:this.opts.allErrors,data:uc.default.data,parentData:uc.default.parentData,parentDataProperty:uc.default.parentDataProperty,dataNames:[uc.default.data],dataPathArr:[Ro.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:s.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Ro.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Ro.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Ro._)`""`,opts:this.opts,self:this},u;try{this._compilations.add(t),(0,Foe.validateFunctionCode)(l),s.optimize(this.opts.code.optimize);let d=s.toString();u=`${s.scopeRefs(uc.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));let f=new Function(`${uc.default.self}`,`${uc.default.scope}`,u)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:s._values}),this.opts.unevaluated){let{props:h,items:m}=l;f.evaluated={props:h instanceof Ro.Name?void 0:h,items:m instanceof Ro.Name?void 0:m,dynamicProps:h instanceof Ro.Name,dynamicItems:m instanceof Ro.Name},f.source&&(f.source.evaluated=(0,Ro.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}lo.compileSchema=vT;function Voe(t,e,r){var n;r=(0,Mo.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let i=Goe.call(this,t,r);if(i===void 0){let s=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;s&&(i=new Zu({schema:s,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=Zoe.call(this,i)}lo.resolveRef=Voe;function Zoe(t){return(0,Mo.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:vT.call(this,t)}function aL(t){for(let e of this._compilations)if(Hoe(e,t))return e}lo.getCompilingSchema=aL;function Hoe(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function Goe(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||uw.call(this,t,e)}function uw(t,e){let r=this.opts.uriResolver.parse(e),n=(0,Mo._getFullPath)(this.opts.uriResolver,r),o=(0,Mo.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return yT.call(this,r,t);let i=(0,Mo.normalizeId)(n),s=this.refs[i]||this.schemas[i];if(typeof s=="string"){let a=uw.call(this,t,s);return typeof a?.schema!="object"?void 0:yT.call(this,r,a)}if(typeof s?.schema=="object"){if(s.validate||vT.call(this,s),i===(0,Mo.normalizeId)(e)){let{schema:a}=s,{schemaId:c}=this.opts,l=a[c];return l&&(o=(0,Mo.resolveUrl)(this.opts.uriResolver,o,l)),new Zu({schema:a,schemaId:c,root:t,baseId:o})}return yT.call(this,r,s)}}lo.resolveSchema=uw;var Woe=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function yT(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,sL.unescapeFragment)(a)];if(c===void 0)return;r=c;let l=typeof r=="object"&&r[this.opts.schemaId];!Woe.has(a)&&l&&(e=(0,Mo.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,sL.schemaHasRulesButRef)(r,this.RULES)){let a=(0,Mo.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=uw.call(this,n,a)}let{schemaId:s}=this.opts;if(i=i||new Zu({schema:r,schemaId:s,root:n,baseId:e}),i.schema!==i.root.schema)return i}});var cL=g((A$e,Koe)=>{Koe.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var uL=g(_T=>{"use strict";Object.defineProperty(_T,"__esModule",{value:!0});var lL=zC();lL.code='require("ajv/dist/runtime/uri").default';_T.default=lL});var vL=g(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.CodeGen=Or.Name=Or.nil=Or.stringify=Or.str=Or._=Or.KeywordCxt=void 0;var Joe=oh();Object.defineProperty(Or,"KeywordCxt",{enumerable:!0,get:function(){return Joe.KeywordCxt}});var Hu=Ie();Object.defineProperty(Or,"_",{enumerable:!0,get:function(){return Hu._}});Object.defineProperty(Or,"str",{enumerable:!0,get:function(){return Hu.str}});Object.defineProperty(Or,"stringify",{enumerable:!0,get:function(){return Hu.stringify}});Object.defineProperty(Or,"nil",{enumerable:!0,get:function(){return Hu.nil}});Object.defineProperty(Or,"Name",{enumerable:!0,get:function(){return Hu.Name}});Object.defineProperty(Or,"CodeGen",{enumerable:!0,get:function(){return Hu.CodeGen}});var Yoe=lw(),hL=ih(),Xoe=eT(),sh=dw(),Qoe=Ie(),ah=th(),pw=eh(),wT=ot(),dL=cL(),eie=uL(),gL=(t,e)=>new RegExp(t,e);gL.code="new RegExp";var tie=["removeAdditional","useDefaults","coerceTypes"],rie=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),nie={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},oie={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},pL=200;function iie(t){var e,r,n,o,i,s,a,c,l,u,d,p,f,h,m,y,v,w,$,R,P,ce,Te,be,et;let Ge=t.strict,ar=(e=t.code)===null||e===void 0?void 0:e.optimize,Xr=ar===!0||ar===void 0?1:ar||0,Wt=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:gL,ii=(o=t.uriResolver)!==null&&o!==void 0?o:eie.default;return{strictSchema:(s=(i=t.strictSchema)!==null&&i!==void 0?i:Ge)!==null&&s!==void 0?s:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:Ge)!==null&&c!==void 0?c:!0,strictTypes:(u=(l=t.strictTypes)!==null&&l!==void 0?l:Ge)!==null&&u!==void 0?u:"log",strictTuples:(p=(d=t.strictTuples)!==null&&d!==void 0?d:Ge)!==null&&p!==void 0?p:"log",strictRequired:(h=(f=t.strictRequired)!==null&&f!==void 0?f:Ge)!==null&&h!==void 0?h:!1,code:t.code?{...t.code,optimize:Xr,regExp:Wt}:{optimize:Xr,regExp:Wt},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:pL,loopEnum:(y=t.loopEnum)!==null&&y!==void 0?y:pL,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(w=t.messages)!==null&&w!==void 0?w:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(R=t.schemaId)!==null&&R!==void 0?R:"$id",addUsedSchema:(P=t.addUsedSchema)!==null&&P!==void 0?P:!0,validateSchema:(ce=t.validateSchema)!==null&&ce!==void 0?ce:!0,validateFormats:(Te=t.validateFormats)!==null&&Te!==void 0?Te:!0,unicodeRegExp:(be=t.unicodeRegExp)!==null&&be!==void 0?be:!0,int32range:(et=t.int32range)!==null&&et!==void 0?et:!0,uriResolver:ii}}var ch=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...iie(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new Qoe.ValueScope({scope:{},prefixes:rie,es5:r,lines:n}),this.logger=die(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,Xoe.getRules)(),fL.call(this,nie,e,"NOT SUPPORTED"),fL.call(this,oie,e,"DEPRECATED","warn"),this._metaOpts=lie.call(this),e.formats&&aie.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&cie.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),sie.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=dL;n==="id"&&(o={...dL},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(u,d){await i.call(this,u.$schema);let p=this._addSchema(u,d);return p.validate||s.call(this,p)}async function i(u){u&&!this.getSchema(u)&&await o.call(this,{$ref:u},!0)}async function s(u){try{return this._compileSchemaEnv(u)}catch(d){if(!(d instanceof hL.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),s.call(this,u)}}function a({missingSchema:u,missingRef:d}){if(this.refs[u])throw new Error(`AnySchema ${u} is loaded but ${d} cannot be resolved`)}async function c(u){let d=await l.call(this,u);this.refs[u]||await i.call(this,d.$schema),this.refs[u]||this.addSchema(d,u,r)}async function l(u){let d=this._loading[u];if(d)return d;try{return await(this._loading[u]=n(u))}finally{delete this._loading[u]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let s of e)this.addSchema(s,void 0,n,o);return this}let i;if(typeof e=="object"){let{schemaId:s}=this.opts;if(i=e[s],i!==void 0&&typeof i!="string")throw new Error(`schema ${s} must be string`)}return r=(0,ah.normalizeId)(r||i),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let i="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(i);else throw new Error(i)}return o}getSchema(e){let r;for(;typeof(r=mL.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new sh.SchemaEnv({schema:{},schemaId:n});if(r=sh.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=mL.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ah.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(fie.call(this,n,r),!r)return(0,wT.eachItem)(n,i=>bT.call(this,i)),this;hie.call(this,r);let o={...r,type:(0,pw.getJSONTypes)(r.type),schemaType:(0,pw.getJSONTypes)(r.schemaType)};return(0,wT.eachItem)(n,o.type.length===0?i=>bT.call(this,i,o):i=>o.type.forEach(s=>bT.call(this,i,o,s))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(i=>i.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,i)=>o+r+i)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let i=o.split("/").slice(1),s=e;for(let a of i)s=s[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:l}=c.definition,u=s[a];l&&u&&(s[a]=yL(u))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,i=this.opts.addUsedSchema){let s,{schemaId:a}=this.opts;if(typeof e=="object")s=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ah.normalizeId)(s||n);let l=ah.getSchemaRefs.call(this,e,n);return c=new sh.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:l}),this._cache.set(c.schema,c),i&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):sh.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{sh.compileSchema.call(this,e)}finally{this.opts=r}}};ch.ValidationError=Yoe.default;ch.MissingRefError=hL.default;Or.default=ch;function fL(t,e,r,n="error"){for(let o in t){let i=o;i in e&&this.logger[n](`${r}: option ${o}. ${t[i]}`)}}function mL(t){return t=(0,ah.normalizeId)(t),this.schemas[t]||this.refs[t]}function sie(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function aie(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function cie(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function lie(){let t={...this.opts};for(let e of tie)delete t[e];return t}var uie={log(){},warn(){},error(){}};function die(t){if(t===!1)return uie;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var pie=/^[a-z_$][a-z0-9_$:-]*$/i;function fie(t,e){let{RULES:r}=this;if((0,wT.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!pie.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function bT(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:i}=this,s=o?i.post:i.rules.find(({type:c})=>c===r);if(s||(s={type:r,rules:[]},i.rules.push(s)),i.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,pw.getJSONTypes)(e.type),schemaType:(0,pw.getJSONTypes)(e.schemaType)}};e.before?mie.call(this,s,a,e.before):s.rules.push(a),i.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function mie(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function hie(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=yL(e)),t.validateSchema=this.compile(e,!0))}var gie={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function yL(t){return{anyOf:[t,gie]}}});var _L=g(xT=>{"use strict";Object.defineProperty(xT,"__esModule",{value:!0});var yie={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};xT.default=yie});var SL=g(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.callRef=dc.getValidate=void 0;var vie=ih(),bL=co(),wn=Ie(),Gu=ns(),wL=dw(),fw=ot(),_ie={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:i,validateName:s,opts:a,self:c}=n,{root:l}=i;if((r==="#"||r==="#/")&&o===l.baseId)return d();let u=wL.resolveRef.call(c,l,o,r);if(u===void 0)throw new vie.default(n.opts.uriResolver,o,r);if(u instanceof wL.SchemaEnv)return p(u);return f(u);function d(){if(i===l)return mw(t,s,i,i.$async);let h=e.scopeValue("root",{ref:l});return mw(t,(0,wn._)`${h}.validate`,l,l.$async)}function p(h){let m=xL(t,h);mw(t,m,h,h.$async)}function f(h){let m=e.scopeValue("schema",a.code.source===!0?{ref:h,code:(0,wn.stringify)(h)}:{ref:h}),y=e.name("valid"),v=t.subschema({schema:h,dataTypes:[],schemaPath:wn.nil,topSchemaRef:m,errSchemaPath:r},y);t.mergeEvaluated(v),t.ok(y)}}};function xL(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,wn._)`${r.scopeValue("wrapper",{ref:e})}.validate`}dc.getValidate=xL;function mw(t,e,r,n){let{gen:o,it:i}=t,{allErrors:s,schemaEnv:a,opts:c}=i,l=c.passContext?Gu.default.this:wn.nil;n?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");let h=o.let("valid");o.try(()=>{o.code((0,wn._)`await ${(0,bL.callValidateCode)(t,e,l)}`),f(e),s||o.assign(h,!0)},m=>{o.if((0,wn._)`!(${m} instanceof ${i.ValidationError})`,()=>o.throw(m)),p(m),s||o.assign(h,!1)}),t.ok(h)}function d(){t.result((0,bL.callValidateCode)(t,e,l),()=>f(e),()=>p(e))}function p(h){let m=(0,wn._)`${h}.errors`;o.assign(Gu.default.vErrors,(0,wn._)`${Gu.default.vErrors} === null ? ${m} : ${Gu.default.vErrors}.concat(${m})`),o.assign(Gu.default.errors,(0,wn._)`${Gu.default.vErrors}.length`)}function f(h){var m;if(!i.opts.unevaluated)return;let y=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(i.props!==!0)if(y&&!y.dynamicProps)y.props!==void 0&&(i.props=fw.mergeEvaluated.props(o,y.props,i.props));else{let v=o.var("props",(0,wn._)`${h}.evaluated.props`);i.props=fw.mergeEvaluated.props(o,v,i.props,wn.Name)}if(i.items!==!0)if(y&&!y.dynamicItems)y.items!==void 0&&(i.items=fw.mergeEvaluated.items(o,y.items,i.items));else{let v=o.var("items",(0,wn._)`${h}.evaluated.items`);i.items=fw.mergeEvaluated.items(o,v,i.items,wn.Name)}}}dc.callRef=mw;dc.default=_ie});var kL=g(ST=>{"use strict";Object.defineProperty(ST,"__esModule",{value:!0});var bie=_L(),wie=SL(),xie=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",bie.default,wie.default];ST.default=xie});var $L=g(kT=>{"use strict";Object.defineProperty(kT,"__esModule",{value:!0});var hw=Ie(),ia=hw.operators,gw={maximum:{okStr:"<=",ok:ia.LTE,fail:ia.GT},minimum:{okStr:">=",ok:ia.GTE,fail:ia.LT},exclusiveMaximum:{okStr:"<",ok:ia.LT,fail:ia.GTE},exclusiveMinimum:{okStr:">",ok:ia.GT,fail:ia.LTE}},Sie={message:({keyword:t,schemaCode:e})=>(0,hw.str)`must be ${gw[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,hw._)`{comparison: ${gw[t].okStr}, limit: ${e}}`},kie={keyword:Object.keys(gw),type:"number",schemaType:"number",$data:!0,error:Sie,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,hw._)`${r} ${gw[e].fail} ${n} || isNaN(${r})`)}};kT.default=kie});var AL=g($T=>{"use strict";Object.defineProperty($T,"__esModule",{value:!0});var lh=Ie(),$ie={message:({schemaCode:t})=>(0,lh.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,lh._)`{multipleOf: ${t}}`},Aie={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:$ie,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,i=o.opts.multipleOfPrecision,s=e.let("res"),a=i?(0,lh._)`Math.abs(Math.round(${s}) - ${s}) > 1e-${i}`:(0,lh._)`${s} !== parseInt(${s})`;t.fail$data((0,lh._)`(${n} === 0 || (${s} = ${r}/${n}, ${a}))`)}};$T.default=Aie});var CL=g(AT=>{"use strict";Object.defineProperty(AT,"__esModule",{value:!0});function PL(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}AT.default=PL;PL.code='require("ajv/dist/runtime/ucs2length").default'});var IL=g(PT=>{"use strict";Object.defineProperty(PT,"__esModule",{value:!0});var pc=Ie(),Pie=ot(),Cie=CL(),Iie={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,pc.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,pc._)`{limit: ${t}}`},Tie={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Iie,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,i=e==="maxLength"?pc.operators.GT:pc.operators.LT,s=o.opts.unicode===!1?(0,pc._)`${r}.length`:(0,pc._)`${(0,Pie.useFunc)(t.gen,Cie.default)}(${r})`;t.fail$data((0,pc._)`${s} ${i} ${n}`)}};PT.default=Tie});var TL=g(CT=>{"use strict";Object.defineProperty(CT,"__esModule",{value:!0});var Eie=co(),yw=Ie(),Oie={message:({schemaCode:t})=>(0,yw.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,yw._)`{pattern: ${t}}`},jie={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Oie,code(t){let{data:e,$data:r,schema:n,schemaCode:o,it:i}=t,s=i.opts.unicodeRegExp?"u":"",a=r?(0,yw._)`(new RegExp(${o}, ${s}))`:(0,Eie.usePattern)(t,n);t.fail$data((0,yw._)`!${a}.test(${e})`)}};CT.default=jie});var EL=g(IT=>{"use strict";Object.defineProperty(IT,"__esModule",{value:!0});var uh=Ie(),Nie={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,uh.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,uh._)`{limit: ${t}}`},zie={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Nie,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?uh.operators.GT:uh.operators.LT;t.fail$data((0,uh._)`Object.keys(${r}).length ${o} ${n}`)}};IT.default=zie});var OL=g(TT=>{"use strict";Object.defineProperty(TT,"__esModule",{value:!0});var dh=co(),ph=Ie(),Rie=ot(),Mie={message:({params:{missingProperty:t}})=>(0,ph.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,ph._)`{missingProperty: ${t}}`},qie={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Mie,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:i,it:s}=t,{opts:a}=s;if(!i&&r.length===0)return;let c=r.length>=a.loopRequired;if(s.allErrors?l():u(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:h}=t.it;for(let m of r)if(f?.[m]===void 0&&!h.has(m)){let y=s.schemaEnv.baseId+s.errSchemaPath,v=`required property "${m}" is not defined at "${y}" (strictRequired)`;(0,Rie.checkStrictMode)(s,v,s.opts.strictRequired)}}function l(){if(c||i)t.block$data(ph.nil,d);else for(let f of r)(0,dh.checkReportMissingProp)(t,f)}function u(){let f=e.let("missing");if(c||i){let h=e.let("valid",!0);t.block$data(h,()=>p(f,h)),t.ok(h)}else e.if((0,dh.checkMissingProp)(t,r,f)),(0,dh.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,dh.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function p(f,h){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(h,(0,dh.propertyInData)(e,o,f,a.ownProperties)),e.if((0,ph.not)(h),()=>{t.error(),e.break()})},ph.nil)}}};TT.default=qie});var jL=g(ET=>{"use strict";Object.defineProperty(ET,"__esModule",{value:!0});var fh=Ie(),Die={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,fh.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,fh._)`{limit: ${t}}`},Bie={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Die,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?fh.operators.GT:fh.operators.LT;t.fail$data((0,fh._)`${r}.length ${o} ${n}`)}};ET.default=Bie});var vw=g(OT=>{"use strict";Object.defineProperty(OT,"__esModule",{value:!0});var NL=Am();NL.code='require("ajv/dist/runtime/equal").default';OT.default=NL});var zL=g(NT=>{"use strict";Object.defineProperty(NT,"__esModule",{value:!0});var jT=eh(),jr=Ie(),Uie=ot(),Lie=vw(),Fie={message:({params:{i:t,j:e}})=>(0,jr.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,jr._)`{i: ${t}, j: ${e}}`},Vie={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Fie,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:i,schemaCode:s,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),l=i.items?(0,jT.getSchemaTypes)(i.items):[];t.block$data(c,u,(0,jr._)`${s} === false`),t.ok(c);function u(){let h=e.let("i",(0,jr._)`${r}.length`),m=e.let("j");t.setParams({i:h,j:m}),e.assign(c,!0),e.if((0,jr._)`${h} > 1`,()=>(d()?p:f)(h,m))}function d(){return l.length>0&&!l.some(h=>h==="object"||h==="array")}function p(h,m){let y=e.name("item"),v=(0,jT.checkDataTypes)(l,y,a.opts.strictNumbers,jT.DataType.Wrong),w=e.const("indices",(0,jr._)`{}`);e.for((0,jr._)`;${h}--;`,()=>{e.let(y,(0,jr._)`${r}[${h}]`),e.if(v,(0,jr._)`continue`),l.length>1&&e.if((0,jr._)`typeof ${y} == "string"`,(0,jr._)`${y} += "_"`),e.if((0,jr._)`typeof ${w}[${y}] == "number"`,()=>{e.assign(m,(0,jr._)`${w}[${y}]`),t.error(),e.assign(c,!1).break()}).code((0,jr._)`${w}[${y}] = ${h}`)})}function f(h,m){let y=(0,Uie.useFunc)(e,Lie.default),v=e.name("outer");e.label(v).for((0,jr._)`;${h}--;`,()=>e.for((0,jr._)`${m} = ${h}; ${m}--;`,()=>e.if((0,jr._)`${y}(${r}[${h}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};NT.default=Vie});var RL=g(RT=>{"use strict";Object.defineProperty(RT,"__esModule",{value:!0});var zT=Ie(),Zie=ot(),Hie=vw(),Gie={message:"must be equal to constant",params:({schemaCode:t})=>(0,zT._)`{allowedValue: ${t}}`},Wie={keyword:"const",$data:!0,error:Gie,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,zT._)`!${(0,Zie.useFunc)(e,Hie.default)}(${r}, ${o})`):t.fail((0,zT._)`${i} !== ${r}`)}};RT.default=Wie});var ML=g(MT=>{"use strict";Object.defineProperty(MT,"__esModule",{value:!0});var mh=Ie(),Kie=ot(),Jie=vw(),Yie={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,mh._)`{allowedValues: ${t}}`},Xie={keyword:"enum",schemaType:"array",$data:!0,error:Yie,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:i,it:s}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=s.opts.loopEnum,c,l=()=>c??(c=(0,Kie.useFunc)(e,Jie.default)),u;if(a||n)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",i);u=(0,mh.or)(...o.map((h,m)=>p(f,m)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",i,f=>e.if((0,mh._)`${l()}(${r}, ${f})`,()=>e.assign(u,!0).break()))}function p(f,h){let m=o[h];return typeof m=="object"&&m!==null?(0,mh._)`${l()}(${r}, ${f}[${h}])`:(0,mh._)`${r} === ${m}`}}};MT.default=Xie});var qL=g(qT=>{"use strict";Object.defineProperty(qT,"__esModule",{value:!0});var Qie=$L(),ese=AL(),tse=IL(),rse=TL(),nse=EL(),ose=OL(),ise=jL(),sse=zL(),ase=RL(),cse=ML(),lse=[Qie.default,ese.default,tse.default,rse.default,nse.default,ose.default,ise.default,sse.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},ase.default,cse.default];qT.default=lse});var BT=g(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});hh.validateAdditionalItems=void 0;var fc=Ie(),DT=ot(),use={message:({params:{len:t}})=>(0,fc.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,fc._)`{limit: ${t}}`},dse={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:use,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,DT.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}DL(t,n)}};function DL(t,e){let{gen:r,schema:n,data:o,keyword:i,it:s}=t;s.items=!0;let a=r.const("len",(0,fc._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,fc._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,DT.alwaysValidSchema)(s,n)){let l=r.var("valid",(0,fc._)`${a} <= ${e.length}`);r.if((0,fc.not)(l),()=>c(l)),t.ok(l)}function c(l){r.forRange("i",e.length,a,u=>{t.subschema({keyword:i,dataProp:u,dataPropType:DT.Type.Num},l),s.allErrors||r.if((0,fc.not)(l),()=>r.break())})}}hh.validateAdditionalItems=DL;hh.default=dse});var UT=g(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.validateTuple=void 0;var BL=Ie(),_w=ot(),pse=co(),fse={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return UL(t,"additionalItems",e);r.items=!0,!(0,_w.alwaysValidSchema)(r,e)&&t.ok((0,pse.validateArray)(t))}};function UL(t,e,r=t.schema){let{gen:n,parentSchema:o,data:i,keyword:s,it:a}=t;u(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=_w.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),l=n.const("len",(0,BL._)`${i}.length`);r.forEach((d,p)=>{(0,_w.alwaysValidSchema)(a,d)||(n.if((0,BL._)`${l} > ${p}`,()=>t.subschema({keyword:s,schemaProp:p,dataProp:p},c)),t.ok(c))});function u(d){let{opts:p,errSchemaPath:f}=a,h=r.length,m=h===d.minItems&&(h===d.maxItems||d[e]===!1);if(p.strictTuples&&!m){let y=`"${s}" is ${h}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,_w.checkStrictMode)(a,y,p.strictTuples)}}}gh.validateTuple=UL;gh.default=fse});var LL=g(LT=>{"use strict";Object.defineProperty(LT,"__esModule",{value:!0});var mse=UT(),hse={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,mse.validateTuple)(t,"items")};LT.default=hse});var VL=g(FT=>{"use strict";Object.defineProperty(FT,"__esModule",{value:!0});var FL=Ie(),gse=ot(),yse=co(),vse=BT(),_se={message:({params:{len:t}})=>(0,FL.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,FL._)`{limit: ${t}}`},bse={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:_se,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,gse.alwaysValidSchema)(n,e)&&(o?(0,vse.validateAdditionalItems)(t,o):t.ok((0,yse.validateArray)(t)))}};FT.default=bse});var ZL=g(VT=>{"use strict";Object.defineProperty(VT,"__esModule",{value:!0});var uo=Ie(),bw=ot(),wse={message:({params:{min:t,max:e}})=>e===void 0?(0,uo.str)`must contain at least ${t} valid item(s)`:(0,uo.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,uo._)`{minContains: ${t}}`:(0,uo._)`{minContains: ${t}, maxContains: ${e}}`},xse={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:wse,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:i}=t,s,a,{minContains:c,maxContains:l}=n;i.opts.next?(s=c===void 0?1:c,a=l):s=1;let u=e.const("len",(0,uo._)`${o}.length`);if(t.setParams({min:s,max:a}),a===void 0&&s===0){(0,bw.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&s>a){(0,bw.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,bw.alwaysValidSchema)(i,r)){let m=(0,uo._)`${u} >= ${s}`;a!==void 0&&(m=(0,uo._)`${m} && ${u} <= ${a}`),t.pass(m);return}i.items=!0;let d=e.name("valid");a===void 0&&s===1?f(d,()=>e.if(d,()=>e.break())):s===0?(e.let(d,!0),a!==void 0&&e.if((0,uo._)`${o}.length > 0`,p)):(e.let(d,!1),p()),t.result(d,()=>t.reset());function p(){let m=e.name("_valid"),y=e.let("count",0);f(m,()=>e.if(m,()=>h(y)))}function f(m,y){e.forRange("i",0,u,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:bw.Type.Num,compositeRule:!0},m),y()})}function h(m){e.code((0,uo._)`${m}++`),a===void 0?e.if((0,uo._)`${m} >= ${s}`,()=>e.assign(d,!0).break()):(e.if((0,uo._)`${m} > ${a}`,()=>e.assign(d,!1).break()),s===1?e.assign(d,!0):e.if((0,uo._)`${m} >= ${s}`,()=>e.assign(d,!0)))}}};VT.default=xse});var WL=g(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.validateSchemaDeps=vi.validatePropertyDeps=vi.error=void 0;var ZT=Ie(),Sse=ot(),yh=co();vi.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,ZT.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,ZT._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var kse={keyword:"dependencies",type:"object",schemaType:"object",error:vi.error,code(t){let[e,r]=$se(t);HL(t,e),GL(t,r)}};function $se({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function HL(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let i=r.let("missing");for(let s in e){let a=e[s];if(a.length===0)continue;let c=(0,yh.propertyInData)(r,n,s,o.opts.ownProperties);t.setParams({property:s,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let l of a)(0,yh.checkReportMissingProp)(t,l)}):(r.if((0,ZT._)`${c} && (${(0,yh.checkMissingProp)(t,a,i)})`),(0,yh.reportMissingProp)(t,i),r.else())}}vi.validatePropertyDeps=HL;function GL(t,e=t.schema){let{gen:r,data:n,keyword:o,it:i}=t,s=r.name("valid");for(let a in e)(0,Sse.alwaysValidSchema)(i,e[a])||(r.if((0,yh.propertyInData)(r,n,a,i.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},s);t.mergeValidEvaluated(c,s)},()=>r.var(s,!0)),t.ok(s))}vi.validateSchemaDeps=GL;vi.default=kse});var JL=g(HT=>{"use strict";Object.defineProperty(HT,"__esModule",{value:!0});var KL=Ie(),Ase=ot(),Pse={message:"property name must be valid",params:({params:t})=>(0,KL._)`{propertyName: ${t.propertyName}}`},Cse={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Pse,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,Ase.alwaysValidSchema)(o,r))return;let i=e.name("valid");e.forIn("key",n,s=>{t.setParams({propertyName:s}),t.subschema({keyword:"propertyNames",data:s,dataTypes:["string"],propertyName:s,compositeRule:!0},i),e.if((0,KL.not)(i),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(i)}};HT.default=Cse});var WT=g(GT=>{"use strict";Object.defineProperty(GT,"__esModule",{value:!0});var ww=co(),qo=Ie(),Ise=ns(),xw=ot(),Tse={message:"must NOT have additional properties",params:({params:t})=>(0,qo._)`{additionalProperty: ${t.additionalProperty}}`},Ese={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Tse,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:i,it:s}=t;if(!i)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=s;if(s.props=!0,c.removeAdditional!=="all"&&(0,xw.alwaysValidSchema)(s,r))return;let l=(0,ww.allSchemaProperties)(n.properties),u=(0,ww.allSchemaProperties)(n.patternProperties);d(),t.ok((0,qo._)`${i} === ${Ise.default.errors}`);function d(){e.forIn("key",o,y=>{!l.length&&!u.length?h(y):e.if(p(y),()=>h(y))})}function p(y){let v;if(l.length>8){let w=(0,xw.schemaRefOrVal)(s,n.properties,"properties");v=(0,ww.isOwnProperty)(e,w,y)}else l.length?v=(0,qo.or)(...l.map(w=>(0,qo._)`${y} === ${w}`)):v=qo.nil;return u.length&&(v=(0,qo.or)(v,...u.map(w=>(0,qo._)`${(0,ww.usePattern)(t,w)}.test(${y})`))),(0,qo.not)(v)}function f(y){e.code((0,qo._)`delete ${o}[${y}]`)}function h(y){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(y);return}if(r===!1){t.setParams({additionalProperty:y}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,xw.alwaysValidSchema)(s,r)){let v=e.name("valid");c.removeAdditional==="failing"?(m(y,v,!1),e.if((0,qo.not)(v),()=>{t.reset(),f(y)})):(m(y,v),a||e.if((0,qo.not)(v),()=>e.break()))}}function m(y,v,w){let $={keyword:"additionalProperties",dataProp:y,dataPropType:xw.Type.Str};w===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,v)}}};GT.default=Ese});var QL=g(JT=>{"use strict";Object.defineProperty(JT,"__esModule",{value:!0});var Ose=oh(),YL=co(),KT=ot(),XL=WT(),jse={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&XL.default.code(new Ose.KeywordCxt(i,XL.default,"additionalProperties"));let s=(0,YL.allSchemaProperties)(r);for(let d of s)i.definedProperties.add(d);i.opts.unevaluated&&s.length&&i.props!==!0&&(i.props=KT.mergeEvaluated.props(e,(0,KT.toHash)(s),i.props));let a=s.filter(d=>!(0,KT.alwaysValidSchema)(i,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)l(d)?u(d):(e.if((0,YL.propertyInData)(e,o,d,i.opts.ownProperties)),u(d),i.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};JT.default=jse});var n6=g(YT=>{"use strict";Object.defineProperty(YT,"__esModule",{value:!0});var e6=co(),Sw=Ie(),t6=ot(),r6=ot(),Nse={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:i}=t,{opts:s}=i,a=(0,e6.allSchemaProperties)(r),c=a.filter(m=>(0,t6.alwaysValidSchema)(i,r[m]));if(a.length===0||c.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;let l=s.strictSchema&&!s.allowMatchingProperties&&o.properties,u=e.name("valid");i.props!==!0&&!(i.props instanceof Sw.Name)&&(i.props=(0,r6.evaluatedPropsToName)(e,i.props));let{props:d}=i;p();function p(){for(let m of a)l&&f(m),i.allErrors?h(m):(e.var(u,!0),h(m),e.if(u))}function f(m){for(let y in l)new RegExp(m).test(y)&&(0,t6.checkStrictMode)(i,`property ${y} matches pattern ${m} (use allowMatchingProperties)`)}function h(m){e.forIn("key",n,y=>{e.if((0,Sw._)`${(0,e6.usePattern)(t,m)}.test(${y})`,()=>{let v=c.includes(m);v||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:y,dataPropType:r6.Type.Str},u),i.opts.unevaluated&&d!==!0?e.assign((0,Sw._)`${d}[${y}]`,!0):!v&&!i.allErrors&&e.if((0,Sw.not)(u),()=>e.break())})})}}};YT.default=Nse});var o6=g(XT=>{"use strict";Object.defineProperty(XT,"__esModule",{value:!0});var zse=ot(),Rse={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,zse.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};XT.default=Rse});var i6=g(QT=>{"use strict";Object.defineProperty(QT,"__esModule",{value:!0});var Mse=co(),qse={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Mse.validateUnion,error:{message:"must match a schema in anyOf"}};QT.default=qse});var s6=g(eE=>{"use strict";Object.defineProperty(eE,"__esModule",{value:!0});var kw=Ie(),Dse=ot(),Bse={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,kw._)`{passingSchemas: ${t.passing}}`},Use={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Bse,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let i=r,s=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(s,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((u,d)=>{let p;(0,Dse.alwaysValidSchema)(o,u)?e.var(c,!0):p=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,kw._)`${c} && ${s}`).assign(s,!1).assign(a,(0,kw._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(s,!0),e.assign(a,d),p&&t.mergeEvaluated(p,kw.Name)})})}}};eE.default=Use});var a6=g(tE=>{"use strict";Object.defineProperty(tE,"__esModule",{value:!0});var Lse=ot(),Fse={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((i,s)=>{if((0,Lse.alwaysValidSchema)(n,i))return;let a=t.subschema({keyword:"allOf",schemaProp:s},o);t.ok(o),t.mergeEvaluated(a)})}};tE.default=Fse});var u6=g(rE=>{"use strict";Object.defineProperty(rE,"__esModule",{value:!0});var $w=Ie(),l6=ot(),Vse={message:({params:t})=>(0,$w.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,$w._)`{failingKeyword: ${t.ifClause}}`},Zse={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Vse,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,l6.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=c6(n,"then"),i=c6(n,"else");if(!o&&!i)return;let s=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&i){let u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,l("then",u),l("else",u))}else o?e.if(a,l("then")):e.if((0,$w.not)(a),l("else"));t.pass(s,()=>t.error(!0));function c(){let u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function l(u,d){return()=>{let p=t.subschema({keyword:u},a);e.assign(s,a),t.mergeValidEvaluated(p,s),d?e.assign(d,(0,$w._)`${u}`):t.setParams({ifClause:u})}}}};function c6(t,e){let r=t.schema[e];return r!==void 0&&!(0,l6.alwaysValidSchema)(t,r)}rE.default=Zse});var d6=g(nE=>{"use strict";Object.defineProperty(nE,"__esModule",{value:!0});var Hse=ot(),Gse={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Hse.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};nE.default=Gse});var p6=g(oE=>{"use strict";Object.defineProperty(oE,"__esModule",{value:!0});var Wse=BT(),Kse=LL(),Jse=UT(),Yse=VL(),Xse=ZL(),Qse=WL(),eae=JL(),tae=WT(),rae=QL(),nae=n6(),oae=o6(),iae=i6(),sae=s6(),aae=a6(),cae=u6(),lae=d6();function uae(t=!1){let e=[oae.default,iae.default,sae.default,aae.default,cae.default,lae.default,eae.default,tae.default,Qse.default,rae.default,nae.default];return t?e.push(Kse.default,Yse.default):e.push(Wse.default,Jse.default),e.push(Xse.default),e}oE.default=uae});var f6=g(iE=>{"use strict";Object.defineProperty(iE,"__esModule",{value:!0});var rr=Ie(),dae={message:({schemaCode:t})=>(0,rr.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,rr._)`{format: ${t}}`},pae={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:dae,code(t,e){let{gen:r,data:n,$data:o,schema:i,schemaCode:s,it:a}=t,{opts:c,errSchemaPath:l,schemaEnv:u,self:d}=a;if(!c.validateFormats)return;o?p():f();function p(){let h=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,rr._)`${h}[${s}]`),y=r.let("fType"),v=r.let("format");r.if((0,rr._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(y,(0,rr._)`${m}.type || "string"`).assign(v,(0,rr._)`${m}.validate`),()=>r.assign(y,(0,rr._)`"string"`).assign(v,m)),t.fail$data((0,rr.or)(w(),$()));function w(){return c.strictSchema===!1?rr.nil:(0,rr._)`${s} && !${v}`}function $(){let R=u.$async?(0,rr._)`(${m}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,rr._)`${v}(${n})`,P=(0,rr._)`(typeof ${v} == "function" ? ${R} : ${v}.test(${n}))`;return(0,rr._)`${v} && ${v} !== true && ${y} === ${e} && !${P}`}}function f(){let h=d.formats[i];if(!h){w();return}if(h===!0)return;let[m,y,v]=$(h);m===e&&t.pass(R());function w(){if(c.strictSchema===!1){d.logger.warn(P());return}throw new Error(P());function P(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function $(P){let ce=P instanceof RegExp?(0,rr.regexpCode)(P):c.code.formats?(0,rr._)`${c.code.formats}${(0,rr.getProperty)(i)}`:void 0,Te=r.scopeValue("formats",{key:i,ref:P,code:ce});return typeof P=="object"&&!(P instanceof RegExp)?[P.type||"string",P.validate,(0,rr._)`${Te}.validate`]:["string",P,Te]}function R(){if(typeof h=="object"&&!(h instanceof RegExp)&&h.async){if(!u.$async)throw new Error("async format in sync schema");return(0,rr._)`await ${v}(${n})`}return typeof y=="function"?(0,rr._)`${v}(${n})`:(0,rr._)`${v}.test(${n})`}}}};iE.default=pae});var m6=g(sE=>{"use strict";Object.defineProperty(sE,"__esModule",{value:!0});var fae=f6(),mae=[fae.default];sE.default=mae});var h6=g(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.contentVocabulary=Wu.metadataVocabulary=void 0;Wu.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Wu.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var y6=g(aE=>{"use strict";Object.defineProperty(aE,"__esModule",{value:!0});var hae=kL(),gae=qL(),yae=p6(),vae=m6(),g6=h6(),_ae=[hae.default,gae.default,(0,yae.default)(),vae.default,g6.metadataVocabulary,g6.contentVocabulary];aE.default=_ae});var _6=g(Aw=>{"use strict";Object.defineProperty(Aw,"__esModule",{value:!0});Aw.DiscrError=void 0;var v6;(function(t){t.Tag="tag",t.Mapping="mapping"})(v6||(Aw.DiscrError=v6={}))});var w6=g(lE=>{"use strict";Object.defineProperty(lE,"__esModule",{value:!0});var Ku=Ie(),cE=_6(),b6=dw(),bae=ih(),wae=ot(),xae={message:({params:{discrError:t,tagName:e}})=>t===cE.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Ku._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},Sae={keyword:"discriminator",type:"object",schemaType:"object",error:xae,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:i}=t,{oneOf:s}=o;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!s)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),l=e.const("tag",(0,Ku._)`${r}${(0,Ku.getProperty)(a)}`);e.if((0,Ku._)`typeof ${l} == "string"`,()=>u(),()=>t.error(!1,{discrError:cE.DiscrError.Tag,tag:l,tagName:a})),t.ok(c);function u(){let f=p();e.if(!1);for(let h in f)e.elseIf((0,Ku._)`${l} === ${h}`),e.assign(c,d(f[h]));e.else(),t.error(!1,{discrError:cE.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){let h=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},h);return t.mergeEvaluated(m,Ku.Name),h}function p(){var f;let h={},m=v(o),y=!0;for(let R=0;R<s.length;R++){let P=s[R];if(P?.$ref&&!(0,wae.schemaHasRulesButRef)(P,i.self.RULES)){let Te=P.$ref;if(P=b6.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,Te),P instanceof b6.SchemaEnv&&(P=P.schema),P===void 0)throw new bae.default(i.opts.uriResolver,i.baseId,Te)}let ce=(f=P?.properties)===null||f===void 0?void 0:f[a];if(typeof ce!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);y=y&&(m||v(P)),w(ce,R)}if(!y)throw new Error(`discriminator: "${a}" must be required`);return h;function v({required:R}){return Array.isArray(R)&&R.includes(a)}function w(R,P){if(R.const)$(R.const,P);else if(R.enum)for(let ce of R.enum)$(ce,P);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(R,P){if(typeof R!="string"||R in h)throw new Error(`discriminator: "${a}" values must be unique strings`);h[R]=P}}}};lE.default=Sae});var x6=g((mAe,kae)=>{kae.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var k6=g((Rt,uE)=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.MissingRefError=Rt.ValidationError=Rt.CodeGen=Rt.Name=Rt.nil=Rt.stringify=Rt.str=Rt._=Rt.KeywordCxt=Rt.Ajv=void 0;var $ae=vL(),Aae=y6(),Pae=w6(),S6=x6(),Cae=["/properties"],Pw="http://json-schema.org/draft-07/schema",Ju=class extends $ae.default{_addVocabularies(){super._addVocabularies(),Aae.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(Pae.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(S6,Cae):S6;this.addMetaSchema(e,Pw,!1),this.refs["http://json-schema.org/schema"]=Pw}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Pw)?Pw:void 0)}};Rt.Ajv=Ju;uE.exports=Rt=Ju;uE.exports.Ajv=Ju;Object.defineProperty(Rt,"__esModule",{value:!0});Rt.default=Ju;var Iae=oh();Object.defineProperty(Rt,"KeywordCxt",{enumerable:!0,get:function(){return Iae.KeywordCxt}});var Yu=Ie();Object.defineProperty(Rt,"_",{enumerable:!0,get:function(){return Yu._}});Object.defineProperty(Rt,"str",{enumerable:!0,get:function(){return Yu.str}});Object.defineProperty(Rt,"stringify",{enumerable:!0,get:function(){return Yu.stringify}});Object.defineProperty(Rt,"nil",{enumerable:!0,get:function(){return Yu.nil}});Object.defineProperty(Rt,"Name",{enumerable:!0,get:function(){return Yu.Name}});Object.defineProperty(Rt,"CodeGen",{enumerable:!0,get:function(){return Yu.CodeGen}});var Tae=lw();Object.defineProperty(Rt,"ValidationError",{enumerable:!0,get:function(){return Tae.default}});var Eae=ih();Object.defineProperty(Rt,"MissingRefError",{enumerable:!0,get:function(){return Eae.default}})});var $6=g(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.formatLimitDefinition=void 0;var Oae=k6(),Do=Ie(),sa=Do.operators,Cw={formatMaximum:{okStr:"<=",ok:sa.LTE,fail:sa.GT},formatMinimum:{okStr:">=",ok:sa.GTE,fail:sa.LT},formatExclusiveMaximum:{okStr:"<",ok:sa.LT,fail:sa.GTE},formatExclusiveMinimum:{okStr:">",ok:sa.GT,fail:sa.LTE}},jae={message:({keyword:t,schemaCode:e})=>(0,Do.str)`should be ${Cw[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Do._)`{comparison: ${Cw[t].okStr}, limit: ${e}}`};Xu.formatLimitDefinition={keyword:Object.keys(Cw),type:"string",schemaType:"string",$data:!0,error:jae,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:i}=t,{opts:s,self:a}=i;if(!s.validateFormats)return;let c=new Oae.KeywordCxt(i,a.RULES.all.format.definition,"format");c.$data?l():u();function l(){let p=e.scopeValue("formats",{ref:a.formats,code:s.code.formats}),f=e.const("fmt",(0,Do._)`${p}[${c.schemaCode}]`);t.fail$data((0,Do.or)((0,Do._)`typeof ${f} != "object"`,(0,Do._)`${f} instanceof RegExp`,(0,Do._)`typeof ${f}.compare != "function"`,d(f)))}function u(){let p=c.schema,f=a.formats[p];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${p}" does not define "compare" function`);let h=e.scopeValue("formats",{key:p,ref:f,code:s.code.formats?(0,Do._)`${s.code.formats}${(0,Do.getProperty)(p)}`:void 0});t.fail$data(d(h))}function d(p){return(0,Do._)`${p}.compare(${r}, ${n}) ${Cw[o].fail} 0`}},dependencies:["format"]};var Nae=t=>(t.addKeyword(Xu.formatLimitDefinition),t);Xu.default=Nae});var I6=g((vh,C6)=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});var Qu=uU(),zae=$6(),dE=Ie(),A6=new dE.Name("fullFormats"),Rae=new dE.Name("fastFormats"),pE=(t,e={keywords:!0})=>{if(Array.isArray(e))return P6(t,e,Qu.fullFormats,A6),t;let[r,n]=e.mode==="fast"?[Qu.fastFormats,Rae]:[Qu.fullFormats,A6],o=e.formats||Qu.formatNames;return P6(t,o,r,n),e.keywords&&(0,zae.default)(t),t};pE.get=(t,e="full")=>{let n=(e==="fast"?Qu.fastFormats:Qu.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function P6(t,e,r,n){var o,i;(o=(i=t.opts.code).formats)!==null&&o!==void 0||(i.formats=(0,dE._)`require("ajv-formats/dist/formats").${n}`);for(let s of e)t.addFormat(s,r[s])}C6.exports=vh=pE;Object.defineProperty(vh,"__esModule",{value:!0});vh.default=pE});var q6=g((PAe,M6)=>{M6.exports=R6;R6.sync=Bae;var N6=require("fs");function Dae(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&t.substr(-o.length).toLowerCase()===o)return!0}return!1}function z6(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:Dae(e,r)}function R6(t,e,r){N6.stat(t,function(n,o){r(n,n?!1:z6(o,t,e))})}function Bae(t,e){return z6(N6.statSync(t),t,e)}});var F6=g((CAe,L6)=>{L6.exports=B6;B6.sync=Uae;var D6=require("fs");function B6(t,e,r){D6.stat(t,function(n,o){r(n,n?!1:U6(o,e))})}function Uae(t,e){return U6(D6.statSync(t),e)}function U6(t,e){return t.isFile()&&Lae(t,e)}function Lae(t,e){var r=t.mode,n=t.uid,o=t.gid,i=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),s=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),l=parseInt("001",8),u=a|c,d=r&l||r&c&&o===s||r&a&&n===i||r&u&&i===0;return d}});var Z6=g((TAe,V6)=>{var IAe=require("fs"),jw;process.platform==="win32"||global.TESTING_WINDOWS?jw=q6():jw=F6();V6.exports=fE;fE.sync=Fae;function fE(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,o){fE(t,e||{},function(i,s){i?o(i):n(s)})})}jw(t,e||{},function(n,o){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,o=!1),r(n,o)})}function Fae(t,e){try{return jw.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var X6=g((EAe,Y6)=>{var ed=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",H6=require("path"),Vae=ed?";":":",G6=Z6(),W6=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),K6=(t,e)=>{let r=e.colon||Vae,n=t.match(/\//)||ed&&t.match(/\\/)?[""]:[...ed?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],o=ed?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",i=ed?o.split(r):[""];return ed&&t.indexOf(".")!==-1&&i[0]!==""&&i.unshift(""),{pathEnv:n,pathExt:i,pathExtExe:o}},J6=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:o,pathExtExe:i}=K6(t,e),s=[],a=l=>new Promise((u,d)=>{if(l===n.length)return e.all&&s.length?u(s):d(W6(t));let p=n[l],f=/^".*"$/.test(p)?p.slice(1,-1):p,h=H6.join(f,t),m=!f&&/^\.[\\\/]/.test(t)?t.slice(0,2)+h:h;u(c(m,l,0))}),c=(l,u,d)=>new Promise((p,f)=>{if(d===o.length)return p(a(u+1));let h=o[d];G6(l+h,{pathExt:i},(m,y)=>{if(!m&&y)if(e.all)s.push(l+h);else return p(l+h);return p(c(l,u,d+1))})});return r?a(0).then(l=>r(null,l),r):a(0)},Zae=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:o}=K6(t,e),i=[];for(let s=0;s<r.length;s++){let a=r[s],c=/^".*"$/.test(a)?a.slice(1,-1):a,l=H6.join(c,t),u=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+l:l;for(let d=0;d<n.length;d++){let p=u+n[d];try{if(G6.sync(p,{pathExt:o}))if(e.all)i.push(p);else return p}catch{}}}if(e.all&&i.length)return i;if(e.nothrow)return null;throw W6(t)};Y6.exports=J6;J6.sync=Zae});var eF=g((OAe,mE)=>{"use strict";var Q6=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};mE.exports=Q6;mE.exports.default=Q6});var oF=g((jAe,nF)=>{"use strict";var tF=require("path"),Hae=X6(),Gae=eF();function rF(t,e){let r=t.options.env||process.env,n=process.cwd(),o=t.options.cwd!=null,i=o&&process.chdir!==void 0&&!process.chdir.disabled;if(i)try{process.chdir(t.options.cwd)}catch{}let s;try{s=Hae.sync(t.command,{path:r[Gae({env:r})],pathExt:e?tF.delimiter:void 0})}catch{}finally{i&&process.chdir(n)}return s&&(s=tF.resolve(o?t.options.cwd:"",s)),s}function Wae(t){return rF(t)||rF(t,!0)}nF.exports=Wae});var iF=g((NAe,gE)=>{"use strict";var hE=/([()\][%!^"`<>&|;, *?])/g;function Kae(t){return t=t.replace(hE,"^$1"),t}function Jae(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(hE,"^$1"),e&&(t=t.replace(hE,"^$1")),t}gE.exports.command=Kae;gE.exports.argument=Jae});var aF=g((zAe,sF)=>{"use strict";sF.exports=/^#!(.*)/});var lF=g((RAe,cF)=>{"use strict";var Yae=aF();cF.exports=(t="")=>{let e=t.match(Yae);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),o=r.split("/").pop();return o==="env"?n:n?`${o} ${n}`:o}});var dF=g((MAe,uF)=>{"use strict";var yE=require("fs"),Xae=lF();function Qae(t){let r=Buffer.alloc(150),n;try{n=yE.openSync(t,"r"),yE.readSync(n,r,0,150,0),yE.closeSync(n)}catch{}return Xae(r.toString())}uF.exports=Qae});var hF=g((qAe,mF)=>{"use strict";var ece=require("path"),pF=oF(),fF=iF(),tce=dF(),rce=process.platform==="win32",nce=/\.(?:com|exe)$/i,oce=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ice(t){t.file=pF(t);let e=t.file&&tce(t.file);return e?(t.args.unshift(t.file),t.command=e,pF(t)):t.file}function sce(t){if(!rce)return t;let e=ice(t),r=!nce.test(e);if(t.options.forceShell||r){let n=oce.test(e);t.command=ece.normalize(t.command),t.command=fF.command(t.command),t.args=t.args.map(i=>fF.argument(i,n));let o=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${o}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function ace(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:sce(n)}mF.exports=ace});var vF=g((DAe,yF)=>{"use strict";var vE=process.platform==="win32";function _E(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function cce(t,e){if(!vE)return;let r=t.emit;t.emit=function(n,o){if(n==="exit"){let i=gF(o,e);if(i)return r.call(t,"error",i)}return r.apply(t,arguments)}}function gF(t,e){return vE&&t===1&&!e.file?_E(e.original,"spawn"):null}function lce(t,e){return vE&&t===1&&!e.file?_E(e.original,"spawnSync"):null}yF.exports={hookChildProcess:cce,verifyENOENT:gF,verifyENOENTSync:lce,notFoundError:_E}});var wF=g((BAe,td)=>{"use strict";var _F=require("child_process"),bE=hF(),wE=vF();function bF(t,e,r){let n=bE(t,e,r),o=_F.spawn(n.command,n.args,n.options);return wE.hookChildProcess(o,n),o}function uce(t,e,r){let n=bE(t,e,r),o=_F.spawnSync(n.command,n.args,n.options);return o.error=o.error||wE.verifyENOENTSync(o.status,n),o}td.exports=bF;td.exports.spawn=bF;td.exports.sync=uce;td.exports._parse=bE;td.exports._enoent=wE});var as=g((wPe,ZF)=>{"use strict";var FF=["nodebuffer","arraybuffer","fragments"],VF=typeof Blob<"u";VF&&FF.push("blob");ZF.exports={BINARY_TYPES:FF,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:VF,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Rh=g((xPe,Zw)=>{"use strict";var{EMPTY_BUFFER:Vce}=as(),LE=Buffer[Symbol.species];function Zce(t,e){if(t.length===0)return Vce;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),n=0;for(let o=0;o<t.length;o++){let i=t[o];r.set(i,n),n+=i.length}return n<e?new LE(r.buffer,r.byteOffset,n):r}function HF(t,e,r,n,o){for(let i=0;i<o;i++)r[n+i]=t[i]^e[i&3]}function GF(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}function Hce(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}function FE(t){if(FE.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new LE(t):ArrayBuffer.isView(t)?e=new LE(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),FE.readOnly=!1),e}Zw.exports={concat:Zce,mask:HF,toArrayBuffer:Hce,toBuffer:FE,unmask:GF};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=require("bufferutil");Zw.exports.mask=function(e,r,n,o,i){i<48?HF(e,r,n,o,i):t.mask(e,r,n,o,i)},Zw.exports.unmask=function(e,r){e.length<32?GF(e,r):t.unmask(e,r)}}catch{}});var JF=g((SPe,KF)=>{"use strict";var WF=Symbol("kDone"),VE=Symbol("kRun"),ZE=class{constructor(e){this[WF]=()=>{this.pending--,this[VE]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[VE]()}[VE](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[WF])}}};KF.exports=ZE});var qh=g((kPe,eV)=>{"use strict";var Mh=require("zlib"),YF=Rh(),Gce=JF(),{kStatusCode:XF}=as(),Wce=Buffer[Symbol.species],Kce=Buffer.from([0,0,255,255]),Gw=Symbol("permessage-deflate"),cs=Symbol("total-length"),ad=Symbol("callback"),la=Symbol("buffers"),cd=Symbol("error"),Hw,HE=class{constructor(e,r,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!Hw){let o=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Hw=new Gce(o)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[ad];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,n=e.find(o=>!(r.serverNoContextTakeover===!1&&o.server_no_context_takeover||o.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>o.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!o.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(n.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?n.client_max_window_bits=r.clientMaxWindowBits:(n.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(n=>{let o=r[n];if(o.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(o=o[0],n==="client_max_window_bits"){if(o!==!0){let i=+o;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${n}": ${o}`);o=i}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${o}`)}else if(n==="server_max_window_bits"){let i=+o;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${n}": ${o}`);o=i}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(o!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${o}`)}else throw new Error(`Unknown parameter "${n}"`);r[n]=o})}),e}decompress(e,r,n){Hw.add(o=>{this._decompress(e,r,(i,s)=>{o(),n(i,s)})})}compress(e,r,n){Hw.add(o=>{this._compress(e,r,(i,s)=>{o(),n(i,s)})})}_decompress(e,r,n){let o=this._isServer?"client":"server";if(!this._inflate){let i=`${o}_max_window_bits`,s=typeof this.params[i]!="number"?Mh.Z_DEFAULT_WINDOWBITS:this.params[i];this._inflate=Mh.createInflateRaw({...this._options.zlibInflateOptions,windowBits:s}),this._inflate[Gw]=this,this._inflate[cs]=0,this._inflate[la]=[],this._inflate.on("error",Yce),this._inflate.on("data",QF)}this._inflate[ad]=n,this._inflate.write(e),r&&this._inflate.write(Kce),this._inflate.flush(()=>{let i=this._inflate[cd];if(i){this._inflate.close(),this._inflate=null,n(i);return}let s=YF.concat(this._inflate[la],this._inflate[cs]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[cs]=0,this._inflate[la]=[],r&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),n(null,s)})}_compress(e,r,n){let o=this._isServer?"server":"client";if(!this._deflate){let i=`${o}_max_window_bits`,s=typeof this.params[i]!="number"?Mh.Z_DEFAULT_WINDOWBITS:this.params[i];this._deflate=Mh.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:s}),this._deflate[cs]=0,this._deflate[la]=[],this._deflate.on("data",Jce)}this._deflate[ad]=n,this._deflate.write(e),this._deflate.flush(Mh.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let i=YF.concat(this._deflate[la],this._deflate[cs]);r&&(i=new Wce(i.buffer,i.byteOffset,i.length-4)),this._deflate[ad]=null,this._deflate[cs]=0,this._deflate[la]=[],r&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),n(null,i)})}};eV.exports=HE;function Jce(t){this[la].push(t),this[cs]+=t.length}function QF(t){if(this[cs]+=t.length,this[Gw]._maxPayload<1||this[cs]<=this[Gw]._maxPayload){this[la].push(t);return}this[cd]=new RangeError("Max payload size exceeded"),this[cd].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[cd][XF]=1009,this.removeListener("data",QF),this.reset()}function Yce(t){if(this[Gw]._inflate=null,this[cd]){this[ad](this[cd]);return}t[XF]=1007,this[ad](t)}});var ld=g(($Pe,Ww)=>{"use strict";var{isUtf8:tV}=require("buffer"),{hasBlob:Xce}=as(),Qce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function ele(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}function GE(t){let e=t.length,r=0;for(;r<e;)if((t[r]&128)===0)r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}function tle(t){return Xce&&typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&(t[Symbol.toStringTag]==="Blob"||t[Symbol.toStringTag]==="File")}Ww.exports={isBlob:tle,isValidStatusCode:ele,isValidUTF8:GE,tokenChars:Qce};if(tV)Ww.exports.isValidUTF8=function(t){return t.length<24?GE(t):tV(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=require("utf-8-validate");Ww.exports.isValidUTF8=function(e){return e.length<32?GE(e):t(e)}}catch{}});var XE=g((APe,cV)=>{"use strict";var{Writable:rle}=require("stream"),rV=qh(),{BINARY_TYPES:nle,EMPTY_BUFFER:nV,kStatusCode:ole,kWebSocket:ile}=as(),{concat:WE,toArrayBuffer:sle,unmask:ale}=Rh(),{isValidStatusCode:cle,isValidUTF8:oV}=ld(),Kw=Buffer[Symbol.species],po=0,iV=1,sV=2,aV=3,KE=4,JE=5,Jw=6,YE=class extends rle{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||nle[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[ile]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=po}_write(e,r,n){if(this._opcode===8&&this._state==po)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new Kw(n.buffer,n.byteOffset+e,n.length-e),new Kw(n.buffer,n.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let n=this._buffers[0],o=r.length-e;e>=n.length?r.set(this._buffers.shift(),o):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),o),this._buffers[0]=new Kw(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}startLoop(e){this._loop=!0;do switch(this._state){case po:this.getInfo(e);break;case iV:this.getPayloadLength16(e);break;case sV:this.getPayloadLength64(e);break;case aV:this.getMask();break;case KE:this.getData(e);break;case JE:case Jw:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let r=this.consume(2);if((r[0]&48)!==0){let o=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(o);return}let n=(r[0]&64)===64;if(n&&!this._extensions[rV.extensionName]){let o=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(o);return}if(this._fin=(r[0]&128)===128,this._opcode=r[0]&15,this._payloadLength=r[1]&127,this._opcode===0){if(n){let o=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(o);return}if(!this._fragmented){let o=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(o);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let o=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(o);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let o=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(o);return}if(n){let o=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(o);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let o=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(o);return}}else{let o=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(o);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(r[1]&128)===128,this._isServer){if(!this._masked){let o=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(o);return}}else if(this._masked){let o=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(o);return}this._payloadLength===126?this._state=iV:this._payloadLength===127?this._state=sV:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let r=this.consume(8),n=r.readUInt32BE(0);if(n>Math.pow(2,21)-1){let o=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(o);return}this._payloadLength=n*Math.pow(2,32)+r.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let r=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(r);return}this._masked?this._state=aV:this._state=KE}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=KE}getData(e){let r=nV;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&ale(r,this._mask)}if(this._opcode>7){this.controlMessage(r,e);return}if(this._compressed){this._state=JE,this.decompress(r,e);return}r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage(e)}decompress(e,r){this._extensions[rV.extensionName].decompress(e,this._fin,(o,i)=>{if(o)return r(o);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let s=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");r(s);return}this._fragments.push(i)}this.dataMessage(r),this._state===po&&this.startLoop(r)})}dataMessage(e){if(!this._fin){this._state=po;return}let r=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let o;this._binaryType==="nodebuffer"?o=WE(n,r):this._binaryType==="arraybuffer"?o=sle(WE(n,r)):this._binaryType==="blob"?o=new Blob(n):o=n,this._allowSynchronousEvents?(this.emit("message",o,!0),this._state=po):(this._state=Jw,setImmediate(()=>{this.emit("message",o,!0),this._state=po,this.startLoop(e)}))}else{let o=WE(n,r);if(!this._skipUTF8Validation&&!oV(o)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(i);return}this._state===JE||this._allowSynchronousEvents?(this.emit("message",o,!1),this._state=po):(this._state=Jw,setImmediate(()=>{this.emit("message",o,!1),this._state=po,this.startLoop(e)}))}}controlMessage(e,r){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,nV),this.end();else{let n=e.readUInt16BE(0);if(!cle(n)){let i=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");r(i);return}let o=new Kw(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!oV(o)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");r(i);return}this._loop=!1,this.emit("conclude",n,o),this.end()}this._state=po;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=po):(this._state=Jw,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=po,this.startLoop(r)}))}createError(e,r,n,o,i){this._loop=!1,this._errored=!0;let s=new e(n?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(s,this.createError),s.code=i,s[ole]=o,s}};cV.exports=YE});var tO=g((CPe,dV)=>{"use strict";var{Duplex:PPe}=require("stream"),{randomFillSync:lle}=require("crypto"),lV=qh(),{EMPTY_BUFFER:ule,kWebSocket:dle,NOOP:ple}=as(),{isBlob:ud,isValidStatusCode:fle}=ld(),{mask:uV,toBuffer:bc}=Rh(),fo=Symbol("kByteLength"),mle=Buffer.alloc(4),Yw=8*1024,wc,dd=Yw,Uo=0,hle=1,gle=2,QE=class t{constructor(e,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=Uo,this.onerror=ple,this[dle]=void 0}static frame(e,r){let n,o=!1,i=2,s=!1;r.mask&&(n=r.maskBuffer||mle,r.generateMask?r.generateMask(n):(dd===Yw&&(wc===void 0&&(wc=Buffer.alloc(Yw)),lle(wc,0,Yw),dd=0),n[0]=wc[dd++],n[1]=wc[dd++],n[2]=wc[dd++],n[3]=wc[dd++]),s=(n[0]|n[1]|n[2]|n[3])===0,i=6);let a;typeof e=="string"?(!r.mask||s)&&r[fo]!==void 0?a=r[fo]:(e=Buffer.from(e),a=e.length):(a=e.length,o=r.mask&&r.readOnly&&!s);let c=a;a>=65536?(i+=8,c=127):a>125&&(i+=2,c=126);let l=Buffer.allocUnsafe(o?a+i:i);return l[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(l[0]|=64),l[1]=c,c===126?l.writeUInt16BE(a,2):c===127&&(l[2]=l[3]=0,l.writeUIntBE(a,4,6)),r.mask?(l[1]|=128,l[i-4]=n[0],l[i-3]=n[1],l[i-2]=n[2],l[i-1]=n[3],s?[l,e]:o?(uV(e,n,l,i,a),[l]):(uV(e,n,e,0,a),[l,e])):[l,e]}close(e,r,n,o){let i;if(e===void 0)i=ule;else{if(typeof e!="number"||!fle(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0);else{let a=Buffer.byteLength(r);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+a),i.writeUInt16BE(e,0),typeof r=="string"?i.write(r,2):i.set(r,2)}}let s={[fo]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==Uo?this.enqueue([this.dispatch,i,!1,s,o]):this.sendFrame(t.frame(i,s),o)}ping(e,r,n){let o,i;if(typeof e=="string"?(o=Buffer.byteLength(e),i=!1):ud(e)?(o=e.size,i=!1):(e=bc(e),o=e.length,i=bc.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[fo]:o,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};ud(e)?this._state!==Uo?this.enqueue([this.getBlobData,e,!1,s,n]):this.getBlobData(e,!1,s,n):this._state!==Uo?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}pong(e,r,n){let o,i;if(typeof e=="string"?(o=Buffer.byteLength(e),i=!1):ud(e)?(o=e.size,i=!1):(e=bc(e),o=e.length,i=bc.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[fo]:o,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};ud(e)?this._state!==Uo?this.enqueue([this.getBlobData,e,!1,s,n]):this.getBlobData(e,!1,s,n):this._state!==Uo?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}send(e,r,n){let o=this._extensions[lV.extensionName],i=r.binary?2:1,s=r.compress,a,c;typeof e=="string"?(a=Buffer.byteLength(e),c=!1):ud(e)?(a=e.size,c=!1):(e=bc(e),a=e.length,c=bc.readOnly),this._firstFragment?(this._firstFragment=!1,s&&o&&o.params[o._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(s=a>=o._threshold),this._compress=s):(s=!1,i=0),r.fin&&(this._firstFragment=!0);let l={[fo]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:i,readOnly:c,rsv1:s};ud(e)?this._state!==Uo?this.enqueue([this.getBlobData,e,this._compress,l,n]):this.getBlobData(e,this._compress,l,n):this._state!==Uo?this.enqueue([this.dispatch,e,this._compress,l,n]):this.dispatch(e,this._compress,l,n)}getBlobData(e,r,n,o){this._bufferedBytes+=n[fo],this._state=gle,e.arrayBuffer().then(i=>{if(this._socket.destroyed){let a=new Error("The socket was closed while the blob was being read");process.nextTick(eO,this,a,o);return}this._bufferedBytes-=n[fo];let s=bc(i);r?this.dispatch(s,r,n,o):(this._state=Uo,this.sendFrame(t.frame(s,n),o),this.dequeue())}).catch(i=>{process.nextTick(yle,this,i,o)})}dispatch(e,r,n,o){if(!r){this.sendFrame(t.frame(e,n),o);return}let i=this._extensions[lV.extensionName];this._bufferedBytes+=n[fo],this._state=hle,i.compress(e,n.fin,(s,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");eO(this,c,o);return}this._bufferedBytes-=n[fo],this._state=Uo,n.readOnly=!1,this.sendFrame(t.frame(a,n),o),this.dequeue()})}dequeue(){for(;this._state===Uo&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][fo],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][fo],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};dV.exports=QE;function eO(t,e,r){typeof r=="function"&&r(e);for(let n=0;n<t._queue.length;n++){let o=t._queue[n],i=o[o.length-1];typeof i=="function"&&i(e)}}function yle(t,e,r){eO(t,e,r),t.onerror(e)}});var bV=g((IPe,_V)=>{"use strict";var{kForOnEventAttribute:Dh,kListener:rO}=as(),pV=Symbol("kCode"),fV=Symbol("kData"),mV=Symbol("kError"),hV=Symbol("kMessage"),gV=Symbol("kReason"),pd=Symbol("kTarget"),yV=Symbol("kType"),vV=Symbol("kWasClean"),ls=class{constructor(e){this[pd]=null,this[yV]=e}get target(){return this[pd]}get type(){return this[yV]}};Object.defineProperty(ls.prototype,"target",{enumerable:!0});Object.defineProperty(ls.prototype,"type",{enumerable:!0});var xc=class extends ls{constructor(e,r={}){super(e),this[pV]=r.code===void 0?0:r.code,this[gV]=r.reason===void 0?"":r.reason,this[vV]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[pV]}get reason(){return this[gV]}get wasClean(){return this[vV]}};Object.defineProperty(xc.prototype,"code",{enumerable:!0});Object.defineProperty(xc.prototype,"reason",{enumerable:!0});Object.defineProperty(xc.prototype,"wasClean",{enumerable:!0});var fd=class extends ls{constructor(e,r={}){super(e),this[mV]=r.error===void 0?null:r.error,this[hV]=r.message===void 0?"":r.message}get error(){return this[mV]}get message(){return this[hV]}};Object.defineProperty(fd.prototype,"error",{enumerable:!0});Object.defineProperty(fd.prototype,"message",{enumerable:!0});var Bh=class extends ls{constructor(e,r={}){super(e),this[fV]=r.data===void 0?null:r.data}get data(){return this[fV]}};Object.defineProperty(Bh.prototype,"data",{enumerable:!0});var vle={addEventListener(t,e,r={}){for(let o of this.listeners(t))if(!r[Dh]&&o[rO]===e&&!o[Dh])return;let n;if(t==="message")n=function(i,s){let a=new Bh("message",{data:s?i:i.toString()});a[pd]=this,Xw(e,this,a)};else if(t==="close")n=function(i,s){let a=new xc("close",{code:i,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[pd]=this,Xw(e,this,a)};else if(t==="error")n=function(i){let s=new fd("error",{error:i,message:i.message});s[pd]=this,Xw(e,this,s)};else if(t==="open")n=function(){let i=new ls("open");i[pd]=this,Xw(e,this,i)};else return;n[Dh]=!!r[Dh],n[rO]=e,r.once?this.once(t,n):this.on(t,n)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[rO]===e&&!r[Dh]){this.removeListener(t,r);break}}};_V.exports={CloseEvent:xc,ErrorEvent:fd,Event:ls,EventTarget:vle,MessageEvent:Bh};function Xw(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}});var nO=g((TPe,wV)=>{"use strict";var{tokenChars:Uh}=ld();function _i(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}function _le(t){let e=Object.create(null),r=Object.create(null),n=!1,o=!1,i=!1,s,a,c=-1,l=-1,u=-1,d=0;for(;d<t.length;d++)if(l=t.charCodeAt(d),s===void 0)if(u===-1&&Uh[l]===1)c===-1&&(c=d);else if(d!==0&&(l===32||l===9))u===-1&&c!==-1&&(u=d);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);u===-1&&(u=d);let f=t.slice(c,u);l===44?(_i(e,f,r),r=Object.create(null)):s=f,c=u=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);else if(a===void 0)if(u===-1&&Uh[l]===1)c===-1&&(c=d);else if(l===32||l===9)u===-1&&c!==-1&&(u=d);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);u===-1&&(u=d),_i(r,t.slice(c,u),!0),l===44&&(_i(e,s,r),r=Object.create(null),s=void 0),c=u=-1}else if(l===61&&c!==-1&&u===-1)a=t.slice(c,d),c=u=-1;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(o){if(Uh[l]!==1)throw new SyntaxError(`Unexpected character at index ${d}`);c===-1?c=d:n||(n=!0),o=!1}else if(i)if(Uh[l]===1)c===-1&&(c=d);else if(l===34&&c!==-1)i=!1,u=d;else if(l===92)o=!0;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(l===34&&t.charCodeAt(d-1)===61)i=!0;else if(u===-1&&Uh[l]===1)c===-1&&(c=d);else if(c!==-1&&(l===32||l===9))u===-1&&(u=d);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);u===-1&&(u=d);let f=t.slice(c,u);n&&(f=f.replace(/\\/g,""),n=!1),_i(r,a,f),l===44&&(_i(e,s,r),r=Object.create(null),s=void 0),a=void 0,c=u=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);if(c===-1||i||l===32||l===9)throw new SyntaxError("Unexpected end of input");u===-1&&(u=d);let p=t.slice(c,u);return s===void 0?_i(e,p,r):(a===void 0?_i(r,p,!0):n?_i(r,a,p.replace(/\\/g,"")):_i(r,a,p),_i(e,s,r)),e}function ble(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(n=>[e].concat(Object.keys(n).map(o=>{let i=n[o];return Array.isArray(i)||(i=[i]),i.map(s=>s===!0?o:`${o}=${s}`).join("; ")})).join("; ")).join(", ")}).join(", ")}wV.exports={format:ble,parse:_le}});var r0=g((jPe,jV)=>{"use strict";var wle=require("events"),xle=require("https"),Sle=require("http"),kV=require("net"),kle=require("tls"),{randomBytes:$le,createHash:Ale}=require("crypto"),{Duplex:EPe,Readable:OPe}=require("stream"),{URL:oO}=require("url"),ua=qh(),Ple=XE(),Cle=tO(),{isBlob:Ile}=ld(),{BINARY_TYPES:xV,EMPTY_BUFFER:Qw,GUID:Tle,kForOnEventAttribute:iO,kListener:Ele,kStatusCode:Ole,kWebSocket:br,NOOP:$V}=as(),{EventTarget:{addEventListener:jle,removeEventListener:Nle}}=bV(),{format:zle,parse:Rle}=nO(),{toBuffer:Mle}=Rh(),qle=30*1e3,AV=Symbol("kAborted"),sO=[8,13],us=["CONNECTING","OPEN","CLOSING","CLOSED"],Dle=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Ft=class t extends wle{constructor(e,r,n){super(),this._binaryType=xV[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Qw,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(n=r,r=[]):r=[r]),PV(this,e,r,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){xV.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,n){let o=new Ple({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),i=new Cle(e,this._extensions,n.generateMask);this._receiver=o,this._sender=i,this._socket=e,o[br]=this,i[br]=this,e[br]=this,o.on("conclude",Lle),o.on("drain",Fle),o.on("error",Vle),o.on("message",Zle),o.on("ping",Hle),o.on("pong",Gle),i.onerror=Wle,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",TV),e.on("data",t0),e.on("end",EV),e.on("error",OV),this._readyState=t.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ua.extensionName]&&this._extensions[ua.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){Vn(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===t.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),IV(this)}}pause(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){aO(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||Qw,r,n)}pong(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){aO(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||Qw,r,n)}resume(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(n=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){aO(this,e,n);return}let o={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[ua.extensionName]||(o.compress=!1),this._sender.send(e||Qw,o,n)}terminate(){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){Vn(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=t.CLOSING,this._socket.destroy())}}};Object.defineProperty(Ft,"CONNECTING",{enumerable:!0,value:us.indexOf("CONNECTING")});Object.defineProperty(Ft.prototype,"CONNECTING",{enumerable:!0,value:us.indexOf("CONNECTING")});Object.defineProperty(Ft,"OPEN",{enumerable:!0,value:us.indexOf("OPEN")});Object.defineProperty(Ft.prototype,"OPEN",{enumerable:!0,value:us.indexOf("OPEN")});Object.defineProperty(Ft,"CLOSING",{enumerable:!0,value:us.indexOf("CLOSING")});Object.defineProperty(Ft.prototype,"CLOSING",{enumerable:!0,value:us.indexOf("CLOSING")});Object.defineProperty(Ft,"CLOSED",{enumerable:!0,value:us.indexOf("CLOSED")});Object.defineProperty(Ft.prototype,"CLOSED",{enumerable:!0,value:us.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(Ft.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty(Ft.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[iO])return e[Ele];return null},set(e){for(let r of this.listeners(t))if(r[iO]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[iO]:!0})}})});Ft.prototype.addEventListener=jle;Ft.prototype.removeEventListener=Nle;jV.exports=Ft;function PV(t,e,r,n){let o={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:sO[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=o.autoPong,!sO.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${sO.join(", ")})`);let i;if(e instanceof oO)i=e;else try{i=new oO(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}i.protocol==="http:"?i.protocol="ws:":i.protocol==="https:"&&(i.protocol="wss:"),t._url=i.href;let s=i.protocol==="wss:",a=i.protocol==="ws+unix:",c;if(i.protocol!=="ws:"&&!s&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`:a&&!i.pathname?c="The URL's pathname is empty":i.hash&&(c="The URL contains a fragment identifier"),c){let m=new SyntaxError(c);if(t._redirects===0)throw m;e0(t,m);return}let l=s?443:80,u=$le(16).toString("base64"),d=s?xle.request:Sle.request,p=new Set,f;if(o.createConnection=o.createConnection||(s?Ule:Ble),o.defaultPort=o.defaultPort||l,o.port=i.port||l,o.host=i.hostname.startsWith("[")?i.hostname.slice(1,-1):i.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},o.path=i.pathname+i.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(f=new ua(o.perMessageDeflate!==!0?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=zle({[ua.extensionName]:f.offer()})),r.length){for(let m of r){if(typeof m!="string"||!Dle.test(m)||p.has(m))throw new SyntaxError("An invalid or duplicated subprotocol was specified");p.add(m)}o.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(i.username||i.password)&&(o.auth=`${i.username}:${i.password}`),a){let m=o.path.split(":");o.socketPath=m[0],o.path=m[1]}let h;if(o.followRedirects){if(t._redirects===0){t._originalIpc=a,t._originalSecure=s,t._originalHostOrSocketPath=a?o.socketPath:i.host;let m=n&&n.headers;if(n={...n,headers:{}},m)for(let[y,v]of Object.entries(m))n.headers[y.toLowerCase()]=v}else if(t.listenerCount("redirect")===0){let m=a?t._originalIpc?o.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:i.host===t._originalHostOrSocketPath;(!m||t._originalSecure&&!s)&&(delete o.headers.authorization,delete o.headers.cookie,m||delete o.headers.host,o.auth=void 0)}o.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),h=t._req=d(o),t._redirects&&t.emit("redirect",t.url,h)}else h=t._req=d(o);o.timeout&&h.on("timeout",()=>{Vn(t,h,"Opening handshake has timed out")}),h.on("error",m=>{h===null||h[AV]||(h=t._req=null,e0(t,m))}),h.on("response",m=>{let y=m.headers.location,v=m.statusCode;if(y&&o.followRedirects&&v>=300&&v<400){if(++t._redirects>o.maxRedirects){Vn(t,h,"Maximum redirects exceeded");return}h.abort();let w;try{w=new oO(y,e)}catch{let R=new SyntaxError(`Invalid URL: ${y}`);e0(t,R);return}PV(t,w,r,n)}else t.emit("unexpected-response",h,m)||Vn(t,h,`Unexpected server response: ${m.statusCode}`)}),h.on("upgrade",(m,y,v)=>{if(t.emit("upgrade",m),t.readyState!==Ft.CONNECTING)return;h=t._req=null;let w=m.headers.upgrade;if(w===void 0||w.toLowerCase()!=="websocket"){Vn(t,y,"Invalid Upgrade header");return}let $=Ale("sha1").update(u+Tle).digest("base64");if(m.headers["sec-websocket-accept"]!==$){Vn(t,y,"Invalid Sec-WebSocket-Accept header");return}let R=m.headers["sec-websocket-protocol"],P;if(R!==void 0?p.size?p.has(R)||(P="Server sent an invalid subprotocol"):P="Server sent a subprotocol but none was requested":p.size&&(P="Server sent no subprotocol"),P){Vn(t,y,P);return}R&&(t._protocol=R);let ce=m.headers["sec-websocket-extensions"];if(ce!==void 0){if(!f){Vn(t,y,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Te;try{Te=Rle(ce)}catch{Vn(t,y,"Invalid Sec-WebSocket-Extensions header");return}let be=Object.keys(Te);if(be.length!==1||be[0]!==ua.extensionName){Vn(t,y,"Server indicated an extension that was not requested");return}try{f.accept(Te[ua.extensionName])}catch{Vn(t,y,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[ua.extensionName]=f}t.setSocket(y,v,{allowSynchronousEvents:o.allowSynchronousEvents,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})}),o.finishRequest?o.finishRequest(h,t):h.end()}function e0(t,e){t._readyState=Ft.CLOSING,t._errorEmitted=!0,t.emit("error",e),t.emitClose()}function Ble(t){return t.path=t.socketPath,kV.connect(t)}function Ule(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=kV.isIP(t.host)?"":t.host),kle.connect(t)}function Vn(t,e,r){t._readyState=Ft.CLOSING;let n=new Error(r);Error.captureStackTrace(n,Vn),e.setHeader?(e[AV]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(e0,t,n)):(e.destroy(n),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}function aO(t,e,r){if(e){let n=Ile(e)?e.size:Mle(e).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(r){let n=new Error(`WebSocket is not open: readyState ${t.readyState} (${us[t.readyState]})`);process.nextTick(r,n)}}function Lle(t,e){let r=this[br];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[br]!==void 0&&(r._socket.removeListener("data",t0),process.nextTick(CV,r._socket),t===1005?r.close():r.close(t,e))}function Fle(){let t=this[br];t.isPaused||t._socket.resume()}function Vle(t){let e=this[br];e._socket[br]!==void 0&&(e._socket.removeListener("data",t0),process.nextTick(CV,e._socket),e.close(t[Ole])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t))}function SV(){this[br].emitClose()}function Zle(t,e){this[br].emit("message",t,e)}function Hle(t){let e=this[br];e._autoPong&&e.pong(t,!this._isServer,$V),e.emit("ping",t)}function Gle(t){this[br].emit("pong",t)}function CV(t){t.resume()}function Wle(t){let e=this[br];e.readyState!==Ft.CLOSED&&(e.readyState===Ft.OPEN&&(e._readyState=Ft.CLOSING,IV(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t)))}function IV(t){t._closeTimer=setTimeout(t._socket.destroy.bind(t._socket),qle)}function TV(){let t=this[br];this.removeListener("close",TV),this.removeListener("data",t0),this.removeListener("end",EV),t._readyState=Ft.CLOSING;let e;!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&(e=t._socket.read())!==null&&t._receiver.write(e),t._receiver.end(),this[br]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",SV),t._receiver.on("finish",SV))}function t0(t){this[br]._receiver.write(t)||this.pause()}function EV(){let t=this[br];t._readyState=Ft.CLOSING,t._receiver.end(),this.end()}function OV(){let t=this[br];this.removeListener("error",OV),this.on("error",$V),t&&(t._readyState=Ft.CLOSING,this.destroy())}});var MV=g((zPe,RV)=>{"use strict";var NPe=r0(),{Duplex:Kle}=require("stream");function NV(t){t.emit("close")}function Jle(){!this.destroyed&&this._writableState.finished&&this.destroy()}function zV(t){this.removeListener("error",zV),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}function Yle(t,e){let r=!0,n=new Kle({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(i,s){let a=!s&&n._readableState.objectMode?i.toString():i;n.push(a)||t.pause()}),t.once("error",function(i){n.destroyed||(r=!1,n.destroy(i))}),t.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(o,i){if(t.readyState===t.CLOSED){i(o),process.nextTick(NV,n);return}let s=!1;t.once("error",function(c){s=!0,i(c)}),t.once("close",function(){s||i(o),process.nextTick(NV,n)}),r&&t.terminate()},n._final=function(o){if(t.readyState===t.CONNECTING){t.once("open",function(){n._final(o)});return}t._socket!==null&&(t._socket._writableState.finished?(o(),n._readableState.endEmitted&&n.destroy()):(t._socket.once("finish",function(){o()}),t.close()))},n._read=function(){t.isPaused&&t.resume()},n._write=function(o,i,s){if(t.readyState===t.CONNECTING){t.once("open",function(){n._write(o,i,s)});return}t.send(o,s)},n.on("end",Jle),n.on("error",zV),n}RV.exports=Yle});var DV=g((RPe,qV)=>{"use strict";var{tokenChars:Xle}=ld();function Qle(t){let e=new Set,r=-1,n=-1,o=0;for(o;o<t.length;o++){let s=t.charCodeAt(o);if(n===-1&&Xle[s]===1)r===-1&&(r=o);else if(o!==0&&(s===32||s===9))n===-1&&r!==-1&&(n=o);else if(s===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${o}`);n===-1&&(n=o);let a=t.slice(r,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),r=n=-1}else throw new SyntaxError(`Unexpected character at index ${o}`)}if(r===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let i=t.slice(r,o);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);return e.add(i),e}qV.exports={parse:Qle}});var HV=g((qPe,ZV)=>{"use strict";var eue=require("events"),n0=require("http"),{Duplex:MPe}=require("stream"),{createHash:tue}=require("crypto"),BV=nO(),Sc=qh(),rue=DV(),nue=r0(),{GUID:oue,kWebSocket:iue}=as(),sue=/^[+/0-9A-Za-z]{22}==$/,UV=0,LV=1,VV=2,cO=class extends eue{constructor(e,r){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:nue,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=n0.createServer((n,o)=>{let i=n0.STATUS_CODES[426];o.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),o.end(i)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=aue(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(o,i,s)=>{this.handleUpgrade(o,i,s,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=UV}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===VV){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Lh,this);return}if(e&&this.once("close",e),this._state!==LV)if(this._state=LV,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Lh,this):process.nextTick(Lh,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{Lh(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,n,o){r.on("error",FV);let i=e.headers["sec-websocket-key"],s=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){kc(this,e,r,405,"Invalid HTTP method");return}if(s===void 0||s.toLowerCase()!=="websocket"){kc(this,e,r,400,"Invalid Upgrade header");return}if(i===void 0||!sue.test(i)){kc(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==13&&a!==8){kc(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){Fh(r,400);return}let c=e.headers["sec-websocket-protocol"],l=new Set;if(c!==void 0)try{l=rue.parse(c)}catch{kc(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let u=e.headers["sec-websocket-extensions"],d={};if(this.options.perMessageDeflate&&u!==void 0){let p=new Sc(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let f=BV.parse(u);f[Sc.extensionName]&&(p.accept(f[Sc.extensionName]),d[Sc.extensionName]=p)}catch{kc(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let p={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(p,(f,h,m,y)=>{if(!f)return Fh(r,h||401,m,y);this.completeUpgrade(d,i,l,e,r,n,o)});return}if(!this.options.verifyClient(p))return Fh(r,401)}this.completeUpgrade(d,i,l,e,r,n,o)}completeUpgrade(e,r,n,o,i,s,a){if(!i.readable||!i.writable)return i.destroy();if(i[iue])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>UV)return Fh(i,503);let l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${tue("sha1").update(r+oue).digest("base64")}`],u=new this.options.WebSocket(null,void 0,this.options);if(n.size){let d=this.options.handleProtocols?this.options.handleProtocols(n,o):n.values().next().value;d&&(l.push(`Sec-WebSocket-Protocol: ${d}`),u._protocol=d)}if(e[Sc.extensionName]){let d=e[Sc.extensionName].params,p=BV.format({[Sc.extensionName]:[d]});l.push(`Sec-WebSocket-Extensions: ${p}`),u._extensions=e}this.emit("headers",l,o),i.write(l.concat(`\r
`).join(`\r
`)),i.removeListener("error",FV),u.setSocket(i,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(u),u.on("close",()=>{this.clients.delete(u),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Lh,this)})),a(u,o)}};ZV.exports=cO;function aue(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return function(){for(let n of Object.keys(e))t.removeListener(n,e[n])}}function Lh(t){t._state=VV,t.emit("close")}function FV(){this.destroy()}function Fh(t,e,r,n){r=r||n0.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${n0.STATUS_CODES[e]}\r
`+Object.keys(n).map(o=>`${o}: ${n[o]}`).join(`\r
`)+`\r
\r
`+r)}function kc(t,e,r,n,o,i){if(t.listenerCount("wsClientError")){let s=new Error(o);Error.captureStackTrace(s,kc),t.emit("wsClientError",s,r,e)}else Fh(r,n,o,i)}});var WV=g(()=>{var GV;(function(t){(function(e){var r=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:a(),n=o(t);typeof r.Reflect<"u"&&(n=o(r.Reflect,n)),e(n,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(c,l){return function(u,d){Object.defineProperty(c,u,{configurable:!0,writable:!0,value:d}),l&&l(u,d)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function a(){return i()||s()}})(function(e,r){var n=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",a=typeof Object.create=="function",c={__proto__:[]}instanceof Array,l=!a&&!c,u={create:a?function(){return Dk(Object.create(null))}:c?function(){return Dk({__proto__:null})}:function(){return Dk({})},has:l?function(S,k){return n.call(S,k)}:function(S,k){return k in S},get:l?function(S,k){return n.call(S,k)?S[k]:void 0}:function(S,k){return S[k]}},d=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:aG(),f=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:cG(),h=typeof WeakMap=="function"?WeakMap:lG(),m=o?Symbol.for("@reflect-metadata:registry"):void 0,y=oG(),v=iG(y);function w(S,k,E,U){if(ue(E)){if(!iM(S))throw new TypeError;if(!sM(k))throw new TypeError;return Xr(S,k)}else{if(!iM(S))throw new TypeError;if(!Zt(k))throw new TypeError;if(!Zt(U)&&!ue(U)&&!js(U))throw new TypeError;return js(U)&&(U=void 0),E=si(E),Wt(S,k,E,U)}}e("decorate",w);function $(S,k){function E(U,ae){if(!Zt(U))throw new TypeError;if(!ue(ae)&&!rG(ae))throw new TypeError;Gv(S,k,U,ae)}return E}e("metadata",$);function R(S,k,E,U){if(!Zt(E))throw new TypeError;return ue(U)||(U=si(U)),Gv(S,k,E,U)}e("defineMetadata",R);function P(S,k,E){if(!Zt(k))throw new TypeError;return ue(E)||(E=si(E)),ii(S,k,E)}e("hasMetadata",P);function ce(S,k,E){if(!Zt(k))throw new TypeError;return ue(E)||(E=si(E)),Zl(S,k,E)}e("hasOwnMetadata",ce);function Te(S,k,E){if(!Zt(k))throw new TypeError;return ue(E)||(E=si(E)),Hv(S,k,E)}e("getMetadata",Te);function be(S,k,E){if(!Zt(k))throw new TypeError;return ue(E)||(E=si(E)),Hl(S,k,E)}e("getOwnMetadata",be);function et(S,k){if(!Zt(S))throw new TypeError;return ue(k)||(k=si(k)),Wv(S,k)}e("getMetadataKeys",et);function Ge(S,k){if(!Zt(S))throw new TypeError;return ue(k)||(k=si(k)),Gl(S,k)}e("getOwnMetadataKeys",Ge);function ar(S,k,E){if(!Zt(k))throw new TypeError;if(ue(E)||(E=si(E)),!Zt(k))throw new TypeError;ue(E)||(E=si(E));var U=rf(k,E,!1);return ue(U)?!1:U.OrdinaryDeleteMetadata(S,k,E)}e("deleteMetadata",ar);function Xr(S,k){for(var E=S.length-1;E>=0;--E){var U=S[E],ae=U(k);if(!ue(ae)&&!js(ae)){if(!sM(ae))throw new TypeError;k=ae}}return k}function Wt(S,k,E,U){for(var ae=S.length-1;ae>=0;--ae){var Qt=S[ae],pr=Qt(k,E,U);if(!ue(pr)&&!js(pr)){if(!Zt(pr))throw new TypeError;U=pr}}return U}function ii(S,k,E){var U=Zl(S,k,E);if(U)return!0;var ae=qk(k);return js(ae)?!1:ii(S,ae,E)}function Zl(S,k,E){var U=rf(k,E,!1);return ue(U)?!1:Kv(U.OrdinaryHasOwnMetadata(S,k,E))}function Hv(S,k,E){var U=Zl(S,k,E);if(U)return Hl(S,k,E);var ae=qk(k);if(!js(ae))return Hv(S,ae,E)}function Hl(S,k,E){var U=rf(k,E,!1);if(!ue(U))return U.OrdinaryGetOwnMetadata(S,k,E)}function Gv(S,k,E,U){var ae=rf(E,U,!0);ae.OrdinaryDefineOwnMetadata(S,k,E,U)}function Wv(S,k){var E=Gl(S,k),U=qk(S);if(U===null)return E;var ae=Wv(U,k);if(ae.length<=0)return E;if(E.length<=0)return ae;for(var Qt=new f,pr=[],qe=0,G=E;qe<G.length;qe++){var X=G[qe],ee=Qt.has(X);ee||(Qt.add(X),pr.push(X))}for(var ne=0,Le=ae;ne<Le.length;ne++){var X=Le[ne],ee=Qt.has(X);ee||(Qt.add(X),pr.push(X))}return pr}function Gl(S,k){var E=rf(S,k,!1);return E?E.OrdinaryOwnMetadataKeys(S,k):[]}function Ra(S){if(S===null)return 1;switch(typeof S){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return S===null?1:6;default:return 6}}function ue(S){return S===void 0}function js(S){return S===null}function Nk(S){return typeof S=="symbol"}function Zt(S){return typeof S=="object"?S!==null:typeof S=="function"}function zk(S,k){switch(Ra(S)){case 0:return S;case 1:return S;case 2:return S;case 3:return S;case 4:return S;case 5:return S}var E=k===3?"string":k===5?"number":"default",U=aM(S,i);if(U!==void 0){var ae=U.call(S,E);if(Zt(ae))throw new TypeError;return ae}return Rk(S,E==="default"?"number":E)}function Rk(S,k){if(k==="string"){var E=S.toString;if(Kl(E)){var U=E.call(S);if(!Zt(U))return U}var ae=S.valueOf;if(Kl(ae)){var U=ae.call(S);if(!Zt(U))return U}}else{var ae=S.valueOf;if(Kl(ae)){var U=ae.call(S);if(!Zt(U))return U}var Qt=S.toString;if(Kl(Qt)){var U=Qt.call(S);if(!Zt(U))return U}}throw new TypeError}function Kv(S){return!!S}function Wl(S){return""+S}function si(S){var k=zk(S,3);return Nk(k)?k:Wl(k)}function iM(S){return Array.isArray?Array.isArray(S):S instanceof Object?S instanceof Array:Object.prototype.toString.call(S)==="[object Array]"}function Kl(S){return typeof S=="function"}function sM(S){return typeof S=="function"}function rG(S){switch(Ra(S)){case 3:return!0;case 4:return!0;default:return!1}}function Mk(S,k){return S===k||S!==S&&k!==k}function aM(S,k){var E=S[k];if(E!=null){if(!Kl(E))throw new TypeError;return E}}function cM(S){var k=aM(S,s);if(!Kl(k))throw new TypeError;var E=k.call(S);if(!Zt(E))throw new TypeError;return E}function lM(S){return S.value}function uM(S){var k=S.next();return k.done?!1:k}function dM(S){var k=S.return;k&&k.call(S)}function qk(S){var k=Object.getPrototypeOf(S);if(typeof S!="function"||S===d||k!==d)return k;var E=S.prototype,U=E&&Object.getPrototypeOf(E);if(U==null||U===Object.prototype)return k;var ae=U.constructor;return typeof ae!="function"||ae===S?k:ae}function nG(){var S;!ue(m)&&typeof r.Reflect<"u"&&!(m in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(S=sG(r.Reflect));var k,E,U,ae=new h,Qt={registerProvider:pr,getProvider:G,setProvider:ee};return Qt;function pr(ne){if(!Object.isExtensible(Qt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case S===ne:break;case ue(k):k=ne;break;case k===ne:break;case ue(E):E=ne;break;case E===ne:break;default:U===void 0&&(U=new f),U.add(ne);break}}function qe(ne,Le){if(!ue(k)){if(k.isProviderFor(ne,Le))return k;if(!ue(E)){if(E.isProviderFor(ne,Le))return k;if(!ue(U))for(var Tt=cM(U);;){var er=uM(Tt);if(!er)return;var Ao=lM(er);if(Ao.isProviderFor(ne,Le))return dM(Tt),Ao}}}if(!ue(S)&&S.isProviderFor(ne,Le))return S}function G(ne,Le){var Tt=ae.get(ne),er;return ue(Tt)||(er=Tt.get(Le)),ue(er)&&(er=qe(ne,Le),ue(er)||(ue(Tt)&&(Tt=new p,ae.set(ne,Tt)),Tt.set(Le,er))),er}function X(ne){if(ue(ne))throw new TypeError;return k===ne||E===ne||!ue(U)&&U.has(ne)}function ee(ne,Le,Tt){if(!X(Tt))throw new Error("Metadata provider not registered.");var er=G(ne,Le);if(er!==Tt){if(!ue(er))return!1;var Ao=ae.get(ne);ue(Ao)&&(Ao=new p,ae.set(ne,Ao)),Ao.set(Le,Tt)}return!0}}function oG(){var S;return!ue(m)&&Zt(r.Reflect)&&Object.isExtensible(r.Reflect)&&(S=r.Reflect[m]),ue(S)&&(S=nG()),!ue(m)&&Zt(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,m,{enumerable:!1,configurable:!1,writable:!1,value:S}),S}function iG(S){var k=new h,E={isProviderFor:function(X,ee){var ne=k.get(X);return ue(ne)?!1:ne.has(ee)},OrdinaryDefineOwnMetadata:pr,OrdinaryHasOwnMetadata:ae,OrdinaryGetOwnMetadata:Qt,OrdinaryOwnMetadataKeys:qe,OrdinaryDeleteMetadata:G};return y.registerProvider(E),E;function U(X,ee,ne){var Le=k.get(X),Tt=!1;if(ue(Le)){if(!ne)return;Le=new p,k.set(X,Le),Tt=!0}var er=Le.get(ee);if(ue(er)){if(!ne)return;if(er=new p,Le.set(ee,er),!S.setProvider(X,ee,E))throw Le.delete(ee),Tt&&k.delete(X),new Error("Wrong provider for target.")}return er}function ae(X,ee,ne){var Le=U(ee,ne,!1);return ue(Le)?!1:Kv(Le.has(X))}function Qt(X,ee,ne){var Le=U(ee,ne,!1);if(!ue(Le))return Le.get(X)}function pr(X,ee,ne,Le){var Tt=U(ne,Le,!0);Tt.set(X,ee)}function qe(X,ee){var ne=[],Le=U(X,ee,!1);if(ue(Le))return ne;for(var Tt=Le.keys(),er=cM(Tt),Ao=0;;){var pM=uM(er);if(!pM)return ne.length=Ao,ne;var uG=lM(pM);try{ne[Ao]=uG}catch(dG){try{dM(er)}finally{throw dG}}Ao++}}function G(X,ee,ne){var Le=U(ee,ne,!1);if(ue(Le)||!Le.delete(X))return!1;if(Le.size===0){var Tt=k.get(ee);ue(Tt)||(Tt.delete(ne),Tt.size===0&&k.delete(Tt))}return!0}}function sG(S){var k=S.defineMetadata,E=S.hasOwnMetadata,U=S.getOwnMetadata,ae=S.getOwnMetadataKeys,Qt=S.deleteMetadata,pr=new h,qe={isProviderFor:function(G,X){var ee=pr.get(G);return!ue(ee)&&ee.has(X)?!0:ae(G,X).length?(ue(ee)&&(ee=new f,pr.set(G,ee)),ee.add(X),!0):!1},OrdinaryDefineOwnMetadata:k,OrdinaryHasOwnMetadata:E,OrdinaryGetOwnMetadata:U,OrdinaryOwnMetadataKeys:ae,OrdinaryDeleteMetadata:Qt};return qe}function rf(S,k,E){var U=y.getProvider(S,k);if(!ue(U))return U;if(E){if(y.setProvider(S,k,v))return v;throw new Error("Illegal state.")}}function aG(){var S={},k=[],E=(function(){function qe(G,X,ee){this._index=0,this._keys=G,this._values=X,this._selector=ee}return qe.prototype["@@iterator"]=function(){return this},qe.prototype[s]=function(){return this},qe.prototype.next=function(){var G=this._index;if(G>=0&&G<this._keys.length){var X=this._selector(this._keys[G],this._values[G]);return G+1>=this._keys.length?(this._index=-1,this._keys=k,this._values=k):this._index++,{value:X,done:!1}}return{value:void 0,done:!0}},qe.prototype.throw=function(G){throw this._index>=0&&(this._index=-1,this._keys=k,this._values=k),G},qe.prototype.return=function(G){return this._index>=0&&(this._index=-1,this._keys=k,this._values=k),{value:G,done:!0}},qe})(),U=(function(){function qe(){this._keys=[],this._values=[],this._cacheKey=S,this._cacheIndex=-2}return Object.defineProperty(qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),qe.prototype.has=function(G){return this._find(G,!1)>=0},qe.prototype.get=function(G){var X=this._find(G,!1);return X>=0?this._values[X]:void 0},qe.prototype.set=function(G,X){var ee=this._find(G,!0);return this._values[ee]=X,this},qe.prototype.delete=function(G){var X=this._find(G,!1);if(X>=0){for(var ee=this._keys.length,ne=X+1;ne<ee;ne++)this._keys[ne-1]=this._keys[ne],this._values[ne-1]=this._values[ne];return this._keys.length--,this._values.length--,Mk(G,this._cacheKey)&&(this._cacheKey=S,this._cacheIndex=-2),!0}return!1},qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=S,this._cacheIndex=-2},qe.prototype.keys=function(){return new E(this._keys,this._values,ae)},qe.prototype.values=function(){return new E(this._keys,this._values,Qt)},qe.prototype.entries=function(){return new E(this._keys,this._values,pr)},qe.prototype["@@iterator"]=function(){return this.entries()},qe.prototype[s]=function(){return this.entries()},qe.prototype._find=function(G,X){if(!Mk(this._cacheKey,G)){this._cacheIndex=-1;for(var ee=0;ee<this._keys.length;ee++)if(Mk(this._keys[ee],G)){this._cacheIndex=ee;break}}return this._cacheIndex<0&&X&&(this._cacheIndex=this._keys.length,this._keys.push(G),this._values.push(void 0)),this._cacheIndex},qe})();return U;function ae(qe,G){return qe}function Qt(qe,G){return G}function pr(qe,G){return[qe,G]}}function cG(){var S=(function(){function k(){this._map=new p}return Object.defineProperty(k.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),k.prototype.has=function(E){return this._map.has(E)},k.prototype.add=function(E){return this._map.set(E,E),this},k.prototype.delete=function(E){return this._map.delete(E)},k.prototype.clear=function(){this._map.clear()},k.prototype.keys=function(){return this._map.keys()},k.prototype.values=function(){return this._map.keys()},k.prototype.entries=function(){return this._map.entries()},k.prototype["@@iterator"]=function(){return this.keys()},k.prototype[s]=function(){return this.keys()},k})();return S}function lG(){var S=16,k=u.create(),E=U();return(function(){function G(){this._key=U()}return G.prototype.has=function(X){var ee=ae(X,!1);return ee!==void 0?u.has(ee,this._key):!1},G.prototype.get=function(X){var ee=ae(X,!1);return ee!==void 0?u.get(ee,this._key):void 0},G.prototype.set=function(X,ee){var ne=ae(X,!0);return ne[this._key]=ee,this},G.prototype.delete=function(X){var ee=ae(X,!1);return ee!==void 0?delete ee[this._key]:!1},G.prototype.clear=function(){this._key=U()},G})();function U(){var G;do G="@@WeakMap@@"+qe();while(u.has(k,G));return k[G]=!0,G}function ae(G,X){if(!n.call(G,E)){if(!X)return;Object.defineProperty(G,E,{value:u.create()})}return G[E]}function Qt(G,X){for(var ee=0;ee<X;++ee)G[ee]=Math.random()*255|0;return G}function pr(G){if(typeof Uint8Array=="function"){var X=new Uint8Array(G);return typeof crypto<"u"?crypto.getRandomValues(X):typeof msCrypto<"u"?msCrypto.getRandomValues(X):Qt(X,G),X}return Qt(new Array(G),G)}function qe(){var G=pr(S);G[6]=G[6]&79|64,G[8]=G[8]&191|128;for(var X="",ee=0;ee<S;++ee){var ne=G[ee];(ee===4||ee===6||ee===8)&&(X+="-"),ne<16&&(X+="0"),X+=ne.toString(16).toLowerCase()}return X}}function Dk(S){return S.__=void 0,delete S.__,S}})})(GV||(GV={}))});var I={};Ui(I,{__addDisposableResource:()=>_Z,__assign:()=>o0,__asyncDelegator:()=>dZ,__asyncGenerator:()=>uZ,__asyncValues:()=>pZ,__await:()=>md,__awaiter:()=>oZ,__classPrivateFieldGet:()=>gZ,__classPrivateFieldIn:()=>vZ,__classPrivateFieldSet:()=>yZ,__createBinding:()=>s0,__decorate:()=>YV,__disposeResources:()=>bZ,__esDecorate:()=>QV,__exportStar:()=>sZ,__extends:()=>KV,__generator:()=>iZ,__importDefault:()=>hZ,__importStar:()=>mZ,__makeTemplateObject:()=>fZ,__metadata:()=>nZ,__param:()=>XV,__propKey:()=>tZ,__read:()=>pO,__rest:()=>JV,__rewriteRelativeImportExtension:()=>wZ,__runInitializers:()=>eZ,__setFunctionName:()=>rZ,__spread:()=>aZ,__spreadArray:()=>lZ,__spreadArrays:()=>cZ,__values:()=>i0,default:()=>mue});function KV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");uO(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function JV(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r}function YV(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i}function XV(t,e){return function(r,n){e(r,n,t)}}function QV(t,e,r,n,o,i){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var a=n.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=!e&&t?n.static?t:t.prototype:null,u=e||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d,p=!1,f=r.length-1;f>=0;f--){var h={};for(var m in n)h[m]=m==="access"?{}:n[m];for(var m in n.access)h.access[m]=n.access[m];h.addInitializer=function(v){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(v||null))};var y=(0,r[f])(a==="accessor"?{get:u.get,set:u.set}:u[c],h);if(a==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(d=s(y.get))&&(u.get=d),(d=s(y.set))&&(u.set=d),(d=s(y.init))&&o.unshift(d)}else(d=s(y))&&(a==="field"?o.unshift(d):u[c]=d)}l&&Object.defineProperty(l,n.name,u),p=!0}function eZ(t,e,r){for(var n=arguments.length>2,o=0;o<e.length;o++)r=n?e[o].call(t,r):e[o].call(t);return n?r:void 0}function tZ(t){return typeof t=="symbol"?t:"".concat(t)}function rZ(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function nZ(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function oZ(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(u){try{l(n.next(u))}catch(d){s(d)}}function c(u){try{l(n.throw(u))}catch(d){s(d)}}function l(u){u.done?i(u.value):o(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function iZ(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],o=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function sZ(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&s0(e,t,r)}function i0(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pO(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function aZ(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(pO(arguments[e]));return t}function cZ(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function lZ(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function md(t){return this instanceof md?(this.v=t,this):new md(t)}function uZ(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(f){return function(h){return Promise.resolve(h).then(f,d)}}function a(f,h){n[f]&&(o[f]=function(m){return new Promise(function(y,v){i.push([f,m,y,v])>1||c(f,m)})},h&&(o[f]=h(o[f])))}function c(f,h){try{l(n[f](h))}catch(m){p(i[0][3],m)}}function l(f){f.value instanceof md?Promise.resolve(f.value.v).then(u,d):p(i[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function p(f,h){f(h),i.shift(),i.length&&c(i[0][0],i[0][1])}}function dZ(t){var e,r;return e={},n("next"),n("throw",function(o){throw o}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(o,i){e[o]=t[o]?function(s){return(r=!r)?{value:md(t[o](s)),done:!1}:i?i(s):s}:i}}function pZ(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof i0=="function"?i0(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(s){return new Promise(function(a,c){s=t[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}}function fZ(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function mZ(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=dO(t),n=0;n<r.length;n++)r[n]!=="default"&&s0(e,t,r[n]);return pue(e,t),e}function hZ(t){return t&&t.__esModule?t:{default:t}}function gZ(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function yZ(t,e,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,r):o?o.value=r:e.set(t,r),r}function vZ(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function _Z(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(o=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(i){return Promise.reject(i)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}function bZ(t){function e(i){t.error=t.hasError?new fue(i,t.error,"An error was suppressed during disposal."):i,t.hasError=!0}var r,n=0;function o(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,function(s){return e(s),o()})}else n|=1}catch(s){e(s)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return o()}function wZ(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,o,i,s){return n?e?".jsx":".js":o&&(!i||!s)?r:o+i+"."+s.toLowerCase()+"js"}):t}var uO,o0,s0,pue,dO,fue,mue,T=fM(()=>{uO=function(t,e){return uO=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},uO(t,e)};o0=function(){return o0=Object.assign||function(e){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},o0.apply(this,arguments)};s0=Object.create?(function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]});pue=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},dO=function(t){return dO=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},dO(t)};fue=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};mue={__extends:KV,__assign:o0,__rest:JV,__decorate:YV,__param:XV,__esDecorate:QV,__runInitializers:eZ,__propKey:tZ,__setFunctionName:rZ,__metadata:nZ,__awaiter:oZ,__generator:iZ,__createBinding:s0,__exportStar:sZ,__values:i0,__read:pO,__spread:aZ,__spreadArrays:cZ,__spreadArray:lZ,__await:md,__asyncGenerator:uZ,__asyncDelegator:dZ,__asyncValues:pZ,__makeTemplateObject:fZ,__importStar:mZ,__importDefault:hZ,__classPrivateFieldGet:gZ,__classPrivateFieldSet:yZ,__classPrivateFieldIn:vZ,__addDisposableResource:_Z,__disposeResources:bZ,__rewriteRelativeImportExtension:wZ}});var ps=g(hd=>{"use strict";var hue="[object ArrayBuffer]",ds=class t{static isArrayBuffer(e){return Object.prototype.toString.call(e)===hue}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,r){if(e.constructor===r)return e;if(this.isArrayBuffer(e))return new r(e);if(this.isArrayBufferView(e))return new r(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,r){let n=t.toUint8Array(e),o=t.toUint8Array(r);if(n.length!==o.byteLength)return!1;for(let i=0;i<n.length;i++)if(n[i]!==o[i])return!1;return!0}static concat(...e){let r;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?r=e[0]:e[e.length-1]instanceof Function?r=e.slice(0,e.length-1):r=e;let n=0;for(let s of r)n+=s.byteLength;let o=new Uint8Array(n),i=0;for(let s of r){let a=this.toUint8Array(s);o.set(a,i),i+=a.length}return e[e.length-1]instanceof Function?this.toView(o,e[e.length-1]):o.buffer}},fO="string",gue=/^[0-9a-f\s]+$/i,yue=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,vue=/^[a-zA-Z0-9-_]+$/,a0=class{static fromString(e){let r=unescape(encodeURIComponent(e)),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n.buffer}static toString(e){let r=ds.toUint8Array(e),n="";for(let i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return decodeURIComponent(escape(n))}},mo=class{static toString(e,r=!1){let n=ds.toArrayBuffer(e),o=new DataView(n),i="";for(let s=0;s<n.byteLength;s+=2){let a=o.getUint16(s,r);i+=String.fromCharCode(a)}return i}static fromString(e,r=!1){let n=new ArrayBuffer(e.length*2),o=new DataView(n);for(let i=0;i<e.length;i++)o.setUint16(i*2,e.charCodeAt(i),r);return n}},c0=class t{static isHex(e){return typeof e===fO&&gue.test(e)}static isBase64(e){return typeof e===fO&&yue.test(e)}static isBase64Url(e){return typeof e===fO&&vue.test(e)}static ToString(e,r="utf8"){let n=ds.toUint8Array(e);switch(r.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return mo.toString(n,!0);case"utf16":case"utf16be":return mo.toString(n);default:throw new Error(`Unknown type of encoding '${r}'`)}}static FromString(e,r="utf8"){if(!e)return new ArrayBuffer(0);switch(r.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return mo.fromString(e,!0);case"utf16":case"utf16be":return mo.fromString(e);default:throw new Error(`Unknown type of encoding '${r}'`)}}static ToBase64(e){let r=ds.toUint8Array(e);if(typeof btoa<"u"){let n=this.ToString(r,"binary");return btoa(n)}else return Buffer.from(r).toString("base64")}static FromBase64(e){let r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!t.isBase64(r))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(r)):new Uint8Array(Buffer.from(r,"base64")).buffer}static FromBase64Url(e){let r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!t.isBase64Url(r))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(r.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,r=t.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.FromBinary(e);case"utf8":return a0.fromString(e);case"utf16":case"utf16be":return mo.fromString(e);case"utf16le":case"usc2":return mo.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${r}'`)}}static ToUtf8String(e,r=t.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.ToBinary(e);case"utf8":return a0.toString(e);case"utf16":case"utf16be":return mo.toString(e);case"utf16le":case"usc2":return mo.toString(e,!0);default:throw new Error(`Unknown type of encoding '${r}'`)}}static FromBinary(e){let r=e.length,n=new Uint8Array(r);for(let o=0;o<r;o++)n[o]=e.charCodeAt(o);return n.buffer}static ToBinary(e){let r=ds.toUint8Array(e),n="";for(let o=0;o<r.length;o++)n+=String.fromCharCode(r[o]);return n}static ToHex(e){let r=ds.toUint8Array(e),n="",o=r.length;for(let i=0;i<o;i++){let s=r[i];s<16&&(n+="0"),n+=s.toString(16)}return n}static FromHex(e){let r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!t.isHex(r))throw new TypeError("Argument 'hexString' is not HEX encoded");r.length%2&&(r=`0${r}`);let n=new Uint8Array(r.length/2);for(let o=0;o<r.length;o=o+2){let i=r.slice(o,o+2);n[o/2]=parseInt(i,16)}return n.buffer}static ToUtf16String(e,r=!1){return mo.toString(e,r)}static FromUtf16String(e,r=!1){return mo.fromString(e,r)}static Base64Padding(e){let r=4-e.length%4;if(r<4)for(let n=0;n<r;n++)e+="=";return e}static formatString(e){return e?.replace(/[\n\r\t ]/g,"")||""}};c0.DEFAULT_UTF8_ENCODING="utf8";function _ue(t,...e){let r=arguments[0];for(let n=1;n<arguments.length;n++){let o=arguments[n];for(let i in o)r[i]=o[i]}return r}function bue(...t){let e=t.map(o=>o.byteLength).reduce((o,i)=>o+i),r=new Uint8Array(e),n=0;return t.map(o=>new Uint8Array(o)).forEach(o=>{for(let i of o)r[n++]=i}),r.buffer}function wue(t,e){if(!(t&&e)||t.byteLength!==e.byteLength)return!1;let r=new Uint8Array(t),n=new Uint8Array(e);for(let o=0;o<t.byteLength;o++)if(r[o]!==n[o])return!1;return!0}hd.BufferSourceConverter=ds;hd.Convert=c0;hd.assign=_ue;hd.combine=bue;hd.isEqual=wue});var kZ=g(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});function xue(t){return new Date(t.getTime()+t.getTimezoneOffset()*6e4)}function Sue(t,e,r){var n;return t instanceof Object&&(n=t[e])!==null&&n!==void 0?n:r}function kue(t,e=0,r=t.byteLength-e,n=!1){let o="";for(let i of new Uint8Array(t,e,r)){let s=i.toString(16).toUpperCase();s.length===1&&(o+="0"),o+=s,n&&(o+=" ")}return o.trim()}function $ue(t,e,r,n){return e instanceof ArrayBuffer?e.byteLength?r<0?(t.error="Wrong parameter: inputOffset less than zero",!1):n<0?(t.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-r-n<0?(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1)}function mO(t,e){let r=0;if(t.length===1)return t[0];for(let n=t.length-1;n>=0;n--)r+=t[t.length-1-n]*Math.pow(2,e*n);return r}function hO(t,e,r=-1){let n=r,o=t,i=0,s=Math.pow(2,e);for(let a=1;a<8;a++){if(t<s){let c;if(n<0)c=new ArrayBuffer(a),i=a;else{if(n<a)return new ArrayBuffer(0);c=new ArrayBuffer(n),i=n}let l=new Uint8Array(c);for(let u=a-1;u>=0;u--){let d=Math.pow(2,u*e);l[i-u-1]=Math.floor(o/d),o-=l[i-u-1]*d}return c}s*=Math.pow(2,e)}return new ArrayBuffer(0)}function Aue(...t){let e=0,r=0;for(let i of t)e+=i.byteLength;let n=new ArrayBuffer(e),o=new Uint8Array(n);for(let i of t)o.set(new Uint8Array(i),r),r+=i.byteLength;return n}function Pue(...t){let e=0,r=0;for(let i of t)e+=i.length;let n=new ArrayBuffer(e),o=new Uint8Array(n);for(let i of t)o.set(i,r),r+=i.length;return o}function Cue(){let t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let a=t[0]===255&&t[1]&128,c=t[0]===0&&(t[1]&128)===0;(a||c)&&this.warnings.push("Needlessly long format")}let e=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(e);for(let a=0;a<this.valueHex.byteLength;a++)r[a]=0;r[0]=t[0]&128;let n=mO(r,8),o=new ArrayBuffer(this.valueHex.byteLength),i=new Uint8Array(o);for(let a=0;a<this.valueHex.byteLength;a++)i[a]=t[a];return i[0]&=127,mO(i,8)-n}function Iue(t){let e=t<0?t*-1:t,r=128;for(let n=1;n<8;n++){if(e<=r){if(t<0){let s=r-e,a=hO(s,8,n),c=new Uint8Array(a);return c[0]|=128,a}let o=hO(e,8,n),i=new Uint8Array(o);if(i[0]&128){let s=o.slice(0),a=new Uint8Array(s);o=new ArrayBuffer(o.byteLength+1),i=new Uint8Array(o);for(let c=0;c<s.byteLength;c++)i[c+1]=a[c];i[0]=0}return o}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function Tue(t,e){if(t.byteLength!==e.byteLength)return!1;let r=new Uint8Array(t),n=new Uint8Array(e);for(let o=0;o<r.length;o++)if(r[o]!==n[o])return!1;return!0}function Eue(t,e){let r=t.toString(10);if(e<r.length)return"";let n=e-r.length,o=new Array(n);for(let s=0;s<n;s++)o[s]="0";return o.join("").concat(r)}var xZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",SZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function Oue(t,e=!1,r=!1,n=!1){let o=0,i=0,s=0,a="",c=e?SZ:xZ;if(n){let l=0;for(let u=0;u<t.length;u++)if(t.charCodeAt(u)!==0){l=u;break}t=t.slice(l)}for(;o<t.length;){let l=t.charCodeAt(o++);o>=t.length&&(i=1);let u=t.charCodeAt(o++);o>=t.length&&(s=1);let d=t.charCodeAt(o++),p=l>>2,f=(l&3)<<4|u>>4,h=(u&15)<<2|d>>6,m=d&63;i===1?h=m=64:s===1&&(m=64),r?h===64?a+=`${c.charAt(p)}${c.charAt(f)}`:m===64?a+=`${c.charAt(p)}${c.charAt(f)}${c.charAt(h)}`:a+=`${c.charAt(p)}${c.charAt(f)}${c.charAt(h)}${c.charAt(m)}`:a+=`${c.charAt(p)}${c.charAt(f)}${c.charAt(h)}${c.charAt(m)}`}return a}function jue(t,e=!1,r=!1){let n=e?SZ:xZ;function o(c){for(let l=0;l<64;l++)if(n.charAt(l)===c)return l;return 64}function i(c){return c===64?0:c}let s=0,a="";for(;s<t.length;){let c=o(t.charAt(s++)),l=s>=t.length?0:o(t.charAt(s++)),u=s>=t.length?0:o(t.charAt(s++)),d=s>=t.length?0:o(t.charAt(s++)),p=i(c)<<2|i(l)>>4,f=(i(l)&15)<<4|i(u)>>2,h=(i(u)&3)<<6|i(d);a+=String.fromCharCode(p),u!==64&&(a+=String.fromCharCode(f)),d!==64&&(a+=String.fromCharCode(h))}if(r){let c=a.length,l=-1;for(let u=c-1;u>=0;u--)if(a.charCodeAt(u)!==0){l=u;break}l!==-1?a=a.slice(0,l+1):a=""}return a}function Nue(t){let e="",r=new Uint8Array(t);for(let n of r)e+=String.fromCharCode(n);return e}function zue(t){let e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r);for(let o=0;o<e;o++)n[o]=t.charCodeAt(o);return r}var Rue=Math.log(2);function Mue(t){let e=Math.log(t)/Rue,r=Math.floor(e),n=Math.round(e);return r===n?r:n}function que(t,e){for(let r of e)delete t[r]}lr.arrayBufferToString=Nue;lr.bufferToHexCodes=kue;lr.checkBufferParams=$ue;lr.clearProps=que;lr.fromBase64=jue;lr.getParametersValue=Sue;lr.getUTCDate=xue;lr.isEqualBuffer=Tue;lr.nearestPowerOf2=Mue;lr.padNumber=Eue;lr.stringToArrayBuffer=zue;lr.toBase64=Oue;lr.utilConcatBuf=Aue;lr.utilConcatView=Pue;lr.utilDecodeTC=Cue;lr.utilEncodeTC=Iue;lr.utilFromBase=mO;lr.utilToBase=hO});var da=g(xe=>{"use strict";var Due=ps(),Bue=kZ();function CZ(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}var Ue=CZ(Due),ut=CZ(Bue);function l0(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function vO(t){let e=0,r=0;for(let o=0;o<t.length;o++){let i=t[o];e+=i.byteLength}let n=new Uint8Array(e);for(let o=0;o<t.length;o++){let i=t[o];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function hs(t,e,r,n){return e instanceof Uint8Array?e.byteLength?r<0?(t.error="Wrong parameter: inputOffset less than zero",!1):n<0?(t.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-r-n<0?(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}var yd=class{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return vO(this.items)}},Vh=[new Uint8Array([1])],$Z="0123456789",gO="name",AZ="valueHexView",Uue="isHexOnly",Lue="idBlock",Fue="tagClass",Vue="tagNumber",Zue="isConstructed",Hue="fromBER",Gue="toBER",Wue="local",Sn="",xi=new ArrayBuffer(0),$0=new Uint8Array(0),Hh="EndOfContent",IZ="OCTET STRING",TZ="BIT STRING";function Si(t){var e;return e=class extends t{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(n){this.valueHexView=new Uint8Array(n)}constructor(...n){var o;super(...n);let i=n[0]||{};this.isHexOnly=(o=i.isHexOnly)!==null&&o!==void 0?o:!1,this.valueHexView=i.valueHex?Ue.BufferSourceConverter.toUint8Array(i.valueHex):$0}fromBER(n,o,i){let s=n instanceof ArrayBuffer?new Uint8Array(n):n;if(!hs(this,s,o,i))return-1;let a=o+i;return this.valueHexView=s.subarray(o,a),this.valueHexView.length?(this.blockLength=i,a):(this.warnings.push("Zero buffer length"),o)}toBER(n=!1){return this.isHexOnly?n?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",xi)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Ue.Convert.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}var fs=class{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:r=Sn,warnings:n=[],valueBeforeDecode:o=$0}={}){this.blockLength=e,this.error=r,this.warnings=n,this.valueBeforeDecodeView=Ue.BufferSourceConverter.toUint8Array(o)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Ue.Convert.ToHex(this.valueBeforeDecodeView)}}};fs.NAME="baseBlock";var zr=class extends fs{fromBER(e,r,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}};zr.NAME="valueBlock";var u0=class extends Si(fs){constructor({idBlock:e={}}={}){var r,n,o,i;super(),e?(this.isHexOnly=(r=e.isHexOnly)!==null&&r!==void 0?r:!1,this.valueHexView=e.valueHex?Ue.BufferSourceConverter.toUint8Array(e.valueHex):$0,this.tagClass=(n=e.tagClass)!==null&&n!==void 0?n:-1,this.tagNumber=(o=e.tagNumber)!==null&&o!==void 0?o:-1,this.isConstructed=(i=e.isConstructed)!==null&&i!==void 0?i:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let r=0;switch(this.tagClass){case 1:r|=0;break;case 2:r|=64;break;case 3:r|=128;break;case 4:r|=192;break;default:return this.error="Unknown tag class",xi}if(this.isConstructed&&(r|=32),this.tagNumber<31&&!this.isHexOnly){let o=new Uint8Array(1);if(!e){let i=this.tagNumber;i&=31,r|=i,o[0]=r}return o.buffer}if(!this.isHexOnly){let o=ut.utilToBase(this.tagNumber,7),i=new Uint8Array(o),s=o.byteLength,a=new Uint8Array(s+1);if(a[0]=r|31,!e){for(let c=0;c<s-1;c++)a[c+1]=i[c]|128;a[s]=i[s-1]}return a.buffer}let n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=r|31,!e){let o=this.valueHexView;for(let i=0;i<o.length-1;i++)n[i+1]=o[i]|128;n[this.valueHexView.byteLength]=o[o.length-1]}return n.buffer}fromBER(e,r,n){let o=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,o,r,n))return-1;let i=o.subarray(r,r+n);if(i.length===0)return this.error="Zero buffer length",-1;switch(i[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(i[0]&32)===32,this.isHexOnly=!1;let a=i[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let c=1,l=this.valueHexView=new Uint8Array(255),u=255;for(;i[c]&128;){if(l[c-1]=i[c]&127,c++,c>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(c===u){u+=255;let p=new Uint8Array(u);for(let f=0;f<l.length;f++)p[f]=l[f];l=this.valueHexView=new Uint8Array(u)}}this.blockLength=c+1,l[c-1]=i[c]&127;let d=new Uint8Array(c);for(let p=0;p<c;p++)d[p]=l[p];l=this.valueHexView=new Uint8Array(c),l.set(d),this.blockLength<=9?this.tagNumber=ut.utilFromBase(l,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return r+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}};u0.NAME="identificationBlock";var d0=class extends fs{constructor({lenBlock:e={}}={}){var r,n,o;super(),this.isIndefiniteForm=(r=e.isIndefiniteForm)!==null&&r!==void 0?r:!1,this.longFormUsed=(n=e.longFormUsed)!==null&&n!==void 0?n:!1,this.length=(o=e.length)!==null&&o!==void 0?o:0}fromBER(e,r,n){let o=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,o,r,n))return-1;let i=o.subarray(r,r+n);if(i.length===0)return this.error="Zero buffer length",-1;if(i[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=i[0]===128,this.isIndefiniteForm)return this.blockLength=1,r+this.blockLength;if(this.longFormUsed=!!(i[0]&128),this.longFormUsed===!1)return this.length=i[0],this.blockLength=1,r+this.blockLength;let s=i[0]&127;if(s>8)return this.error="Too big integer",-1;if(s+1>i.length)return this.error="End of input reached before message was fully decoded",-1;let a=r+1,c=o.subarray(a,a+s);return c[s-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=ut.utilFromBase(c,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,r+this.blockLength}toBER(e=!1){let r,n;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return r=new ArrayBuffer(1),e===!1&&(n=new Uint8Array(r),n[0]=128),r;if(this.longFormUsed){let o=ut.utilToBase(this.length,8);if(o.byteLength>127)return this.error="Too big length",xi;if(r=new ArrayBuffer(o.byteLength+1),e)return r;let i=new Uint8Array(o);n=new Uint8Array(r),n[0]=o.byteLength|128;for(let s=0;s<o.byteLength;s++)n[s+1]=i[s];return r}return r=new ArrayBuffer(1),e===!1&&(n=new Uint8Array(r),n[0]=this.length),r}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}};d0.NAME="lengthBlock";var K={},wr=class extends fs{constructor({name:e=Sn,optional:r=!1,primitiveSchema:n,...o}={},i){super(o),this.name=e,this.optional=r,n&&(this.primitiveSchema=n),this.idBlock=new u0(o),this.lenBlock=new d0(o),this.valueBlock=i?new i(o):new zr(o)}fromBER(e,r,n){let o=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}toBER(e,r){let n=r||new yd;r||EZ(this);let o=this.idBlock.toBER(e);if(n.write(o),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,n),n.write(new ArrayBuffer(2));else{let i=this.valueBlock.toBER(e);this.lenBlock.length=i.byteLength;let s=this.lenBlock.toBER(e);n.write(s),n.write(i)}return r?xi:n.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():Ue.Convert.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,r=Ue.Convert.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${r}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let r=this.toBER(),n=e.toBER();return ut.isEqualBuffer(r,n)}};wr.NAME="BaseBlock";function EZ(t){var e;if(t instanceof K.Constructed)for(let r of t.valueBlock.value)EZ(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(!((e=t.lenBlock)===null||e===void 0)&&e.isIndefiniteForm)}var Gh=class extends wr{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e=Sn,...r}={},n){super(r,n),e&&this.fromString(e)}fromBER(e,r,n){let o=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}};Gh.NAME="BaseStringBlock";var p0=class extends Si(zr){constructor({isHexOnly:e=!0,...r}={}){super(r),this.isHexOnly=e}};p0.NAME="PrimitiveValueBlock";var OZ,Wh=class extends wr{constructor(e={}){super(e,p0),this.idBlock.isConstructed=!1}};OZ=Wh;K.Primitive=OZ;Wh.NAME="PRIMITIVE";function Kue(t,e){if(t instanceof e)return t;let r=new e;return r.idBlock=t.idBlock,r.lenBlock=t.lenBlock,r.warnings=t.warnings,r.valueBeforeDecodeView=t.valueBeforeDecodeView,r}function wd(t,e=0,r=t.length){let n=e,o=new wr({},zr),i=new fs;if(!hs(i,t,e,r))return o.error=i.error,{offset:-1,result:o};if(!t.subarray(e,e+r).length)return o.error="Zero buffer length",{offset:-1,result:o};let a=o.idBlock.fromBER(t,e,r);if(o.idBlock.warnings.length&&o.warnings.concat(o.idBlock.warnings),a===-1)return o.error=o.idBlock.error,{offset:-1,result:o};if(e=a,r-=o.idBlock.blockLength,a=o.lenBlock.fromBER(t,e,r),o.lenBlock.warnings.length&&o.warnings.concat(o.lenBlock.warnings),a===-1)return o.error=o.lenBlock.error,{offset:-1,result:o};if(e=a,r-=o.lenBlock.blockLength,!o.idBlock.isConstructed&&o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let c=wr;switch(o.idBlock.tagClass){case 1:if(o.idBlock.tagNumber>=37&&o.idBlock.isHexOnly===!1)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};c=K.EndOfContent;break;case 1:c=K.Boolean;break;case 2:c=K.Integer;break;case 3:c=K.BitString;break;case 4:c=K.OctetString;break;case 5:c=K.Null;break;case 6:c=K.ObjectIdentifier;break;case 10:c=K.Enumerated;break;case 12:c=K.Utf8String;break;case 13:c=K.RelativeObjectIdentifier;break;case 14:c=K.TIME;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:c=K.Sequence;break;case 17:c=K.Set;break;case 18:c=K.NumericString;break;case 19:c=K.PrintableString;break;case 20:c=K.TeletexString;break;case 21:c=K.VideotexString;break;case 22:c=K.IA5String;break;case 23:c=K.UTCTime;break;case 24:c=K.GeneralizedTime;break;case 25:c=K.GraphicString;break;case 26:c=K.VisibleString;break;case 27:c=K.GeneralString;break;case 28:c=K.UniversalString;break;case 29:c=K.CharacterString;break;case 30:c=K.BmpString;break;case 31:c=K.DATE;break;case 32:c=K.TimeOfDay;break;case 33:c=K.DateTime;break;case 34:c=K.Duration;break;default:{let l=o.idBlock.isConstructed?new K.Constructed:new K.Primitive;l.idBlock=o.idBlock,l.lenBlock=o.lenBlock,l.warnings=o.warnings,o=l}}break;default:c=o.idBlock.isConstructed?K.Constructed:K.Primitive}return o=Kue(o,c),a=o.fromBER(t,e,o.lenBlock.isIndefiniteForm?r:o.lenBlock.length),o.valueBeforeDecodeView=t.subarray(n,n+o.blockLength),{offset:a,result:o}}function Jue(t){if(!t.byteLength){let e=new wr({},zr);return e.error="Input buffer has zero length",{offset:-1,result:e}}return wd(Ue.BufferSourceConverter.toUint8Array(t).slice(),0,t.byteLength)}function Yue(t,e){return t?1:e}var bi=class extends zr{constructor({value:e=[],isIndefiniteForm:r=!1,...n}={}){super(n),this.value=e,this.isIndefiniteForm=r}fromBER(e,r,n){let o=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,o,r,n))return-1;if(this.valueBeforeDecodeView=o.subarray(r,r+n),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),r;let i=r;for(;Yue(this.isIndefiniteForm,n)>0;){let s=wd(o,i,n);if(s.offset===-1)return this.error=s.result.error,this.warnings.concat(s.result.warnings),-1;if(i=s.offset,this.blockLength+=s.result.blockLength,n-=s.result.blockLength,this.value.push(s.result),this.isIndefiniteForm&&s.result.constructor.NAME===Hh)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Hh?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,r){let n=r||new yd;for(let o=0;o<this.value.length;o++)this.value[o].toBER(e,n);return r?xi:n.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let r of this.value)e.value.push(r.toJSON());return e}};bi.NAME="ConstructedValueBlock";var jZ,ms=class extends wr{constructor(e={}){super(e,bi),this.idBlock.isConstructed=!0}fromBER(e,r,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let o=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return o===-1?(this.error=this.valueBlock.error,o):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),o)}onAsciiEncoding(){let e=[];for(let n of this.valueBlock.value)e.push(n.toString("ascii").split(`
`).map(o=>`  ${o}`).join(`
`));let r=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${r} :
${e.join(`
`)}`:`${r} :`}};jZ=ms;K.Constructed=jZ;ms.NAME="CONSTRUCTED";var f0=class extends zr{fromBER(e,r,n){return r}toBER(e){return xi}};f0.override="EndOfContentValueBlock";var NZ,Kh=class extends wr{constructor(e={}){super(e,f0),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}};NZ=Kh;K.EndOfContent=NZ;Kh.NAME=Hh;var zZ,Jh=class extends wr{constructor(e={}){super(e,zr),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,r,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,r+n>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):r+n}toBER(e,r){let n=new ArrayBuffer(2);if(!e){let o=new Uint8Array(n);o[0]=5,o[1]=0}return r&&r.write(n),n}onAsciiEncoding(){return`${this.constructor.NAME}`}};zZ=Jh;K.Null=zZ;Jh.NAME="NULL";var m0=class extends Si(zr){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}constructor({value:e,...r}={}){super(r),r.valueHex?this.valueHexView=Ue.BufferSourceConverter.toUint8Array(r.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,r,n){let o=Ue.BufferSourceConverter.toUint8Array(e);return hs(this,o,r,n)?(this.valueHexView=o.subarray(r,r+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,ut.utilDecodeTC.call(this),this.blockLength=n,r+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}};m0.NAME="BooleanValueBlock";var RZ,Yh=class extends wr{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,m0),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};RZ=Yh;K.Boolean=RZ;Yh.NAME="BOOLEAN";var h0=class extends Si(bi){constructor({isConstructed:e=!1,...r}={}){super(r),this.isConstructed=e}fromBER(e,r,n){let o=0;if(this.isConstructed){if(this.isHexOnly=!1,o=bi.prototype.fromBER.call(this,e,r,n),o===-1)return o;for(let i=0;i<this.value.length;i++){let s=this.value[i].constructor.NAME;if(s===Hh){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(s!==IZ)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,o=super.fromBER(e,r,n),this.blockLength=n;return o}toBER(e,r){return this.isConstructed?bi.prototype.toBER.call(this,e,r):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}};h0.NAME="OctetStringValueBlock";var _O,Xh=class extends wr{constructor({idBlock:e={},lenBlock:r={},...n}={}){var o,i;(o=n.isConstructed)!==null&&o!==void 0||(n.isConstructed=!!(!((i=n.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...r,isIndefiniteForm:!!n.isIndefiniteForm},...n},h0),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,r,n){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,n===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),r;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(r,r+n);try{if(i.byteLength){let s=wd(i,0,i.byteLength);s.offset!==-1&&s.offset===n&&(this.valueBlock.value=[s.result])}}catch{}}return super.fromBER(e,r,n)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ms.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,r=Ue.Convert.ToHex(this.valueBlock.valueHexView);return`${e} : ${r}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let r of this.valueBlock.value)r instanceof _O&&e.push(r.valueBlock.valueHexView);return Ue.BufferSourceConverter.concat(e)}};_O=Xh;K.OctetString=_O;Xh.NAME=IZ;var g0=class extends Si(bi){constructor({unusedBits:e=0,isConstructed:r=!1,...n}={}){super(n),this.unusedBits=e,this.isConstructed=r,this.blockLength=this.valueHexView.byteLength}fromBER(e,r,n){if(!n)return r;let o=-1;if(this.isConstructed){if(o=bi.prototype.fromBER.call(this,e,r,n),o===-1)return o;for(let a of this.value){let c=a.constructor.NAME;if(c===Hh){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(c!==TZ)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let l=a.valueBlock;if(this.unusedBits>0&&l.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=l.unusedBits}return o}let i=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,i,r,n))return-1;let s=i.subarray(r,r+n);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let a=s.subarray(1);try{if(a.byteLength){let c=wd(a,0,a.byteLength);c.offset!==-1&&c.offset===n-1&&(this.value=[c.result])}}catch{}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,r+n}toBER(e,r){if(this.isConstructed)return bi.prototype.toBER.call(this,e,r);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength){let o=new Uint8Array(1);return o[0]=0,o.buffer}let n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}};g0.NAME="BitStringValueBlock";var MZ,Qh=class extends wr{constructor({idBlock:e={},lenBlock:r={},...n}={}){var o,i;(o=n.isConstructed)!==null&&o!==void 0||(n.isConstructed=!!(!((i=n.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...r,isIndefiniteForm:!!n.isIndefiniteForm},...n},g0),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,r,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,r,n)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ms.prototype.onAsciiEncoding.call(this);{let e=[],r=this.valueBlock.valueHexView;for(let s of r)e.push(s.toString(2).padStart(8,"0"));let n=e.join(""),o=this.constructor.NAME,i=n.substring(0,n.length-this.valueBlock.unusedBits);return`${o} : ${i}`}}};MZ=Qh;K.BitString=MZ;Qh.NAME=TZ;var qZ;function Xue(t,e){let r=new Uint8Array([0]),n=new Uint8Array(t),o=new Uint8Array(e),i=n.slice(0),s=i.length-1,a=o.slice(0),c=a.length-1,l=0,u=c<s?s:c,d=0;for(let p=u;p>=0;p--,d++)!0===d<a.length?l=i[s-d]+a[c-d]+r[0]:l=i[s-d]+r[0],r[0]=l/10,!0===d>=i.length?i=ut.utilConcatView(new Uint8Array([l%10]),i):i[s-d]=l%10;return r[0]>0&&(i=ut.utilConcatView(r,i)),i}function PZ(t){if(t>=Vh.length)for(let e=Vh.length;e<=t;e++){let r=new Uint8Array([0]),n=Vh[e-1].slice(0);for(let o=n.length-1;o>=0;o--){let i=new Uint8Array([(n[o]<<1)+r[0]]);r[0]=i[0]/10,n[o]=i[0]%10}r[0]>0&&(n=ut.utilConcatView(r,n)),Vh.push(n)}return Vh[t]}function Que(t,e){let r=0,n=new Uint8Array(t),o=new Uint8Array(e),i=n.slice(0),s=i.length-1,a=o.slice(0),c=a.length-1,l,u=0;for(let d=c;d>=0;d--,u++)l=i[s-u]-a[c-u]-r,!0===l<0?(r=1,i[s-u]=l+10):(r=0,i[s-u]=l);if(r>0)for(let d=s-c+1;d>=0;d--,u++)if(l=i[s-u]-r,l<0)r=1,i[s-u]=l+10;else{r=0,i[s-u]=l;break}return i.slice()}var eg=class extends Si(zr){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=ut.utilDecodeTC.call(this)))}constructor({value:e,...r}={}){super(r),this._valueDec=0,r.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(ut.utilEncodeTC(e))}get valueDec(){return this._valueDec}fromDER(e,r,n,o=0){let i=this.fromBER(e,r,n);if(i===-1)return i;let s=this.valueHexView;return s[0]===0&&(s[1]&128)!==0?this.valueHexView=s.subarray(1):o!==0&&s.length<o&&(o-s.length>1&&(o=s.length+1),this.valueHexView=s.subarray(o-s.length)),i}toDER(e=!1){let r=this.valueHexView;switch(!0){case(r[0]&128)!==0:{let n=new Uint8Array(this.valueHexView.length+1);n[0]=0,n.set(r,1),this.valueHexView=n}break;case(r[0]===0&&(r[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,r,n){let o=super.fromBER(e,r,n);return o===-1||this.setValueHex(),o}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e=this.valueHexView.length*8-1,r=new Uint8Array(this.valueHexView.length*8/3),n=0,o,i=this.valueHexView,s="",a=!1;for(let c=i.byteLength-1;c>=0;c--){o=i[c];for(let l=0;l<8;l++)(o&1)===1&&(n===e?(r=Que(PZ(n),r),s="-"):r=Xue(r,PZ(n))),n++,o>>=1}for(let c=0;c<r.length;c++)r[c]&&(a=!0),a&&(s+=$Z.charAt(r[c]));return a===!1&&(s+=$Z.charAt(0)),s}};qZ=eg;eg.NAME="IntegerValueBlock";Object.defineProperty(qZ.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Zh,vd=class extends wr{constructor(e={}){super(e,eg),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return l0(),BigInt(this.valueBlock.toString())}static fromBigInt(e){l0();let r=BigInt(e),n=new yd,o=r.toString(16).replace(/^-/,""),i=new Uint8Array(Ue.Convert.FromHex(o));if(r<0){let a=new Uint8Array(i.length+(i[0]&128?1:0));a[0]|=128;let l=BigInt(`0x${Ue.Convert.ToHex(a)}`)+r,u=Ue.BufferSourceConverter.toUint8Array(Ue.Convert.FromHex(l.toString(16)));u[0]|=128,n.write(u)}else i[0]&128&&n.write(new Uint8Array([0])),n.write(i);return new Zh({valueHex:n.final()})}convertToDER(){let e=new Zh({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Zh({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}};Zh=vd;K.Integer=Zh;vd.NAME="INTEGER";var DZ,tg=class extends vd{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}};DZ=tg;K.Enumerated=DZ;tg.NAME="ENUMERATED";var rg=class extends Si(zr){constructor({valueDec:e=-1,isFirstSid:r=!1,...n}={}){super(n),this.valueDec=e,this.isFirstSid=r}fromBER(e,r,n){if(!n)return r;let o=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,o,r,n))return-1;let i=o.subarray(r,r+n);this.valueHexView=new Uint8Array(n);for(let a=0;a<n&&(this.valueHexView[a]=i[a]&127,this.blockLength++,(i[a]&128)!==0);a++);let s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)s[a]=this.valueHexView[a];return this.valueHexView=s,(i[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ut.utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}set valueBigInt(e){l0();let r=BigInt(e).toString(2);for(;r.length%7;)r="0"+r;let n=new Uint8Array(r.length/7);for(let o=0;o<n.length;o++)n[o]=parseInt(r.slice(o*7,o*7+7),2)+(o+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let o=this.valueHexView,i=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength-1;s++)i[s]=o[s]|128;return i[this.blockLength-1]=o[this.blockLength-1],i.buffer}let r=ut.utilToBase(this.valueDec,7);if(r.byteLength===0)return this.error="Error during encoding SID value",xi;let n=new Uint8Array(r.byteLength);if(!e){let o=new Uint8Array(r),i=r.byteLength-1;for(let s=0;s<i;s++)n[s]=o[s]|128;n[i]=o[i]}return n}toString(){let e="";if(this.isHexOnly)e=Ue.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let r=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",r-=40):(e="2.",r-=80),e+=r.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}};rg.NAME="sidBlock";var y0=class extends zr{constructor({value:e=Sn,...r}={}){super(r),this.value=[],e&&this.fromString(e)}fromBER(e,r,n){let o=r;for(;n>0;){let i=new rg;if(o=i.fromBER(e,o,n),o===-1)return this.blockLength=0,this.error=i.error,o;this.value.length===0&&(i.isFirstSid=!0),this.blockLength+=i.blockLength,n-=i.blockLength,this.value.push(i)}return o}toBER(e){let r=[];for(let n=0;n<this.value.length;n++){let o=this.value[n].toBER(e);if(o.byteLength===0)return this.error=this.value[n].error,xi;r.push(o)}return vO(r)}fromString(e){this.value=[];let r=0,n=0,o="",i=!1;do if(n=e.indexOf(".",r),n===-1?o=e.substring(r):o=e.substring(r,n),r=n+1,i){let s=this.value[0],a=0;switch(s.valueDec){case 0:break;case 1:a=40;break;case 2:a=80;break;default:this.value=[];return}let c=parseInt(o,10);if(isNaN(c))return;s.valueDec=c+a,i=!1}else{let s=new rg;if(o>Number.MAX_SAFE_INTEGER){l0();let a=BigInt(o);s.valueBigInt=a}else if(s.valueDec=parseInt(o,10),isNaN(s.valueDec))return;this.value.length||(s.isFirstSid=!0,i=!0),this.value.push(s)}while(n!==-1)}toString(){let e="",r=!1;for(let n=0;n<this.value.length;n++){r=this.value[n].isHexOnly;let o=this.value[n].toString();n!==0&&(e=`${e}.`),r?(o=`{${o}}`,this.value[n].isFirstSid?e=`2.{${o} - 80}`:e+=o):e+=o}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)e.sidArray.push(this.value[r].toJSON());return e}};y0.NAME="ObjectIdentifierValueBlock";var BZ,ng=class extends wr{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,y0),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};BZ=ng;K.ObjectIdentifier=BZ;ng.NAME="OBJECT IDENTIFIER";var og=class extends Si(fs){constructor({valueDec:e=0,...r}={}){super(r),this.valueDec=e}fromBER(e,r,n){if(n===0)return r;let o=Ue.BufferSourceConverter.toUint8Array(e);if(!hs(this,o,r,n))return-1;let i=o.subarray(r,r+n);this.valueHexView=new Uint8Array(n);for(let a=0;a<n&&(this.valueHexView[a]=i[a]&127,this.blockLength++,(i[a]&128)!==0);a++);let s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)s[a]=this.valueHexView[a];return this.valueHexView=s,(i[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ut.utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let o=this.valueHexView,i=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength-1;s++)i[s]=o[s]|128;return i[this.blockLength-1]=o[this.blockLength-1],i.buffer}let r=ut.utilToBase(this.valueDec,7);if(r.byteLength===0)return this.error="Error during encoding SID value",xi;let n=new Uint8Array(r.byteLength);if(!e){let o=new Uint8Array(r),i=r.byteLength-1;for(let s=0;s<i;s++)n[s]=o[s]|128;n[i]=o[i]}return n.buffer}toString(){let e="";return this.isHexOnly?e=Ue.Convert.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}};og.NAME="relativeSidBlock";var v0=class extends zr{constructor({value:e=Sn,...r}={}){super(r),this.value=[],e&&this.fromString(e)}fromBER(e,r,n){let o=r;for(;n>0;){let i=new og;if(o=i.fromBER(e,o,n),o===-1)return this.blockLength=0,this.error=i.error,o;this.blockLength+=i.blockLength,n-=i.blockLength,this.value.push(i)}return o}toBER(e,r){let n=[];for(let o=0;o<this.value.length;o++){let i=this.value[o].toBER(e);if(i.byteLength===0)return this.error=this.value[o].error,xi;n.push(i)}return vO(n)}fromString(e){this.value=[];let r=0,n=0,o="";do{n=e.indexOf(".",r),n===-1?o=e.substring(r):o=e.substring(r,n),r=n+1;let i=new og;if(i.valueDec=parseInt(o,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(n!==-1);return!0}toString(){let e="",r=!1;for(let n=0;n<this.value.length;n++){r=this.value[n].isHexOnly;let o=this.value[n].toString();n!==0&&(e=`${e}.`),r&&(o=`{${o}}`),e+=o}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)e.sidArray.push(this.value[r].toJSON());return e}};v0.NAME="RelativeObjectIdentifierValueBlock";var UZ,ig=class extends wr{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,v0),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};UZ=ig;K.RelativeObjectIdentifier=UZ;ig.NAME="RelativeObjectIdentifier";var LZ,sg=class extends ms{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}};LZ=sg;K.Sequence=LZ;sg.NAME="SEQUENCE";var FZ,ag=class extends ms{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};FZ=ag;K.Set=FZ;ag.NAME="SET";var _0=class extends Si(zr){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Sn}toJSON(){return{...super.toJSON(),value:this.value}}};_0.NAME="StringValueBlock";var b0=class extends _0{};b0.NAME="SimpleStringValueBlock";var cn=class extends Gh{constructor({...e}={}){super(e,b0)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,Ue.BufferSourceConverter.toUint8Array(e))}fromString(e){let r=e.length,n=this.valueBlock.valueHexView=new Uint8Array(r);for(let o=0;o<r;o++)n[o]=e.charCodeAt(o);this.valueBlock.value=e}};cn.NAME="SIMPLE STRING";var w0=class extends cn{fromBuffer(e){this.valueBlock.valueHexView=Ue.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=Ue.Convert.ToUtf8String(e)}catch(r){this.warnings.push(`Error during "decodeURIComponent": ${r}, using raw string`),this.valueBlock.value=Ue.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(Ue.Convert.FromUtf8String(e)),this.valueBlock.value=e}};w0.NAME="Utf8StringValueBlock";var VZ,wi=class extends w0{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}};VZ=wi;K.Utf8String=VZ;wi.NAME="UTF8String";var x0=class extends cn{fromBuffer(e){this.valueBlock.value=Ue.Convert.ToUtf16String(e),this.valueBlock.valueHexView=Ue.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(Ue.Convert.FromUtf16String(e))}};x0.NAME="BmpStringValueBlock";var ZZ,cg=class extends x0{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}};ZZ=cg;K.BmpString=ZZ;cg.NAME="BMPString";var S0=class extends cn{fromBuffer(e){let r=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),n=new Uint8Array(r);for(let o=0;o<n.length;o+=4)n[o]=n[o+3],n[o+1]=n[o+2],n[o+2]=0,n[o+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(r))}fromString(e){let r=e.length,n=this.valueBlock.valueHexView=new Uint8Array(r*4);for(let o=0;o<r;o++){let i=ut.utilToBase(e.charCodeAt(o),8),s=new Uint8Array(i);if(s.length>4)continue;let a=4-s.length;for(let c=s.length-1;c>=0;c--)n[o*4+c+a]=s[c]}this.valueBlock.value=e}};S0.NAME="UniversalStringValueBlock";var HZ,lg=class extends S0{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}};HZ=lg;K.UniversalString=HZ;lg.NAME="UniversalString";var GZ,ug=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}};GZ=ug;K.NumericString=GZ;ug.NAME="NumericString";var WZ,dg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}};WZ=dg;K.PrintableString=WZ;dg.NAME="PrintableString";var KZ,pg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}};KZ=pg;K.TeletexString=KZ;pg.NAME="TeletexString";var JZ,fg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}};JZ=fg;K.VideotexString=JZ;fg.NAME="VideotexString";var YZ,mg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}};YZ=mg;K.IA5String=YZ;mg.NAME="IA5String";var XZ,hg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}};XZ=hg;K.GraphicString=XZ;hg.NAME="GraphicString";var QZ,_d=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}};QZ=_d;K.VisibleString=QZ;_d.NAME="VisibleString";var eH,gg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}};eH=gg;K.GeneralString=eH;gg.NAME="GeneralString";var tH,yg=class extends cn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}};tH=yg;K.CharacterString=tH;yg.NAME="CharacterString";var rH,bd=class extends _d{constructor({value:e,valueDate:r,...n}={}){if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let o=0;o<e.length;o++)this.valueBlock.valueHexView[o]=e.charCodeAt(o)}r&&(this.fromDate(r),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,Ue.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),r=new ArrayBuffer(e.length),n=new Uint8Array(r);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);return r}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let n=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(n===null){this.error="Wrong input string for conversion";return}let o=parseInt(n[1],10);o>=50?this.year=1900+o:this.year=2e3+o,this.month=parseInt(n[2],10),this.day=parseInt(n[3],10),this.hour=parseInt(n[4],10),this.minute=parseInt(n[5],10),this.second=parseInt(n[6],10)}toString(e="iso"){if(e==="iso"){let r=new Array(7);return r[0]=ut.padNumber(this.year<2e3?this.year-1900:this.year-2e3,2),r[1]=ut.padNumber(this.month,2),r[2]=ut.padNumber(this.day,2),r[3]=ut.padNumber(this.hour,2),r[4]=ut.padNumber(this.minute,2),r[5]=ut.padNumber(this.second,2),r[6]="Z",r.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}};rH=bd;K.UTCTime=rH;bd.NAME="UTCTime";var nH,vg=class extends bd{constructor(e={}){var r;super(e),(r=this.millisecond)!==null&&r!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){let e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(e)}fromString(e){let r=!1,n="",o="",i=0,s,a=0,c=0;if(e[e.length-1]==="Z")n=e.substring(0,e.length-1),r=!0;else{let d=new Number(e[e.length-1]);if(isNaN(d.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(n.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(n.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let d=1,p=n.indexOf("+"),f="";if(p===-1&&(p=n.indexOf("-"),d=-1),p!==-1){if(f=n.substring(p+1),n=n.substring(0,p),f.length!==2&&f.length!==4)throw new Error("Wrong input string for conversion");let h=parseInt(f.substring(0,2),10);if(isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");if(a=d*h,f.length===4){if(h=parseInt(f.substring(2,4),10),isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");c=d*h}}}let l=n.indexOf(".");if(l===-1&&(l=n.indexOf(",")),l!==-1){let d=new Number(`0${n.substring(l)}`);if(isNaN(d.valueOf()))throw new Error("Wrong input string for conversion");i=d.valueOf(),o=n.substring(0,l)}else o=n;switch(!0){case o.length===8:if(s=/(\d{4})(\d{2})(\d{2})/ig,l!==-1)throw new Error("Wrong input string for conversion");break;case o.length===10:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,l!==-1){let d=60*i;this.minute=Math.floor(d),d=60*(d-this.minute),this.second=Math.floor(d),d=1e3*(d-this.second),this.millisecond=Math.floor(d)}break;case o.length===12:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,l!==-1){let d=60*i;this.second=Math.floor(d),d=1e3*(d-this.second),this.millisecond=Math.floor(d)}break;case o.length===14:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,l!==-1){let d=1e3*i;this.millisecond=Math.floor(d)}break;default:throw new Error("Wrong input string for conversion")}let u=s.exec(o);if(u===null)throw new Error("Wrong input string for conversion");for(let d=1;d<u.length;d++)switch(d){case 1:this.year=parseInt(u[d],10);break;case 2:this.month=parseInt(u[d],10);break;case 3:this.day=parseInt(u[d],10);break;case 4:this.hour=parseInt(u[d],10)+a;break;case 5:this.minute=parseInt(u[d],10)+c;break;case 6:this.second=parseInt(u[d],10);break;default:throw new Error("Wrong input string for conversion")}if(r===!1){let d=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=d.getUTCFullYear(),this.month=d.getUTCMonth(),this.day=d.getUTCDay(),this.hour=d.getUTCHours(),this.minute=d.getUTCMinutes(),this.second=d.getUTCSeconds(),this.millisecond=d.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){let r=[];return r.push(ut.padNumber(this.year,4)),r.push(ut.padNumber(this.month,2)),r.push(ut.padNumber(this.day,2)),r.push(ut.padNumber(this.hour,2)),r.push(ut.padNumber(this.minute,2)),r.push(ut.padNumber(this.second,2)),this.millisecond!==0&&(r.push("."),r.push(ut.padNumber(this.millisecond,3))),r.push("Z"),r.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}};nH=vg;K.GeneralizedTime=nH;vg.NAME="GeneralizedTime";var oH,_g=class extends wi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}};oH=_g;K.DATE=oH;_g.NAME="DATE";var iH,bg=class extends wi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}};iH=bg;K.TimeOfDay=iH;bg.NAME="TimeOfDay";var sH,wg=class extends wi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}};sH=wg;K.DateTime=sH;wg.NAME="DateTime";var aH,xg=class extends wi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}};aH=xg;K.Duration=aH;xg.NAME="Duration";var cH,Sg=class extends wi{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}};cH=Sg;K.TIME=cH;Sg.NAME="TIME";var $c=class{constructor({name:e=Sn,optional:r=!1}={}){this.name=e,this.optional=r}},k0=class extends $c{constructor({value:e=[],...r}={}){super(r),this.value=e}},kg=class extends $c{constructor({value:e=new $c,local:r=!1,...n}={}){super(n),this.value=e,this.local=r}},yO=class{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=Ue.BufferSourceConverter.toUint8Array(e)}constructor({data:e=$0}={}){this.dataView=Ue.BufferSourceConverter.toUint8Array(e)}fromBER(e,r,n){let o=r+n;return this.dataView=Ue.BufferSourceConverter.toUint8Array(e).subarray(r,o),o}toBER(e){return this.dataView.slice().buffer}};function gd(t,e,r){if(r instanceof k0){for(let i of r.value)if(gd(t,e,i).verified)return{verified:!0,result:t};{let i={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(gO)&&(i.name=r.name),i}}if(r instanceof $c)return r.hasOwnProperty(gO)&&(t[r.name]=e),{verified:!0,result:t};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Lue in r))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Hue in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Gue in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let n=r.idBlock.toBER(!1);if(n.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(r.idBlock.fromBER(n,0,n.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(r.idBlock.hasOwnProperty(Fue)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:t};if(r.idBlock.hasOwnProperty(Vue)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:t};if(r.idBlock.hasOwnProperty(Zue)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:t};if(!(Uue in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:t};if(r.idBlock.isHexOnly){if(!(AZ in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,s=e.idBlock.valueHexView;if(i.length!==s.length)return{verified:!1,result:t};for(let a=0;a<i.length;a++)if(i[a]!==s[1])return{verified:!1,result:t}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&(t[r.name]=e)),r instanceof K.Constructed){let i=0,s={verified:!1,result:{error:"Unknown error"}},a=r.valueBlock.value.length;if(a>0&&r.valueBlock.value[0]instanceof kg&&(a=e.valueBlock.value.length),a===0)return{verified:!0,result:t};if(e.valueBlock.value.length===0&&r.valueBlock.value.length!==0){let c=!0;for(let l=0;l<r.valueBlock.value.length;l++)c=c&&(r.valueBlock.value[l].optional||!1);return c?{verified:!0,result:t}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&delete t[r.name]),t.error="Inconsistent object length",{verified:!1,result:t})}for(let c=0;c<a;c++)if(c-i>=e.valueBlock.value.length){if(r.valueBlock.value[c].optional===!1){let l={verified:!1,result:t};return t.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&(delete t[r.name],l.name=r.name)),l}}else if(r.valueBlock.value[0]instanceof kg){if(s=gd(t,e.valueBlock.value[c],r.valueBlock.value[0].value),s.verified===!1)if(r.valueBlock.value[0].optional)i++;else return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&delete t[r.name]),s;if(gO in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let l={};Wue in r.valueBlock.value[0]&&r.valueBlock.value[0].local?l=e:l=t,typeof l[r.valueBlock.value[0].name]>"u"&&(l[r.valueBlock.value[0].name]=[]),l[r.valueBlock.value[0].name].push(e.valueBlock.value[c])}}else if(s=gd(t,e.valueBlock.value[c-i],r.valueBlock.value[c]),s.verified===!1)if(r.valueBlock.value[c].optional)i++;else return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&delete t[r.name]),s;if(s.verified===!1){let c={verified:!1,result:t};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&(delete t[r.name],c.name=r.name)),c}return{verified:!0,result:t}}if(r.primitiveSchema&&AZ in e.valueBlock){let i=wd(e.valueBlock.valueHexView);if(i.offset===-1){let s={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Sn),r.name&&(delete t[r.name],s.name=r.name)),s}return gd(t,i.result,r.primitiveSchema)}return{verified:!0,result:t}}function ede(t,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=wd(Ue.BufferSourceConverter.toUint8Array(t));return r.offset===-1?{verified:!1,result:r.result}:gd(r.result,r.result,e)}xe.Any=$c;xe.BaseBlock=wr;xe.BaseStringBlock=Gh;xe.BitString=Qh;xe.BmpString=cg;xe.Boolean=Yh;xe.CharacterString=yg;xe.Choice=k0;xe.Constructed=ms;xe.DATE=_g;xe.DateTime=wg;xe.Duration=xg;xe.EndOfContent=Kh;xe.Enumerated=tg;xe.GeneralString=gg;xe.GeneralizedTime=vg;xe.GraphicString=hg;xe.HexBlock=Si;xe.IA5String=mg;xe.Integer=vd;xe.Null=Jh;xe.NumericString=ug;xe.ObjectIdentifier=ng;xe.OctetString=Xh;xe.Primitive=Wh;xe.PrintableString=dg;xe.RawData=yO;xe.RelativeObjectIdentifier=ig;xe.Repeated=kg;xe.Sequence=sg;xe.Set=ag;xe.TIME=Sg;xe.TeletexString=pg;xe.TimeOfDay=bg;xe.UTCTime=bd;xe.UniversalString=lg;xe.Utf8String=wi;xe.ValueBlock=zr;xe.VideotexString=fg;xe.ViewWriter=yd;xe.VisibleString=_d;xe.compareSchema=gd;xe.fromBER=Jue;xe.verifySchema=ede});var Ac=g(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.AsnPropTypes=xd.AsnTypeTypes=void 0;var lH;(function(t){t[t.Sequence=0]="Sequence",t[t.Set=1]="Set",t[t.Choice=2]="Choice"})(lH||(xd.AsnTypeTypes=lH={}));var uH;(function(t){t[t.Any=1]="Any",t[t.Boolean=2]="Boolean",t[t.OctetString=3]="OctetString",t[t.BitString=4]="BitString",t[t.Integer=5]="Integer",t[t.Enumerated=6]="Enumerated",t[t.ObjectIdentifier=7]="ObjectIdentifier",t[t.Utf8String=8]="Utf8String",t[t.BmpString=9]="BmpString",t[t.UniversalString=10]="UniversalString",t[t.NumericString=11]="NumericString",t[t.PrintableString=12]="PrintableString",t[t.TeletexString=13]="TeletexString",t[t.VideotexString=14]="VideotexString",t[t.IA5String=15]="IA5String",t[t.GraphicString=16]="GraphicString",t[t.VisibleString=17]="VisibleString",t[t.GeneralString=18]="GeneralString",t[t.CharacterString=19]="CharacterString",t[t.UTCTime=20]="UTCTime",t[t.GeneralizedTime=21]="GeneralizedTime",t[t.DATE=22]="DATE",t[t.TimeOfDay=23]="TimeOfDay",t[t.DateTime=24]="DateTime",t[t.Duration=25]="Duration",t[t.TIME=26]="TIME",t[t.Null=27]="Null"})(uH||(xd.AsnPropTypes=uH={}))});var pH=g(A0=>{"use strict";Object.defineProperty(A0,"__esModule",{value:!0});A0.BitString=void 0;var bO=da(),dH=ps(),wO=class{constructor(e,r=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if(typeof e=="number")this.fromNumber(e);else if(dH.BufferSourceConverter.isBufferSource(e))this.unusedBits=r,this.value=dH.BufferSourceConverter.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof bO.BitString))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new bO.BitString({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new bO.BitString({name:e})}toNumber(){let e="",r=new Uint8Array(this.value);for(let n of r)e+=n.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let r=e.toString(2),n=r.length+7>>3;this.unusedBits=(n<<3)-r.length;let o=new Uint8Array(n);r=r.padStart(n<<3,"0").split("").reverse().join("");let i=0;for(;i<n;)o[i]=parseInt(r.slice(i<<3,(i<<3)+8),2),i++;this.value=o.buffer}};A0.BitString=wO});var mH=g(P0=>{"use strict";Object.defineProperty(P0,"__esModule",{value:!0});P0.OctetString=void 0;var xO=da(),fH=ps(),SO=class{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){typeof e=="number"?this.buffer=new ArrayBuffer(e):fH.BufferSourceConverter.isBufferSource(e)?this.buffer=fH.BufferSourceConverter.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof xO.OctetString))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new xO.OctetString({valueHex:this.buffer})}toSchema(e){return new xO.OctetString({name:e})}};P0.OctetString=SO});var kO=g(C0=>{"use strict";Object.defineProperty(C0,"__esModule",{value:!0});var hH=(T(),C(I));hH.__exportStar(pH(),C0);hH.__exportStar(mH(),C0)});var $g=g(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.AsnNullConverter=H.AsnGeneralizedTimeConverter=H.AsnUTCTimeConverter=H.AsnCharacterStringConverter=H.AsnGeneralStringConverter=H.AsnVisibleStringConverter=H.AsnGraphicStringConverter=H.AsnIA5StringConverter=H.AsnVideotexStringConverter=H.AsnTeletexStringConverter=H.AsnPrintableStringConverter=H.AsnNumericStringConverter=H.AsnUniversalStringConverter=H.AsnBmpStringConverter=H.AsnUtf8StringConverter=H.AsnConstructedOctetStringConverter=H.AsnOctetStringConverter=H.AsnBooleanConverter=H.AsnObjectIdentifierConverter=H.AsnBitStringConverter=H.AsnIntegerBigIntConverter=H.AsnIntegerArrayBufferConverter=H.AsnEnumeratedConverter=H.AsnIntegerConverter=H.AsnAnyConverter=void 0;H.defaultConverter=rde;var Ct=da(),Kt=Ac(),tde=kO();H.AsnAnyConverter={fromASN:t=>t instanceof Ct.Null?null:t.valueBeforeDecodeView,toASN:t=>{if(t===null)return new Ct.Null;let e=Ct.fromBER(t);if(e.result.error)throw new Error(e.result.error);return e.result}};H.AsnIntegerConverter={fromASN:t=>t.valueBlock.valueHexView.byteLength>=4?t.valueBlock.toString():t.valueBlock.valueDec,toASN:t=>new Ct.Integer({value:+t})};H.AsnEnumeratedConverter={fromASN:t=>t.valueBlock.valueDec,toASN:t=>new Ct.Enumerated({value:t})};H.AsnIntegerArrayBufferConverter={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new Ct.Integer({valueHex:t})};H.AsnIntegerBigIntConverter={fromASN:t=>t.toBigInt(),toASN:t=>Ct.Integer.fromBigInt(t)};H.AsnBitStringConverter={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new Ct.BitString({valueHex:t})};H.AsnObjectIdentifierConverter={fromASN:t=>t.valueBlock.toString(),toASN:t=>new Ct.ObjectIdentifier({value:t})};H.AsnBooleanConverter={fromASN:t=>t.valueBlock.value,toASN:t=>new Ct.Boolean({value:t})};H.AsnOctetStringConverter={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new Ct.OctetString({valueHex:t})};H.AsnConstructedOctetStringConverter={fromASN:t=>new tde.OctetString(t.getValue()),toASN:t=>t.toASN()};function ho(t){return{fromASN:e=>e.valueBlock.value,toASN:e=>new t({value:e})}}H.AsnUtf8StringConverter=ho(Ct.Utf8String);H.AsnBmpStringConverter=ho(Ct.BmpString);H.AsnUniversalStringConverter=ho(Ct.UniversalString);H.AsnNumericStringConverter=ho(Ct.NumericString);H.AsnPrintableStringConverter=ho(Ct.PrintableString);H.AsnTeletexStringConverter=ho(Ct.TeletexString);H.AsnVideotexStringConverter=ho(Ct.VideotexString);H.AsnIA5StringConverter=ho(Ct.IA5String);H.AsnGraphicStringConverter=ho(Ct.GraphicString);H.AsnVisibleStringConverter=ho(Ct.VisibleString);H.AsnGeneralStringConverter=ho(Ct.GeneralString);H.AsnCharacterStringConverter=ho(Ct.CharacterString);H.AsnUTCTimeConverter={fromASN:t=>t.toDate(),toASN:t=>new Ct.UTCTime({valueDate:t})};H.AsnGeneralizedTimeConverter={fromASN:t=>t.toDate(),toASN:t=>new Ct.GeneralizedTime({valueDate:t})};H.AsnNullConverter={fromASN:()=>null,toASN:()=>new Ct.Null};function rde(t){switch(t){case Kt.AsnPropTypes.Any:return H.AsnAnyConverter;case Kt.AsnPropTypes.BitString:return H.AsnBitStringConverter;case Kt.AsnPropTypes.BmpString:return H.AsnBmpStringConverter;case Kt.AsnPropTypes.Boolean:return H.AsnBooleanConverter;case Kt.AsnPropTypes.CharacterString:return H.AsnCharacterStringConverter;case Kt.AsnPropTypes.Enumerated:return H.AsnEnumeratedConverter;case Kt.AsnPropTypes.GeneralString:return H.AsnGeneralStringConverter;case Kt.AsnPropTypes.GeneralizedTime:return H.AsnGeneralizedTimeConverter;case Kt.AsnPropTypes.GraphicString:return H.AsnGraphicStringConverter;case Kt.AsnPropTypes.IA5String:return H.AsnIA5StringConverter;case Kt.AsnPropTypes.Integer:return H.AsnIntegerConverter;case Kt.AsnPropTypes.Null:return H.AsnNullConverter;case Kt.AsnPropTypes.NumericString:return H.AsnNumericStringConverter;case Kt.AsnPropTypes.ObjectIdentifier:return H.AsnObjectIdentifierConverter;case Kt.AsnPropTypes.OctetString:return H.AsnOctetStringConverter;case Kt.AsnPropTypes.PrintableString:return H.AsnPrintableStringConverter;case Kt.AsnPropTypes.TeletexString:return H.AsnTeletexStringConverter;case Kt.AsnPropTypes.UTCTime:return H.AsnUTCTimeConverter;case Kt.AsnPropTypes.UniversalString:return H.AsnUniversalStringConverter;case Kt.AsnPropTypes.Utf8String:return H.AsnUtf8StringConverter;case Kt.AsnPropTypes.VideotexString:return H.AsnVideotexStringConverter;case Kt.AsnPropTypes.VisibleString:return H.AsnVisibleStringConverter;default:return null}}});var I0=g(Ag=>{"use strict";Object.defineProperty(Ag,"__esModule",{value:!0});Ag.isConvertible=gH;Ag.isTypeOfArray=yH;Ag.isArrayEqual=nde;function gH(t){return typeof t=="function"&&t.prototype?t.prototype.toASN&&t.prototype.fromASN?!0:gH(t.prototype):!!(t&&typeof t=="object"&&"toASN"in t&&"fromASN"in t)}function yH(t){var e;if(t){let r=Object.getPrototypeOf(t);return((e=r?.prototype)===null||e===void 0?void 0:e.constructor)===Array?!0:yH(r)}return!1}function nde(t,e){if(!(t&&e)||t.byteLength!==e.byteLength)return!1;let r=new Uint8Array(t),n=new Uint8Array(e);for(let o=0;o<t.byteLength;o++)if(r[o]!==n[o])return!1;return!0}});var _H=g(T0=>{"use strict";Object.defineProperty(T0,"__esModule",{value:!0});T0.AsnSchemaStorage=void 0;var Zn=da(),Sd=Ac(),vH=I0(),$O=class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,r=!1){let n=this.items.get(e);if(!n)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(r&&!n.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return n}cache(e){let r=this.get(e);r.schema||(r.schema=this.create(e,!0))}createDefault(e){let r={type:Sd.AsnTypeTypes.Sequence,items:{}},n=this.findParentSchema(e);return n&&(Object.assign(r,n),r.items=Object.assign({},r.items,n.items)),r}create(e,r){let n=this.items.get(e)||this.createDefault(e),o=[];for(let i in n.items){let s=n.items[i],a=r?i:"",c;if(typeof s.type=="number"){let u=Sd.AsnPropTypes[s.type],d=Zn[u];if(!d)throw new Error(`Cannot get ASN1 class by name '${u}'`);c=new d({name:a})}else(0,vH.isConvertible)(s.type)?c=new s.type().toSchema(a):s.optional?this.get(s.type).type===Sd.AsnTypeTypes.Choice?c=new Zn.Any({name:a}):(c=this.create(s.type,!1),c.name=a):c=new Zn.Any({name:a});let l=!!s.optional||s.defaultValue!==void 0;if(s.repeated){c.name="";let u=s.repeated==="set"?Zn.Set:Zn.Sequence;c=new u({name:"",value:[new Zn.Repeated({name:a,value:c})]})}if(s.context!==null&&s.context!==void 0)if(s.implicit)if(typeof s.type=="number"||(0,vH.isConvertible)(s.type)){let u=s.repeated?Zn.Constructed:Zn.Primitive;o.push(new u({name:a,optional:l,idBlock:{tagClass:3,tagNumber:s.context}}))}else{this.cache(s.type);let u=!!s.repeated,d=u?c:this.get(s.type,!0).schema;d="valueBlock"in d?d.valueBlock.value:d.value,o.push(new Zn.Constructed({name:u?"":a,optional:l,idBlock:{tagClass:3,tagNumber:s.context},value:d}))}else o.push(new Zn.Constructed({optional:l,idBlock:{tagClass:3,tagNumber:s.context},value:[c]}));else c.optional=l,o.push(c)}switch(n.type){case Sd.AsnTypeTypes.Sequence:return new Zn.Sequence({value:o,name:""});case Sd.AsnTypeTypes.Set:return new Zn.Set({value:o,name:""});case Sd.AsnTypeTypes.Choice:return new Zn.Choice({value:o,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,r){return this.items.set(e,r),this}findParentSchema(e){let r=Object.getPrototypeOf(e);return r?this.items.get(r)||this.findParentSchema(r):null}};T0.AsnSchemaStorage=$O});var O0=g(E0=>{"use strict";Object.defineProperty(E0,"__esModule",{value:!0});E0.schemaStorage=void 0;var ode=_H();E0.schemaStorage=new ode.AsnSchemaStorage});var bH=g(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.AsnProp=ln.AsnSequenceType=ln.AsnSetType=ln.AsnChoiceType=ln.AsnType=void 0;var ide=$g(),AO=Ac(),pa=O0(),sde=t=>e=>{let r;pa.schemaStorage.has(e)?r=pa.schemaStorage.get(e):(r=pa.schemaStorage.createDefault(e),pa.schemaStorage.set(e,r)),Object.assign(r,t)};ln.AsnType=sde;var ade=()=>(0,ln.AsnType)({type:AO.AsnTypeTypes.Choice});ln.AsnChoiceType=ade;var cde=t=>(0,ln.AsnType)({type:AO.AsnTypeTypes.Set,...t});ln.AsnSetType=cde;var lde=t=>(0,ln.AsnType)({type:AO.AsnTypeTypes.Sequence,...t});ln.AsnSequenceType=lde;var ude=t=>(e,r)=>{let n;pa.schemaStorage.has(e.constructor)?n=pa.schemaStorage.get(e.constructor):(n=pa.schemaStorage.createDefault(e.constructor),pa.schemaStorage.set(e.constructor,n));let o=Object.assign({},t);if(typeof o.type=="number"&&!o.converter){let i=ide.defaultConverter(t.type);if(!i)throw new Error(`Cannot get default converter for property '${r}' of ${e.constructor.name}`);o.converter=i}o.raw=t.raw,n.items[r]=o};ln.AsnProp=ude});var wH=g(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0});j0.AsnSchemaValidationError=void 0;var PO=class extends Error{constructor(){super(...arguments),this.schemas=[]}};j0.AsnSchemaValidationError=PO});var IO=g(CO=>{"use strict";Object.defineProperty(CO,"__esModule",{value:!0});var dde=(T(),C(I));dde.__exportStar(wH(),CO)});var OO=g(N0=>{"use strict";Object.defineProperty(N0,"__esModule",{value:!0});N0.AsnParser=void 0;var kn=da(),fa=Ac(),TO=$g(),Pg=IO(),Cg=I0(),Pc=O0(),EO=class{static parse(e,r){let n=kn.fromBER(e);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,r)}static fromASN(e,r){try{if((0,Cg.isConvertible)(r))return new r().fromASN(e);let n=Pc.schemaStorage.get(r);Pc.schemaStorage.cache(r);let o=n.schema,i=this.handleChoiceTypes(e,n,r,o);if(i?.result)return i.result;i?.targetSchema&&(o=i.targetSchema);let s=this.handleSequenceTypes(e,n,r,o),a=new r;return(0,Cg.isTypeOfArray)(r)?this.handleArrayTypes(e,n,r):(this.processSchemaItems(n,s,a),a)}catch(n){throw n instanceof Pg.AsnSchemaValidationError&&n.schemas.push(r.name),n}}static handleChoiceTypes(e,r,n,o){if(e.constructor===kn.Constructed&&r.type===fa.AsnTypeTypes.Choice&&e.idBlock.tagClass===3)for(let i in r.items){let s=r.items[i];if(s.context===e.idBlock.tagNumber&&s.implicit&&typeof s.type=="function"&&Pc.schemaStorage.has(s.type)){let a=Pc.schemaStorage.get(s.type);if(a&&a.type===fa.AsnTypeTypes.Sequence){let c=new kn.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in c.valueBlock){c.valueBlock.value=e.valueBlock.value;let l=this.fromASN(c,s.type),u=new n;return u[i]=l,{result:u}}}}}else if(e.constructor===kn.Constructed&&r.type!==fa.AsnTypeTypes.Choice){let i=new kn.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:r.schema.valueBlock.value});for(let s in r.items)delete e[s];return{targetSchema:i}}return null}static handleSequenceTypes(e,r,n,o){if(r.type===fa.AsnTypeTypes.Sequence){let i=kn.compareSchema({},e,o);if(!i.verified)throw new Pg.AsnSchemaValidationError(`Data does not match to ${n.name} ASN1 schema.${i.result.error?` ${i.result.error}`:""}`);return i}else{let i=kn.compareSchema({},e,o);if(!i.verified)throw new Pg.AsnSchemaValidationError(`Data does not match to ${n.name} ASN1 schema.${i.result.error?` ${i.result.error}`:""}`);return i}}static processRepeatedField(e,r,n){let o=e.slice(r);if(o.length===1&&o[0].constructor.name==="Sequence"){let i=o[0];i.valueBlock&&i.valueBlock.value&&Array.isArray(i.valueBlock.value)&&(o=i.valueBlock.value)}if(typeof n.type=="number"){let i=TO.defaultConverter(n.type);if(!i)throw new Error(`No converter for ASN.1 type ${n.type}`);return o.filter(s=>s&&s.valueBlock).map(s=>{try{return i.fromASN(s)}catch{return}}).filter(s=>s!==void 0)}else return o.filter(i=>i&&i.valueBlock).map(i=>{try{return this.fromASN(i,n.type)}catch{return}}).filter(i=>i!==void 0)}static processPrimitiveField(e,r){let n=TO.defaultConverter(r.type);if(!n)throw new Error(`No converter for ASN.1 type ${r.type}`);return n.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&typeof e.type=="function"&&Pc.schemaStorage.has(e.type)&&Pc.schemaStorage.get(e.type).type===fa.AsnTypeTypes.Choice}static processOptionalChoiceField(e,r){try{return{processed:!0,value:this.fromASN(e,r.type)}}catch(n){if(n instanceof Pg.AsnSchemaValidationError&&/Wrong values for Choice type/.test(n.message))return{processed:!1};throw n}}static handleArrayTypes(e,r,n){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let o=r.itemType;if(typeof o=="number"){let i=TO.defaultConverter(o);if(!i)throw new Error(`Cannot get default converter for array item of ${n.name} ASN1 schema`);return n.from(e.valueBlock.value,s=>i.fromASN(s))}else return n.from(e.valueBlock.value,i=>this.fromASN(i,o))}static processSchemaItems(e,r,n){for(let o in e.items){let i=r.result[o];if(!i)continue;let s=e.items[o],a=s.type,c;typeof a=="number"||(0,Cg.isConvertible)(a)?c=this.processPrimitiveSchemaItem(i,s,a):c=this.processComplexSchemaItem(i,s,a),c&&typeof c=="object"&&"value"in c&&"raw"in c?(n[o]=c.value,n[`${o}Raw`]=c.raw):n[o]=c}}static processPrimitiveSchemaItem(e,r,n){var o;let i=(o=r.converter)!==null&&o!==void 0?o:(0,Cg.isConvertible)(n)?new n:null;if(!i)throw new Error("Converter is empty");return r.repeated?this.processRepeatedPrimitiveItem(e,r,i):this.processSinglePrimitiveItem(e,r,n,i)}static processRepeatedPrimitiveItem(e,r,n){if(r.implicit){let o=r.repeated==="sequence"?kn.Sequence:kn.Set,i=new o;i.valueBlock=e.valueBlock;let s=kn.fromBER(i.toBER(!1));if(s.offset===-1)throw new Error(`Cannot parse the child item. ${s.result.error}`);if(!("value"in s.result.valueBlock&&Array.isArray(s.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let a=s.result.valueBlock.value;return Array.from(a,c=>n.fromASN(c))}else return Array.from(e,o=>n.fromASN(o))}static processSinglePrimitiveItem(e,r,n,o){let i=e;if(r.implicit){let s;if((0,Cg.isConvertible)(n))s=new n().toSchema("");else{let a=fa.AsnPropTypes[n],c=kn[a];if(!c)throw new Error(`Cannot get '${a}' class from asn1js module`);s=new c}s.valueBlock=i.valueBlock,i=kn.fromBER(s.toBER(!1)).result}return o.fromASN(i)}static processComplexSchemaItem(e,r,n){if(r.repeated){if(!Array.isArray(e))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,o=>this.fromASN(o,n))}else{let o=this.handleImplicitTagging(e,r,n);if(this.isOptionalChoiceField(r))try{return this.fromASN(o,n)}catch(i){if(i instanceof Pg.AsnSchemaValidationError&&/Wrong values for Choice type/.test(i.message))return;throw i}else{let i=this.fromASN(o,n);return r.raw?{value:i,raw:e.valueBeforeDecodeView}:i}}}static handleImplicitTagging(e,r,n){if(r.implicit&&typeof r.context=="number"){let o=Pc.schemaStorage.get(n);if(o.type===fa.AsnTypeTypes.Sequence){let i=new kn.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in i.valueBlock)return i.valueBlock.value=e.valueBlock.value,i}else if(o.type===fa.AsnTypeTypes.Set){let i=new kn.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in i.valueBlock)return i.valueBlock.value=e.valueBlock.value,i}}return e}};N0.AsnParser=EO});var zO=g(R0=>{"use strict";Object.defineProperty(R0,"__esModule",{value:!0});R0.AsnSerializer=void 0;var Lo=da(),pde=$g(),z0=Ac(),jO=I0(),xH=O0(),NO=class t{static serialize(e){return e instanceof Lo.BaseBlock?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&typeof e=="object"&&(0,jO.isConvertible)(e))return e.toASN();if(!(e&&typeof e=="object"))throw new TypeError("Parameter 1 should be type of Object.");let r=e.constructor,n=xH.schemaStorage.get(r);xH.schemaStorage.cache(r);let o=[];if(n.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if(typeof n.itemType=="number"){let s=pde.defaultConverter(n.itemType);if(!s)throw new Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);o=e.map(a=>s.toASN(a))}else o=e.map(s=>this.toAsnItem({type:n.itemType},"[]",r,s))}else for(let s in n.items){let a=n.items[s],c=e[s];if(c===void 0||a.defaultValue===c||typeof a.defaultValue=="object"&&typeof c=="object"&&(0,jO.isArrayEqual)(this.serialize(a.defaultValue),this.serialize(c)))continue;let l=t.toAsnItem(a,s,r,c);if(typeof a.context=="number")if(a.implicit)if(!a.repeated&&(typeof a.type=="number"||(0,jO.isConvertible)(a.type))){let u={};u.valueHex=l instanceof Lo.Null?l.valueBeforeDecodeView:l.valueBlock.toBER(),o.push(new Lo.Primitive({optional:a.optional,idBlock:{tagClass:3,tagNumber:a.context},...u}))}else o.push(new Lo.Constructed({optional:a.optional,idBlock:{tagClass:3,tagNumber:a.context},value:l.valueBlock.value}));else o.push(new Lo.Constructed({optional:a.optional,idBlock:{tagClass:3,tagNumber:a.context},value:[l]}));else a.repeated?o=o.concat(l):o.push(l)}let i;switch(n.type){case z0.AsnTypeTypes.Sequence:i=new Lo.Sequence({value:o});break;case z0.AsnTypeTypes.Set:i=new Lo.Set({value:o});break;case z0.AsnTypeTypes.Choice:if(!o[0])throw new Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);i=o[0];break}return i}static toAsnItem(e,r,n,o){let i;if(typeof e.type=="number"){let s=e.converter;if(!s)throw new Error(`Property '${r}' doesn't have converter for type ${z0.AsnPropTypes[e.type]} in schema '${n.name}'`);if(e.repeated){if(!Array.isArray(o))throw new TypeError("Parameter 'objProp' should be type of Array.");let a=Array.from(o,l=>s.toASN(l)),c=e.repeated==="sequence"?Lo.Sequence:Lo.Set;i=new c({value:a})}else i=s.toASN(o)}else if(e.repeated){if(!Array.isArray(o))throw new TypeError("Parameter 'objProp' should be type of Array.");let s=Array.from(o,c=>this.toASN(c)),a=e.repeated==="sequence"?Lo.Sequence:Lo.Set;i=new a({value:s})}else i=this.toASN(o);return i}};R0.AsnSerializer=NO});var SH=g(M0=>{"use strict";Object.defineProperty(M0,"__esModule",{value:!0});M0.AsnArray=void 0;var RO=class extends Array{constructor(e=[]){if(typeof e=="number")super(e);else{super();for(let r of e)this.push(r)}}};M0.AsnArray=RO});var $H=g(q0=>{"use strict";Object.defineProperty(q0,"__esModule",{value:!0});q0.AsnConvert=void 0;var fde=da(),kH=ps(),mde=OO(),hde=zO(),MO=class t{static serialize(e){return hde.AsnSerializer.serialize(e)}static parse(e,r){return mde.AsnParser.parse(e,r)}static toString(e){let r=kH.BufferSourceConverter.isBufferSource(e)?kH.BufferSourceConverter.toArrayBuffer(e):t.serialize(e),n=fde.fromBER(r);if(n.offset===-1)throw new Error(`Cannot decode ASN.1 data. ${n.result.error}`);return n.result.toString()}};q0.AsnConvert=MO});var N=g(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.AsnSerializer=Mt.AsnParser=Mt.AsnPropTypes=Mt.AsnTypeTypes=Mt.AsnSetType=Mt.AsnSequenceType=Mt.AsnChoiceType=Mt.AsnType=Mt.AsnProp=void 0;var Ig=(T(),C(I));Ig.__exportStar($g(),Mt);Ig.__exportStar(kO(),Mt);var Tg=bH();Object.defineProperty(Mt,"AsnProp",{enumerable:!0,get:function(){return Tg.AsnProp}});Object.defineProperty(Mt,"AsnType",{enumerable:!0,get:function(){return Tg.AsnType}});Object.defineProperty(Mt,"AsnChoiceType",{enumerable:!0,get:function(){return Tg.AsnChoiceType}});Object.defineProperty(Mt,"AsnSequenceType",{enumerable:!0,get:function(){return Tg.AsnSequenceType}});Object.defineProperty(Mt,"AsnSetType",{enumerable:!0,get:function(){return Tg.AsnSetType}});var AH=Ac();Object.defineProperty(Mt,"AsnTypeTypes",{enumerable:!0,get:function(){return AH.AsnTypeTypes}});Object.defineProperty(Mt,"AsnPropTypes",{enumerable:!0,get:function(){return AH.AsnPropTypes}});var gde=OO();Object.defineProperty(Mt,"AsnParser",{enumerable:!0,get:function(){return gde.AsnParser}});var yde=zO();Object.defineProperty(Mt,"AsnSerializer",{enumerable:!0,get:function(){return yde.AsnSerializer}});Ig.__exportStar(IO(),Mt);Ig.__exportStar(SH(),Mt);Ig.__exportStar($H(),Mt)});var PH=g(D0=>{"use strict";Object.defineProperty(D0,"__esModule",{value:!0});D0.IpConverter=void 0;var vde=ps(),qO=class{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let r=e.split(".");if(r.length!==4)throw new Error("Invalid IPv4 address");return r.map(n=>{let o=parseInt(n,10);if(isNaN(o)||o<0||o>255)throw new Error("Invalid IPv4 address part");return o})}static parseIPv6(e){let n=this.expandIPv6(e).split(":");if(n.length!==8)throw new Error("Invalid IPv6 address");return n.reduce((o,i)=>{let s=parseInt(i,16);if(isNaN(s)||s<0||s>65535)throw new Error("Invalid IPv6 address part");return o.push(s>>8&255),o.push(s&255),o},[])}static expandIPv6(e){if(!e.includes("::"))return e;let r=e.split("::");if(r.length>2)throw new Error("Invalid IPv6 address");let n=r[0]?r[0].split(":"):[],o=r[1]?r[1].split(":"):[],i=8-(n.length+o.length);if(i<0)throw new Error("Invalid IPv6 address");return[...n,...Array(i).fill("0"),...o].join(":")}static formatIPv6(e){let r=[];for(let n=0;n<16;n+=2)r.push((e[n]<<8|e[n+1]).toString(16));return this.compressIPv6(r.join(":"))}static compressIPv6(e){let r=e.split(":"),n=-1,o=0,i=-1,s=0;for(let a=0;a<r.length;a++)r[a]==="0"?(i===-1&&(i=a),s++):(s>o&&(n=i,o=s),i=-1,s=0);if(s>o&&(n=i,o=s),o>1){let a=r.slice(0,n).join(":"),c=r.slice(n+o).join(":");return`${a}::${c}`}return e}static parseCIDR(e){let[r,n]=e.split("/"),o=parseInt(n,10);if(this.isIPv4(r)){if(o<0||o>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(r),o]}else{if(o<0||o>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(r),o]}}static decodeIP(e){if(e.length===64&&parseInt(e,16)===0)return"::/0";if(e.length!==16)return e;let r=parseInt(e.slice(8),16).toString(2).split("").reduce((o,i)=>o+ +i,0),n=e.slice(0,8).replace(/(.{2})/g,o=>`${parseInt(o,16)}.`);return n=n.slice(0,-1),`${n}/${r}`}static toString(e){let r=new Uint8Array(e);if(r.length===4)return Array.from(r).join(".");if(r.length===16)return this.formatIPv6(r);if(r.length===8||r.length===32){let n=r.length/2,o=r.slice(0,n),i=r.slice(n);if(r.every(c=>c===0))return r.length===8?"0.0.0.0/0":"::/0";let a=i.reduce((c,l)=>c+(l.toString(2).match(/1/g)||[]).length,0);return r.length===8?`${Array.from(o).join(".")}/${a}`:`${this.formatIPv6(o)}/${a}`}return this.decodeIP(vde.Convert.ToHex(e))}static fromString(e){if(e.includes("/")){let[n,o]=this.parseCIDR(e),i=new Uint8Array(n.length),s=o;for(let c=0;c<i.length;c++)s>=8?(i[c]=255,s-=8):s>0&&(i[c]=255<<8-s,s=0);let a=new Uint8Array(n.length*2);return a.set(n,0),a.set(i,n.length),a.buffer}let r=this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e);return new Uint8Array(r).buffer}};D0.IpConverter=qO});var $d=g(hr=>{"use strict";var DO,BO,UO;Object.defineProperty(hr,"__esModule",{value:!0});hr.Name=hr.RDNSequence=hr.RelativeDistinguishedName=hr.AttributeTypeAndValue=hr.AttributeValue=hr.DirectoryString=void 0;var $n=(T(),C(I)),dt=N(),_de=ps(),gs=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};hr.DirectoryString=gs;$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.TeletexString})],gs.prototype,"teletexString",void 0);$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.PrintableString})],gs.prototype,"printableString",void 0);$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.UniversalString})],gs.prototype,"universalString",void 0);$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.Utf8String})],gs.prototype,"utf8String",void 0);$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.BmpString})],gs.prototype,"bmpString",void 0);hr.DirectoryString=gs=$n.__decorate([(0,dt.AsnType)({type:dt.AsnTypeTypes.Choice})],gs);var Cc=class extends gs{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?_de.Convert.ToHex(this.anyValue):super.toString())}};hr.AttributeValue=Cc;$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.IA5String})],Cc.prototype,"ia5String",void 0);$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.Any})],Cc.prototype,"anyValue",void 0);hr.AttributeValue=Cc=$n.__decorate([(0,dt.AsnType)({type:dt.AsnTypeTypes.Choice})],Cc);var kd=class{constructor(e={}){this.type="",this.value=new Cc,Object.assign(this,e)}};hr.AttributeTypeAndValue=kd;$n.__decorate([(0,dt.AsnProp)({type:dt.AsnPropTypes.ObjectIdentifier})],kd.prototype,"type",void 0);$n.__decorate([(0,dt.AsnProp)({type:Cc})],kd.prototype,"value",void 0);var B0=DO=class extends dt.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,DO.prototype)}};hr.RelativeDistinguishedName=B0;hr.RelativeDistinguishedName=B0=DO=$n.__decorate([(0,dt.AsnType)({type:dt.AsnTypeTypes.Set,itemType:kd})],B0);var U0=BO=class extends dt.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,BO.prototype)}};hr.RDNSequence=U0;hr.RDNSequence=U0=BO=$n.__decorate([(0,dt.AsnType)({type:dt.AsnTypeTypes.Sequence,itemType:B0})],U0);var LO=UO=class extends U0{constructor(e){super(e),Object.setPrototypeOf(this,UO.prototype)}};hr.Name=LO;hr.Name=LO=UO=$n.__decorate([(0,dt.AsnType)({type:dt.AsnTypeTypes.Sequence})],LO)});var Ic=g(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.GeneralName=go.EDIPartyName=go.OtherName=go.AsnIpConverter=void 0;var An=(T(),C(I)),qt=N(),CH=PH(),L0=$d();go.AsnIpConverter={fromASN:t=>CH.IpConverter.toString(qt.AsnOctetStringConverter.fromASN(t)),toASN:t=>qt.AsnOctetStringConverter.toASN(CH.IpConverter.fromString(t))};var Ad=class{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}};go.OtherName=Ad;An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.ObjectIdentifier})],Ad.prototype,"typeId",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.Any,context:0})],Ad.prototype,"value",void 0);var Pd=class{constructor(e={}){this.partyName=new L0.DirectoryString,Object.assign(this,e)}};go.EDIPartyName=Pd;An.__decorate([(0,qt.AsnProp)({type:L0.DirectoryString,optional:!0,context:0,implicit:!0})],Pd.prototype,"nameAssigner",void 0);An.__decorate([(0,qt.AsnProp)({type:L0.DirectoryString,context:1,implicit:!0})],Pd.prototype,"partyName",void 0);var yo=class{constructor(e={}){Object.assign(this,e)}};go.GeneralName=yo;An.__decorate([(0,qt.AsnProp)({type:Ad,context:0,implicit:!0})],yo.prototype,"otherName",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.IA5String,context:1,implicit:!0})],yo.prototype,"rfc822Name",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.IA5String,context:2,implicit:!0})],yo.prototype,"dNSName",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.Any,context:3,implicit:!0})],yo.prototype,"x400Address",void 0);An.__decorate([(0,qt.AsnProp)({type:L0.Name,context:4,implicit:!1})],yo.prototype,"directoryName",void 0);An.__decorate([(0,qt.AsnProp)({type:Pd,context:5})],yo.prototype,"ediPartyName",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.IA5String,context:6,implicit:!0})],yo.prototype,"uniformResourceIdentifier",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.OctetString,context:7,implicit:!0,converter:go.AsnIpConverter})],yo.prototype,"iPAddress",void 0);An.__decorate([(0,qt.AsnProp)({type:qt.AsnPropTypes.ObjectIdentifier,context:8,implicit:!0})],yo.prototype,"registeredID",void 0);go.GeneralName=yo=An.__decorate([(0,qt.AsnType)({type:qt.AsnTypeTypes.Choice})],yo)});var It=g(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.id_ce=Ve.id_ad_caRepository=Ve.id_ad_timeStamping=Ve.id_ad_caIssuers=Ve.id_ad_ocsp=Ve.id_qt_unotice=Ve.id_qt_csp=Ve.id_ad=Ve.id_kp=Ve.id_qt=Ve.id_pe=Ve.id_pkix=void 0;Ve.id_pkix="1.3.6.1.5.5.7";Ve.id_pe=`${Ve.id_pkix}.1`;Ve.id_qt=`${Ve.id_pkix}.2`;Ve.id_kp=`${Ve.id_pkix}.3`;Ve.id_ad=`${Ve.id_pkix}.48`;Ve.id_qt_csp=`${Ve.id_qt}.1`;Ve.id_qt_unotice=`${Ve.id_qt}.2`;Ve.id_ad_ocsp=`${Ve.id_ad}.1`;Ve.id_ad_caIssuers=`${Ve.id_ad}.2`;Ve.id_ad_timeStamping=`${Ve.id_ad}.3`;Ve.id_ad_caRepository=`${Ve.id_ad}.5`;Ve.id_ce="2.5.29"});var HO=g(ys=>{"use strict";var FO;Object.defineProperty(ys,"__esModule",{value:!0});ys.AuthorityInfoAccessSyntax=ys.AccessDescription=ys.id_pe_authorityInfoAccess=void 0;var ZO=(T(),C(I)),Cd=N(),IH=Ic(),bde=It();ys.id_pe_authorityInfoAccess=`${bde.id_pe}.1`;var Id=class{constructor(e={}){this.accessMethod="",this.accessLocation=new IH.GeneralName,Object.assign(this,e)}};ys.AccessDescription=Id;ZO.__decorate([(0,Cd.AsnProp)({type:Cd.AsnPropTypes.ObjectIdentifier})],Id.prototype,"accessMethod",void 0);ZO.__decorate([(0,Cd.AsnProp)({type:IH.GeneralName})],Id.prototype,"accessLocation",void 0);var VO=FO=class extends Cd.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,FO.prototype)}};ys.AuthorityInfoAccessSyntax=VO;ys.AuthorityInfoAccessSyntax=VO=FO=ZO.__decorate([(0,Cd.AsnType)({type:Cd.AsnTypeTypes.Sequence,itemType:Id})],VO)});var WO=g(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.AuthorityKeyIdentifier=ma.KeyIdentifier=ma.id_ce_authorityKeyIdentifier=void 0;var GO=(T(),C(I)),Td=N(),wde=Ic(),xde=It();ma.id_ce_authorityKeyIdentifier=`${xde.id_ce}.35`;var F0=class extends Td.OctetString{};ma.KeyIdentifier=F0;var Ed=class{constructor(e={}){e&&Object.assign(this,e)}};ma.AuthorityKeyIdentifier=Ed;GO.__decorate([(0,Td.AsnProp)({type:F0,context:0,optional:!0,implicit:!0})],Ed.prototype,"keyIdentifier",void 0);GO.__decorate([(0,Td.AsnProp)({type:wde.GeneralName,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Ed.prototype,"authorityCertIssuer",void 0);GO.__decorate([(0,Td.AsnProp)({type:Td.AsnPropTypes.Integer,context:2,optional:!0,implicit:!0,converter:Td.AsnIntegerArrayBufferConverter})],Ed.prototype,"authorityCertSerialNumber",void 0)});var EH=g(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.BasicConstraints=Od.id_ce_basicConstraints=void 0;var TH=(T(),C(I)),V0=N(),Sde=It();Od.id_ce_basicConstraints=`${Sde.id_ce}.19`;var Eg=class{constructor(e={}){this.cA=!1,Object.assign(this,e)}};Od.BasicConstraints=Eg;TH.__decorate([(0,V0.AsnProp)({type:V0.AsnPropTypes.Boolean,defaultValue:!1})],Eg.prototype,"cA",void 0);TH.__decorate([(0,V0.AsnProp)({type:V0.AsnPropTypes.Integer,optional:!0})],Eg.prototype,"pathLenConstraint",void 0)});var jg=g(Og=>{"use strict";var KO;Object.defineProperty(Og,"__esModule",{value:!0});Og.GeneralNames=void 0;var kde=(T(),C(I)),OH=N(),$de=Ic(),Ade=N(),JO=KO=class extends Ade.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,KO.prototype)}};Og.GeneralNames=JO;Og.GeneralNames=JO=KO=kde.__decorate([(0,OH.AsnType)({type:OH.AsnTypeTypes.Sequence,itemType:$de.GeneralName})],JO)});var NH=g(Tc=>{"use strict";var YO;Object.defineProperty(Tc,"__esModule",{value:!0});Tc.CertificateIssuer=Tc.id_ce_certificateIssuer=void 0;var Pde=(T(),C(I)),jH=N(),Cde=jg(),Ide=It();Tc.id_ce_certificateIssuer=`${Ide.id_ce}.29`;var XO=YO=class extends Cde.GeneralNames{constructor(e){super(e),Object.setPrototypeOf(this,YO.prototype)}};Tc.CertificateIssuer=XO;Tc.CertificateIssuer=XO=YO=Pde.__decorate([(0,jH.AsnType)({type:jH.AsnTypeTypes.Sequence})],XO)});var zH=g(Vt=>{"use strict";var QO;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.CertificatePolicies=Vt.PolicyInformation=Vt.PolicyQualifierInfo=Vt.Qualifier=Vt.UserNotice=Vt.NoticeReference=Vt.DisplayText=Vt.id_ce_certificatePolicies_anyPolicy=Vt.id_ce_certificatePolicies=void 0;var Rr=(T(),C(I)),at=N(),Tde=It();Vt.id_ce_certificatePolicies=`${Tde.id_ce}.32`;Vt.id_ce_certificatePolicies_anyPolicy=`${Vt.id_ce_certificatePolicies}.0`;var ki=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};Vt.DisplayText=ki;Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.IA5String})],ki.prototype,"ia5String",void 0);Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.VisibleString})],ki.prototype,"visibleString",void 0);Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.BmpString})],ki.prototype,"bmpString",void 0);Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.Utf8String})],ki.prototype,"utf8String",void 0);Vt.DisplayText=ki=Rr.__decorate([(0,at.AsnType)({type:at.AsnTypeTypes.Choice})],ki);var jd=class{constructor(e={}){this.organization=new ki,this.noticeNumbers=[],Object.assign(this,e)}};Vt.NoticeReference=jd;Rr.__decorate([(0,at.AsnProp)({type:ki})],jd.prototype,"organization",void 0);Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.Integer,repeated:"sequence"})],jd.prototype,"noticeNumbers",void 0);var Nd=class{constructor(e={}){Object.assign(this,e)}};Vt.UserNotice=Nd;Rr.__decorate([(0,at.AsnProp)({type:jd,optional:!0})],Nd.prototype,"noticeRef",void 0);Rr.__decorate([(0,at.AsnProp)({type:ki,optional:!0})],Nd.prototype,"explicitText",void 0);var Ng=class{constructor(e={}){Object.assign(this,e)}};Vt.Qualifier=Ng;Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.IA5String})],Ng.prototype,"cPSuri",void 0);Rr.__decorate([(0,at.AsnProp)({type:Nd})],Ng.prototype,"userNotice",void 0);Vt.Qualifier=Ng=Rr.__decorate([(0,at.AsnType)({type:at.AsnTypeTypes.Choice})],Ng);var zd=class{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}};Vt.PolicyQualifierInfo=zd;Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.ObjectIdentifier})],zd.prototype,"policyQualifierId",void 0);Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.Any})],zd.prototype,"qualifier",void 0);var Rd=class{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}};Vt.PolicyInformation=Rd;Rr.__decorate([(0,at.AsnProp)({type:at.AsnPropTypes.ObjectIdentifier})],Rd.prototype,"policyIdentifier",void 0);Rr.__decorate([(0,at.AsnProp)({type:zd,repeated:"sequence",optional:!0})],Rd.prototype,"policyQualifiers",void 0);var ej=QO=class extends at.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,QO.prototype)}};Vt.CertificatePolicies=ej;Vt.CertificatePolicies=ej=QO=Rr.__decorate([(0,at.AsnType)({type:at.AsnTypeTypes.Sequence,itemType:Rd})],ej)});var tj=g(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.CRLNumber=Ec.id_ce_cRLNumber=void 0;var RH=(T(),C(I)),Z0=N(),Ede=It();Ec.id_ce_cRLNumber=`${Ede.id_ce}.20`;var H0=class{constructor(e=0){this.value=e}};Ec.CRLNumber=H0;RH.__decorate([(0,Z0.AsnProp)({type:Z0.AsnPropTypes.Integer})],H0.prototype,"value",void 0);Ec.CRLNumber=H0=RH.__decorate([(0,Z0.AsnType)({type:Z0.AsnTypeTypes.Choice})],H0)});var qH=g(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.BaseCRLNumber=Oc.id_ce_deltaCRLIndicator=void 0;var Ode=(T(),C(I)),MH=N(),jde=It(),Nde=tj();Oc.id_ce_deltaCRLIndicator=`${jde.id_ce}.27`;var rj=class extends Nde.CRLNumber{};Oc.BaseCRLNumber=rj;Oc.BaseCRLNumber=rj=Ode.__decorate([(0,MH.AsnType)({type:MH.AsnTypeTypes.Choice})],rj)});var W0=g(Gr=>{"use strict";var nj;Object.defineProperty(Gr,"__esModule",{value:!0});Gr.CRLDistributionPoints=Gr.DistributionPoint=Gr.DistributionPointName=Gr.Reason=Gr.ReasonFlags=Gr.id_ce_cRLDistributionPoints=void 0;var Nc=(T(),C(I)),Vo=N(),zde=$d(),DH=Ic(),Rde=It();Gr.id_ce_cRLDistributionPoints=`${Rde.id_ce}.31`;var Fo;(function(t){t[t.unused=1]="unused",t[t.keyCompromise=2]="keyCompromise",t[t.cACompromise=4]="cACompromise",t[t.affiliationChanged=8]="affiliationChanged",t[t.superseded=16]="superseded",t[t.cessationOfOperation=32]="cessationOfOperation",t[t.certificateHold=64]="certificateHold",t[t.privilegeWithdrawn=128]="privilegeWithdrawn",t[t.aACompromise=256]="aACompromise"})(Fo||(Gr.ReasonFlags=Fo={}));var G0=class extends Vo.BitString{toJSON(){let e=[],r=this.toNumber();return r&Fo.aACompromise&&e.push("aACompromise"),r&Fo.affiliationChanged&&e.push("affiliationChanged"),r&Fo.cACompromise&&e.push("cACompromise"),r&Fo.certificateHold&&e.push("certificateHold"),r&Fo.cessationOfOperation&&e.push("cessationOfOperation"),r&Fo.keyCompromise&&e.push("keyCompromise"),r&Fo.privilegeWithdrawn&&e.push("privilegeWithdrawn"),r&Fo.superseded&&e.push("superseded"),r&Fo.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}};Gr.Reason=G0;var Md=class{constructor(e={}){Object.assign(this,e)}};Gr.DistributionPointName=Md;Nc.__decorate([(0,Vo.AsnProp)({type:DH.GeneralName,context:0,repeated:"sequence",implicit:!0})],Md.prototype,"fullName",void 0);Nc.__decorate([(0,Vo.AsnProp)({type:zde.RelativeDistinguishedName,context:1,implicit:!0})],Md.prototype,"nameRelativeToCRLIssuer",void 0);Gr.DistributionPointName=Md=Nc.__decorate([(0,Vo.AsnType)({type:Vo.AsnTypeTypes.Choice})],Md);var jc=class{constructor(e={}){Object.assign(this,e)}};Gr.DistributionPoint=jc;Nc.__decorate([(0,Vo.AsnProp)({type:Md,context:0,optional:!0})],jc.prototype,"distributionPoint",void 0);Nc.__decorate([(0,Vo.AsnProp)({type:G0,context:1,optional:!0,implicit:!0})],jc.prototype,"reasons",void 0);Nc.__decorate([(0,Vo.AsnProp)({type:DH.GeneralName,context:2,optional:!0,repeated:"sequence",implicit:!0})],jc.prototype,"cRLIssuer",void 0);var oj=nj=class extends Vo.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,nj.prototype)}};Gr.CRLDistributionPoints=oj;Gr.CRLDistributionPoints=oj=nj=Nc.__decorate([(0,Vo.AsnType)({type:Vo.AsnTypeTypes.Sequence,itemType:jc})],oj)});var LH=g(zc=>{"use strict";var ij;Object.defineProperty(zc,"__esModule",{value:!0});zc.FreshestCRL=zc.id_ce_freshestCRL=void 0;var Mde=(T(),C(I)),BH=N(),qde=It(),UH=W0();zc.id_ce_freshestCRL=`${qde.id_ce}.46`;var sj=ij=class extends UH.CRLDistributionPoints{constructor(e){super(e),Object.setPrototypeOf(this,ij.prototype)}};zc.FreshestCRL=sj;zc.FreshestCRL=sj=ij=Mde.__decorate([(0,BH.AsnType)({type:BH.AsnTypeTypes.Sequence,itemType:UH.DistributionPoint})],sj)});var VH=g(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});qd.IssuingDistributionPoint=qd.id_ce_issuingDistributionPoint=void 0;var Dd=(T(),C(I)),Bd=N(),FH=W0(),Dde=It(),K0=N();qd.id_ce_issuingDistributionPoint=`${Dde.id_ce}.28`;var Pn=class t{constructor(e={}){this.onlyContainsUserCerts=t.ONLY,this.onlyContainsCACerts=t.ONLY,this.indirectCRL=t.ONLY,this.onlyContainsAttributeCerts=t.ONLY,Object.assign(this,e)}};qd.IssuingDistributionPoint=Pn;Pn.ONLY=!1;Dd.__decorate([(0,Bd.AsnProp)({type:FH.DistributionPointName,context:0,optional:!0})],Pn.prototype,"distributionPoint",void 0);Dd.__decorate([(0,Bd.AsnProp)({type:K0.AsnPropTypes.Boolean,context:1,defaultValue:Pn.ONLY,implicit:!0})],Pn.prototype,"onlyContainsUserCerts",void 0);Dd.__decorate([(0,Bd.AsnProp)({type:K0.AsnPropTypes.Boolean,context:2,defaultValue:Pn.ONLY,implicit:!0})],Pn.prototype,"onlyContainsCACerts",void 0);Dd.__decorate([(0,Bd.AsnProp)({type:FH.Reason,context:3,optional:!0,implicit:!0})],Pn.prototype,"onlySomeReasons",void 0);Dd.__decorate([(0,Bd.AsnProp)({type:K0.AsnPropTypes.Boolean,context:4,defaultValue:Pn.ONLY,implicit:!0})],Pn.prototype,"indirectCRL",void 0);Dd.__decorate([(0,Bd.AsnProp)({type:K0.AsnPropTypes.Boolean,context:5,defaultValue:Pn.ONLY,implicit:!0})],Pn.prototype,"onlyContainsAttributeCerts",void 0)});var HH=g(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.CRLReason=vs.CRLReasons=vs.id_ce_cRLReasons=void 0;var ZH=(T(),C(I)),J0=N(),Bde=It();vs.id_ce_cRLReasons=`${Bde.id_ce}.21`;var zg;(function(t){t[t.unspecified=0]="unspecified",t[t.keyCompromise=1]="keyCompromise",t[t.cACompromise=2]="cACompromise",t[t.affiliationChanged=3]="affiliationChanged",t[t.superseded=4]="superseded",t[t.cessationOfOperation=5]="cessationOfOperation",t[t.certificateHold=6]="certificateHold",t[t.removeFromCRL=8]="removeFromCRL",t[t.privilegeWithdrawn=9]="privilegeWithdrawn",t[t.aACompromise=10]="aACompromise"})(zg||(vs.CRLReasons=zg={}));var Y0=class{constructor(e=zg.unspecified){this.reason=zg.unspecified,this.reason=e}toJSON(){return zg[this.reason]}toString(){return this.toJSON()}};vs.CRLReason=Y0;ZH.__decorate([(0,J0.AsnProp)({type:J0.AsnPropTypes.Enumerated})],Y0.prototype,"reason",void 0);vs.CRLReason=Y0=ZH.__decorate([(0,J0.AsnType)({type:J0.AsnTypeTypes.Choice})],Y0)});var GH=g(Jt=>{"use strict";var aj;Object.defineProperty(Jt,"__esModule",{value:!0});Jt.id_kp_OCSPSigning=Jt.id_kp_timeStamping=Jt.id_kp_emailProtection=Jt.id_kp_codeSigning=Jt.id_kp_clientAuth=Jt.id_kp_serverAuth=Jt.anyExtendedKeyUsage=Jt.ExtendedKeyUsage=Jt.id_ce_extKeyUsage=void 0;var Ude=(T(),C(I)),X0=N(),Rc=It();Jt.id_ce_extKeyUsage=`${Rc.id_ce}.37`;var cj=aj=class extends X0.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,aj.prototype)}};Jt.ExtendedKeyUsage=cj;Jt.ExtendedKeyUsage=cj=aj=Ude.__decorate([(0,X0.AsnType)({type:X0.AsnTypeTypes.Sequence,itemType:X0.AsnPropTypes.ObjectIdentifier})],cj);Jt.anyExtendedKeyUsage=`${Jt.id_ce_extKeyUsage}.0`;Jt.id_kp_serverAuth=`${Rc.id_kp}.1`;Jt.id_kp_clientAuth=`${Rc.id_kp}.2`;Jt.id_kp_codeSigning=`${Rc.id_kp}.3`;Jt.id_kp_emailProtection=`${Rc.id_kp}.4`;Jt.id_kp_timeStamping=`${Rc.id_kp}.8`;Jt.id_kp_OCSPSigning=`${Rc.id_kp}.9`});var KH=g(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.InhibitAnyPolicy=Mc.id_ce_inhibitAnyPolicy=void 0;var WH=(T(),C(I)),Rg=N(),Lde=It();Mc.id_ce_inhibitAnyPolicy=`${Lde.id_ce}.54`;var Q0=class{constructor(e=new ArrayBuffer(0)){this.value=e}};Mc.InhibitAnyPolicy=Q0;WH.__decorate([(0,Rg.AsnProp)({type:Rg.AsnPropTypes.Integer,converter:Rg.AsnIntegerArrayBufferConverter})],Q0.prototype,"value",void 0);Mc.InhibitAnyPolicy=Q0=WH.__decorate([(0,Rg.AsnType)({type:Rg.AsnTypeTypes.Choice})],Q0)});var YH=g(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.InvalidityDate=qc.id_ce_invalidityDate=void 0;var JH=(T(),C(I)),ex=N(),Fde=It();qc.id_ce_invalidityDate=`${Fde.id_ce}.24`;var tx=class{constructor(e){this.value=new Date,e&&(this.value=e)}};qc.InvalidityDate=tx;JH.__decorate([(0,ex.AsnProp)({type:ex.AsnPropTypes.GeneralizedTime})],tx.prototype,"value",void 0);qc.InvalidityDate=tx=JH.__decorate([(0,ex.AsnType)({type:ex.AsnTypeTypes.Choice})],tx)});var QH=g(Dc=>{"use strict";var lj;Object.defineProperty(Dc,"__esModule",{value:!0});Dc.IssueAlternativeName=Dc.id_ce_issuerAltName=void 0;var Vde=(T(),C(I)),XH=N(),Zde=jg(),Hde=It();Dc.id_ce_issuerAltName=`${Hde.id_ce}.18`;var uj=lj=class extends Zde.GeneralNames{constructor(e){super(e),Object.setPrototypeOf(this,lj.prototype)}};Dc.IssueAlternativeName=uj;Dc.IssueAlternativeName=uj=lj=Vde.__decorate([(0,XH.AsnType)({type:XH.AsnTypeTypes.Sequence})],uj)});var e9=g(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.KeyUsage=ha.KeyUsageFlags=ha.id_ce_keyUsage=void 0;var Gde=N(),Wde=It();ha.id_ce_keyUsage=`${Wde.id_ce}.15`;var Zo;(function(t){t[t.digitalSignature=1]="digitalSignature",t[t.nonRepudiation=2]="nonRepudiation",t[t.keyEncipherment=4]="keyEncipherment",t[t.dataEncipherment=8]="dataEncipherment",t[t.keyAgreement=16]="keyAgreement",t[t.keyCertSign=32]="keyCertSign",t[t.cRLSign=64]="cRLSign",t[t.encipherOnly=128]="encipherOnly",t[t.decipherOnly=256]="decipherOnly"})(Zo||(ha.KeyUsageFlags=Zo={}));var dj=class extends Gde.BitString{toJSON(){let e=this.toNumber(),r=[];return e&Zo.cRLSign&&r.push("crlSign"),e&Zo.dataEncipherment&&r.push("dataEncipherment"),e&Zo.decipherOnly&&r.push("decipherOnly"),e&Zo.digitalSignature&&r.push("digitalSignature"),e&Zo.encipherOnly&&r.push("encipherOnly"),e&Zo.keyAgreement&&r.push("keyAgreement"),e&Zo.keyCertSign&&r.push("keyCertSign"),e&Zo.keyEncipherment&&r.push("keyEncipherment"),e&Zo.nonRepudiation&&r.push("nonRepudiation"),r}toString(){return`[${this.toJSON().join(", ")}]`}};ha.KeyUsage=dj});var r9=g(Ho=>{"use strict";var pj;Object.defineProperty(Ho,"__esModule",{value:!0});Ho.NameConstraints=Ho.GeneralSubtrees=Ho.GeneralSubtree=Ho.id_ce_nameConstraints=void 0;var Ud=(T(),C(I)),$i=N(),t9=Ic(),Kde=It();Ho.id_ce_nameConstraints=`${Kde.id_ce}.30`;var Bc=class{constructor(e={}){this.base=new t9.GeneralName,this.minimum=0,Object.assign(this,e)}};Ho.GeneralSubtree=Bc;Ud.__decorate([(0,$i.AsnProp)({type:t9.GeneralName})],Bc.prototype,"base",void 0);Ud.__decorate([(0,$i.AsnProp)({type:$i.AsnPropTypes.Integer,context:0,defaultValue:0,implicit:!0})],Bc.prototype,"minimum",void 0);Ud.__decorate([(0,$i.AsnProp)({type:$i.AsnPropTypes.Integer,context:1,optional:!0,implicit:!0})],Bc.prototype,"maximum",void 0);var Mg=pj=class extends $i.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,pj.prototype)}};Ho.GeneralSubtrees=Mg;Ho.GeneralSubtrees=Mg=pj=Ud.__decorate([(0,$i.AsnType)({type:$i.AsnTypeTypes.Sequence,itemType:Bc})],Mg);var qg=class{constructor(e={}){Object.assign(this,e)}};Ho.NameConstraints=qg;Ud.__decorate([(0,$i.AsnProp)({type:Mg,context:0,optional:!0,implicit:!0})],qg.prototype,"permittedSubtrees",void 0);Ud.__decorate([(0,$i.AsnProp)({type:Mg,context:1,optional:!0,implicit:!0})],qg.prototype,"excludedSubtrees",void 0)});var o9=g(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.PolicyConstraints=Fd.id_ce_policyConstraints=void 0;var n9=(T(),C(I)),Ld=N(),Jde=It();Fd.id_ce_policyConstraints=`${Jde.id_ce}.36`;var Dg=class{constructor(e={}){Object.assign(this,e)}};Fd.PolicyConstraints=Dg;n9.__decorate([(0,Ld.AsnProp)({type:Ld.AsnPropTypes.Integer,context:0,implicit:!0,optional:!0,converter:Ld.AsnIntegerArrayBufferConverter})],Dg.prototype,"requireExplicitPolicy",void 0);n9.__decorate([(0,Ld.AsnProp)({type:Ld.AsnPropTypes.Integer,context:1,implicit:!0,optional:!0,converter:Ld.AsnIntegerArrayBufferConverter})],Dg.prototype,"inhibitPolicyMapping",void 0)});var i9=g(_s=>{"use strict";var fj;Object.defineProperty(_s,"__esModule",{value:!0});_s.PolicyMappings=_s.PolicyMapping=_s.id_ce_policyMappings=void 0;var hj=(T(),C(I)),Uc=N(),Yde=It();_s.id_ce_policyMappings=`${Yde.id_ce}.33`;var Vd=class{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}};_s.PolicyMapping=Vd;hj.__decorate([(0,Uc.AsnProp)({type:Uc.AsnPropTypes.ObjectIdentifier})],Vd.prototype,"issuerDomainPolicy",void 0);hj.__decorate([(0,Uc.AsnProp)({type:Uc.AsnPropTypes.ObjectIdentifier})],Vd.prototype,"subjectDomainPolicy",void 0);var mj=fj=class extends Uc.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,fj.prototype)}};_s.PolicyMappings=mj;_s.PolicyMappings=mj=fj=hj.__decorate([(0,Uc.AsnType)({type:Uc.AsnTypeTypes.Sequence,itemType:Vd})],mj)});var a9=g(Lc=>{"use strict";var gj;Object.defineProperty(Lc,"__esModule",{value:!0});Lc.SubjectAlternativeName=Lc.id_ce_subjectAltName=void 0;var Xde=(T(),C(I)),s9=N(),Qde=jg(),epe=It();Lc.id_ce_subjectAltName=`${epe.id_ce}.17`;var yj=gj=class extends Qde.GeneralNames{constructor(e){super(e),Object.setPrototypeOf(this,gj.prototype)}};Lc.SubjectAlternativeName=yj;Lc.SubjectAlternativeName=yj=gj=Xde.__decorate([(0,s9.AsnType)({type:s9.AsnTypeTypes.Sequence})],yj)});var vj=g(nx=>{"use strict";Object.defineProperty(nx,"__esModule",{value:!0});nx.Attribute=void 0;var c9=(T(),C(I)),rx=N(),Bg=class{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}};nx.Attribute=Bg;c9.__decorate([(0,rx.AsnProp)({type:rx.AsnPropTypes.ObjectIdentifier})],Bg.prototype,"type",void 0);c9.__decorate([(0,rx.AsnProp)({type:rx.AsnPropTypes.Any,repeated:"set"})],Bg.prototype,"values",void 0)});var l9=g(Fc=>{"use strict";var _j;Object.defineProperty(Fc,"__esModule",{value:!0});Fc.SubjectDirectoryAttributes=Fc.id_ce_subjectDirectoryAttributes=void 0;var tpe=(T(),C(I)),bj=N(),rpe=vj(),npe=It();Fc.id_ce_subjectDirectoryAttributes=`${npe.id_ce}.9`;var wj=_j=class extends bj.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,_j.prototype)}};Fc.SubjectDirectoryAttributes=wj;Fc.SubjectDirectoryAttributes=wj=_j=tpe.__decorate([(0,bj.AsnType)({type:bj.AsnTypeTypes.Sequence,itemType:rpe.Attribute})],wj)});var u9=g(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.SubjectKeyIdentifier=Zd.id_ce_subjectKeyIdentifier=void 0;var ope=It(),ipe=WO();Zd.id_ce_subjectKeyIdentifier=`${ope.id_ce}.14`;var xj=class extends ipe.KeyIdentifier{};Zd.SubjectKeyIdentifier=xj});var p9=g(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.PrivateKeyUsagePeriod=Hd.id_ce_privateKeyUsagePeriod=void 0;var d9=(T(),C(I)),ox=N(),spe=It();Hd.id_ce_privateKeyUsagePeriod=`${spe.id_ce}.16`;var Ug=class{constructor(e={}){Object.assign(this,e)}};Hd.PrivateKeyUsagePeriod=Ug;d9.__decorate([(0,ox.AsnProp)({type:ox.AsnPropTypes.GeneralizedTime,context:0,implicit:!0,optional:!0})],Ug.prototype,"notBefore",void 0);d9.__decorate([(0,ox.AsnProp)({type:ox.AsnPropTypes.GeneralizedTime,context:1,implicit:!0,optional:!0})],Ug.prototype,"notAfter",void 0)});var m9=g(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.EntrustVersionInfo=Ai.EntrustInfo=Ai.EntrustInfoFlags=Ai.id_entrust_entrustVersInfo=void 0;var f9=(T(),C(I)),ix=N();Ai.id_entrust_entrustVersInfo="1.2.840.113533.7.65.0";var Lg;(function(t){t[t.keyUpdateAllowed=1]="keyUpdateAllowed",t[t.newExtensions=2]="newExtensions",t[t.pKIXCertificate=4]="pKIXCertificate"})(Lg||(Ai.EntrustInfoFlags=Lg={}));var Fg=class extends ix.BitString{toJSON(){let e=[],r=this.toNumber();return r&Lg.pKIXCertificate&&e.push("pKIXCertificate"),r&Lg.newExtensions&&e.push("newExtensions"),r&Lg.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}};Ai.EntrustInfo=Fg;var Vg=class{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Fg,Object.assign(this,e)}};Ai.EntrustVersionInfo=Vg;f9.__decorate([(0,ix.AsnProp)({type:ix.AsnPropTypes.GeneralString})],Vg.prototype,"entrustVers",void 0);f9.__decorate([(0,ix.AsnProp)({type:Fg})],Vg.prototype,"entrustInfoFlags",void 0)});var h9=g(Vc=>{"use strict";var Sj;Object.defineProperty(Vc,"__esModule",{value:!0});Vc.SubjectInfoAccessSyntax=Vc.id_pe_subjectInfoAccess=void 0;var ape=(T(),C(I)),kj=N(),cpe=It(),lpe=HO();Vc.id_pe_subjectInfoAccess=`${cpe.id_pe}.11`;var $j=Sj=class extends kj.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Sj.prototype)}};Vc.SubjectInfoAccessSyntax=$j;Vc.SubjectInfoAccessSyntax=$j=Sj=ape.__decorate([(0,kj.AsnType)({type:kj.AsnTypeTypes.Sequence,itemType:lpe.AccessDescription})],$j)});var g9=g(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});var Dt=(T(),C(I));Dt.__exportStar(HO(),St);Dt.__exportStar(WO(),St);Dt.__exportStar(EH(),St);Dt.__exportStar(NH(),St);Dt.__exportStar(zH(),St);Dt.__exportStar(qH(),St);Dt.__exportStar(W0(),St);Dt.__exportStar(LH(),St);Dt.__exportStar(VH(),St);Dt.__exportStar(tj(),St);Dt.__exportStar(HH(),St);Dt.__exportStar(GH(),St);Dt.__exportStar(KH(),St);Dt.__exportStar(YH(),St);Dt.__exportStar(QH(),St);Dt.__exportStar(e9(),St);Dt.__exportStar(r9(),St);Dt.__exportStar(o9(),St);Dt.__exportStar(i9(),St);Dt.__exportStar(a9(),St);Dt.__exportStar(l9(),St);Dt.__exportStar(u9(),St);Dt.__exportStar(p9(),St);Dt.__exportStar(m9(),St);Dt.__exportStar(h9(),St)});var Zc=g(ax=>{"use strict";Object.defineProperty(ax,"__esModule",{value:!0});ax.AlgorithmIdentifier=void 0;var y9=(T(),C(I)),sx=N(),upe=ps(),Zg=class t{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof t&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&upe.isEqual(e.parameters,this.parameters)||e.parameters===this.parameters)}};ax.AlgorithmIdentifier=Zg;y9.__decorate([(0,sx.AsnProp)({type:sx.AsnPropTypes.ObjectIdentifier})],Zg.prototype,"algorithm",void 0);y9.__decorate([(0,sx.AsnProp)({type:sx.AsnPropTypes.Any,optional:!0})],Zg.prototype,"parameters",void 0)});var Pj=g(cx=>{"use strict";Object.defineProperty(cx,"__esModule",{value:!0});cx.SubjectPublicKeyInfo=void 0;var v9=(T(),C(I)),Aj=N(),_9=Zc(),Hg=class{constructor(e={}){this.algorithm=new _9.AlgorithmIdentifier,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}};cx.SubjectPublicKeyInfo=Hg;v9.__decorate([(0,Aj.AsnProp)({type:_9.AlgorithmIdentifier})],Hg.prototype,"algorithm",void 0);v9.__decorate([(0,Aj.AsnProp)({type:Aj.AsnPropTypes.BitString})],Hg.prototype,"subjectPublicKey",void 0)});var lx=g(Wg=>{"use strict";Object.defineProperty(Wg,"__esModule",{value:!0});Wg.Time=void 0;var Cj=(T(),C(I)),Gd=N(),Gg=class{constructor(e){if(e)if(typeof e=="string"||typeof e=="number"||e instanceof Date){let r=new Date(e);r.getUTCFullYear()>2049?this.generalTime=r:this.utcTime=r}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};Wg.Time=Gg;Cj.__decorate([(0,Gd.AsnProp)({type:Gd.AsnPropTypes.UTCTime})],Gg.prototype,"utcTime",void 0);Cj.__decorate([(0,Gd.AsnProp)({type:Gd.AsnPropTypes.GeneralizedTime})],Gg.prototype,"generalTime",void 0);Wg.Time=Gg=Cj.__decorate([(0,Gd.AsnType)({type:Gd.AsnTypeTypes.Choice})],Gg)});var Ij=g(ux=>{"use strict";Object.defineProperty(ux,"__esModule",{value:!0});ux.Validity=void 0;var b9=(T(),C(I)),w9=N(),Wd=lx(),Kg=class{constructor(e){this.notBefore=new Wd.Time(new Date),this.notAfter=new Wd.Time(new Date),e&&(this.notBefore=new Wd.Time(e.notBefore),this.notAfter=new Wd.Time(e.notAfter))}};ux.Validity=Kg;b9.__decorate([(0,w9.AsnProp)({type:Wd.Time})],Kg.prototype,"notBefore",void 0);b9.__decorate([(0,w9.AsnProp)({type:Wd.Time})],Kg.prototype,"notAfter",void 0)});var px=g(Hc=>{"use strict";var Tj;Object.defineProperty(Hc,"__esModule",{value:!0});Hc.Extensions=Hc.Extension=void 0;var dx=(T(),C(I)),Pi=N(),bs=class t{constructor(e={}){this.extnID="",this.critical=t.CRITICAL,this.extnValue=new Pi.OctetString,Object.assign(this,e)}};Hc.Extension=bs;bs.CRITICAL=!1;dx.__decorate([(0,Pi.AsnProp)({type:Pi.AsnPropTypes.ObjectIdentifier})],bs.prototype,"extnID",void 0);dx.__decorate([(0,Pi.AsnProp)({type:Pi.AsnPropTypes.Boolean,defaultValue:bs.CRITICAL})],bs.prototype,"critical",void 0);dx.__decorate([(0,Pi.AsnProp)({type:Pi.OctetString})],bs.prototype,"extnValue",void 0);var Ej=Tj=class extends Pi.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Tj.prototype)}};Hc.Extensions=Ej;Hc.Extensions=Ej=Tj=dx.__decorate([(0,Pi.AsnType)({type:Pi.AsnTypeTypes.Sequence,itemType:bs})],Ej)});var Oj=g(fx=>{"use strict";Object.defineProperty(fx,"__esModule",{value:!0});fx.Version=void 0;var x9;(function(t){t[t.v1=0]="v1",t[t.v2=1]="v2",t[t.v3=2]="v3"})(x9||(fx.Version=x9={}))});var jj=g(hx=>{"use strict";Object.defineProperty(hx,"__esModule",{value:!0});hx.TBSCertificate=void 0;var Ci=(T(),C(I)),un=N(),S9=Zc(),mx=$d(),k9=Pj(),$9=Ij(),dpe=px(),A9=Oj(),Hn=class{constructor(e={}){this.version=A9.Version.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new S9.AlgorithmIdentifier,this.issuer=new mx.Name,this.validity=new $9.Validity,this.subject=new mx.Name,this.subjectPublicKeyInfo=new k9.SubjectPublicKeyInfo,Object.assign(this,e)}};hx.TBSCertificate=Hn;Ci.__decorate([(0,un.AsnProp)({type:un.AsnPropTypes.Integer,context:0,defaultValue:A9.Version.v1})],Hn.prototype,"version",void 0);Ci.__decorate([(0,un.AsnProp)({type:un.AsnPropTypes.Integer,converter:un.AsnIntegerArrayBufferConverter})],Hn.prototype,"serialNumber",void 0);Ci.__decorate([(0,un.AsnProp)({type:S9.AlgorithmIdentifier})],Hn.prototype,"signature",void 0);Ci.__decorate([(0,un.AsnProp)({type:mx.Name})],Hn.prototype,"issuer",void 0);Ci.__decorate([(0,un.AsnProp)({type:$9.Validity})],Hn.prototype,"validity",void 0);Ci.__decorate([(0,un.AsnProp)({type:mx.Name})],Hn.prototype,"subject",void 0);Ci.__decorate([(0,un.AsnProp)({type:k9.SubjectPublicKeyInfo})],Hn.prototype,"subjectPublicKeyInfo",void 0);Ci.__decorate([(0,un.AsnProp)({type:un.AsnPropTypes.BitString,context:1,implicit:!0,optional:!0})],Hn.prototype,"issuerUniqueID",void 0);Ci.__decorate([(0,un.AsnProp)({type:un.AsnPropTypes.BitString,context:2,implicit:!0,optional:!0})],Hn.prototype,"subjectUniqueID",void 0);Ci.__decorate([(0,un.AsnProp)({type:dpe.Extensions,context:3,optional:!0})],Hn.prototype,"extensions",void 0)});var I9=g(yx=>{"use strict";Object.defineProperty(yx,"__esModule",{value:!0});yx.Certificate=void 0;var Nj=(T(),C(I)),gx=N(),P9=Zc(),C9=jj(),Kd=class{constructor(e={}){this.tbsCertificate=new C9.TBSCertificate,this.signatureAlgorithm=new P9.AlgorithmIdentifier,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}};yx.Certificate=Kd;Nj.__decorate([(0,gx.AsnProp)({type:C9.TBSCertificate,raw:!0})],Kd.prototype,"tbsCertificate",void 0);Nj.__decorate([(0,gx.AsnProp)({type:P9.AlgorithmIdentifier})],Kd.prototype,"signatureAlgorithm",void 0);Nj.__decorate([(0,gx.AsnProp)({type:gx.AsnPropTypes.BitString})],Kd.prototype,"signatureValue",void 0)});var zj=g(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.TBSCertList=Jd.RevokedCertificate=void 0;var Ti=(T(),C(I)),Gn=N(),T9=Zc(),E9=$d(),Jg=lx(),O9=px(),Gc=class{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new Jg.Time,Object.assign(this,e)}};Jd.RevokedCertificate=Gc;Ti.__decorate([(0,Gn.AsnProp)({type:Gn.AsnPropTypes.Integer,converter:Gn.AsnIntegerArrayBufferConverter})],Gc.prototype,"userCertificate",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:Jg.Time})],Gc.prototype,"revocationDate",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:O9.Extension,optional:!0,repeated:"sequence"})],Gc.prototype,"crlEntryExtensions",void 0);var Ii=class{constructor(e={}){this.signature=new T9.AlgorithmIdentifier,this.issuer=new E9.Name,this.thisUpdate=new Jg.Time,Object.assign(this,e)}};Jd.TBSCertList=Ii;Ti.__decorate([(0,Gn.AsnProp)({type:Gn.AsnPropTypes.Integer,optional:!0})],Ii.prototype,"version",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:T9.AlgorithmIdentifier})],Ii.prototype,"signature",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:E9.Name})],Ii.prototype,"issuer",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:Jg.Time})],Ii.prototype,"thisUpdate",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:Jg.Time,optional:!0})],Ii.prototype,"nextUpdate",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:Gc,repeated:"sequence",optional:!0})],Ii.prototype,"revokedCertificates",void 0);Ti.__decorate([(0,Gn.AsnProp)({type:O9.Extension,optional:!0,context:0,repeated:"sequence"})],Ii.prototype,"crlExtensions",void 0)});var z9=g(_x=>{"use strict";Object.defineProperty(_x,"__esModule",{value:!0});_x.CertificateList=void 0;var Rj=(T(),C(I)),vx=N(),j9=Zc(),N9=zj(),Yd=class{constructor(e={}){this.tbsCertList=new N9.TBSCertList,this.signatureAlgorithm=new j9.AlgorithmIdentifier,this.signature=new ArrayBuffer(0),Object.assign(this,e)}};_x.CertificateList=Yd;Rj.__decorate([(0,vx.AsnProp)({type:N9.TBSCertList,raw:!0})],Yd.prototype,"tbsCertList",void 0);Rj.__decorate([(0,vx.AsnProp)({type:j9.AlgorithmIdentifier})],Yd.prototype,"signatureAlgorithm",void 0);Rj.__decorate([(0,vx.AsnProp)({type:vx.AsnPropTypes.BitString})],Yd.prototype,"signature",void 0)});var Ye=g(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});var Wr=(T(),C(I));Wr.__exportStar(g9(),xr);Wr.__exportStar(Zc(),xr);Wr.__exportStar(vj(),xr);Wr.__exportStar(I9(),xr);Wr.__exportStar(z9(),xr);Wr.__exportStar(px(),xr);Wr.__exportStar(Ic(),xr);Wr.__exportStar(jg(),xr);Wr.__exportStar($d(),xr);Wr.__exportStar(It(),xr);Wr.__exportStar(Pj(),xr);Wr.__exportStar(zj(),xr);Wr.__exportStar(jj(),xr);Wr.__exportStar(lx(),xr);Wr.__exportStar(Oj(),xr);Wr.__exportStar(Ij(),xr)});var Xg=g(wx=>{"use strict";Object.defineProperty(wx,"__esModule",{value:!0});wx.IssuerAndSerialNumber=void 0;var R9=(T(),C(I)),bx=N(),M9=Ye(),Yg=class{constructor(e={}){this.issuer=new M9.Name,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}};wx.IssuerAndSerialNumber=Yg;R9.__decorate([(0,bx.AsnProp)({type:M9.Name})],Yg.prototype,"issuer",void 0);R9.__decorate([(0,bx.AsnProp)({type:bx.AsnPropTypes.Integer,converter:bx.AsnIntegerArrayBufferConverter})],Yg.prototype,"serialNumber",void 0)});var qj=g(ey=>{"use strict";Object.defineProperty(ey,"__esModule",{value:!0});ey.SignerIdentifier=void 0;var Mj=(T(),C(I)),xx=N(),ppe=Xg(),fpe=Ye(),Qg=class{constructor(e={}){Object.assign(this,e)}};ey.SignerIdentifier=Qg;Mj.__decorate([(0,xx.AsnProp)({type:fpe.SubjectKeyIdentifier,context:0,implicit:!0})],Qg.prototype,"subjectKeyIdentifier",void 0);Mj.__decorate([(0,xx.AsnProp)({type:ppe.IssuerAndSerialNumber})],Qg.prototype,"issuerAndSerialNumber",void 0);ey.SignerIdentifier=Qg=Mj.__decorate([(0,xx.AsnType)({type:xx.AsnTypeTypes.Choice})],Qg)});var Ei=g(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.KeyDerivationAlgorithmIdentifier=Yt.MessageAuthenticationCodeAlgorithm=Yt.ContentEncryptionAlgorithmIdentifier=Yt.KeyEncryptionAlgorithmIdentifier=Yt.SignatureAlgorithmIdentifier=Yt.DigestAlgorithmIdentifier=Yt.CMSVersion=void 0;var Xd=(T(),C(I)),Qd=Ye(),vo=N(),q9;(function(t){t[t.v0=0]="v0",t[t.v1=1]="v1",t[t.v2=2]="v2",t[t.v3=3]="v3",t[t.v4=4]="v4",t[t.v5=5]="v5"})(q9||(Yt.CMSVersion=q9={}));var Dj=class extends Qd.AlgorithmIdentifier{};Yt.DigestAlgorithmIdentifier=Dj;Yt.DigestAlgorithmIdentifier=Dj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Dj);var Bj=class extends Qd.AlgorithmIdentifier{};Yt.SignatureAlgorithmIdentifier=Bj;Yt.SignatureAlgorithmIdentifier=Bj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Bj);var Uj=class extends Qd.AlgorithmIdentifier{};Yt.KeyEncryptionAlgorithmIdentifier=Uj;Yt.KeyEncryptionAlgorithmIdentifier=Uj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Uj);var Lj=class extends Qd.AlgorithmIdentifier{};Yt.ContentEncryptionAlgorithmIdentifier=Lj;Yt.ContentEncryptionAlgorithmIdentifier=Lj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Lj);var Fj=class extends Qd.AlgorithmIdentifier{};Yt.MessageAuthenticationCodeAlgorithm=Fj;Yt.MessageAuthenticationCodeAlgorithm=Fj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Fj);var Vj=class extends Qd.AlgorithmIdentifier{};Yt.KeyDerivationAlgorithmIdentifier=Vj;Yt.KeyDerivationAlgorithmIdentifier=Vj=Xd.__decorate([(0,vo.AsnType)({type:vo.AsnTypeTypes.Sequence})],Vj)});var $x=g(kx=>{"use strict";Object.defineProperty(kx,"__esModule",{value:!0});kx.Attribute=void 0;var D9=(T(),C(I)),Sx=N(),ty=class{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}};kx.Attribute=ty;D9.__decorate([(0,Sx.AsnProp)({type:Sx.AsnPropTypes.ObjectIdentifier})],ty.prototype,"attrType",void 0);D9.__decorate([(0,Sx.AsnProp)({type:Sx.AsnPropTypes.Any,repeated:"set"})],ty.prototype,"attrValues",void 0)});var Ax=g(Wc=>{"use strict";var Zj;Object.defineProperty(Wc,"__esModule",{value:!0});Wc.SignerInfos=Wc.SignerInfo=void 0;var ga=(T(),C(I)),Wn=N(),B9=qj(),ry=Ei(),U9=$x(),Go=class{constructor(e={}){this.version=ry.CMSVersion.v0,this.sid=new B9.SignerIdentifier,this.digestAlgorithm=new ry.DigestAlgorithmIdentifier,this.signatureAlgorithm=new ry.SignatureAlgorithmIdentifier,this.signature=new Wn.OctetString,Object.assign(this,e)}};Wc.SignerInfo=Go;ga.__decorate([(0,Wn.AsnProp)({type:Wn.AsnPropTypes.Integer})],Go.prototype,"version",void 0);ga.__decorate([(0,Wn.AsnProp)({type:B9.SignerIdentifier})],Go.prototype,"sid",void 0);ga.__decorate([(0,Wn.AsnProp)({type:ry.DigestAlgorithmIdentifier})],Go.prototype,"digestAlgorithm",void 0);ga.__decorate([(0,Wn.AsnProp)({type:U9.Attribute,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],Go.prototype,"signedAttrs",void 0);ga.__decorate([(0,Wn.AsnProp)({type:ry.SignatureAlgorithmIdentifier})],Go.prototype,"signatureAlgorithm",void 0);ga.__decorate([(0,Wn.AsnProp)({type:Wn.OctetString})],Go.prototype,"signature",void 0);ga.__decorate([(0,Wn.AsnProp)({type:U9.Attribute,repeated:"set",context:1,implicit:!0,optional:!0})],Go.prototype,"unsignedAttrs",void 0);var Hj=Zj=class extends Wn.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Zj.prototype)}};Wc.SignerInfos=Hj;Wc.SignerInfos=Hj=Zj=ga.__decorate([(0,Wn.AsnType)({type:Wn.AsnTypeTypes.Set,itemType:Go})],Hj)});var F9=g(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.CounterSignature=Kc.id_counterSignature=void 0;var mpe=(T(),C(I)),L9=N(),hpe=Ax();Kc.id_counterSignature="1.2.840.113549.1.9.6";var Gj=class extends hpe.SignerInfo{};Kc.CounterSignature=Gj;Kc.CounterSignature=Gj=mpe.__decorate([(0,L9.AsnType)({type:L9.AsnTypeTypes.Sequence})],Gj)});var V9=g(ep=>{"use strict";Object.defineProperty(ep,"__esModule",{value:!0});ep.MessageDigest=ep.id_messageDigest=void 0;var gpe=N();ep.id_messageDigest="1.2.840.113549.1.9.4";var Wj=class extends gpe.OctetString{};ep.MessageDigest=Wj});var H9=g(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.SigningTime=Jc.id_signingTime=void 0;var ype=(T(),C(I)),vpe=Ye(),Z9=N();Jc.id_signingTime="1.2.840.113549.1.9.5";var Kj=class extends vpe.Time{};Jc.SigningTime=Kj;Jc.SigningTime=Kj=ype.__decorate([(0,Z9.AsnType)({type:Z9.AsnTypeTypes.Choice})],Kj)});var G9=g(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.id_contentType=void 0;var Jj=(T(),C(I));Jj.__exportStar(F9(),Yc);Jj.__exportStar(V9(),Yc);Jj.__exportStar(H9(),Yc);Yc.id_contentType="1.2.840.113549.1.9.3"});var W9=g(Cx=>{"use strict";Object.defineProperty(Cx,"__esModule",{value:!0});Cx.ACClearAttrs=void 0;var Yj=(T(),C(I)),Px=N(),Xj=Ye(),tp=class{constructor(e={}){this.acIssuer=new Xj.GeneralName,this.acSerial=0,this.attrs=[],Object.assign(this,e)}};Cx.ACClearAttrs=tp;Yj.__decorate([(0,Px.AsnProp)({type:Xj.GeneralName})],tp.prototype,"acIssuer",void 0);Yj.__decorate([(0,Px.AsnProp)({type:Px.AsnPropTypes.Integer})],tp.prototype,"acSerial",void 0);Yj.__decorate([(0,Px.AsnProp)({type:Xj.Attribute,repeated:"sequence"})],tp.prototype,"attrs",void 0)});var tN=g(ny=>{"use strict";var Qj;Object.defineProperty(ny,"__esModule",{value:!0});ny.AttrSpec=void 0;var _pe=(T(),C(I)),Ix=N(),eN=Qj=class extends Ix.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Qj.prototype)}};ny.AttrSpec=eN;ny.AttrSpec=eN=Qj=_pe.__decorate([(0,Ix.AsnType)({type:Ix.AsnTypeTypes.Sequence,itemType:Ix.AsnPropTypes.ObjectIdentifier})],eN)});var J9=g(Ex=>{"use strict";Object.defineProperty(Ex,"__esModule",{value:!0});Ex.AAControls=void 0;var Tx=(T(),C(I)),rp=N(),K9=tN(),Xc=class{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}};Ex.AAControls=Xc;Tx.__decorate([(0,rp.AsnProp)({type:rp.AsnPropTypes.Integer,optional:!0})],Xc.prototype,"pathLenConstraint",void 0);Tx.__decorate([(0,rp.AsnProp)({type:K9.AttrSpec,implicit:!0,context:0,optional:!0})],Xc.prototype,"permittedAttrs",void 0);Tx.__decorate([(0,rp.AsnProp)({type:K9.AttrSpec,implicit:!0,context:1,optional:!0})],Xc.prototype,"excludedAttrs",void 0);Tx.__decorate([(0,rp.AsnProp)({type:rp.AsnPropTypes.Boolean,defaultValue:!0})],Xc.prototype,"permitUnSpecified",void 0)});var oy=g(Ox=>{"use strict";Object.defineProperty(Ox,"__esModule",{value:!0});Ox.IssuerSerial=void 0;var rN=(T(),C(I)),np=N(),Y9=Ye(),op=class{constructor(e={}){this.issuer=new Y9.GeneralNames,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}};Ox.IssuerSerial=op;rN.__decorate([(0,np.AsnProp)({type:Y9.GeneralNames})],op.prototype,"issuer",void 0);rN.__decorate([(0,np.AsnProp)({type:np.AsnPropTypes.Integer,converter:np.AsnIntegerArrayBufferConverter})],op.prototype,"serial",void 0);rN.__decorate([(0,np.AsnProp)({type:np.AsnPropTypes.BitString,optional:!0})],op.prototype,"issuerUID",void 0)});var iy=g(ip=>{"use strict";Object.defineProperty(ip,"__esModule",{value:!0});ip.ObjectDigestInfo=ip.DigestedObjectType=void 0;var jx=(T(),C(I)),Qc=N(),X9=Ye(),nN;(function(t){t[t.publicKey=0]="publicKey",t[t.publicKeyCert=1]="publicKeyCert",t[t.otherObjectTypes=2]="otherObjectTypes"})(nN||(ip.DigestedObjectType=nN={}));var el=class{constructor(e={}){this.digestedObjectType=nN.publicKey,this.digestAlgorithm=new X9.AlgorithmIdentifier,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}};ip.ObjectDigestInfo=el;jx.__decorate([(0,Qc.AsnProp)({type:Qc.AsnPropTypes.Enumerated})],el.prototype,"digestedObjectType",void 0);jx.__decorate([(0,Qc.AsnProp)({type:Qc.AsnPropTypes.ObjectIdentifier,optional:!0})],el.prototype,"otherObjectTypeID",void 0);jx.__decorate([(0,Qc.AsnProp)({type:X9.AlgorithmIdentifier})],el.prototype,"digestAlgorithm",void 0);jx.__decorate([(0,Qc.AsnProp)({type:Qc.AsnPropTypes.BitString})],el.prototype,"objectDigest",void 0)});var sN=g(Nx=>{"use strict";Object.defineProperty(Nx,"__esModule",{value:!0});Nx.V2Form=void 0;var oN=(T(),C(I)),iN=N(),bpe=Ye(),wpe=oy(),xpe=iy(),sp=class{constructor(e={}){Object.assign(this,e)}};Nx.V2Form=sp;oN.__decorate([(0,iN.AsnProp)({type:bpe.GeneralNames,optional:!0})],sp.prototype,"issuerName",void 0);oN.__decorate([(0,iN.AsnProp)({type:wpe.IssuerSerial,context:0,implicit:!0,optional:!0})],sp.prototype,"baseCertificateID",void 0);oN.__decorate([(0,iN.AsnProp)({type:xpe.ObjectDigestInfo,context:1,implicit:!0,optional:!0})],sp.prototype,"objectDigestInfo",void 0)});var cN=g(ay=>{"use strict";Object.defineProperty(ay,"__esModule",{value:!0});ay.AttCertIssuer=void 0;var aN=(T(),C(I)),zx=N(),Spe=Ye(),kpe=sN(),sy=class{constructor(e={}){Object.assign(this,e)}};ay.AttCertIssuer=sy;aN.__decorate([(0,zx.AsnProp)({type:Spe.GeneralName,repeated:"sequence"})],sy.prototype,"v1Form",void 0);aN.__decorate([(0,zx.AsnProp)({type:kpe.V2Form,context:0,implicit:!0})],sy.prototype,"v2Form",void 0);ay.AttCertIssuer=sy=aN.__decorate([(0,zx.AsnType)({type:zx.AsnTypeTypes.Choice})],sy)});var lN=g(Mx=>{"use strict";Object.defineProperty(Mx,"__esModule",{value:!0});Mx.AttCertValidityPeriod=void 0;var Q9=(T(),C(I)),Rx=N(),cy=class{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}};Mx.AttCertValidityPeriod=cy;Q9.__decorate([(0,Rx.AsnProp)({type:Rx.AsnPropTypes.GeneralizedTime})],cy.prototype,"notBeforeTime",void 0);Q9.__decorate([(0,Rx.AsnProp)({type:Rx.AsnPropTypes.GeneralizedTime})],cy.prototype,"notAfterTime",void 0)});var pN=g(qx=>{"use strict";Object.defineProperty(qx,"__esModule",{value:!0});qx.Holder=void 0;var uN=(T(),C(I)),dN=N(),$pe=oy(),Ape=Ye(),Ppe=iy(),ap=class{constructor(e={}){Object.assign(this,e)}};qx.Holder=ap;uN.__decorate([(0,dN.AsnProp)({type:$pe.IssuerSerial,implicit:!0,context:0,optional:!0})],ap.prototype,"baseCertificateID",void 0);uN.__decorate([(0,dN.AsnProp)({type:Ape.GeneralNames,implicit:!0,context:1,optional:!0})],ap.prototype,"entityName",void 0);uN.__decorate([(0,dN.AsnProp)({type:Ppe.ObjectDigestInfo,implicit:!0,context:2,optional:!0})],ap.prototype,"objectDigestInfo",void 0)});var mN=g(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0});cp.AttributeCertificateInfo=cp.AttCertVersion=void 0;var ws=(T(),C(I)),Kn=N(),Dx=Ye(),e5=pN(),t5=cN(),r5=lN(),fN;(function(t){t[t.v2=1]="v2"})(fN||(cp.AttCertVersion=fN={}));var _o=class{constructor(e={}){this.version=fN.v2,this.holder=new e5.Holder,this.issuer=new t5.AttCertIssuer,this.signature=new Dx.AlgorithmIdentifier,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new r5.AttCertValidityPeriod,this.attributes=[],Object.assign(this,e)}};cp.AttributeCertificateInfo=_o;ws.__decorate([(0,Kn.AsnProp)({type:Kn.AsnPropTypes.Integer})],_o.prototype,"version",void 0);ws.__decorate([(0,Kn.AsnProp)({type:e5.Holder})],_o.prototype,"holder",void 0);ws.__decorate([(0,Kn.AsnProp)({type:t5.AttCertIssuer})],_o.prototype,"issuer",void 0);ws.__decorate([(0,Kn.AsnProp)({type:Dx.AlgorithmIdentifier})],_o.prototype,"signature",void 0);ws.__decorate([(0,Kn.AsnProp)({type:Kn.AsnPropTypes.Integer,converter:Kn.AsnIntegerArrayBufferConverter})],_o.prototype,"serialNumber",void 0);ws.__decorate([(0,Kn.AsnProp)({type:r5.AttCertValidityPeriod})],_o.prototype,"attrCertValidityPeriod",void 0);ws.__decorate([(0,Kn.AsnProp)({type:Dx.Attribute,repeated:"sequence"})],_o.prototype,"attributes",void 0);ws.__decorate([(0,Kn.AsnProp)({type:Kn.AsnPropTypes.BitString,optional:!0})],_o.prototype,"issuerUniqueID",void 0);ws.__decorate([(0,Kn.AsnProp)({type:Dx.Extensions,optional:!0})],_o.prototype,"extensions",void 0)});var i5=g(Ux=>{"use strict";Object.defineProperty(Ux,"__esModule",{value:!0});Ux.AttributeCertificate=void 0;var hN=(T(),C(I)),Bx=N(),n5=Ye(),o5=mN(),lp=class{constructor(e={}){this.acinfo=new o5.AttributeCertificateInfo,this.signatureAlgorithm=new n5.AlgorithmIdentifier,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}};Ux.AttributeCertificate=lp;hN.__decorate([(0,Bx.AsnProp)({type:o5.AttributeCertificateInfo})],lp.prototype,"acinfo",void 0);hN.__decorate([(0,Bx.AsnProp)({type:n5.AlgorithmIdentifier})],lp.prototype,"signatureAlgorithm",void 0);hN.__decorate([(0,Bx.AsnProp)({type:Bx.AsnPropTypes.BitString})],lp.prototype,"signatureValue",void 0)});var yN=g(up=>{"use strict";Object.defineProperty(up,"__esModule",{value:!0});up.ClassList=up.ClassListFlags=void 0;var Cpe=N(),s5;(function(t){t[t.unmarked=1]="unmarked",t[t.unclassified=2]="unclassified",t[t.restricted=4]="restricted",t[t.confidential=8]="confidential",t[t.secret=16]="secret",t[t.topSecret=32]="topSecret"})(s5||(up.ClassListFlags=s5={}));var gN=class extends Cpe.BitString{};up.ClassList=gN});var vN=g(Fx=>{"use strict";Object.defineProperty(Fx,"__esModule",{value:!0});Fx.SecurityCategory=void 0;var a5=(T(),C(I)),Lx=N(),ly=class{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}};Fx.SecurityCategory=ly;a5.__decorate([(0,Lx.AsnProp)({type:Lx.AsnPropTypes.ObjectIdentifier,implicit:!0,context:0})],ly.prototype,"type",void 0);a5.__decorate([(0,Lx.AsnProp)({type:Lx.AsnPropTypes.Any,implicit:!0,context:1})],ly.prototype,"value",void 0)});var c5=g(Zx=>{"use strict";Object.defineProperty(Zx,"__esModule",{value:!0});Zx.Clearance=void 0;var _N=(T(),C(I)),Vx=N(),uy=yN(),Ipe=vN(),dp=class{constructor(e={}){this.policyId="",this.classList=new uy.ClassList(uy.ClassListFlags.unclassified),Object.assign(this,e)}};Zx.Clearance=dp;_N.__decorate([(0,Vx.AsnProp)({type:Vx.AsnPropTypes.ObjectIdentifier})],dp.prototype,"policyId",void 0);_N.__decorate([(0,Vx.AsnProp)({type:uy.ClassList,defaultValue:new uy.ClassList(uy.ClassListFlags.unclassified)})],dp.prototype,"classList",void 0);_N.__decorate([(0,Vx.AsnProp)({type:Ipe.SecurityCategory,repeated:"set"})],dp.prototype,"securityCategories",void 0)});var l5=g(pp=>{"use strict";Object.defineProperty(pp,"__esModule",{value:!0});pp.IetfAttrSyntax=pp.IetfAttrSyntaxValueChoices=void 0;var py=(T(),C(I)),ya=N(),Tpe=Ye(),tl=class{constructor(e={}){Object.assign(this,e)}};pp.IetfAttrSyntaxValueChoices=tl;py.__decorate([(0,ya.AsnProp)({type:ya.OctetString})],tl.prototype,"cotets",void 0);py.__decorate([(0,ya.AsnProp)({type:ya.AsnPropTypes.ObjectIdentifier})],tl.prototype,"oid",void 0);py.__decorate([(0,ya.AsnProp)({type:ya.AsnPropTypes.Utf8String})],tl.prototype,"string",void 0);var dy=class{constructor(e={}){this.values=[],Object.assign(this,e)}};pp.IetfAttrSyntax=dy;py.__decorate([(0,ya.AsnProp)({type:Tpe.GeneralNames,implicit:!0,context:0,optional:!0})],dy.prototype,"policyAuthority",void 0);py.__decorate([(0,ya.AsnProp)({type:tl,repeated:"sequence"})],dy.prototype,"values",void 0)});var u5=g(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.id_at_clearance=Xe.id_at_role=Xe.id_at=Xe.id_aca_encAttrs=Xe.id_aca_group=Xe.id_aca_chargingIdentity=Xe.id_aca_accessIdentity=Xe.id_aca_authenticationInfo=Xe.id_aca=Xe.id_ce_targetInformation=Xe.id_pe_ac_proxying=Xe.id_pe_aaControls=Xe.id_pe_ac_auditIdentity=void 0;var fy=Ye();Xe.id_pe_ac_auditIdentity=`${fy.id_pe}.4`;Xe.id_pe_aaControls=`${fy.id_pe}.6`;Xe.id_pe_ac_proxying=`${fy.id_pe}.10`;Xe.id_ce_targetInformation=`${fy.id_ce}.55`;Xe.id_aca=`${fy.id_pkix}.10`;Xe.id_aca_authenticationInfo=`${Xe.id_aca}.1`;Xe.id_aca_accessIdentity=`${Xe.id_aca}.2`;Xe.id_aca_chargingIdentity=`${Xe.id_aca}.3`;Xe.id_aca_group=`${Xe.id_aca}.4`;Xe.id_aca_encAttrs=`${Xe.id_aca}.6`;Xe.id_at="2.5.4";Xe.id_at_role=`${Xe.id_at}.72`;Xe.id_at_clearance="2.5.1.5.55"});var SN=g(Oi=>{"use strict";var bN;Object.defineProperty(Oi,"__esModule",{value:!0});Oi.Targets=Oi.Target=Oi.TargetCert=void 0;var va=(T(),C(I)),Wo=N(),xN=Ye(),d5=oy(),Epe=iy(),rl=class{constructor(e={}){this.targetCertificate=new d5.IssuerSerial,Object.assign(this,e)}};Oi.TargetCert=rl;va.__decorate([(0,Wo.AsnProp)({type:d5.IssuerSerial})],rl.prototype,"targetCertificate",void 0);va.__decorate([(0,Wo.AsnProp)({type:xN.GeneralName,optional:!0})],rl.prototype,"targetName",void 0);va.__decorate([(0,Wo.AsnProp)({type:Epe.ObjectDigestInfo,optional:!0})],rl.prototype,"certDigestInfo",void 0);var nl=class{constructor(e={}){Object.assign(this,e)}};Oi.Target=nl;va.__decorate([(0,Wo.AsnProp)({type:xN.GeneralName,context:0,implicit:!0})],nl.prototype,"targetName",void 0);va.__decorate([(0,Wo.AsnProp)({type:xN.GeneralName,context:1,implicit:!0})],nl.prototype,"targetGroup",void 0);va.__decorate([(0,Wo.AsnProp)({type:rl,context:2,implicit:!0})],nl.prototype,"targetCert",void 0);Oi.Target=nl=va.__decorate([(0,Wo.AsnType)({type:Wo.AsnTypeTypes.Choice})],nl);var wN=bN=class extends Wo.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,bN.prototype)}};Oi.Targets=wN;Oi.Targets=wN=bN=va.__decorate([(0,Wo.AsnType)({type:Wo.AsnTypeTypes.Sequence,itemType:nl})],wN)});var p5=g(my=>{"use strict";var kN;Object.defineProperty(my,"__esModule",{value:!0});my.ProxyInfo=void 0;var Ope=(T(),C(I)),$N=N(),jpe=SN(),AN=kN=class extends $N.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,kN.prototype)}};my.ProxyInfo=AN;my.ProxyInfo=AN=kN=Ope.__decorate([(0,$N.AsnType)({type:$N.AsnTypeTypes.Sequence,itemType:jpe.Targets})],AN)});var g5=g(Hx=>{"use strict";Object.defineProperty(Hx,"__esModule",{value:!0});Hx.RoleSyntax=void 0;var f5=(T(),C(I)),m5=N(),h5=Ye(),hy=class{constructor(e={}){Object.assign(this,e)}};Hx.RoleSyntax=hy;f5.__decorate([(0,m5.AsnProp)({type:h5.GeneralNames,implicit:!0,context:0,optional:!0})],hy.prototype,"roleAuthority",void 0);f5.__decorate([(0,m5.AsnProp)({type:h5.GeneralName,implicit:!0,context:1})],hy.prototype,"roleName",void 0)});var y5=g(Kx=>{"use strict";Object.defineProperty(Kx,"__esModule",{value:!0});Kx.SvceAuthInfo=void 0;var PN=(T(),C(I)),Gx=N(),Wx=Ye(),fp=class{constructor(e={}){this.service=new Wx.GeneralName,this.ident=new Wx.GeneralName,Object.assign(this,e)}};Kx.SvceAuthInfo=fp;PN.__decorate([(0,Gx.AsnProp)({type:Wx.GeneralName})],fp.prototype,"service",void 0);PN.__decorate([(0,Gx.AsnProp)({type:Wx.GeneralName})],fp.prototype,"ident",void 0);PN.__decorate([(0,Gx.AsnProp)({type:Gx.OctetString,optional:!0})],fp.prototype,"authInfo",void 0)});var CN=g(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});var ur=(T(),C(I));ur.__exportStar(W9(),Xt);ur.__exportStar(J9(),Xt);ur.__exportStar(cN(),Xt);ur.__exportStar(lN(),Xt);ur.__exportStar(tN(),Xt);ur.__exportStar(i5(),Xt);ur.__exportStar(mN(),Xt);ur.__exportStar(yN(),Xt);ur.__exportStar(c5(),Xt);ur.__exportStar(pN(),Xt);ur.__exportStar(l5(),Xt);ur.__exportStar(oy(),Xt);ur.__exportStar(iy(),Xt);ur.__exportStar(u5(),Xt);ur.__exportStar(p5(),Xt);ur.__exportStar(g5(),Xt);ur.__exportStar(vN(),Xt);ur.__exportStar(y5(),Xt);ur.__exportStar(SN(),Xt);ur.__exportStar(sN(),Xt)});var Jx=g(ji=>{"use strict";var IN;Object.defineProperty(ji,"__esModule",{value:!0});ji.CertificateSet=ji.CertificateChoices=ji.OtherCertificateFormat=void 0;var il=(T(),C(I)),bo=N(),Npe=Ye(),zpe=CN(),mp=class{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}};ji.OtherCertificateFormat=mp;il.__decorate([(0,bo.AsnProp)({type:bo.AsnPropTypes.ObjectIdentifier})],mp.prototype,"otherCertFormat",void 0);il.__decorate([(0,bo.AsnProp)({type:bo.AsnPropTypes.Any})],mp.prototype,"otherCert",void 0);var ol=class{constructor(e={}){Object.assign(this,e)}};ji.CertificateChoices=ol;il.__decorate([(0,bo.AsnProp)({type:Npe.Certificate})],ol.prototype,"certificate",void 0);il.__decorate([(0,bo.AsnProp)({type:zpe.AttributeCertificate,context:2,implicit:!0})],ol.prototype,"v2AttrCert",void 0);il.__decorate([(0,bo.AsnProp)({type:mp,context:3,implicit:!0})],ol.prototype,"other",void 0);ji.CertificateChoices=ol=il.__decorate([(0,bo.AsnType)({type:bo.AsnTypeTypes.Choice})],ol);var TN=IN=class extends bo.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,IN.prototype)}};ji.CertificateSet=TN;ji.CertificateSet=TN=IN=il.__decorate([(0,bo.AsnType)({type:bo.AsnTypeTypes.Set,itemType:ol})],TN)});var _5=g(Xx=>{"use strict";Object.defineProperty(Xx,"__esModule",{value:!0});Xx.ContentInfo=void 0;var v5=(T(),C(I)),Yx=N(),gy=class{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}};Xx.ContentInfo=gy;v5.__decorate([(0,Yx.AsnProp)({type:Yx.AsnPropTypes.ObjectIdentifier})],gy.prototype,"contentType",void 0);v5.__decorate([(0,Yx.AsnProp)({type:Yx.AsnPropTypes.Any,context:0})],gy.prototype,"content",void 0)});var EN=g(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.EncapsulatedContentInfo=sl.EncapsulatedContent=void 0;var vy=(T(),C(I)),xs=N(),hp=class{constructor(e={}){Object.assign(this,e)}};sl.EncapsulatedContent=hp;vy.__decorate([(0,xs.AsnProp)({type:xs.OctetString})],hp.prototype,"single",void 0);vy.__decorate([(0,xs.AsnProp)({type:xs.AsnPropTypes.Any})],hp.prototype,"any",void 0);sl.EncapsulatedContent=hp=vy.__decorate([(0,xs.AsnType)({type:xs.AsnTypeTypes.Choice})],hp);var yy=class{constructor(e={}){this.eContentType="",Object.assign(this,e)}};sl.EncapsulatedContentInfo=yy;vy.__decorate([(0,xs.AsnProp)({type:xs.AsnPropTypes.ObjectIdentifier})],yy.prototype,"eContentType",void 0);vy.__decorate([(0,xs.AsnProp)({type:hp,context:0,optional:!0})],yy.prototype,"eContent",void 0)});var ON=g(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});al.EncryptedContentInfo=al.EncryptedContent=void 0;var vp=(T(),C(I)),Ko=N(),b5=Ei(),gp=class{constructor(e={}){Object.assign(this,e)}};al.EncryptedContent=gp;vp.__decorate([(0,Ko.AsnProp)({type:Ko.OctetString,context:0,implicit:!0,optional:!0})],gp.prototype,"value",void 0);vp.__decorate([(0,Ko.AsnProp)({type:Ko.OctetString,converter:Ko.AsnConstructedOctetStringConverter,context:0,implicit:!0,optional:!0,repeated:"sequence"})],gp.prototype,"constructedValue",void 0);al.EncryptedContent=gp=vp.__decorate([(0,Ko.AsnType)({type:Ko.AsnTypeTypes.Choice})],gp);var yp=class{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new b5.ContentEncryptionAlgorithmIdentifier,Object.assign(this,e)}};al.EncryptedContentInfo=yp;vp.__decorate([(0,Ko.AsnProp)({type:Ko.AsnPropTypes.ObjectIdentifier})],yp.prototype,"contentType",void 0);vp.__decorate([(0,Ko.AsnProp)({type:b5.ContentEncryptionAlgorithmIdentifier})],yp.prototype,"contentEncryptionAlgorithm",void 0);vp.__decorate([(0,Ko.AsnProp)({type:gp,optional:!0})],yp.prototype,"encryptedContent",void 0)});var jN=g(eS=>{"use strict";Object.defineProperty(eS,"__esModule",{value:!0});eS.OtherKeyAttribute=void 0;var w5=(T(),C(I)),Qx=N(),_y=class{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}};eS.OtherKeyAttribute=_y;w5.__decorate([(0,Qx.AsnProp)({type:Qx.AsnPropTypes.ObjectIdentifier})],_y.prototype,"keyAttrId",void 0);w5.__decorate([(0,Qx.AsnProp)({type:Qx.AsnPropTypes.Any,optional:!0})],_y.prototype,"keyAttr",void 0)});var RN=g(gr=>{"use strict";var NN;Object.defineProperty(gr,"__esModule",{value:!0});gr.KeyAgreeRecipientInfo=gr.OriginatorIdentifierOrKey=gr.OriginatorPublicKey=gr.RecipientEncryptedKeys=gr.RecipientEncryptedKey=gr.KeyAgreeRecipientIdentifier=gr.RecipientKeyIdentifier=void 0;var dr=(T(),C(I)),ct=N(),zN=Ei(),x5=Xg(),wy=Ye(),Rpe=jN(),cl=class{constructor(e={}){this.subjectKeyIdentifier=new wy.SubjectKeyIdentifier,Object.assign(this,e)}};gr.RecipientKeyIdentifier=cl;dr.__decorate([(0,ct.AsnProp)({type:wy.SubjectKeyIdentifier})],cl.prototype,"subjectKeyIdentifier",void 0);dr.__decorate([(0,ct.AsnProp)({type:ct.AsnPropTypes.GeneralizedTime,optional:!0})],cl.prototype,"date",void 0);dr.__decorate([(0,ct.AsnProp)({type:Rpe.OtherKeyAttribute,optional:!0})],cl.prototype,"other",void 0);var ll=class{constructor(e={}){Object.assign(this,e)}};gr.KeyAgreeRecipientIdentifier=ll;dr.__decorate([(0,ct.AsnProp)({type:cl,context:0,implicit:!0,optional:!0})],ll.prototype,"rKeyId",void 0);dr.__decorate([(0,ct.AsnProp)({type:x5.IssuerAndSerialNumber,optional:!0})],ll.prototype,"issuerAndSerialNumber",void 0);gr.KeyAgreeRecipientIdentifier=ll=dr.__decorate([(0,ct.AsnType)({type:ct.AsnTypeTypes.Choice})],ll);var _p=class{constructor(e={}){this.rid=new ll,this.encryptedKey=new ct.OctetString,Object.assign(this,e)}};gr.RecipientEncryptedKey=_p;dr.__decorate([(0,ct.AsnProp)({type:ll})],_p.prototype,"rid",void 0);dr.__decorate([(0,ct.AsnProp)({type:ct.OctetString})],_p.prototype,"encryptedKey",void 0);var by=NN=class extends ct.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,NN.prototype)}};gr.RecipientEncryptedKeys=by;gr.RecipientEncryptedKeys=by=NN=dr.__decorate([(0,ct.AsnType)({type:ct.AsnTypeTypes.Sequence,itemType:_p})],by);var bp=class{constructor(e={}){this.algorithm=new wy.AlgorithmIdentifier,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}};gr.OriginatorPublicKey=bp;dr.__decorate([(0,ct.AsnProp)({type:wy.AlgorithmIdentifier})],bp.prototype,"algorithm",void 0);dr.__decorate([(0,ct.AsnProp)({type:ct.AsnPropTypes.BitString})],bp.prototype,"publicKey",void 0);var _a=class{constructor(e={}){Object.assign(this,e)}};gr.OriginatorIdentifierOrKey=_a;dr.__decorate([(0,ct.AsnProp)({type:wy.SubjectKeyIdentifier,context:0,implicit:!0,optional:!0})],_a.prototype,"subjectKeyIdentifier",void 0);dr.__decorate([(0,ct.AsnProp)({type:bp,context:1,implicit:!0,optional:!0})],_a.prototype,"originatorKey",void 0);dr.__decorate([(0,ct.AsnProp)({type:x5.IssuerAndSerialNumber,optional:!0})],_a.prototype,"issuerAndSerialNumber",void 0);gr.OriginatorIdentifierOrKey=_a=dr.__decorate([(0,ct.AsnType)({type:ct.AsnTypeTypes.Choice})],_a);var ba=class{constructor(e={}){this.version=zN.CMSVersion.v3,this.originator=new _a,this.keyEncryptionAlgorithm=new zN.KeyEncryptionAlgorithmIdentifier,this.recipientEncryptedKeys=new by,Object.assign(this,e)}};gr.KeyAgreeRecipientInfo=ba;dr.__decorate([(0,ct.AsnProp)({type:ct.AsnPropTypes.Integer})],ba.prototype,"version",void 0);dr.__decorate([(0,ct.AsnProp)({type:_a,context:0})],ba.prototype,"originator",void 0);dr.__decorate([(0,ct.AsnProp)({type:ct.OctetString,context:1,optional:!0})],ba.prototype,"ukm",void 0);dr.__decorate([(0,ct.AsnProp)({type:zN.KeyEncryptionAlgorithmIdentifier})],ba.prototype,"keyEncryptionAlgorithm",void 0);dr.__decorate([(0,ct.AsnProp)({type:by})],ba.prototype,"recipientEncryptedKeys",void 0)});var qN=g(pl=>{"use strict";Object.defineProperty(pl,"__esModule",{value:!0});pl.KeyTransRecipientInfo=pl.RecipientIdentifier=void 0;var fl=(T(),C(I)),Jo=N(),MN=Ei(),Mpe=Xg(),qpe=Ye(),ul=class{constructor(e={}){Object.assign(this,e)}};pl.RecipientIdentifier=ul;fl.__decorate([(0,Jo.AsnProp)({type:qpe.SubjectKeyIdentifier,context:0,implicit:!0})],ul.prototype,"subjectKeyIdentifier",void 0);fl.__decorate([(0,Jo.AsnProp)({type:Mpe.IssuerAndSerialNumber})],ul.prototype,"issuerAndSerialNumber",void 0);pl.RecipientIdentifier=ul=fl.__decorate([(0,Jo.AsnType)({type:Jo.AsnTypeTypes.Choice})],ul);var dl=class{constructor(e={}){this.version=MN.CMSVersion.v0,this.rid=new ul,this.keyEncryptionAlgorithm=new MN.KeyEncryptionAlgorithmIdentifier,this.encryptedKey=new Jo.OctetString,Object.assign(this,e)}};pl.KeyTransRecipientInfo=dl;fl.__decorate([(0,Jo.AsnProp)({type:Jo.AsnPropTypes.Integer})],dl.prototype,"version",void 0);fl.__decorate([(0,Jo.AsnProp)({type:ul})],dl.prototype,"rid",void 0);fl.__decorate([(0,Jo.AsnProp)({type:MN.KeyEncryptionAlgorithmIdentifier})],dl.prototype,"keyEncryptionAlgorithm",void 0);fl.__decorate([(0,Jo.AsnProp)({type:Jo.OctetString})],dl.prototype,"encryptedKey",void 0)});var BN=g(wp=>{"use strict";Object.defineProperty(wp,"__esModule",{value:!0});wp.KEKRecipientInfo=wp.KEKIdentifier=void 0;var hl=(T(),C(I)),Jn=N(),Dpe=jN(),DN=Ei(),wa=class{constructor(e={}){this.keyIdentifier=new Jn.OctetString,Object.assign(this,e)}};wp.KEKIdentifier=wa;hl.__decorate([(0,Jn.AsnProp)({type:Jn.OctetString})],wa.prototype,"keyIdentifier",void 0);hl.__decorate([(0,Jn.AsnProp)({type:Jn.AsnPropTypes.GeneralizedTime,optional:!0})],wa.prototype,"date",void 0);hl.__decorate([(0,Jn.AsnProp)({type:Dpe.OtherKeyAttribute,optional:!0})],wa.prototype,"other",void 0);var ml=class{constructor(e={}){this.version=DN.CMSVersion.v4,this.kekid=new wa,this.keyEncryptionAlgorithm=new DN.KeyEncryptionAlgorithmIdentifier,this.encryptedKey=new Jn.OctetString,Object.assign(this,e)}};wp.KEKRecipientInfo=ml;hl.__decorate([(0,Jn.AsnProp)({type:Jn.AsnPropTypes.Integer})],ml.prototype,"version",void 0);hl.__decorate([(0,Jn.AsnProp)({type:wa})],ml.prototype,"kekid",void 0);hl.__decorate([(0,Jn.AsnProp)({type:DN.KeyEncryptionAlgorithmIdentifier})],ml.prototype,"keyEncryptionAlgorithm",void 0);hl.__decorate([(0,Jn.AsnProp)({type:Jn.OctetString})],ml.prototype,"encryptedKey",void 0)});var UN=g(nS=>{"use strict";Object.defineProperty(nS,"__esModule",{value:!0});nS.PasswordRecipientInfo=void 0;var rS=(T(),C(I)),gl=N(),tS=Ei(),yl=class{constructor(e={}){this.version=tS.CMSVersion.v0,this.keyEncryptionAlgorithm=new tS.KeyEncryptionAlgorithmIdentifier,this.encryptedKey=new gl.OctetString,Object.assign(this,e)}};nS.PasswordRecipientInfo=yl;rS.__decorate([(0,gl.AsnProp)({type:gl.AsnPropTypes.Integer})],yl.prototype,"version",void 0);rS.__decorate([(0,gl.AsnProp)({type:tS.KeyDerivationAlgorithmIdentifier,context:0,optional:!0})],yl.prototype,"keyDerivationAlgorithm",void 0);rS.__decorate([(0,gl.AsnProp)({type:tS.KeyEncryptionAlgorithmIdentifier})],yl.prototype,"keyEncryptionAlgorithm",void 0);rS.__decorate([(0,gl.AsnProp)({type:gl.OctetString})],yl.prototype,"encryptedKey",void 0)});var LN=g(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});vl.RecipientInfo=vl.OtherRecipientInfo=void 0;var Sa=(T(),C(I)),Yo=N(),Bpe=RN(),Upe=qN(),Lpe=BN(),Fpe=UN(),xp=class{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}};vl.OtherRecipientInfo=xp;Sa.__decorate([(0,Yo.AsnProp)({type:Yo.AsnPropTypes.ObjectIdentifier})],xp.prototype,"oriType",void 0);Sa.__decorate([(0,Yo.AsnProp)({type:Yo.AsnPropTypes.Any})],xp.prototype,"oriValue",void 0);var xa=class{constructor(e={}){Object.assign(this,e)}};vl.RecipientInfo=xa;Sa.__decorate([(0,Yo.AsnProp)({type:Upe.KeyTransRecipientInfo,optional:!0})],xa.prototype,"ktri",void 0);Sa.__decorate([(0,Yo.AsnProp)({type:Bpe.KeyAgreeRecipientInfo,context:1,implicit:!0,optional:!0})],xa.prototype,"kari",void 0);Sa.__decorate([(0,Yo.AsnProp)({type:Lpe.KEKRecipientInfo,context:2,implicit:!0,optional:!0})],xa.prototype,"kekri",void 0);Sa.__decorate([(0,Yo.AsnProp)({type:Fpe.PasswordRecipientInfo,context:3,implicit:!0,optional:!0})],xa.prototype,"pwri",void 0);Sa.__decorate([(0,Yo.AsnProp)({type:xp,context:4,implicit:!0,optional:!0})],xa.prototype,"ori",void 0);vl.RecipientInfo=xa=Sa.__decorate([(0,Yo.AsnType)({type:Yo.AsnTypeTypes.Choice})],xa)});var HN=g(xy=>{"use strict";var FN;Object.defineProperty(xy,"__esModule",{value:!0});xy.RecipientInfos=void 0;var Vpe=(T(),C(I)),VN=N(),Zpe=LN(),ZN=FN=class extends VN.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,FN.prototype)}};xy.RecipientInfos=ZN;xy.RecipientInfos=ZN=FN=Vpe.__decorate([(0,VN.AsnType)({type:VN.AsnTypeTypes.Set,itemType:Zpe.RecipientInfo})],ZN)});var oS=g(Sr=>{"use strict";var GN;Object.defineProperty(Sr,"__esModule",{value:!0});Sr.RevocationInfoChoices=Sr.RevocationInfoChoice=Sr.OtherRevocationInfoFormat=Sr.id_ri_scvp=Sr.id_ri_ocsp_response=Sr.id_ri=void 0;var ky=(T(),C(I)),Ni=N(),Hpe=Ye();Sr.id_ri=`${Hpe.id_pkix}.16`;Sr.id_ri_ocsp_response=`${Sr.id_ri}.2`;Sr.id_ri_scvp=`${Sr.id_ri}.4`;var _l=class{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}};Sr.OtherRevocationInfoFormat=_l;ky.__decorate([(0,Ni.AsnProp)({type:Ni.AsnPropTypes.ObjectIdentifier})],_l.prototype,"otherRevInfoFormat",void 0);ky.__decorate([(0,Ni.AsnProp)({type:Ni.AsnPropTypes.Any})],_l.prototype,"otherRevInfo",void 0);var Sy=class{constructor(e={}){this.other=new _l,Object.assign(this,e)}};Sr.RevocationInfoChoice=Sy;ky.__decorate([(0,Ni.AsnProp)({type:_l,context:1,implicit:!0})],Sy.prototype,"other",void 0);Sr.RevocationInfoChoice=Sy=ky.__decorate([(0,Ni.AsnType)({type:Ni.AsnTypeTypes.Choice})],Sy);var WN=GN=class extends Ni.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,GN.prototype)}};Sr.RevocationInfoChoices=WN;Sr.RevocationInfoChoices=WN=GN=ky.__decorate([(0,Ni.AsnType)({type:Ni.AsnTypeTypes.Set,itemType:Sy})],WN)});var KN=g(iS=>{"use strict";Object.defineProperty(iS,"__esModule",{value:!0});iS.OriginatorInfo=void 0;var S5=(T(),C(I)),k5=N(),Gpe=Jx(),Wpe=oS(),$y=class{constructor(e={}){Object.assign(this,e)}};iS.OriginatorInfo=$y;S5.__decorate([(0,k5.AsnProp)({type:Gpe.CertificateSet,context:0,implicit:!0,optional:!0})],$y.prototype,"certs",void 0);S5.__decorate([(0,k5.AsnProp)({type:Wpe.RevocationInfoChoices,context:1,implicit:!0,optional:!0})],$y.prototype,"crls",void 0)});var P5=g(bl=>{"use strict";var JN;Object.defineProperty(bl,"__esModule",{value:!0});bl.EnvelopedData=bl.UnprotectedAttributes=void 0;var Sp=(T(),C(I)),Ss=N(),Kpe=Ei(),Jpe=$x(),$5=HN(),Ype=KN(),A5=ON(),sS=JN=class extends Ss.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,JN.prototype)}};bl.UnprotectedAttributes=sS;bl.UnprotectedAttributes=sS=JN=Sp.__decorate([(0,Ss.AsnType)({type:Ss.AsnTypeTypes.Set,itemType:Jpe.Attribute})],sS);var ka=class{constructor(e={}){this.version=Kpe.CMSVersion.v0,this.recipientInfos=new $5.RecipientInfos,this.encryptedContentInfo=new A5.EncryptedContentInfo,Object.assign(this,e)}};bl.EnvelopedData=ka;Sp.__decorate([(0,Ss.AsnProp)({type:Ss.AsnPropTypes.Integer})],ka.prototype,"version",void 0);Sp.__decorate([(0,Ss.AsnProp)({type:Ype.OriginatorInfo,context:0,implicit:!0,optional:!0})],ka.prototype,"originatorInfo",void 0);Sp.__decorate([(0,Ss.AsnProp)({type:$5.RecipientInfos})],ka.prototype,"recipientInfos",void 0);Sp.__decorate([(0,Ss.AsnProp)({type:A5.EncryptedContentInfo})],ka.prototype,"encryptedContentInfo",void 0);Sp.__decorate([(0,Ss.AsnProp)({type:sS,context:1,implicit:!0,optional:!0})],ka.prototype,"unprotectedAttrs",void 0)});var C5=g(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.id_authData=Kr.id_encryptedData=Kr.id_digestedData=Kr.id_envelopedData=Kr.id_signedData=Kr.id_data=Kr.id_ct_contentInfo=void 0;Kr.id_ct_contentInfo="1.2.840.113549.1.9.16.1.6";Kr.id_data="1.2.840.113549.1.7.1";Kr.id_signedData="1.2.840.113549.1.7.2";Kr.id_envelopedData="1.2.840.113549.1.7.3";Kr.id_digestedData="1.2.840.113549.1.7.5";Kr.id_encryptedData="1.2.840.113549.1.7.6";Kr.id_authData="1.2.840.113549.1.9.16.1.2"});var O5=g(wl=>{"use strict";var YN;Object.defineProperty(wl,"__esModule",{value:!0});wl.SignedData=wl.DigestAlgorithmIdentifiers=void 0;var xl=(T(),C(I)),zi=N(),Xpe=Jx(),I5=Ei(),T5=EN(),Qpe=oS(),E5=Ax(),Ay=YN=class extends zi.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,YN.prototype)}};wl.DigestAlgorithmIdentifiers=Ay;wl.DigestAlgorithmIdentifiers=Ay=YN=xl.__decorate([(0,zi.AsnType)({type:zi.AsnTypeTypes.Set,itemType:I5.DigestAlgorithmIdentifier})],Ay);var ks=class{constructor(e={}){this.version=I5.CMSVersion.v0,this.digestAlgorithms=new Ay,this.encapContentInfo=new T5.EncapsulatedContentInfo,this.signerInfos=new E5.SignerInfos,Object.assign(this,e)}};wl.SignedData=ks;xl.__decorate([(0,zi.AsnProp)({type:zi.AsnPropTypes.Integer})],ks.prototype,"version",void 0);xl.__decorate([(0,zi.AsnProp)({type:Ay})],ks.prototype,"digestAlgorithms",void 0);xl.__decorate([(0,zi.AsnProp)({type:T5.EncapsulatedContentInfo})],ks.prototype,"encapContentInfo",void 0);xl.__decorate([(0,zi.AsnProp)({type:Xpe.CertificateSet,context:0,implicit:!0,optional:!0})],ks.prototype,"certificates",void 0);xl.__decorate([(0,zi.AsnProp)({type:Qpe.RevocationInfoChoices,context:1,implicit:!0,optional:!0})],ks.prototype,"crls",void 0);xl.__decorate([(0,zi.AsnProp)({type:E5.SignerInfos})],ks.prototype,"signerInfos",void 0)});var Py=g(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});var or=(T(),C(I));or.__exportStar(G9(),Ht);or.__exportStar($x(),Ht);or.__exportStar(Jx(),Ht);or.__exportStar(_5(),Ht);or.__exportStar(EN(),Ht);or.__exportStar(ON(),Ht);or.__exportStar(P5(),Ht);or.__exportStar(Xg(),Ht);or.__exportStar(BN(),Ht);or.__exportStar(RN(),Ht);or.__exportStar(qN(),Ht);or.__exportStar(C5(),Ht);or.__exportStar(KN(),Ht);or.__exportStar(UN(),Ht);or.__exportStar(LN(),Ht);or.__exportStar(HN(),Ht);or.__exportStar(oS(),Ht);or.__exportStar(O5(),Ht);or.__exportStar(qj(),Ht);or.__exportStar(Ax(),Ht);or.__exportStar(Ei(),Ht)});var XN=g(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.id_sect571r1=ge.id_sect571k1=ge.id_secp521r1=ge.id_sect409r1=ge.id_sect409k1=ge.id_secp384r1=ge.id_sect283r1=ge.id_sect283k1=ge.id_secp256r1=ge.id_sect233r1=ge.id_sect233k1=ge.id_secp224r1=ge.id_sect163r2=ge.id_sect163k1=ge.id_secp192r1=ge.id_ecdsaWithSHA512=ge.id_ecdsaWithSHA384=ge.id_ecdsaWithSHA256=ge.id_ecdsaWithSHA224=ge.id_ecdsaWithSHA1=ge.id_ecMQV=ge.id_ecDH=ge.id_ecPublicKey=void 0;ge.id_ecPublicKey="1.2.840.10045.2.1";ge.id_ecDH="1.3.132.1.12";ge.id_ecMQV="1.3.132.1.13";ge.id_ecdsaWithSHA1="1.2.840.10045.4.1";ge.id_ecdsaWithSHA224="1.2.840.10045.4.3.1";ge.id_ecdsaWithSHA256="1.2.840.10045.4.3.2";ge.id_ecdsaWithSHA384="1.2.840.10045.4.3.3";ge.id_ecdsaWithSHA512="1.2.840.10045.4.3.4";ge.id_secp192r1="1.2.840.10045.3.1.1";ge.id_sect163k1="1.3.132.0.1";ge.id_sect163r2="1.3.132.0.15";ge.id_secp224r1="1.3.132.0.33";ge.id_sect233k1="1.3.132.0.26";ge.id_sect233r1="1.3.132.0.27";ge.id_secp256r1="1.2.840.10045.3.1.7";ge.id_sect283k1="1.3.132.0.16";ge.id_sect283r1="1.3.132.0.17";ge.id_secp384r1="1.3.132.0.34";ge.id_sect409k1="1.3.132.0.36";ge.id_sect409r1="1.3.132.0.37";ge.id_secp521r1="1.3.132.0.35";ge.id_sect571k1="1.3.132.0.38";ge.id_sect571r1="1.3.132.0.39"});var j5=g(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.ecdsaWithSHA512=wo.ecdsaWithSHA384=wo.ecdsaWithSHA256=wo.ecdsaWithSHA224=wo.ecdsaWithSHA1=void 0;var efe=Ye(),Cy=XN();function Iy(t){return new efe.AlgorithmIdentifier({algorithm:t})}wo.ecdsaWithSHA1=Iy(Cy.id_ecdsaWithSHA1);wo.ecdsaWithSHA224=Iy(Cy.id_ecdsaWithSHA224);wo.ecdsaWithSHA256=Iy(Cy.id_ecdsaWithSHA256);wo.ecdsaWithSHA384=Iy(Cy.id_ecdsaWithSHA384);wo.ecdsaWithSHA512=Iy(Cy.id_ecdsaWithSHA512)});var tz=g(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.SpecifiedECDomain=Mr.ECPVer=Mr.Curve=Mr.FieldElement=Mr.ECPoint=Mr.FieldID=void 0;var Cn=(T(),C(I)),gt=N(),kp=class{constructor(e={}){Object.assign(this,e)}};Mr.FieldID=kp;Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.ObjectIdentifier})],kp.prototype,"fieldType",void 0);Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.Any})],kp.prototype,"parameters",void 0);Mr.FieldID=kp=Cn.__decorate([(0,gt.AsnType)({type:gt.AsnTypeTypes.Sequence})],kp);var aS=class extends gt.OctetString{};Mr.ECPoint=aS;var QN=class extends gt.OctetString{};Mr.FieldElement=QN;var Sl=class{constructor(e={}){Object.assign(this,e)}};Mr.Curve=Sl;Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.OctetString})],Sl.prototype,"a",void 0);Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.OctetString})],Sl.prototype,"b",void 0);Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.BitString,optional:!0})],Sl.prototype,"seed",void 0);Mr.Curve=Sl=Cn.__decorate([(0,gt.AsnType)({type:gt.AsnTypeTypes.Sequence})],Sl);var ez;(function(t){t[t.ecpVer1=1]="ecpVer1"})(ez||(Mr.ECPVer=ez={}));var $s=class{constructor(e={}){this.version=ez.ecpVer1,Object.assign(this,e)}};Mr.SpecifiedECDomain=$s;Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.Integer})],$s.prototype,"version",void 0);Cn.__decorate([(0,gt.AsnProp)({type:kp})],$s.prototype,"fieldID",void 0);Cn.__decorate([(0,gt.AsnProp)({type:Sl})],$s.prototype,"curve",void 0);Cn.__decorate([(0,gt.AsnProp)({type:aS})],$s.prototype,"base",void 0);Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.Integer,converter:gt.AsnIntegerArrayBufferConverter})],$s.prototype,"order",void 0);Cn.__decorate([(0,gt.AsnProp)({type:gt.AsnPropTypes.Integer,optional:!0})],$s.prototype,"cofactor",void 0);Mr.SpecifiedECDomain=$s=Cn.__decorate([(0,gt.AsnType)({type:gt.AsnTypeTypes.Sequence})],$s)});var rz=g(Ty=>{"use strict";Object.defineProperty(Ty,"__esModule",{value:!0});Ty.ECParameters=void 0;var cS=(T(),C(I)),kl=N(),tfe=tz(),$p=class{constructor(e={}){Object.assign(this,e)}};Ty.ECParameters=$p;cS.__decorate([(0,kl.AsnProp)({type:kl.AsnPropTypes.ObjectIdentifier})],$p.prototype,"namedCurve",void 0);cS.__decorate([(0,kl.AsnProp)({type:kl.AsnPropTypes.Null})],$p.prototype,"implicitCurve",void 0);cS.__decorate([(0,kl.AsnProp)({type:tfe.SpecifiedECDomain})],$p.prototype,"specifiedCurve",void 0);Ty.ECParameters=$p=cS.__decorate([(0,kl.AsnType)({type:kl.AsnTypeTypes.Choice})],$p)});var N5=g(uS=>{"use strict";Object.defineProperty(uS,"__esModule",{value:!0});uS.ECPrivateKey=void 0;var lS=(T(),C(I)),$a=N(),rfe=rz(),$l=class{constructor(e={}){this.version=1,this.privateKey=new $a.OctetString,Object.assign(this,e)}};uS.ECPrivateKey=$l;lS.__decorate([(0,$a.AsnProp)({type:$a.AsnPropTypes.Integer})],$l.prototype,"version",void 0);lS.__decorate([(0,$a.AsnProp)({type:$a.OctetString})],$l.prototype,"privateKey",void 0);lS.__decorate([(0,$a.AsnProp)({type:rfe.ECParameters,context:0,optional:!0})],$l.prototype,"parameters",void 0);lS.__decorate([(0,$a.AsnProp)({type:$a.AsnPropTypes.BitString,context:1,optional:!0})],$l.prototype,"publicKey",void 0)});var R5=g(dS=>{"use strict";Object.defineProperty(dS,"__esModule",{value:!0});dS.ECDSASigValue=void 0;var z5=(T(),C(I)),Ap=N(),Ey=class{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}};dS.ECDSASigValue=Ey;z5.__decorate([(0,Ap.AsnProp)({type:Ap.AsnPropTypes.Integer,converter:Ap.AsnIntegerArrayBufferConverter})],Ey.prototype,"r",void 0);z5.__decorate([(0,Ap.AsnProp)({type:Ap.AsnPropTypes.Integer,converter:Ap.AsnIntegerArrayBufferConverter})],Ey.prototype,"s",void 0)});var M5=g(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});var Pp=(T(),C(I));Pp.__exportStar(j5(),Aa);Pp.__exportStar(rz(),Aa);Pp.__exportStar(N5(),Aa);Pp.__exportStar(R5(),Aa);Pp.__exportStar(XN(),Aa);Pp.__exportStar(tz(),Aa)});var Oy=g(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.id_mgf1=J.id_md5=J.id_md2=J.id_sha512_256=J.id_sha512_224=J.id_sha512=J.id_sha384=J.id_sha256=J.id_sha224=J.id_sha1=J.id_sha512_256WithRSAEncryption=J.id_sha512_224WithRSAEncryption=J.id_sha512WithRSAEncryption=J.id_sha384WithRSAEncryption=J.id_sha256WithRSAEncryption=J.id_ssha224WithRSAEncryption=J.id_sha224WithRSAEncryption=J.id_sha1WithRSAEncryption=J.id_md5WithRSAEncryption=J.id_md2WithRSAEncryption=J.id_RSASSA_PSS=J.id_pSpecified=J.id_RSAES_OAEP=J.id_rsaEncryption=J.id_pkcs_1=void 0;J.id_pkcs_1="1.2.840.113549.1.1";J.id_rsaEncryption=`${J.id_pkcs_1}.1`;J.id_RSAES_OAEP=`${J.id_pkcs_1}.7`;J.id_pSpecified=`${J.id_pkcs_1}.9`;J.id_RSASSA_PSS=`${J.id_pkcs_1}.10`;J.id_md2WithRSAEncryption=`${J.id_pkcs_1}.2`;J.id_md5WithRSAEncryption=`${J.id_pkcs_1}.4`;J.id_sha1WithRSAEncryption=`${J.id_pkcs_1}.5`;J.id_sha224WithRSAEncryption=`${J.id_pkcs_1}.14`;J.id_ssha224WithRSAEncryption=J.id_sha224WithRSAEncryption;J.id_sha256WithRSAEncryption=`${J.id_pkcs_1}.11`;J.id_sha384WithRSAEncryption=`${J.id_pkcs_1}.12`;J.id_sha512WithRSAEncryption=`${J.id_pkcs_1}.13`;J.id_sha512_224WithRSAEncryption=`${J.id_pkcs_1}.15`;J.id_sha512_256WithRSAEncryption=`${J.id_pkcs_1}.16`;J.id_sha1="1.3.14.3.2.26";J.id_sha224="2.16.840.1.101.3.4.2.4";J.id_sha256="2.16.840.1.101.3.4.2.1";J.id_sha384="2.16.840.1.101.3.4.2.2";J.id_sha512="2.16.840.1.101.3.4.2.3";J.id_sha512_224="2.16.840.1.101.3.4.2.5";J.id_sha512_256="2.16.840.1.101.3.4.2.6";J.id_md2="1.2.840.113549.2.2";J.id_md5="1.2.840.113549.2.5";J.id_mgf1=`${J.id_pkcs_1}.8`});var pS=g(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.sha512_256WithRSAEncryption=Se.sha512_224WithRSAEncryption=Se.sha512WithRSAEncryption=Se.sha384WithRSAEncryption=Se.sha256WithRSAEncryption=Se.sha224WithRSAEncryption=Se.sha1WithRSAEncryption=Se.md5WithRSAEncryption=Se.md2WithRSAEncryption=Se.rsaEncryption=Se.pSpecifiedEmpty=Se.mgf1SHA1=Se.sha512_256=Se.sha512_224=Se.sha512=Se.sha384=Se.sha256=Se.sha224=Se.sha1=Se.md4=Se.md2=void 0;var nz=N(),oz=Ye(),ir=Oy();function yr(t){return new oz.AlgorithmIdentifier({algorithm:t,parameters:null})}Se.md2=yr(ir.id_md2);Se.md4=yr(ir.id_md5);Se.sha1=yr(ir.id_sha1);Se.sha224=yr(ir.id_sha224);Se.sha256=yr(ir.id_sha256);Se.sha384=yr(ir.id_sha384);Se.sha512=yr(ir.id_sha512);Se.sha512_224=yr(ir.id_sha512_224);Se.sha512_256=yr(ir.id_sha512_256);Se.mgf1SHA1=new oz.AlgorithmIdentifier({algorithm:ir.id_mgf1,parameters:nz.AsnConvert.serialize(Se.sha1)});Se.pSpecifiedEmpty=new oz.AlgorithmIdentifier({algorithm:ir.id_pSpecified,parameters:nz.AsnConvert.serialize(nz.AsnOctetStringConverter.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});Se.rsaEncryption=yr(ir.id_rsaEncryption);Se.md2WithRSAEncryption=yr(ir.id_md2WithRSAEncryption);Se.md5WithRSAEncryption=yr(ir.id_md5WithRSAEncryption);Se.sha1WithRSAEncryption=yr(ir.id_sha1WithRSAEncryption);Se.sha224WithRSAEncryption=yr(ir.id_sha512_224WithRSAEncryption);Se.sha256WithRSAEncryption=yr(ir.id_sha512_256WithRSAEncryption);Se.sha384WithRSAEncryption=yr(ir.id_sha384WithRSAEncryption);Se.sha512WithRSAEncryption=yr(ir.id_sha512WithRSAEncryption);Se.sha512_224WithRSAEncryption=yr(ir.id_sha512_224WithRSAEncryption);Se.sha512_256WithRSAEncryption=yr(ir.id_sha512_256WithRSAEncryption)});var D5=g(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});Ip.RSAES_OAEP=Ip.RsaEsOaepParams=void 0;var iz=(T(),C(I)),jy=N(),Al=Ye(),q5=Oy(),Cp=pS(),Pl=class{constructor(e={}){this.hashAlgorithm=new Al.AlgorithmIdentifier(Cp.sha1),this.maskGenAlgorithm=new Al.AlgorithmIdentifier({algorithm:q5.id_mgf1,parameters:jy.AsnConvert.serialize(Cp.sha1)}),this.pSourceAlgorithm=new Al.AlgorithmIdentifier(Cp.pSpecifiedEmpty),Object.assign(this,e)}};Ip.RsaEsOaepParams=Pl;iz.__decorate([(0,jy.AsnProp)({type:Al.AlgorithmIdentifier,context:0,defaultValue:Cp.sha1})],Pl.prototype,"hashAlgorithm",void 0);iz.__decorate([(0,jy.AsnProp)({type:Al.AlgorithmIdentifier,context:1,defaultValue:Cp.mgf1SHA1})],Pl.prototype,"maskGenAlgorithm",void 0);iz.__decorate([(0,jy.AsnProp)({type:Al.AlgorithmIdentifier,context:2,defaultValue:Cp.pSpecifiedEmpty})],Pl.prototype,"pSourceAlgorithm",void 0);Ip.RSAES_OAEP=new Al.AlgorithmIdentifier({algorithm:q5.id_RSAES_OAEP,parameters:jy.AsnConvert.serialize(new Pl)})});var U5=g(Tp=>{"use strict";Object.defineProperty(Tp,"__esModule",{value:!0});Tp.RSASSA_PSS=Tp.RsaSaPssParams=void 0;var mS=(T(),C(I)),Pa=N(),Ny=Ye(),B5=Oy(),fS=pS(),Ca=class{constructor(e={}){this.hashAlgorithm=new Ny.AlgorithmIdentifier(fS.sha1),this.maskGenAlgorithm=new Ny.AlgorithmIdentifier({algorithm:B5.id_mgf1,parameters:Pa.AsnConvert.serialize(fS.sha1)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}};Tp.RsaSaPssParams=Ca;mS.__decorate([(0,Pa.AsnProp)({type:Ny.AlgorithmIdentifier,context:0,defaultValue:fS.sha1})],Ca.prototype,"hashAlgorithm",void 0);mS.__decorate([(0,Pa.AsnProp)({type:Ny.AlgorithmIdentifier,context:1,defaultValue:fS.mgf1SHA1})],Ca.prototype,"maskGenAlgorithm",void 0);mS.__decorate([(0,Pa.AsnProp)({type:Pa.AsnPropTypes.Integer,context:2,defaultValue:20})],Ca.prototype,"saltLength",void 0);mS.__decorate([(0,Pa.AsnProp)({type:Pa.AsnPropTypes.Integer,context:3,defaultValue:1})],Ca.prototype,"trailerField",void 0);Tp.RSASSA_PSS=new Ny.AlgorithmIdentifier({algorithm:B5.id_RSASSA_PSS,parameters:Pa.AsnConvert.serialize(new Ca)})});var V5=g(gS=>{"use strict";Object.defineProperty(gS,"__esModule",{value:!0});gS.DigestInfo=void 0;var L5=(T(),C(I)),F5=Ye(),hS=N(),zy=class{constructor(e={}){this.digestAlgorithm=new F5.AlgorithmIdentifier,this.digest=new hS.OctetString,Object.assign(this,e)}};gS.DigestInfo=zy;L5.__decorate([(0,hS.AsnProp)({type:F5.AlgorithmIdentifier})],zy.prototype,"digestAlgorithm",void 0);L5.__decorate([(0,hS.AsnProp)({type:hS.OctetString})],zy.prototype,"digest",void 0)});var Z5=g(Ry=>{"use strict";Object.defineProperty(Ry,"__esModule",{value:!0});var sz=(T(),C(I));sz.__exportStar(D5(),Ry);sz.__exportStar(U5(),Ry);sz.__exportStar(V5(),Ry)});var lz=g(Il=>{"use strict";var az;Object.defineProperty(Il,"__esModule",{value:!0});Il.OtherPrimeInfos=Il.OtherPrimeInfo=void 0;var yS=(T(),C(I)),xo=N(),Cl=class{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}};Il.OtherPrimeInfo=Cl;yS.__decorate([(0,xo.AsnProp)({type:xo.AsnPropTypes.Integer,converter:xo.AsnIntegerArrayBufferConverter})],Cl.prototype,"prime",void 0);yS.__decorate([(0,xo.AsnProp)({type:xo.AsnPropTypes.Integer,converter:xo.AsnIntegerArrayBufferConverter})],Cl.prototype,"exponent",void 0);yS.__decorate([(0,xo.AsnProp)({type:xo.AsnPropTypes.Integer,converter:xo.AsnIntegerArrayBufferConverter})],Cl.prototype,"coefficient",void 0);var cz=az=class extends xo.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,az.prototype)}};Il.OtherPrimeInfos=cz;Il.OtherPrimeInfos=cz=az=yS.__decorate([(0,xo.AsnType)({type:xo.AsnTypeTypes.Sequence,itemType:Cl})],cz)});var H5=g(vS=>{"use strict";Object.defineProperty(vS,"__esModule",{value:!0});vS.RSAPrivateKey=void 0;var Ri=(T(),C(I)),kt=N(),nfe=lz(),Yn=class{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}};vS.RSAPrivateKey=Yn;Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer})],Yn.prototype,"version",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"modulus",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"publicExponent",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"privateExponent",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"prime1",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"prime2",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"exponent1",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"exponent2",void 0);Ri.__decorate([(0,kt.AsnProp)({type:kt.AsnPropTypes.Integer,converter:kt.AsnIntegerArrayBufferConverter})],Yn.prototype,"coefficient",void 0);Ri.__decorate([(0,kt.AsnProp)({type:nfe.OtherPrimeInfos,optional:!0})],Yn.prototype,"otherPrimeInfos",void 0)});var W5=g(_S=>{"use strict";Object.defineProperty(_S,"__esModule",{value:!0});_S.RSAPublicKey=void 0;var G5=(T(),C(I)),Ep=N(),My=class{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}};_S.RSAPublicKey=My;G5.__decorate([(0,Ep.AsnProp)({type:Ep.AsnPropTypes.Integer,converter:Ep.AsnIntegerArrayBufferConverter})],My.prototype,"modulus",void 0);G5.__decorate([(0,Ep.AsnProp)({type:Ep.AsnPropTypes.Integer,converter:Ep.AsnIntegerArrayBufferConverter})],My.prototype,"publicExponent",void 0)});var uz=g(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});var Op=(T(),C(I));Op.__exportStar(Z5(),Ia);Op.__exportStar(pS(),Ia);Op.__exportStar(Oy(),Ia);Op.__exportStar(lz(),Ia);Op.__exportStar(H5(),Ia);Op.__exportStar(W5(),Ia)});var bS={};Ui(bS,{__assign:()=>pz,__asyncDelegator:()=>gfe,__asyncGenerator:()=>hfe,__asyncValues:()=>yfe,__await:()=>qy,__awaiter:()=>lfe,__classPrivateFieldGet:()=>wfe,__classPrivateFieldSet:()=>xfe,__createBinding:()=>dfe,__decorate:()=>sfe,__exportStar:()=>pfe,__extends:()=>ofe,__generator:()=>ufe,__importDefault:()=>bfe,__importStar:()=>_fe,__makeTemplateObject:()=>vfe,__metadata:()=>cfe,__param:()=>afe,__read:()=>K5,__rest:()=>ife,__spread:()=>ffe,__spreadArrays:()=>mfe,__values:()=>fz});function ofe(t,e){dz(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function ife(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r}function sfe(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i}function afe(t,e){return function(r,n){e(r,n,t)}}function cfe(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function lfe(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(u){try{l(n.next(u))}catch(d){s(d)}}function c(u){try{l(n.throw(u))}catch(d){s(d)}}function l(u){u.done?i(u.value):o(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function ufe(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],o=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function dfe(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function pfe(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function fz(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function K5(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function ffe(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(K5(arguments[e]));return t}function mfe(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function qy(t){return this instanceof qy?(this.v=t,this):new qy(t)}function hfe(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(p){n[p]&&(o[p]=function(f){return new Promise(function(h,m){i.push([p,f,h,m])>1||a(p,f)})})}function a(p,f){try{c(n[p](f))}catch(h){d(i[0][3],h)}}function c(p){p.value instanceof qy?Promise.resolve(p.value.v).then(l,u):d(i[0][2],p)}function l(p){a("next",p)}function u(p){a("throw",p)}function d(p,f){p(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function gfe(t){var e,r;return e={},n("next"),n("throw",function(o){throw o}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(o,i){e[o]=t[o]?function(s){return(r=!r)?{value:qy(t[o](s)),done:o==="return"}:i?i(s):s}:i}}function yfe(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof fz=="function"?fz(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(s){return new Promise(function(a,c){s=t[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}}function vfe(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _fe(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function bfe(t){return t&&t.__esModule?t:{default:t}}function wfe(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function xfe(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var dz,pz,wS=fM(()=>{dz=function(t,e){return dz=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},dz(t,e)};pz=function(){return pz=Object.assign||function(e){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},pz.apply(this,arguments)}});var gz=g(hz=>{"use strict";Object.defineProperty(hz,"__esModule",{value:!0});var mz;(function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"})(mz||(mz={}));hz.default=mz});var J5=g(yz=>{"use strict";Object.defineProperty(yz,"__esModule",{value:!0});var Sfe=gz();Object.defineProperty(yz,"Lifecycle",{enumerable:!0,get:function(){return Sfe.default}})});var Tl=g(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.defineInjectionTokenMetadata=Xo.getParamInfo=Xo.INJECTION_TOKEN_METADATA_KEY=void 0;Xo.INJECTION_TOKEN_METADATA_KEY="injectionTokens";function kfe(t){let e=Reflect.getMetadata("design:paramtypes",t)||[],r=Reflect.getOwnMetadata(Xo.INJECTION_TOKEN_METADATA_KEY,t)||{};return Object.keys(r).forEach(n=>{e[+n]=r[n]}),e}Xo.getParamInfo=kfe;function $fe(t,e){return function(r,n,o){let i=Reflect.getOwnMetadata(Xo.INJECTION_TOKEN_METADATA_KEY,r)||{};i[o]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(Xo.INJECTION_TOKEN_METADATA_KEY,i,r)}}Xo.defineInjectionTokenMetadata=$fe});var vz=g(xS=>{"use strict";Object.defineProperty(xS,"__esModule",{value:!0});xS.isClassProvider=void 0;function Afe(t){return!!t.useClass}xS.isClassProvider=Afe});var _z=g(SS=>{"use strict";Object.defineProperty(SS,"__esModule",{value:!0});SS.isFactoryProvider=void 0;function Pfe(t){return!!t.useFactory}SS.isFactoryProvider=Pfe});var $S=g(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});jp.delay=jp.DelayedConstructor=void 0;var kS=class{constructor(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}createProxy(e){let r={},n=!1,o,i=()=>(n||(o=e(this.wrap()),n=!0),o);return new Proxy(r,this.createHandler(i))}createHandler(e){let r={},n=o=>{r[o]=(...i)=>{i[0]=e();let s=Reflect[o];return s(...i)}};return this.reflectMethods.forEach(n),r}};jp.DelayedConstructor=kS;function Cfe(t){if(typeof t>"u")throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new kS(t)}jp.delay=Cfe});var AS=g(Mi=>{"use strict";Object.defineProperty(Mi,"__esModule",{value:!0});Mi.isConstructorToken=Mi.isTransformDescriptor=Mi.isTokenDescriptor=Mi.isNormalToken=void 0;var Ife=$S();function Tfe(t){return typeof t=="string"||typeof t=="symbol"}Mi.isNormalToken=Tfe;function Efe(t){return typeof t=="object"&&"token"in t&&"multiple"in t}Mi.isTokenDescriptor=Efe;function Ofe(t){return typeof t=="object"&&"token"in t&&"transform"in t}Mi.isTransformDescriptor=Ofe;function jfe(t){return typeof t=="function"||t instanceof Ife.DelayedConstructor}Mi.isConstructorToken=jfe});var bz=g(PS=>{"use strict";Object.defineProperty(PS,"__esModule",{value:!0});PS.isTokenProvider=void 0;function Nfe(t){return!!t.useToken}PS.isTokenProvider=Nfe});var wz=g(CS=>{"use strict";Object.defineProperty(CS,"__esModule",{value:!0});CS.isValueProvider=void 0;function zfe(t){return t.useValue!=null}CS.isValueProvider=zfe});var xz=g(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var Rfe=vz();Object.defineProperty(El,"isClassProvider",{enumerable:!0,get:function(){return Rfe.isClassProvider}});var Mfe=_z();Object.defineProperty(El,"isFactoryProvider",{enumerable:!0,get:function(){return Mfe.isFactoryProvider}});var qfe=AS();Object.defineProperty(El,"isNormalToken",{enumerable:!0,get:function(){return qfe.isNormalToken}});var Dfe=bz();Object.defineProperty(El,"isTokenProvider",{enumerable:!0,get:function(){return Dfe.isTokenProvider}});var Bfe=wz();Object.defineProperty(El,"isValueProvider",{enumerable:!0,get:function(){return Bfe.isValueProvider}})});var Y5=g(IS=>{"use strict";Object.defineProperty(IS,"__esModule",{value:!0});IS.isProvider=void 0;var Ufe=vz(),Lfe=wz(),Ffe=bz(),Vfe=_z();function Zfe(t){return Ufe.isClassProvider(t)||Lfe.isValueProvider(t)||Ffe.isTokenProvider(t)||Vfe.isFactoryProvider(t)}IS.isProvider=Zfe});var $z=g(kz=>{"use strict";Object.defineProperty(kz,"__esModule",{value:!0});var Sz=class{constructor(){this._registryMap=new Map}entries(){return this._registryMap.entries()}getAll(e){return this.ensure(e),this._registryMap.get(e)}get(e){this.ensure(e);let r=this._registryMap.get(e);return r[r.length-1]||null}set(e,r){this.ensure(e),this._registryMap.get(e).push(r)}setAll(e,r){this._registryMap.set(e,r)}has(e){return this.ensure(e),this._registryMap.get(e).length>0}clear(){this._registryMap.clear()}ensure(e){this._registryMap.has(e)||this._registryMap.set(e,[])}};kz.default=Sz});var X5=g(Pz=>{"use strict";Object.defineProperty(Pz,"__esModule",{value:!0});var Hfe=$z(),Az=class extends Hfe.default{};Pz.default=Az});var Q5=g(Iz=>{"use strict";Object.defineProperty(Iz,"__esModule",{value:!0});var Cz=class{constructor(){this.scopedResolutions=new Map}};Iz.default=Cz});var Tz=g(TS=>{"use strict";Object.defineProperty(TS,"__esModule",{value:!0});TS.formatErrorCtor=void 0;function Gfe(t,e){return t===null?`at position #${e}`:`"${t.split(",")[e].trim()}" at position #${e}`}function Wfe(t,e,r="    "){return[t,...e.message.split(`
`).map(n=>r+n)].join(`
`)}function Kfe(t,e,r){let[,n=null]=t.toString().match(/constructor\(([\w, ]+)\)/)||[],o=Gfe(n,e);return Wfe(`Cannot inject the dependency ${o} of "${t.name}" constructor. Reason:`,r)}TS.formatErrorCtor=Kfe});var e3=g(ES=>{"use strict";Object.defineProperty(ES,"__esModule",{value:!0});ES.isDisposable=void 0;function Jfe(t){return!(typeof t.dispose!="function"||t.dispose.length>0)}ES.isDisposable=Jfe});var r3=g(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});Ol.PostResolutionInterceptors=Ol.PreResolutionInterceptors=void 0;var t3=$z(),OS=class extends t3.default{};Ol.PreResolutionInterceptors=OS;var jS=class extends t3.default{};Ol.PostResolutionInterceptors=jS;var Ez=class{constructor(){this.preResolution=new OS,this.postResolution=new jS}};Ol.default=Ez});var Ta=g(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.instance=As.typeInfo=void 0;var Yfe=(wS(),C(bS)),dn=xz(),Xfe=Y5(),NS=AS(),Qfe=X5(),In=gz(),zS=Q5(),eme=Tz(),tme=$S(),rme=e3(),nme=r3();As.typeInfo=new Map;var Oz=class t{constructor(e){this.parent=e,this._registry=new Qfe.default,this.interceptors=new nme.default,this.disposed=!1,this.disposables=new Set}register(e,r,n={lifecycle:In.default.Transient}){this.ensureNotDisposed();let o;if(Xfe.isProvider(r)?o=r:o={useClass:r},dn.isTokenProvider(o)){let i=[e],s=o;for(;s!=null;){let a=s.useToken;if(i.includes(a))throw new Error(`Token registration cycle detected! ${[...i,a].join(" -> ")}`);i.push(a);let c=this._registry.get(a);c&&dn.isTokenProvider(c.provider)?s=c.provider:s=null}}if((n.lifecycle===In.default.Singleton||n.lifecycle==In.default.ContainerScoped||n.lifecycle==In.default.ResolutionScoped)&&(dn.isValueProvider(o)||dn.isFactoryProvider(o)))throw new Error(`Cannot use lifecycle "${In.default[n.lifecycle]}" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:o,options:n}),this}registerType(e,r){return this.ensureNotDisposed(),dn.isNormalToken(r)?this.register(e,{useToken:r}):this.register(e,{useClass:r})}registerInstance(e,r){return this.ensureNotDisposed(),this.register(e,{useValue:r})}registerSingleton(e,r){if(this.ensureNotDisposed(),dn.isNormalToken(e)){if(dn.isNormalToken(r))return this.register(e,{useToken:r},{lifecycle:In.default.Singleton});if(r)return this.register(e,{useClass:r},{lifecycle:In.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}let n=e;return r&&!dn.isNormalToken(r)&&(n=r),this.register(e,{useClass:n},{lifecycle:In.default.Singleton})}resolve(e,r=new zS.default,n=!1){this.ensureNotDisposed();let o=this.getRegistration(e);if(!o&&dn.isNormalToken(e)){if(n)return;throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"Single"),o){let i=this.resolveRegistration(o,r);return this.executePostResolutionInterceptor(e,i,"Single"),i}if(NS.isConstructorToken(e)){let i=this.construct(e,r);return this.executePostResolutionInterceptor(e,i,"Single"),i}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")}executePreResolutionInterceptor(e,r){if(this.interceptors.preResolution.has(e)){let n=[];for(let o of this.interceptors.preResolution.getAll(e))o.options.frequency!="Once"&&n.push(o),o.callback(e,r);this.interceptors.preResolution.setAll(e,n)}}executePostResolutionInterceptor(e,r,n){if(this.interceptors.postResolution.has(e)){let o=[];for(let i of this.interceptors.postResolution.getAll(e))i.options.frequency!="Once"&&o.push(i),i.callback(e,r,n);this.interceptors.postResolution.setAll(e,o)}}resolveRegistration(e,r){if(this.ensureNotDisposed(),e.options.lifecycle===In.default.ResolutionScoped&&r.scopedResolutions.has(e))return r.scopedResolutions.get(e);let n=e.options.lifecycle===In.default.Singleton,o=e.options.lifecycle===In.default.ContainerScoped,i=n||o,s;return dn.isValueProvider(e.provider)?s=e.provider.useValue:dn.isTokenProvider(e.provider)?s=i?e.instance||(e.instance=this.resolve(e.provider.useToken,r)):this.resolve(e.provider.useToken,r):dn.isClassProvider(e.provider)?s=i?e.instance||(e.instance=this.construct(e.provider.useClass,r)):this.construct(e.provider.useClass,r):dn.isFactoryProvider(e.provider)?s=e.provider.useFactory(this):s=this.construct(e.provider,r),e.options.lifecycle===In.default.ResolutionScoped&&r.scopedResolutions.set(e,s),s}resolveAll(e,r=new zS.default,n=!1){this.ensureNotDisposed();let o=this.getAllRegistrations(e);if(!o&&dn.isNormalToken(e)){if(n)return[];throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"All"),o){let s=o.map(a=>this.resolveRegistration(a,r));return this.executePostResolutionInterceptor(e,s,"All"),s}let i=[this.construct(e,r)];return this.executePostResolutionInterceptor(e,i,"All"),i}isRegistered(e,r=!1){return this.ensureNotDisposed(),this._registry.has(e)||r&&(this.parent||!1)&&this.parent.isRegistered(e,!0)}reset(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()}clearInstances(){this.ensureNotDisposed();for(let[e,r]of this._registry.entries())this._registry.setAll(e,r.filter(n=>!dn.isValueProvider(n.provider)).map(n=>(n.instance=void 0,n)))}createChildContainer(){this.ensureNotDisposed();let e=new t(this);for(let[r,n]of this._registry.entries())n.some(({options:o})=>o.lifecycle===In.default.ContainerScoped)&&e._registry.setAll(r,n.map(o=>o.options.lifecycle===In.default.ContainerScoped?{provider:o.provider,options:o.options}:o));return e}beforeResolution(e,r,n={frequency:"Always"}){this.interceptors.preResolution.set(e,{callback:r,options:n})}afterResolution(e,r,n={frequency:"Always"}){this.interceptors.postResolution.set(e,{callback:r,options:n})}dispose(){return Yfe.__awaiter(this,void 0,void 0,function*(){this.disposed=!0;let e=[];this.disposables.forEach(r=>{let n=r.dispose();n&&e.push(n)}),yield Promise.all(e)})}getRegistration(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null}getAllRegistrations(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null}construct(e,r){if(e instanceof tme.DelayedConstructor)return e.createProxy(o=>this.resolve(o,r));let n=(()=>{let o=As.typeInfo.get(e);if(!o||o.length===0){if(e.length===0)return new e;throw new Error(`TypeInfo not known for "${e.name}"`)}let i=o.map(this.resolveParams(r,e));return new e(...i)})();return rme.isDisposable(n)&&this.disposables.add(n),n}resolveParams(e,r){return(n,o)=>{try{return NS.isTokenDescriptor(n)?NS.isTransformDescriptor(n)?n.multiple?this.resolve(n.transform).transform(this.resolveAll(n.token,new zS.default,n.isOptional),...n.transformArgs):this.resolve(n.transform).transform(this.resolve(n.token,e,n.isOptional),...n.transformArgs):n.multiple?this.resolveAll(n.token,new zS.default,n.isOptional):this.resolve(n.token,e,n.isOptional):NS.isTransformDescriptor(n)?this.resolve(n.transform,e).transform(this.resolve(n.token,e),...n.transformArgs):this.resolve(n,e)}catch(i){throw new Error(eme.formatErrorCtor(r,o,i))}}}ensureNotDisposed(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")}};As.instance=new Oz;As.default=As.instance});var n3=g(Nz=>{"use strict";Object.defineProperty(Nz,"__esModule",{value:!0});var ome=Tl(),Ps=Ta(),jz=AS(),ime=Tz();function sme(){return function(t){let e=ome.getParamInfo(t);return class extends t{constructor(...r){super(...r.concat(e.slice(r.length).map((n,o)=>{try{return jz.isTokenDescriptor(n)?jz.isTransformDescriptor(n)?n.multiple?Ps.instance.resolve(n.transform).transform(Ps.instance.resolveAll(n.token),...n.transformArgs):Ps.instance.resolve(n.transform).transform(Ps.instance.resolve(n.token),...n.transformArgs):n.multiple?Ps.instance.resolveAll(n.token):Ps.instance.resolve(n.token):jz.isTransformDescriptor(n)?Ps.instance.resolve(n.transform).transform(Ps.instance.resolve(n.token),...n.transformArgs):Ps.instance.resolve(n)}catch(i){let s=o+r.length;throw new Error(ime.formatErrorCtor(t,s,i))}})))}}}}Nz.default=sme});var o3=g(zz=>{"use strict";Object.defineProperty(zz,"__esModule",{value:!0});var ame=Tl();function cme(t,e){let r={token:t,multiple:!1,isOptional:e&&e.isOptional};return ame.defineInjectionTokenMetadata(r)}zz.default=cme});var RS=g(Rz=>{"use strict";Object.defineProperty(Rz,"__esModule",{value:!0});var lme=Tl(),ume=Ta(),i3=Ta();function dme(t){return function(e){ume.typeInfo.set(e,lme.getParamInfo(e)),t&&t.token&&(Array.isArray(t.token)?t.token.forEach(r=>{i3.instance.register(r,e)}):i3.instance.register(t.token,e))}}Rz.default=dme});var s3=g(Mz=>{"use strict";Object.defineProperty(Mz,"__esModule",{value:!0});var pme=(wS(),C(bS)),fme=Ta();function mme(t=[]){return function(e){return t.forEach(r=>{var{token:n,options:o}=r,i=pme.__rest(r,["token","options"]);return fme.instance.register(n,i,o)}),e}}Mz.default=mme});var a3=g(qz=>{"use strict";Object.defineProperty(qz,"__esModule",{value:!0});var hme=RS(),gme=Ta();function yme(){return function(t){hme.default()(t),gme.instance.registerSingleton(t)}}qz.default=yme});var c3=g(Dz=>{"use strict";Object.defineProperty(Dz,"__esModule",{value:!0});var vme=Tl();function _me(t,e){let r={token:t,multiple:!0,isOptional:e&&e.isOptional};return vme.defineInjectionTokenMetadata(r)}Dz.default=_me});var l3=g(Bz=>{"use strict";Object.defineProperty(Bz,"__esModule",{value:!0});var bme=Tl();function wme(t,e,...r){let n={token:t,multiple:!0,transform:e,transformArgs:r};return bme.defineInjectionTokenMetadata(n)}Bz.default=wme});var u3=g(Uz=>{"use strict";Object.defineProperty(Uz,"__esModule",{value:!0});var xme=Tl();function Sme(t,e,...r){return xme.defineInjectionTokenMetadata(t,{transformToken:e,args:r})}Uz.default=Sme});var d3=g(Lz=>{"use strict";Object.defineProperty(Lz,"__esModule",{value:!0});var kme=RS(),$me=Ta();function Ame(t,e){return function(r){kme.default()(r),$me.instance.register(e||r,r,{lifecycle:t})}}Lz.default=Ame});var p3=g(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});var Pme=n3();Object.defineProperty(Qo,"autoInjectable",{enumerable:!0,get:function(){return Pme.default}});var Cme=o3();Object.defineProperty(Qo,"inject",{enumerable:!0,get:function(){return Cme.default}});var Ime=RS();Object.defineProperty(Qo,"injectable",{enumerable:!0,get:function(){return Ime.default}});var Tme=s3();Object.defineProperty(Qo,"registry",{enumerable:!0,get:function(){return Tme.default}});var Eme=a3();Object.defineProperty(Qo,"singleton",{enumerable:!0,get:function(){return Eme.default}});var Ome=c3();Object.defineProperty(Qo,"injectAll",{enumerable:!0,get:function(){return Ome.default}});var jme=l3();Object.defineProperty(Qo,"injectAllWithTransform",{enumerable:!0,get:function(){return jme.default}});var Nme=u3();Object.defineProperty(Qo,"injectWithTransform",{enumerable:!0,get:function(){return Nme.default}});var zme=d3();Object.defineProperty(Qo,"scoped",{enumerable:!0,get:function(){return zme.default}})});var f3=g(Fz=>{"use strict";Object.defineProperty(Fz,"__esModule",{value:!0});function Rme(t){let e;return r=>(e==null&&(e=t(r)),e)}Fz.default=Rme});var m3=g(Vz=>{"use strict";Object.defineProperty(Vz,"__esModule",{value:!0});function Mme(t){let e=new WeakMap;return r=>{let n=e.get(r);return n==null&&(n=t(r),e.set(r,n)),n}}Vz.default=Mme});var h3=g(Zz=>{"use strict";Object.defineProperty(Zz,"__esModule",{value:!0});function qme(t,e,r,n=!0){let o,i;return s=>{let a=t(s);return(!n||i!==a)&&((i=a)?o=s.resolve(e):o=s.resolve(r)),o}}Zz.default=qme});var g3=g(Dy=>{"use strict";Object.defineProperty(Dy,"__esModule",{value:!0});var Dme=f3();Object.defineProperty(Dy,"instanceCachingFactory",{enumerable:!0,get:function(){return Dme.default}});var Bme=m3();Object.defineProperty(Dy,"instancePerContainerCachingFactory",{enumerable:!0,get:function(){return Bme.default}});var Ume=h3();Object.defineProperty(Dy,"predicateAwareClassFactory",{enumerable:!0,get:function(){return Ume.default}})});var y3=g(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});var Hz=(wS(),C(bS));if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var Lme=J5();Object.defineProperty(Ea,"Lifecycle",{enumerable:!0,get:function(){return Lme.Lifecycle}});Hz.__exportStar(p3(),Ea);Hz.__exportStar(g3(),Ea);Hz.__exportStar(xz(),Ea);var Fme=$S();Object.defineProperty(Ea,"delay",{enumerable:!0,get:function(){return Fme.delay}});var Vme=Ta();Object.defineProperty(Ea,"container",{enumerable:!0,get:function(){return Vme.instance}})});var Jz=g(Nl=>{"use strict";var Gz;Object.defineProperty(Nl,"__esModule",{value:!0});Nl.PKCS12AttrSet=Nl.PKCS12Attribute=void 0;var Kz=(T(),C(I)),jl=N(),Np=class{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}};Nl.PKCS12Attribute=Np;Kz.__decorate([(0,jl.AsnProp)({type:jl.AsnPropTypes.ObjectIdentifier})],Np.prototype,"attrId",void 0);Kz.__decorate([(0,jl.AsnProp)({type:jl.AsnPropTypes.Any,repeated:"set"})],Np.prototype,"attrValues",void 0);var Wz=Gz=class extends jl.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Gz.prototype)}};Nl.PKCS12AttrSet=Wz;Nl.PKCS12AttrSet=Wz=Gz=Kz.__decorate([(0,jl.AsnType)({type:jl.AsnTypeTypes.Sequence,itemType:Np})],Wz)});var v3=g(By=>{"use strict";var Yz;Object.defineProperty(By,"__esModule",{value:!0});By.AuthenticatedSafe=void 0;var Zme=(T(),C(I)),Xz=N(),Hme=Py(),Qz=Yz=class extends Xz.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,Yz.prototype)}};By.AuthenticatedSafe=Qz;By.AuthenticatedSafe=Qz=Yz=Zme.__decorate([(0,Xz.AsnType)({type:Xz.AsnTypeTypes.Sequence,itemType:Hme.ContentInfo})],Qz)});var eR=g(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.id_bagtypes=Qe.id_pbewithSHAAnd40BitRC2_CBC=Qe.id_pbeWithSHAAnd128BitRC2_CBC=Qe.id_pbeWithSHAAnd2_KeyTripleDES_CBC=Qe.id_pbeWithSHAAnd3_KeyTripleDES_CBC=Qe.id_pbeWithSHAAnd40BitRC4=Qe.id_pbeWithSHAAnd128BitRC4=Qe.id_pkcs_12PbeIds=Qe.id_pkcs_12=Qe.id_pkcs=Qe.id_rsadsi=void 0;Qe.id_rsadsi="1.2.840.113549";Qe.id_pkcs=`${Qe.id_rsadsi}.1`;Qe.id_pkcs_12=`${Qe.id_pkcs}.12`;Qe.id_pkcs_12PbeIds=`${Qe.id_pkcs_12}.1`;Qe.id_pbeWithSHAAnd128BitRC4=`${Qe.id_pkcs_12PbeIds}.1`;Qe.id_pbeWithSHAAnd40BitRC4=`${Qe.id_pkcs_12PbeIds}.2`;Qe.id_pbeWithSHAAnd3_KeyTripleDES_CBC=`${Qe.id_pkcs_12PbeIds}.3`;Qe.id_pbeWithSHAAnd2_KeyTripleDES_CBC=`${Qe.id_pkcs_12PbeIds}.4`;Qe.id_pbeWithSHAAnd128BitRC2_CBC=`${Qe.id_pkcs_12PbeIds}.5`;Qe.id_pbewithSHAAnd40BitRC2_CBC=`${Qe.id_pkcs_12PbeIds}.6`;Qe.id_bagtypes=`${Qe.id_pkcs_12}.10.1`});var MS=g(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.id_pkcs_9=Jr.id_SafeContents=Jr.id_SecretBag=Jr.id_CRLBag=Jr.id_certBag=Jr.id_pkcs8ShroudedKeyBag=Jr.id_keyBag=void 0;var zp=eR();Jr.id_keyBag=`${zp.id_bagtypes}.1`;Jr.id_pkcs8ShroudedKeyBag=`${zp.id_bagtypes}.2`;Jr.id_certBag=`${zp.id_bagtypes}.3`;Jr.id_CRLBag=`${zp.id_bagtypes}.4`;Jr.id_SecretBag=`${zp.id_bagtypes}.5`;Jr.id_SafeContents=`${zp.id_bagtypes}.6`;Jr.id_pkcs_9="1.2.840.113549.1.9"});var b3=g(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.id_sdsiCertificate=So.id_x509Certificate=So.id_certTypes=So.CertBag=void 0;var _3=(T(),C(I)),qS=N(),Gme=MS(),Uy=class{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}};So.CertBag=Uy;_3.__decorate([(0,qS.AsnProp)({type:qS.AsnPropTypes.ObjectIdentifier})],Uy.prototype,"certId",void 0);_3.__decorate([(0,qS.AsnProp)({type:qS.AsnPropTypes.Any,context:0})],Uy.prototype,"certValue",void 0);So.id_certTypes=`${Gme.id_pkcs_9}.22`;So.id_x509Certificate=`${So.id_certTypes}.1`;So.id_sdsiCertificate=`${So.id_certTypes}.2`});var x3=g(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.id_x509CRL=Cs.id_crlTypes=Cs.CRLBag=void 0;var w3=(T(),C(I)),DS=N(),Wme=MS(),Ly=class{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}};Cs.CRLBag=Ly;w3.__decorate([(0,DS.AsnProp)({type:DS.AsnPropTypes.ObjectIdentifier})],Ly.prototype,"crlId",void 0);w3.__decorate([(0,DS.AsnProp)({type:DS.AsnPropTypes.Any,context:0})],Ly.prototype,"crltValue",void 0);Cs.id_crlTypes=`${Wme.id_pkcs_9}.23`;Cs.id_x509CRL=`${Cs.id_crlTypes}.1`});var $3=g(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});Rp.EncryptedPrivateKeyInfo=Rp.EncryptedData=void 0;var S3=(T(),C(I)),tR=N(),k3=Ye(),Fy=class extends tR.OctetString{};Rp.EncryptedData=Fy;var Vy=class{constructor(e={}){this.encryptionAlgorithm=new k3.AlgorithmIdentifier,this.encryptedData=new Fy,Object.assign(this,e)}};Rp.EncryptedPrivateKeyInfo=Vy;S3.__decorate([(0,tR.AsnProp)({type:k3.AlgorithmIdentifier})],Vy.prototype,"encryptionAlgorithm",void 0);S3.__decorate([(0,tR.AsnProp)({type:Fy})],Vy.prototype,"encryptedData",void 0)});var A3=g(ei=>{"use strict";var rR;Object.defineProperty(ei,"__esModule",{value:!0});ei.PrivateKeyInfo=ei.Attributes=ei.PrivateKey=ei.Version=void 0;var Hy=(T(),C(I)),Is=N(),oR=Ye(),nR;(function(t){t[t.v1=0]="v1"})(nR||(ei.Version=nR={}));var Zy=class extends Is.OctetString{};ei.PrivateKey=Zy;var BS=rR=class extends Is.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,rR.prototype)}};ei.Attributes=BS;ei.Attributes=BS=rR=Hy.__decorate([(0,Is.AsnType)({type:Is.AsnTypeTypes.Sequence,itemType:oR.Attribute})],BS);var zl=class{constructor(e={}){this.version=nR.v1,this.privateKeyAlgorithm=new oR.AlgorithmIdentifier,this.privateKey=new Zy,Object.assign(this,e)}};ei.PrivateKeyInfo=zl;Hy.__decorate([(0,Is.AsnProp)({type:Is.AsnPropTypes.Integer})],zl.prototype,"version",void 0);Hy.__decorate([(0,Is.AsnProp)({type:oR.AlgorithmIdentifier})],zl.prototype,"privateKeyAlgorithm",void 0);Hy.__decorate([(0,Is.AsnProp)({type:Zy})],zl.prototype,"privateKey",void 0);Hy.__decorate([(0,Is.AsnProp)({type:BS,implicit:!0,context:0,optional:!0})],zl.prototype,"attributes",void 0)});var LS=g(US=>{"use strict";Object.defineProperty(US,"__esModule",{value:!0});var P3=(T(),C(I));P3.__exportStar($3(),US);P3.__exportStar(A3(),US)});var I3=g(Gy=>{"use strict";Object.defineProperty(Gy,"__esModule",{value:!0});Gy.KeyBag=void 0;var Kme=(T(),C(I)),Jme=LS(),C3=N(),iR=class extends Jme.PrivateKeyInfo{};Gy.KeyBag=iR;Gy.KeyBag=iR=Kme.__decorate([(0,C3.AsnType)({type:C3.AsnTypeTypes.Sequence})],iR)});var E3=g(Wy=>{"use strict";Object.defineProperty(Wy,"__esModule",{value:!0});Wy.PKCS8ShroudedKeyBag=void 0;var Yme=(T(),C(I)),Xme=LS(),T3=N(),sR=class extends Xme.EncryptedPrivateKeyInfo{};Wy.PKCS8ShroudedKeyBag=sR;Wy.PKCS8ShroudedKeyBag=sR=Yme.__decorate([(0,T3.AsnType)({type:T3.AsnTypeTypes.Sequence})],sR)});var j3=g(VS=>{"use strict";Object.defineProperty(VS,"__esModule",{value:!0});VS.SecretBag=void 0;var O3=(T(),C(I)),FS=N(),Ky=class{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}};VS.SecretBag=Ky;O3.__decorate([(0,FS.AsnProp)({type:FS.AsnPropTypes.ObjectIdentifier})],Ky.prototype,"secretTypeId",void 0);O3.__decorate([(0,FS.AsnProp)({type:FS.AsnPropTypes.Any,context:0})],Ky.prototype,"secretValue",void 0)});var N3=g(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});var Mp=(T(),C(I));Mp.__exportStar(b3(),Oa);Mp.__exportStar(x3(),Oa);Mp.__exportStar(I3(),Oa);Mp.__exportStar(E3(),Oa);Mp.__exportStar(j3(),Oa);Mp.__exportStar(MS(),Oa)});var cR=g(ZS=>{"use strict";Object.defineProperty(ZS,"__esModule",{value:!0});ZS.MacData=void 0;var aR=(T(),C(I)),z3=uz(),qp=N(),Dp=class{constructor(e={}){this.mac=new z3.DigestInfo,this.macSalt=new qp.OctetString,this.iterations=1,Object.assign(this,e)}};ZS.MacData=Dp;aR.__decorate([(0,qp.AsnProp)({type:z3.DigestInfo})],Dp.prototype,"mac",void 0);aR.__decorate([(0,qp.AsnProp)({type:qp.OctetString})],Dp.prototype,"macSalt",void 0);aR.__decorate([(0,qp.AsnProp)({type:qp.AsnPropTypes.Integer,defaultValue:1})],Dp.prototype,"iterations",void 0)});var q3=g(GS=>{"use strict";Object.defineProperty(GS,"__esModule",{value:!0});GS.PFX=void 0;var lR=(T(),C(I)),HS=N(),R3=Py(),M3=cR(),Bp=class{constructor(e={}){this.version=3,this.authSafe=new R3.ContentInfo,this.macData=new M3.MacData,Object.assign(this,e)}};GS.PFX=Bp;lR.__decorate([(0,HS.AsnProp)({type:HS.AsnPropTypes.Integer})],Bp.prototype,"version",void 0);lR.__decorate([(0,HS.AsnProp)({type:R3.ContentInfo})],Bp.prototype,"authSafe",void 0);lR.__decorate([(0,HS.AsnProp)({type:M3.MacData,optional:!0})],Bp.prototype,"macData",void 0)});var D3=g(Ml=>{"use strict";var uR;Object.defineProperty(Ml,"__esModule",{value:!0});Ml.SafeContents=Ml.SafeBag=void 0;var WS=(T(),C(I)),ja=N(),Qme=Jz(),Rl=class{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}};Ml.SafeBag=Rl;WS.__decorate([(0,ja.AsnProp)({type:ja.AsnPropTypes.ObjectIdentifier})],Rl.prototype,"bagId",void 0);WS.__decorate([(0,ja.AsnProp)({type:ja.AsnPropTypes.Any,context:0})],Rl.prototype,"bagValue",void 0);WS.__decorate([(0,ja.AsnProp)({type:Qme.PKCS12Attribute,repeated:"set",optional:!0})],Rl.prototype,"bagAttributes",void 0);var dR=uR=class extends ja.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,uR.prototype)}};Ml.SafeContents=dR;Ml.SafeContents=dR=uR=WS.__decorate([(0,ja.AsnType)({type:ja.AsnTypeTypes.Sequence,itemType:Rl})],dR)});var B3=g(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});var ql=(T(),C(I));ql.__exportStar(Jz(),Ts);ql.__exportStar(v3(),Ts);ql.__exportStar(N3(),Ts);ql.__exportStar(cR(),Ts);ql.__exportStar(eR(),Ts);ql.__exportStar(q3(),Ts);ql.__exportStar(D3(),Ts)});var U3=g(b=>{"use strict";var pR,fR,mR;Object.defineProperty(b,"__esModule",{value:!0});b.DateOfBirth=b.UnstructuredAddress=b.UnstructuredName=b.EmailAddress=b.EncryptedPrivateKeyInfo=b.UserPKCS12=b.Pkcs7PDU=b.PKCS9String=b.id_at_pseudonym=b.crlTypes=b.id_certTypes=b.id_smime=b.id_pkcs9_mr_signingTimeMatch=b.id_pkcs9_mr_caseIgnoreMatch=b.id_pkcs9_sx_signingTime=b.id_pkcs9_sx_pkcs9String=b.id_pkcs9_at_countryOfResidence=b.id_pkcs9_at_countryOfCitizenship=b.id_pkcs9_at_gender=b.id_pkcs9_at_placeOfBirth=b.id_pkcs9_at_dateOfBirth=b.id_ietf_at=b.id_pkcs9_at_pkcs7PDU=b.id_pkcs9_at_sequenceNumber=b.id_pkcs9_at_randomNonce=b.id_pkcs9_at_encryptedPrivateKeyInfo=b.id_pkcs9_at_pkcs15Token=b.id_pkcs9_at_userPKCS12=b.id_pkcs9_at_localKeyId=b.id_pkcs9_at_friendlyName=b.id_pkcs9_at_smimeCapabilities=b.id_pkcs9_at_extensionRequest=b.id_pkcs9_at_signingDescription=b.id_pkcs9_at_extendedCertificateAttributes=b.id_pkcs9_at_unstructuredAddress=b.id_pkcs9_at_challengePassword=b.id_pkcs9_at_counterSignature=b.id_pkcs9_at_signingTime=b.id_pkcs9_at_messageDigest=b.id_pkcs9_at_contentType=b.id_pkcs9_at_unstructuredName=b.id_pkcs9_at_emailAddress=b.id_pkcs9_oc_naturalPerson=b.id_pkcs9_oc_pkcsEntity=b.id_pkcs9_mr=b.id_pkcs9_sx=b.id_pkcs9_at=b.id_pkcs9_oc=b.id_pkcs9_mo=b.id_pkcs9=void 0;b.SMIMECapabilities=b.SMIMECapability=b.SigningDescription=b.LocalKeyId=b.FriendlyName=b.ExtendedCertificateAttributes=b.ExtensionRequest=b.ChallengePassword=b.CounterSignature=b.SequenceNumber=b.RandomNonce=b.SigningTime=b.MessageDigest=b.ContentType=b.Pseudonym=b.CountryOfResidence=b.CountryOfCitizenship=b.Gender=b.PlaceOfBirth=void 0;var st=(T(),C(I)),Y=N(),jR=Py(),ehe=B3(),the=LS(),Es=Ye(),rhe=CN();b.id_pkcs9="1.2.840.113549.1.9";b.id_pkcs9_mo=`${b.id_pkcs9}.0`;b.id_pkcs9_oc=`${b.id_pkcs9}.24`;b.id_pkcs9_at=`${b.id_pkcs9}.25`;b.id_pkcs9_sx=`${b.id_pkcs9}.26`;b.id_pkcs9_mr=`${b.id_pkcs9}.27`;b.id_pkcs9_oc_pkcsEntity=`${b.id_pkcs9_oc}.1`;b.id_pkcs9_oc_naturalPerson=`${b.id_pkcs9_oc}.2`;b.id_pkcs9_at_emailAddress=`${b.id_pkcs9}.1`;b.id_pkcs9_at_unstructuredName=`${b.id_pkcs9}.2`;b.id_pkcs9_at_contentType=`${b.id_pkcs9}.3`;b.id_pkcs9_at_messageDigest=`${b.id_pkcs9}.4`;b.id_pkcs9_at_signingTime=`${b.id_pkcs9}.5`;b.id_pkcs9_at_counterSignature=`${b.id_pkcs9}.6`;b.id_pkcs9_at_challengePassword=`${b.id_pkcs9}.7`;b.id_pkcs9_at_unstructuredAddress=`${b.id_pkcs9}.8`;b.id_pkcs9_at_extendedCertificateAttributes=`${b.id_pkcs9}.9`;b.id_pkcs9_at_signingDescription=`${b.id_pkcs9}.13`;b.id_pkcs9_at_extensionRequest=`${b.id_pkcs9}.14`;b.id_pkcs9_at_smimeCapabilities=`${b.id_pkcs9}.15`;b.id_pkcs9_at_friendlyName=`${b.id_pkcs9}.20`;b.id_pkcs9_at_localKeyId=`${b.id_pkcs9}.21`;b.id_pkcs9_at_userPKCS12="2.16.840.1.113730.3.1.216";b.id_pkcs9_at_pkcs15Token=`${b.id_pkcs9_at}.1`;b.id_pkcs9_at_encryptedPrivateKeyInfo=`${b.id_pkcs9_at}.2`;b.id_pkcs9_at_randomNonce=`${b.id_pkcs9_at}.3`;b.id_pkcs9_at_sequenceNumber=`${b.id_pkcs9_at}.4`;b.id_pkcs9_at_pkcs7PDU=`${b.id_pkcs9_at}.5`;b.id_ietf_at="1.3.6.1.5.5.7.9";b.id_pkcs9_at_dateOfBirth=`${b.id_ietf_at}.1`;b.id_pkcs9_at_placeOfBirth=`${b.id_ietf_at}.2`;b.id_pkcs9_at_gender=`${b.id_ietf_at}.3`;b.id_pkcs9_at_countryOfCitizenship=`${b.id_ietf_at}.4`;b.id_pkcs9_at_countryOfResidence=`${b.id_ietf_at}.5`;b.id_pkcs9_sx_pkcs9String=`${b.id_pkcs9_sx}.1`;b.id_pkcs9_sx_signingTime=`${b.id_pkcs9_sx}.2`;b.id_pkcs9_mr_caseIgnoreMatch=`${b.id_pkcs9_mr}.1`;b.id_pkcs9_mr_signingTimeMatch=`${b.id_pkcs9_mr}.2`;b.id_smime=`${b.id_pkcs9}.16`;b.id_certTypes=`${b.id_pkcs9}.22`;b.crlTypes=`${b.id_pkcs9}.23`;b.id_at_pseudonym=`${rhe.id_at}.65`;var Jy=class extends Es.DirectoryString{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};b.PKCS9String=Jy;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.IA5String})],Jy.prototype,"ia5String",void 0);b.PKCS9String=Jy=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],Jy);var hR=class extends jR.ContentInfo{};b.Pkcs7PDU=hR;b.Pkcs7PDU=hR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],hR);var gR=class extends ehe.PFX{};b.UserPKCS12=gR;b.UserPKCS12=gR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],gR);var yR=class extends the.EncryptedPrivateKeyInfo{};b.EncryptedPrivateKeyInfo=yR;b.EncryptedPrivateKeyInfo=yR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],yR);var KS=class{constructor(e=""){this.value=e}toString(){return this.value}};b.EmailAddress=KS;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.IA5String})],KS.prototype,"value",void 0);b.EmailAddress=KS=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],KS);var vR=class extends Jy{};b.UnstructuredName=vR;b.UnstructuredName=vR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],vR);var _R=class extends Es.DirectoryString{};b.UnstructuredAddress=_R;b.UnstructuredAddress=_R=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],_R);var JS=class{constructor(e=new Date){this.value=e}};b.DateOfBirth=JS;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.GeneralizedTime})],JS.prototype,"value",void 0);b.DateOfBirth=JS=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],JS);var bR=class extends Es.DirectoryString{};b.PlaceOfBirth=bR;b.PlaceOfBirth=bR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],bR);var YS=class{constructor(e="M"){this.value=e}toString(){return this.value}};b.Gender=YS;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.PrintableString})],YS.prototype,"value",void 0);b.Gender=YS=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],YS);var Yy=class{constructor(e=""){this.value=e}toString(){return this.value}};b.CountryOfCitizenship=Yy;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.PrintableString})],Yy.prototype,"value",void 0);b.CountryOfCitizenship=Yy=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],Yy);var wR=class extends Yy{};b.CountryOfResidence=wR;b.CountryOfResidence=wR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],wR);var xR=class extends Es.DirectoryString{};b.Pseudonym=xR;b.Pseudonym=xR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],xR);var XS=class{constructor(e=""){this.value=e}toString(){return this.value}};b.ContentType=XS;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.ObjectIdentifier})],XS.prototype,"value",void 0);b.ContentType=XS=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],XS);var SR=class extends Y.OctetString{};b.MessageDigest=SR;var kR=class extends Es.Time{};b.SigningTime=kR;b.SigningTime=kR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],kR);var $R=class extends Y.OctetString{};b.RandomNonce=$R;var QS=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};b.SequenceNumber=QS;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.Integer})],QS.prototype,"value",void 0);b.SequenceNumber=QS=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],QS);var AR=class extends jR.SignerInfo{};b.CounterSignature=AR;b.CounterSignature=AR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],AR);var PR=class extends Es.DirectoryString{};b.ChallengePassword=PR;b.ChallengePassword=PR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],PR);var CR=pR=class extends Es.Extensions{constructor(e){super(e),Object.setPrototypeOf(this,pR.prototype)}};b.ExtensionRequest=CR;b.ExtensionRequest=CR=pR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],CR);var IR=fR=class extends Y.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,fR.prototype)}};b.ExtendedCertificateAttributes=IR;b.ExtendedCertificateAttributes=IR=fR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Set,itemType:jR.Attribute})],IR);var ek=class{constructor(e=""){this.value=e}toString(){return this.value}};b.FriendlyName=ek;st.__decorate([(0,Y.AsnProp)({type:Y.AsnPropTypes.BmpString})],ek.prototype,"value",void 0);b.FriendlyName=ek=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Choice})],ek);var TR=class extends Y.OctetString{};b.LocalKeyId=TR;var ER=class extends Es.DirectoryString{};b.SigningDescription=ER;var tk=class extends Es.AlgorithmIdentifier{};b.SMIMECapability=tk;b.SMIMECapability=tk=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence})],tk);var OR=mR=class extends Y.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,mR.prototype)}};b.SMIMECapabilities=OR;b.SMIMECapabilities=OR=mR=st.__decorate([(0,Y.AsnType)({type:Y.AsnTypeTypes.Sequence,itemType:tk})],OR)});var MR=g(Xy=>{"use strict";var NR;Object.defineProperty(Xy,"__esModule",{value:!0});Xy.Attributes=void 0;var nhe=(T(),C(I)),zR=N(),ohe=Ye(),RR=NR=class extends zR.AsnArray{constructor(e){super(e),Object.setPrototypeOf(this,NR.prototype)}};Xy.Attributes=RR;Xy.Attributes=RR=NR=nhe.__decorate([(0,zR.AsnType)({type:zR.AsnTypeTypes.Sequence,itemType:ohe.Attribute})],RR)});var qR=g(ok=>{"use strict";Object.defineProperty(ok,"__esModule",{value:!0});ok.CertificationRequestInfo=void 0;var nk=(T(),C(I)),Qy=N(),rk=Ye(),L3=MR(),Dl=class{constructor(e={}){this.version=0,this.subject=new rk.Name,this.subjectPKInfo=new rk.SubjectPublicKeyInfo,this.attributes=new L3.Attributes,Object.assign(this,e)}};ok.CertificationRequestInfo=Dl;nk.__decorate([(0,Qy.AsnProp)({type:Qy.AsnPropTypes.Integer})],Dl.prototype,"version",void 0);nk.__decorate([(0,Qy.AsnProp)({type:rk.Name})],Dl.prototype,"subject",void 0);nk.__decorate([(0,Qy.AsnProp)({type:rk.SubjectPublicKeyInfo})],Dl.prototype,"subjectPKInfo",void 0);nk.__decorate([(0,Qy.AsnProp)({type:L3.Attributes,implicit:!0,context:0,optional:!0})],Dl.prototype,"attributes",void 0)});var Z3=g(sk=>{"use strict";Object.defineProperty(sk,"__esModule",{value:!0});sk.CertificationRequest=void 0;var DR=(T(),C(I)),ik=N(),F3=qR(),V3=Ye(),Up=class{constructor(e={}){this.certificationRequestInfo=new F3.CertificationRequestInfo,this.signatureAlgorithm=new V3.AlgorithmIdentifier,this.signature=new ArrayBuffer(0),Object.assign(this,e)}};sk.CertificationRequest=Up;DR.__decorate([(0,ik.AsnProp)({type:F3.CertificationRequestInfo,raw:!0})],Up.prototype,"certificationRequestInfo",void 0);DR.__decorate([(0,ik.AsnProp)({type:V3.AlgorithmIdentifier})],Up.prototype,"signatureAlgorithm",void 0);DR.__decorate([(0,ik.AsnProp)({type:ik.AsnPropTypes.BitString})],Up.prototype,"signature",void 0)});var H3=g(ev=>{"use strict";Object.defineProperty(ev,"__esModule",{value:!0});var BR=(T(),C(I));BR.__exportStar(MR(),ev);BR.__exportStar(Z3(),ev);BR.__exportStar(qR(),ev)});var T8=g(B=>{"use strict";WV();var j=N(),Q=Ye(),q=ps(),z=(T(),C(I)),ihe=Py(),bk=M5(),En=uz(),At=y3(),GR=U3(),wk=H3();function Fv(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}var O=Fv(Q),Tn=Fv(ihe),Bt=Fv(bk),$t=Fv(En),Kp=Fv(GR),ef="crypto.algorithm",xk=class{getAlgorithms(){return At.container.resolveAll(ef)}toAsnAlgorithm(e){({...e});for(let r of this.getAlgorithms()){let n=r.toAsnAlgorithm(e);if(n)return n}if(/^[0-9.]+$/.test(e.name)){let r=new Q.AlgorithmIdentifier({algorithm:e.name});if("parameters"in e){let n=e;r.parameters=n.parameters}return r}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let n of this.getAlgorithms()){let o=n.toWebAlgorithm(e);if(o)return o}return{name:e.algorithm,parameters:e.parameters}}},ni="crypto.algorithmProvider";At.container.registerSingleton(ni,xk);var lk,zn="1.3.36.3.3.2.8.1.1",G3=`${zn}.1`,W3=`${zn}.2`,K3=`${zn}.3`,J3=`${zn}.4`,Y3=`${zn}.5`,X3=`${zn}.6`,Q3=`${zn}.7`,e8=`${zn}.8`,t8=`${zn}.9`,r8=`${zn}.10`,n8=`${zn}.11`,o8=`${zn}.12`,i8=`${zn}.13`,s8=`${zn}.14`,a8="brainpoolP160r1",c8="brainpoolP160t1",l8="brainpoolP192r1",u8="brainpoolP192t1",d8="brainpoolP224r1",p8="brainpoolP224t1",f8="brainpoolP256r1",m8="brainpoolP256t1",h8="brainpoolP320r1",g8="brainpoolP320t1",y8="brainpoolP384r1",v8="brainpoolP384t1",_8="brainpoolP512r1",b8="brainpoolP512t1",Gt="ECDSA";B.EcAlgorithm=lk=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case Gt.toLowerCase():if("hash"in e)switch((typeof e.hash=="string"?e.hash:e.hash.name).toLowerCase()){case"sha-1":return Bt.ecdsaWithSHA1;case"sha-256":return Bt.ecdsaWithSHA256;case"sha-384":return Bt.ecdsaWithSHA384;case"sha-512":return Bt.ecdsaWithSHA512}else if("namedCurve"in e){let r="";switch(e.namedCurve){case"P-256":r=Bt.id_secp256r1;break;case"K-256":r=lk.SECP256K1;break;case"P-384":r=Bt.id_secp384r1;break;case"P-521":r=Bt.id_secp521r1;break;case a8:r=G3;break;case c8:r=W3;break;case l8:r=K3;break;case u8:r=J3;break;case d8:r=Y3;break;case p8:r=X3;break;case f8:r=Q3;break;case m8:r=e8;break;case h8:r=t8;break;case g8:r=r8;break;case y8:r=n8;break;case v8:r=o8;break;case _8:r=i8;break;case b8:r=s8;break}if(r)return new Q.AlgorithmIdentifier({algorithm:Bt.id_ecPublicKey,parameters:j.AsnConvert.serialize(new Bt.ECParameters({namedCurve:r}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case Bt.id_ecdsaWithSHA1:return{name:Gt,hash:{name:"SHA-1"}};case Bt.id_ecdsaWithSHA256:return{name:Gt,hash:{name:"SHA-256"}};case Bt.id_ecdsaWithSHA384:return{name:Gt,hash:{name:"SHA-384"}};case Bt.id_ecdsaWithSHA512:return{name:Gt,hash:{name:"SHA-512"}};case Bt.id_ecPublicKey:{if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(j.AsnConvert.parse(e.parameters,Bt.ECParameters).namedCurve){case Bt.id_secp256r1:return{name:Gt,namedCurve:"P-256"};case lk.SECP256K1:return{name:Gt,namedCurve:"K-256"};case Bt.id_secp384r1:return{name:Gt,namedCurve:"P-384"};case Bt.id_secp521r1:return{name:Gt,namedCurve:"P-521"};case G3:return{name:Gt,namedCurve:a8};case W3:return{name:Gt,namedCurve:c8};case K3:return{name:Gt,namedCurve:l8};case J3:return{name:Gt,namedCurve:u8};case Y3:return{name:Gt,namedCurve:d8};case X3:return{name:Gt,namedCurve:p8};case Q3:return{name:Gt,namedCurve:f8};case e8:return{name:Gt,namedCurve:m8};case t8:return{name:Gt,namedCurve:h8};case r8:return{name:Gt,namedCurve:g8};case n8:return{name:Gt,namedCurve:y8};case o8:return{name:Gt,namedCurve:v8};case i8:return{name:Gt,namedCurve:_8};case s8:return{name:Gt,namedCurve:b8}}}}return null}};B.EcAlgorithm.SECP256K1="1.3.132.0.10";B.EcAlgorithm=lk=z.__decorate([At.injectable()],B.EcAlgorithm);At.container.registerSingleton(ef,B.EcAlgorithm);var A8=Symbol("name"),P8=Symbol("value"),Me=class{constructor(e,r={},n=""){this[A8]=e,this[P8]=n;for(let o in r)this[o]=r[o]}};Me.NAME=A8;Me.VALUE=P8;var Sk=class{static toTextObject(e){let r=new Me("Algorithm Identifier",{},ko.toString(e.algorithm));if(e.parameters)if(e.algorithm===Bt.id_ecPublicKey){let n=new B.EcAlgorithm().toWebAlgorithm(e);n&&"namedCurve"in n?r["Named Curve"]=n.namedCurve:r.Parameters=e.parameters}else r.Parameters=e.parameters;return r}},ko=class{static toString(e){let r=this.items[e];return r||e}};ko.items={[$t.id_sha1]:"sha1",[$t.id_sha224]:"sha224",[$t.id_sha256]:"sha256",[$t.id_sha384]:"sha384",[$t.id_sha512]:"sha512",[$t.id_rsaEncryption]:"rsaEncryption",[$t.id_sha1WithRSAEncryption]:"sha1WithRSAEncryption",[$t.id_sha224WithRSAEncryption]:"sha224WithRSAEncryption",[$t.id_sha256WithRSAEncryption]:"sha256WithRSAEncryption",[$t.id_sha384WithRSAEncryption]:"sha384WithRSAEncryption",[$t.id_sha512WithRSAEncryption]:"sha512WithRSAEncryption",[Bt.id_ecPublicKey]:"ecPublicKey",[Bt.id_ecdsaWithSHA1]:"ecdsaWithSHA1",[Bt.id_ecdsaWithSHA224]:"ecdsaWithSHA224",[Bt.id_ecdsaWithSHA256]:"ecdsaWithSHA256",[Bt.id_ecdsaWithSHA384]:"ecdsaWithSHA384",[Bt.id_ecdsaWithSHA512]:"ecdsaWithSHA512",[O.id_kp_serverAuth]:"TLS WWW server authentication",[O.id_kp_clientAuth]:"TLS WWW client authentication",[O.id_kp_codeSigning]:"Code Signing",[O.id_kp_emailProtection]:"E-mail Protection",[O.id_kp_timeStamping]:"Time Stamping",[O.id_kp_OCSPSigning]:"OCSP Signing",[Tn.id_signedData]:"Signed Data"};var oi=class{static serialize(e){return this.serializeObj(e).join(`
`)}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,r=0){let n=[],o=this.pad(r++),i="",s=e[Me.VALUE];s&&(i=` ${s}`),n.push(`${o}${e[Me.NAME]}:${i}`),o=this.pad(r);for(let a in e){if(typeof a=="symbol")continue;let c=e[a],l=a?`${a}: `:"";if(typeof c=="string"||typeof c=="number"||typeof c=="boolean")n.push(`${o}${l}${c}`);else if(c instanceof Date)n.push(`${o}${l}${c.toUTCString()}`);else if(Array.isArray(c))for(let u of c)u[Me.NAME]=a,n.push(...this.serializeObj(u,r));else if(c instanceof Me)c[Me.NAME]=a,n.push(...this.serializeObj(c,r));else if(q.BufferSourceConverter.isBufferSource(c))a?(n.push(`${o}${l}`),n.push(...this.serializeBufferSource(c,r+1))):n.push(...this.serializeBufferSource(c,r));else if("toTextObject"in c){let u=c.toTextObject();u[Me.NAME]=a,n.push(...this.serializeObj(u,r))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return n}static serializeBufferSource(e,r=0){let n=this.pad(r),o=q.BufferSourceConverter.toUint8Array(e),i=[];for(let s=0;s<o.length;){let a=[];for(let c=0;c<16&&s<o.length;c++){c===8&&a.push("");let l=o[s++].toString(16).padStart(2,"0");a.push(l)}i.push(`${n}${a.join(" ")}`)}return i}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}};oi.oidSerializer=ko;oi.algorithmSerializer=Sk;var Lp,qi=class t{get rawData(){return z.__classPrivateFieldGet(this,Lp,"f")||z.__classPrivateFieldSet(this,Lp,j.AsnConvert.serialize(this.asn),"f"),z.__classPrivateFieldGet(this,Lp,"f")}constructor(...e){Lp.set(this,void 0),q.BufferSourceConverter.isBufferSource(e[0])?(this.asn=j.AsnConvert.parse(e[0],e[1]),z.__classPrivateFieldSet(this,Lp,q.BufferSourceConverter.toArrayBuffer(e[0]),"f"),this.onInit(this.asn)):(this.asn=e[0],this.onInit(this.asn))}equal(e){return e instanceof t?q.isEqual(e.rawData,this.rawData):!1}toString(e="text"){switch(e){case"asn":return j.AsnConvert.toString(this.rawData);case"text":return oi.serialize(this.toTextObject());case"hex":return q.Convert.ToHex(this.rawData);case"base64":return q.Convert.ToBase64(this.rawData);case"base64url":return q.Convert.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new Me(this.getTextName(),{},e)}};Lp=new WeakMap;qi.NAME="ASN";var On=class t extends qi{constructor(...e){let r;q.BufferSourceConverter.isBufferSource(e[0])?r=q.BufferSourceConverter.toArrayBuffer(e[0]):r=j.AsnConvert.serialize(new Q.Extension({extnID:e[0],critical:e[1],extnValue:new j.OctetString(q.BufferSourceConverter.toArrayBuffer(e[2]))})),super(r,Q.Extension)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[Me.NAME]===t.NAME&&(e[Me.NAME]=ko.toString(this.type)),e}},C8,Jp=class t{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&e.extractable!==void 0}constructor(){this.items=new Map,this[C8]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(t.DEFAULT,crypto):typeof global<"u"&&global.crypto&&global.crypto.subtle&&this.set(t.DEFAULT,global.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,r){return this.items.forEach(e,r)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=t.DEFAULT){let r=this.items.get(e.toLowerCase());if(!r)throw new Error(`Cannot get Crypto by name '${e}'`);return r}set(e,r){if(typeof e=="string"){if(!r)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),r)}else this.items.set(t.DEFAULT,e);return this}};C8=Symbol.toStringTag;Jp.DEFAULT="default";var Ut=new Jp,she=/^[0-2](?:\.[1-9][0-9]*)+$/;function ahe(t){return new RegExp(she).test(t)}var Iv=class{constructor(e={}){this.items={};for(let r in e)this.register(r,e[r])}get(e){return this.items[e]||null}findId(e){return ahe(e)?e:this.get(e)}register(e,r){this.items[e]=r,this.items[r]=e}},jn=new Iv;jn.register("CN","2.5.4.3");jn.register("L","2.5.4.7");jn.register("ST","2.5.4.8");jn.register("O","2.5.4.10");jn.register("OU","2.5.4.11");jn.register("C","2.5.4.6");jn.register("DC","0.9.2342.19200300.100.1.25");jn.register("E","1.2.840.113549.1.9.1");jn.register("G","2.5.4.42");jn.register("I","2.5.4.43");jn.register("SN","2.5.4.4");jn.register("T","2.5.4.12");function che(t,e){return`\\${q.Convert.ToHex(q.Convert.FromUtf8String(e)).toUpperCase()}`}function lhe(t){return t.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,che)}var vr=class t{static isASCII(e){for(let r=0;r<e.length;r++)if(e.charCodeAt(r)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,r={}){this.extraNames=new Iv,this.asn=new Q.Name;for(let n in r)if(Object.prototype.hasOwnProperty.call(r,n)){let o=r[n];this.extraNames.register(n,o)}typeof e=="string"?this.asn=this.fromString(e):e instanceof Q.Name?this.asn=e:q.BufferSourceConverter.isBufferSource(e)?this.asn=j.AsnConvert.parse(e,Q.Name):this.asn=this.fromJSON(e)}getField(e){let r=this.extraNames.findId(e)||jn.findId(e),n=[];for(let o of this.asn)for(let i of o)i.type===r&&n.push(i.value.toString());return n}getName(e){return this.extraNames.get(e)||jn.get(e)}toString(){return this.asn.map(e=>e.map(r=>{let n=this.getName(r.type)||r.type,o=r.value.anyValue?`#${q.Convert.ToHex(r.value.anyValue)}`:lhe(r.value.toString());return`${n}=${o}`}).join("+")).join(", ")}toJSON(){var e;let r=[];for(let n of this.asn){let o={};for(let i of n){let s=this.getName(i.type)||i.type;(e=o[s])!==null&&e!==void 0||(o[s]=[]),o[s].push(i.value.anyValue?`#${q.Convert.ToHex(i.value.anyValue)}`:i.value.toString())}r.push(o)}return r}fromString(e){let r=new Q.Name,n=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,o=null,i=",";for(;o=n.exec(`${e},`);){let[,s,a]=o,c=a[a.length-1];(c===","||c==="+")&&(a=a.slice(0,a.length-1),o[3]=c);let l=o[3];s=this.getTypeOid(s);let u=this.createAttribute(s,a);i==="+"?r[r.length-1].push(u):r.push(new Q.RelativeDistinguishedName([u])),i=l}return r}fromJSON(e){let r=new Q.Name;for(let n of e){let o=new Q.RelativeDistinguishedName;for(let i in n){let s=this.getTypeOid(i),a=n[i];for(let c of a){let l=this.createAttribute(s,c);o.push(l)}}r.push(o)}return r}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,r){let n=new Q.AttributeTypeAndValue({type:e});if(typeof r=="object")for(let o in r)switch(o){case"ia5String":n.value.ia5String=r[o];break;case"utf8String":n.value.utf8String=r[o];break;case"universalString":n.value.universalString=r[o];break;case"bmpString":n.value.bmpString=r[o];break;case"printableString":n.value.printableString=r[o];break}else if(r[0]==="#")n.value.anyValue=q.Convert.FromHex(r.slice(1));else{let o=this.processStringValue(r);e===this.getName("E")||e===this.getName("DC")?n.value.ia5String=o:t.isPrintableString(o)?n.value.printableString=o:n.value.utf8String=o}return n}processStringValue(e){let r=/"(.*?[^\\])?"/.exec(e);return r&&(e=r[1]),e.replace(/\\0a/ig,`
`).replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return j.AsnConvert.serialize(this.asn)}async getThumbprint(...e){var r;let n,o="SHA-1";return e.length>=1&&!(!((r=e[0])===null||r===void 0)&&r.subtle)?(o=e[0]||o,n=e[1]||Ut.get()):n=e[0]||Ut.get(),await n.subtle.digest(o,this.toArrayBuffer())}},I8="Cannot initialize GeneralName from ASN.1 data.",w8=`${I8} Unsupported string format in use.`,uhe=`${I8} Value doesn't match to GUID regular expression.`,x8=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,S8="1.3.6.1.4.1.311.25.1",k8="1.3.6.1.4.1.311.20.2.3",uk="dns",dk="dn",pk="email",fk="ip",mk="url",hk="guid",gk="upn",tv="id",ti=class extends qi{constructor(...e){let r;if(e.length===2)switch(e[0]){case dk:{let n=new vr(e[1]).toArrayBuffer(),o=j.AsnConvert.parse(n,O.Name);r=new O.GeneralName({directoryName:o});break}case uk:r=new O.GeneralName({dNSName:e[1]});break;case pk:r=new O.GeneralName({rfc822Name:e[1]});break;case hk:{let n=new RegExp(x8,"i").exec(e[1]);if(!n)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");let o=n.slice(1).map((i,s)=>s<3?q.Convert.ToHex(new Uint8Array(q.Convert.FromHex(i)).reverse()):i).join("");r=new O.GeneralName({otherName:new O.OtherName({typeId:S8,value:j.AsnConvert.serialize(new j.OctetString(q.Convert.FromHex(o)))})});break}case fk:r=new O.GeneralName({iPAddress:e[1]});break;case tv:r=new O.GeneralName({registeredID:e[1]});break;case gk:{r=new O.GeneralName({otherName:new O.OtherName({typeId:k8,value:j.AsnConvert.serialize(j.AsnUtf8StringConverter.toASN(e[1]))})});break}case mk:r=new O.GeneralName({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else q.BufferSourceConverter.isBufferSource(e[0])?r=j.AsnConvert.parse(e[0],O.GeneralName):r=e[0];super(r)}onInit(e){if(e.dNSName!=null)this.type=uk,this.value=e.dNSName;else if(e.rfc822Name!=null)this.type=pk,this.value=e.rfc822Name;else if(e.iPAddress!=null)this.type=fk,this.value=e.iPAddress;else if(e.uniformResourceIdentifier!=null)this.type=mk,this.value=e.uniformResourceIdentifier;else if(e.registeredID!=null)this.type=tv,this.value=e.registeredID;else if(e.directoryName!=null)this.type=dk,this.value=new vr(e.directoryName).toString();else if(e.otherName!=null)if(e.otherName.typeId===S8){this.type=hk;let r=j.AsnConvert.parse(e.otherName.value,j.OctetString),n=new RegExp(x8,"i").exec(q.Convert.ToHex(r));if(!n)throw new Error(uhe);this.value=n.slice(1).map((o,i)=>i<3?q.Convert.ToHex(new Uint8Array(q.Convert.FromHex(o)).reverse()):o).join("-")}else if(e.otherName.typeId===k8)this.type=gk,this.value=j.AsnConvert.parse(e.otherName.value,O.DirectoryString).toString();else throw new Error(w8);else throw new Error(w8)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case dk:case uk:case hk:case fk:case tv:case gk:case mk:e=this.type.toUpperCase();break;case pk:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let r=this.value;return this.type===tv&&(r=ko.toString(r)),new Me(e,void 0,r)}},Di=class extends qi{constructor(e){let r;if(e instanceof O.GeneralNames)r=e;else if(Array.isArray(e)){let n=[];for(let o of e)if(o instanceof O.GeneralName)n.push(o);else{let i=j.AsnConvert.parse(new ti(o.type,o.value).rawData,O.GeneralName);n.push(i)}r=new O.GeneralNames(n)}else if(q.BufferSourceConverter.isBufferSource(e))r=j.AsnConvert.parse(e,O.GeneralNames);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(r)}onInit(e){let r=[];for(let n of e){let o=null;try{o=new ti(n)}catch{continue}r.push(o)}this.items=r}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let r of this.items){let n=r.toTextObject(),o=e[n[Me.NAME]];Array.isArray(o)||(o=[],e[n[Me.NAME]]=o),o.push(n)}return e}};Di.NAME="GeneralNames";var Cv="-{5}",Tv="\\n",dhe=`[^${Tv}]+`,phe=`${Cv}BEGIN (${dhe}(?=${Cv}))${Cv}`,fhe=`${Cv}END \\1${Cv}`,Yp="\\n",mhe=`[^:${Tv}]+`,hhe=`(?:[^${Tv}]+${Yp}(?: +[^${Tv}]+${Yp})*)`,ghe="[a-zA-Z0-9=+/]+",yhe=`(?:${ghe}${Yp})+`,$8=`${phe}${Yp}(?:((?:${mhe}: ${hhe})+))?${Yp}?(${yhe})${fhe}`,kr=class{static isPem(e){return typeof e=="string"&&new RegExp($8,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let r=new RegExp($8,"g"),n=[],o=null;for(;o=r.exec(e);){let i=o[3].replace(new RegExp(`[${Tv}]+`,"g"),""),s={type:o[1],headers:[],rawData:q.Convert.FromBase64(i)},a=o[2];if(a){let c=a.split(new RegExp(Yp,"g")),l=null;for(let u of c){let[d,p]=u.split(/:(.*)/);if(p===void 0){if(!l)throw new Error("Cannot parse PEM string. Incorrect header value");l.value+=d.trim()}else l&&s.headers.push(l),l={key:d,value:p.trim()}}l&&s.headers.push(l)}n.push(s)}return n}static decode(e){return this.decodeWithHeaders(e).map(n=>n.rawData)}static decodeFirst(e){let r=this.decode(e);if(!r.length)throw new RangeError("PEM string doesn't contain any objects");return r[0]}static encode(e,r){if(Array.isArray(e)){let n=new Array;return r?e.forEach(o=>{if(!q.BufferSourceConverter.isBufferSource(o))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");n.push(this.encodeStruct({type:r,rawData:q.BufferSourceConverter.toArrayBuffer(o)}))}):e.forEach(o=>{if(!("type"in o))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");n.push(this.encodeStruct(o))}),n.join(`
`)}else{if(!r)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:r,rawData:q.BufferSourceConverter.toArrayBuffer(e)})}}static encodeStruct(e){var r;let n=e.type.toLocaleUpperCase(),o=[];if(o.push(`-----BEGIN ${n}-----`),!((r=e.headers)===null||r===void 0)&&r.length){for(let l of e.headers)o.push(`${l.key}: ${l.value}`);o.push("")}let i=q.Convert.ToBase64(e.rawData),s,a=0,c=Array();for(;a<i.length&&(i.length-a<64?s=i.substring(a):(s=i.substring(a,a+64),a+=64),s.length!==0);)if(c.push(s),s.length<64)break;return o.push(...c),o.push(`-----END ${n}-----`),o.join(`
`)}};kr.CertificateTag="CERTIFICATE";kr.CrlTag="CRL";kr.CertificateRequestTag="CERTIFICATE REQUEST";kr.PublicKeyTag="PUBLIC KEY";kr.PrivateKeyTag="PRIVATE KEY";var Nn=class t extends qi{static isAsnEncoded(e){return q.BufferSourceConverter.isBufferSource(e)||typeof e=="string"}static toArrayBuffer(e){if(typeof e=="string"){if(kr.isPem(e))return kr.decode(e)[0];if(q.Convert.isHex(e))return q.Convert.FromHex(e);if(q.Convert.isBase64(e))return q.Convert.FromBase64(e);if(q.Convert.isBase64Url(e))return q.Convert.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{let r=q.BufferSourceConverter.toUint8Array(e);if(r.length>0&&r[0]===48)return q.BufferSourceConverter.toArrayBuffer(e);let n=q.Convert.ToBinary(e);if(kr.isPem(n))return kr.decode(n)[0];if(q.Convert.isHex(n))return q.Convert.FromHex(n);if(q.Convert.isBase64(n))return q.Convert.FromBase64(n);if(q.Convert.isBase64Url(n))return q.Convert.FromBase64Url(n);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...e){t.isAsnEncoded(e[0])?super(t.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return e==="pem"?kr.encode(this.rawData,this.tag):super.toString(e)}},ri=class t extends Nn{static async create(e,r=Ut.get()){if(e instanceof t)return e;if(Jp.isCryptoKey(e)){if(e.type!=="public")throw new TypeError("Public key is required");let n=await r.subtle.exportKey("spki",e);return new t(n)}else{if(e.publicKey)return e.publicKey;if(q.BufferSourceConverter.isBufferSource(e))return new t(e);throw new TypeError("Unsupported PublicKeyType")}}constructor(e){Nn.isAsnEncoded(e)?super(e,Q.SubjectPublicKeyInfo):super(e),this.tag=kr.PublicKeyTag}async export(...e){let r,n=["verify"],o={hash:"SHA-256",...this.algorithm};e.length>1?(o=e[0]||o,n=e[1]||n,r=e[2]||Ut.get()):r=e[0]||Ut.get();let i=this.rawData,s=j.AsnConvert.parse(this.rawData,Q.SubjectPublicKeyInfo);return s.algorithm.algorithm===En.id_RSASSA_PSS&&(i=vhe(s,i)),r.subtle.importKey("spki",i,o,!0,n)}onInit(e){let r=At.container.resolve(ni),n=this.algorithm=r.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===En.id_rsaEncryption){let o=j.AsnConvert.parse(e.subjectPublicKey,En.RSAPublicKey),i=q.BufferSourceConverter.toUint8Array(o.modulus);n.publicExponent=q.BufferSourceConverter.toUint8Array(o.publicExponent),n.modulusLength=(i[0]?i:i.slice(1)).byteLength<<3}}async getThumbprint(...e){var r;let n,o="SHA-1";return e.length>=1&&!(!((r=e[0])===null||r===void 0)&&r.subtle)?(o=e[0]||o,n=e[1]||Ut.get()):n=e[0]||Ut.get(),await n.subtle.digest(o,this.rawData)}async getKeyIdentifier(...e){let r,n="SHA-1";e.length===1?typeof e[0]=="string"?(n=e[0],r=Ut.get()):r=e[0]:e.length===2?(n=e[0],r=e[1]):r=Ut.get();let o=j.AsnConvert.parse(this.rawData,Q.SubjectPublicKeyInfo);return await r.subtle.digest(n,o.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),r=j.AsnConvert.parse(this.rawData,Q.SubjectPublicKeyInfo);switch(e.Algorithm=oi.serializeAlgorithm(r.algorithm),r.algorithm.algorithm){case bk.id_ecPublicKey:e["EC Point"]=r.subjectPublicKey;break;case En.id_rsaEncryption:default:e["Raw Data"]=r.subjectPublicKey}return e}};function vhe(t,e){return t.algorithm=new Q.AlgorithmIdentifier({algorithm:En.id_rsaEncryption,parameters:null}),e=j.AsnConvert.serialize(t),e}var Ev=class t extends On{static async create(e,r=!1,n=Ut.get()){if("name"in e&&"serialNumber"in e)return new t(e,r);let i=await(await ri.create(e,n)).getKeyIdentifier(n);return new t(q.Convert.ToHex(i),r)}constructor(...e){if(q.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(typeof e[0]=="string"){let r=new O.AuthorityKeyIdentifier({keyIdentifier:new O.KeyIdentifier(q.Convert.FromHex(e[0]))});super(O.id_ce_authorityKeyIdentifier,e[1],j.AsnConvert.serialize(r))}else{let r=e[0],n=r.name instanceof Di?j.AsnConvert.parse(r.name.rawData,O.GeneralNames):r.name,o=new O.AuthorityKeyIdentifier({authorityCertIssuer:n,authorityCertSerialNumber:q.Convert.FromHex(r.serialNumber)});super(O.id_ce_authorityKeyIdentifier,e[1],j.AsnConvert.serialize(o))}}onInit(e){super.onInit(e);let r=j.AsnConvert.parse(e.extnValue,O.AuthorityKeyIdentifier);r.keyIdentifier&&(this.keyId=q.Convert.ToHex(r.keyIdentifier)),(r.authorityCertIssuer||r.authorityCertSerialNumber)&&(this.certId={name:r.authorityCertIssuer||[],serialNumber:r.authorityCertSerialNumber?q.Convert.ToHex(r.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),r=j.AsnConvert.parse(this.value,O.AuthorityKeyIdentifier);return r.authorityCertIssuer&&(e["Authority Issuer"]=new Di(r.authorityCertIssuer).toTextObject()),r.authorityCertSerialNumber&&(e["Authority Serial Number"]=r.authorityCertSerialNumber),r.keyIdentifier&&(e[""]=r.keyIdentifier),e}};Ev.NAME="Authority Key Identifier";var Ov=class extends On{constructor(...e){if(q.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);let r=j.AsnConvert.parse(this.value,Q.BasicConstraints);this.ca=r.cA,this.pathLength=r.pathLenConstraint}else{let r=new Q.BasicConstraints({cA:e[0],pathLenConstraint:e[1]});super(Q.id_ce_basicConstraints,e[2],j.AsnConvert.serialize(r)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),this.pathLength!==void 0&&(e["Path Length"]=this.pathLength),e}};Ov.NAME="Basic Constraints";B.ExtendedKeyUsage=void 0;(function(t){t.serverAuth="1.3.6.1.5.5.7.3.1",t.clientAuth="1.3.6.1.5.5.7.3.2",t.codeSigning="1.3.6.1.5.5.7.3.3",t.emailProtection="1.3.6.1.5.5.7.3.4",t.timeStamping="1.3.6.1.5.5.7.3.8",t.ocspSigning="1.3.6.1.5.5.7.3.9"})(B.ExtendedKeyUsage||(B.ExtendedKeyUsage={}));var jv=class extends On{constructor(...e){if(q.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);let r=j.AsnConvert.parse(this.value,O.ExtendedKeyUsage);this.usages=r.map(n=>n)}else{let r=new O.ExtendedKeyUsage(e[0]);super(O.id_ce_extKeyUsage,e[1],j.AsnConvert.serialize(r)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(r=>ko.toString(r)).join(", "),e}};jv.NAME="Extended Key Usages";B.KeyUsageFlags=void 0;(function(t){t[t.digitalSignature=1]="digitalSignature",t[t.nonRepudiation=2]="nonRepudiation",t[t.keyEncipherment=4]="keyEncipherment",t[t.dataEncipherment=8]="dataEncipherment",t[t.keyAgreement=16]="keyAgreement",t[t.keyCertSign=32]="keyCertSign",t[t.cRLSign=64]="cRLSign",t[t.encipherOnly=128]="encipherOnly",t[t.decipherOnly=256]="decipherOnly"})(B.KeyUsageFlags||(B.KeyUsageFlags={}));var Nv=class extends On{constructor(...e){if(q.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);let r=j.AsnConvert.parse(this.value,Q.KeyUsage);this.usages=r.toNumber()}else{let r=new Q.KeyUsage(e[0]);super(Q.id_ce_keyUsage,e[1],j.AsnConvert.serialize(r)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue(),r=j.AsnConvert.parse(this.value,Q.KeyUsage);return e[""]=r.toJSON().join(", "),e}};Nv.NAME="Key Usages";var zv=class t extends On{static async create(e,r=!1,n=Ut.get()){let i=await(await ri.create(e,n)).getKeyIdentifier(n);return new t(q.Convert.ToHex(i),r)}constructor(...e){if(q.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);let r=j.AsnConvert.parse(this.value,O.SubjectKeyIdentifier);this.keyId=q.Convert.ToHex(r)}else{let r=typeof e[0]=="string"?q.Convert.FromHex(e[0]):e[0],n=new O.SubjectKeyIdentifier(r);super(O.id_ce_subjectKeyIdentifier,e[1],j.AsnConvert.serialize(n)),this.keyId=q.Convert.ToHex(r)}}toTextObject(){let e=this.toTextObjectWithoutValue(),r=j.AsnConvert.parse(this.value,O.SubjectKeyIdentifier);return e[""]=r,e}};zv.NAME="Subject Key Identifier";var Rv=class extends On{constructor(...e){q.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(O.id_ce_subjectAltName,e[1],new Di(e[0]||[]).rawData)}onInit(e){super.onInit(e);let r=j.AsnConvert.parse(e.extnValue,O.SubjectAlternativeName);this.names=new Di(r)}toTextObject(){let e=this.toTextObjectWithoutValue(),r=this.names.toTextObject();for(let n in r)e[n]=r[n];return e}};Rv.NAME="Subject Alternative Name";var $r=class{static register(e,r){this.items.set(e,r)}static create(e){let r=new On(e),n=this.items.get(r.type);return n?new n(e):r}};$r.items=new Map;var Mv=class extends On{constructor(...e){var r;if(q.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);let n=j.AsnConvert.parse(this.value,O.CertificatePolicies);this.policies=n.map(o=>o.policyIdentifier)}else{let n=e[0],o=(r=e[1])!==null&&r!==void 0?r:!1,i=new O.CertificatePolicies(n.map(s=>new O.PolicyInformation({policyIdentifier:s})));super(O.id_ce_certificatePolicies,o,j.AsnConvert.serialize(i)),this.policies=n}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(r=>new Me("",{},ko.toString(r))),e}};Mv.NAME="Certificate Policies";$r.register(O.id_ce_certificatePolicies,Mv);var qv=class extends On{constructor(...e){var r;if(q.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&typeof e[0][0]=="string"){let o=e[0].map(s=>new O.DistributionPoint({distributionPoint:new O.DistributionPointName({fullName:[new O.GeneralName({uniformResourceIdentifier:s})]})})),i=new O.CRLDistributionPoints(o);super(O.id_ce_cRLDistributionPoints,e[1],j.AsnConvert.serialize(i))}else{let n=new O.CRLDistributionPoints(e[0]);super(O.id_ce_cRLDistributionPoints,e[1],j.AsnConvert.serialize(n))}(r=this.distributionPoints)!==null&&r!==void 0||(this.distributionPoints=[])}onInit(e){super.onInit(e);let r=j.AsnConvert.parse(e.extnValue,O.CRLDistributionPoints);this.distributionPoints=r}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(r=>{var n;let o={};return r.distributionPoint&&(o[""]=(n=r.distributionPoint.fullName)===null||n===void 0?void 0:n.map(i=>new ti(i).toString()).join(", ")),r.reasons&&(o.Reasons=r.reasons.toString()),r.cRLIssuer&&(o["CRL Issuer"]=r.cRLIssuer.map(i=>i.toString()).join(", ")),o}),e}};qv.NAME="CRL Distribution Points";var Dv=class extends On{constructor(...e){var r,n,o,i;if(q.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof O.AuthorityInfoAccessSyntax){let s=new O.AuthorityInfoAccessSyntax(e[0]);super(O.id_pe_authorityInfoAccess,e[1],j.AsnConvert.serialize(s))}else{let s=e[0],a=new O.AuthorityInfoAccessSyntax;ck(a,s,O.id_ad_ocsp,"ocsp"),ck(a,s,O.id_ad_caIssuers,"caIssuers"),ck(a,s,O.id_ad_timeStamping,"timeStamping"),ck(a,s,O.id_ad_caRepository,"caRepository"),super(O.id_pe_authorityInfoAccess,e[1],j.AsnConvert.serialize(a))}(r=this.ocsp)!==null&&r!==void 0||(this.ocsp=[]),(n=this.caIssuers)!==null&&n!==void 0||(this.caIssuers=[]),(o=this.timeStamping)!==null&&o!==void 0||(this.timeStamping=[]),(i=this.caRepository)!==null&&i!==void 0||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],j.AsnConvert.parse(e.extnValue,O.AuthorityInfoAccessSyntax).forEach(n=>{switch(n.accessMethod){case O.id_ad_ocsp:this.ocsp.push(new ti(n.accessLocation));break;case O.id_ad_caIssuers:this.caIssuers.push(new ti(n.accessLocation));break;case O.id_ad_timeStamping:this.timeStamping.push(new ti(n.accessLocation));break;case O.id_ad_caRepository:this.caRepository.push(new ti(n.accessLocation));break}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&ak(e,"OCSP",this.ocsp),this.caIssuers.length&&ak(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&ak(e,"Time Stamping",this.timeStamping),this.caRepository.length&&ak(e,"CA Repository",this.caRepository),e}};Dv.NAME="Authority Info Access";function ak(t,e,r){if(r.length===1)t[e]=r[0].toTextObject();else{let n=new Me("");r.forEach((o,i)=>{let s=o.toTextObject(),a=`${s[Me.NAME]} ${i+1}`,c=n[a];Array.isArray(c)||(c=[],n[a]=c),c.push(s)}),t[e]=n}}function ck(t,e,r,n){let o=e[n];o&&(Array.isArray(o)?o:[o]).forEach(s=>{typeof s=="string"&&(s=new ti("url",s)),t.push(new O.AccessDescription({accessMethod:r,accessLocation:j.AsnConvert.parse(s.rawData,O.GeneralName)}))})}var Bv=class extends On{constructor(...e){q.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(O.id_ce_issuerAltName,e[1],new Di(e[0]||[]).rawData)}onInit(e){super.onInit(e);let r=j.AsnConvert.parse(e.extnValue,O.GeneralNames);this.names=new Di(r)}toTextObject(){let e=this.toTextObjectWithoutValue(),r=this.names.toTextObject();for(let n in r)e[n]=r[n];return e}};Bv.NAME="Issuer Alternative Name";var Bl=class t extends qi{constructor(...e){let r;if(q.BufferSourceConverter.isBufferSource(e[0]))r=q.BufferSourceConverter.toArrayBuffer(e[0]);else{let n=e[0],o=Array.isArray(e[1])?e[1].map(i=>q.BufferSourceConverter.toArrayBuffer(i)):[];r=j.AsnConvert.serialize(new Q.Attribute({type:n,values:o}))}super(r,Q.Attribute)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(r=>new Me("",{"":r})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[Me.NAME]===t.NAME&&(e[Me.NAME]=ko.toString(this.type)),e}};Bl.NAME="Attribute";var Uv=class extends Bl{constructor(...e){var r;if(q.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{let n=new Kp.ChallengePassword({printableString:e[0]});super(Kp.id_pkcs9_at_challengePassword,[j.AsnConvert.serialize(n)])}(r=this.password)!==null&&r!==void 0||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let r=j.AsnConvert.parse(this.values[0],Kp.ChallengePassword);this.password=r.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[Me.VALUE]=this.password,e}};Uv.NAME="Challenge Password";var Xp=class extends Bl{constructor(...e){var r;if(q.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{let n=e[0],o=new O.Extensions;for(let i of n)o.push(j.AsnConvert.parse(i.rawData,O.Extension));super(Kp.id_pkcs9_at_extensionRequest,[j.AsnConvert.serialize(o)])}(r=this.items)!==null&&r!==void 0||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let r=j.AsnConvert.parse(this.values[0],O.Extensions);this.items=r.map(n=>$r.create(j.AsnConvert.serialize(n)))}}toTextObject(){let e=this.toTextObjectWithoutValue(),r=this.items.map(n=>n.toTextObject());for(let n of r)e[n[Me.NAME]]=n;return e}};Xp.NAME="Extensions";var Ul=class{static register(e,r){this.items.set(e,r)}static create(e){let r=new Bl(e),n=this.items.get(r.type);return n?new n(e):r}};Ul.items=new Map;var Os="crypto.signatureFormatter",kk=class{toAsnSignature(e,r){return q.BufferSourceConverter.toArrayBuffer(r)}toWebSignature(e,r){return q.BufferSourceConverter.toArrayBuffer(r)}},yk;B.RsaAlgorithm=yk=class{static createPssParams(e,r){let n=yk.getHashAlgorithm(e);return n?new $t.RsaSaPssParams({hashAlgorithm:n,maskGenAlgorithm:new Q.AlgorithmIdentifier({algorithm:$t.id_mgf1,parameters:j.AsnConvert.serialize(n)}),saltLength:r}):null}static getHashAlgorithm(e){let r=At.container.resolve(ni);return typeof e=="string"?r.toAsnAlgorithm({name:e}):typeof e=="object"&&e&&"name"in e?r.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in e){let r;if(typeof e.hash=="string")r=e.hash;else if(e.hash&&typeof e.hash=="object"&&"name"in e.hash&&typeof e.hash.name=="string")r=e.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(r.toLowerCase()){case"sha-1":return new Q.AlgorithmIdentifier({algorithm:$t.id_sha1WithRSAEncryption,parameters:null});case"sha-256":return new Q.AlgorithmIdentifier({algorithm:$t.id_sha256WithRSAEncryption,parameters:null});case"sha-384":return new Q.AlgorithmIdentifier({algorithm:$t.id_sha384WithRSAEncryption,parameters:null});case"sha-512":return new Q.AlgorithmIdentifier({algorithm:$t.id_sha512WithRSAEncryption,parameters:null})}}else return new Q.AlgorithmIdentifier({algorithm:$t.id_rsaEncryption,parameters:null});break;case"rsa-pss":if("hash"in e){if(!("saltLength"in e&&typeof e.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");let r=yk.createPssParams(e.hash,e.saltLength);if(!r)throw new Error("Cannot create PSS parameters");return new Q.AlgorithmIdentifier({algorithm:$t.id_RSASSA_PSS,parameters:j.AsnConvert.serialize(r)})}else return new Q.AlgorithmIdentifier({algorithm:$t.id_RSASSA_PSS,parameters:null})}return null}toWebAlgorithm(e){switch(e.algorithm){case $t.id_rsaEncryption:return{name:"RSASSA-PKCS1-v1_5"};case $t.id_sha1WithRSAEncryption:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case $t.id_sha256WithRSAEncryption:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case $t.id_sha384WithRSAEncryption:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case $t.id_sha512WithRSAEncryption:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case $t.id_RSASSA_PSS:if(e.parameters){let r=j.AsnConvert.parse(e.parameters,$t.RsaSaPssParams);return{name:"RSA-PSS",hash:At.container.resolve(ni).toWebAlgorithm(r.hashAlgorithm),saltLength:r.saltLength}}else return{name:"RSA-PSS"}}return null}};B.RsaAlgorithm=yk=z.__decorate([At.injectable()],B.RsaAlgorithm);At.container.registerSingleton(ef,B.RsaAlgorithm);B.ShaAlgorithm=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new Q.AlgorithmIdentifier({algorithm:En.id_sha1});case"sha-256":return new Q.AlgorithmIdentifier({algorithm:En.id_sha256});case"sha-384":return new Q.AlgorithmIdentifier({algorithm:En.id_sha384});case"sha-512":return new Q.AlgorithmIdentifier({algorithm:En.id_sha512})}return null}toWebAlgorithm(e){switch(e.algorithm){case En.id_sha1:return{name:"SHA-1"};case En.id_sha256:return{name:"SHA-256"};case En.id_sha384:return{name:"SHA-384"};case En.id_sha512:return{name:"SHA-512"}}return null}};B.ShaAlgorithm=z.__decorate([At.injectable()],B.ShaAlgorithm);At.container.registerSingleton(ef,B.ShaAlgorithm);var Bi=class t{addPadding(e,r){let n=q.BufferSourceConverter.toUint8Array(r),o=new Uint8Array(e);return o.set(n,e-n.length),o.buffer}removePadding(e,r=!1){let n=q.BufferSourceConverter.toUint8Array(e);for(let o=0;o<n.length;o++)if(n[o]){n=n.slice(o);break}if(r&&n[0]>127){let o=new Uint8Array(n.length+1);return o.set(n,1),o.buffer}return n.buffer}toAsnSignature(e,r){if(e.name==="ECDSA"){let n=e.namedCurve,o=t.namedCurveSize.get(n)||t.defaultNamedCurveSize,i=new bk.ECDSASigValue,s=q.BufferSourceConverter.toUint8Array(r);return i.r=this.removePadding(s.slice(0,o),!0),i.s=this.removePadding(s.slice(o,o+o),!0),j.AsnConvert.serialize(i)}return null}toWebSignature(e,r){if(e.name==="ECDSA"){let n=j.AsnConvert.parse(r,bk.ECDSASigValue),o=e.namedCurve,i=t.namedCurveSize.get(o)||t.defaultNamedCurveSize,s=this.addPadding(i,this.removePadding(n.r)),a=this.addPadding(i,this.removePadding(n.s));return q.combine(s,a)}return null}};Bi.namedCurveSize=new Map;Bi.defaultNamedCurveSize=32;var vk="1.3.101.110",UR="1.3.101.111",_k="1.3.101.112",LR="1.3.101.113";B.EdAlgorithm=class{toAsnAlgorithm(e){let r=null;switch(e.name.toLowerCase()){case"ed25519":r=_k;break;case"x25519":r=vk;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":r=_k;break;case"ed448":r=LR;break}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":r=vk;break;case"x448":r=UR;break}}return r?new Q.AlgorithmIdentifier({algorithm:r}):null}toWebAlgorithm(e){switch(e.algorithm){case _k:return{name:"Ed25519"};case LR:return{name:"EdDSA",namedCurve:"Ed448"};case vk:return{name:"X25519"};case UR:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};B.EdAlgorithm=z.__decorate([At.injectable()],B.EdAlgorithm);At.container.registerSingleton(ef,B.EdAlgorithm);var rv,nv,ov,iv,sv,av,cv,Fp,Lv=class extends Nn{get subjectName(){return z.__classPrivateFieldGet(this,nv,"f")||z.__classPrivateFieldSet(this,nv,new vr(this.asn.certificationRequestInfo.subject),"f"),z.__classPrivateFieldGet(this,nv,"f")}get subject(){return z.__classPrivateFieldGet(this,ov,"f")||z.__classPrivateFieldSet(this,ov,this.subjectName.toString(),"f"),z.__classPrivateFieldGet(this,ov,"f")}get signatureAlgorithm(){if(!z.__classPrivateFieldGet(this,iv,"f")){let e=At.container.resolve(ni);z.__classPrivateFieldSet(this,iv,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return z.__classPrivateFieldGet(this,iv,"f")}get signature(){return z.__classPrivateFieldGet(this,sv,"f")||z.__classPrivateFieldSet(this,sv,this.asn.signature,"f"),z.__classPrivateFieldGet(this,sv,"f")}get publicKey(){return z.__classPrivateFieldGet(this,av,"f")||z.__classPrivateFieldSet(this,av,new ri(this.asn.certificationRequestInfo.subjectPKInfo),"f"),z.__classPrivateFieldGet(this,av,"f")}get attributes(){return z.__classPrivateFieldGet(this,cv,"f")||z.__classPrivateFieldSet(this,cv,this.asn.certificationRequestInfo.attributes.map(e=>Ul.create(j.AsnConvert.serialize(e))),"f"),z.__classPrivateFieldGet(this,cv,"f")}get extensions(){if(!z.__classPrivateFieldGet(this,Fp,"f")){z.__classPrivateFieldSet(this,Fp,[],"f");let e=this.getAttribute(GR.id_pkcs9_at_extensionRequest);e instanceof Xp&&z.__classPrivateFieldSet(this,Fp,e.items,"f")}return z.__classPrivateFieldGet(this,Fp,"f")}get tbs(){return z.__classPrivateFieldGet(this,rv,"f")||z.__classPrivateFieldSet(this,rv,this.asn.certificationRequestInfoRaw||j.AsnConvert.serialize(this.asn.certificationRequestInfo),"f"),z.__classPrivateFieldGet(this,rv,"f")}constructor(e){let r=Nn.isAsnEncoded(e)?[e,wk.CertificationRequest]:[e];super(r[0],r[1]),rv.set(this,void 0),nv.set(this,void 0),ov.set(this,void 0),iv.set(this,void 0),sv.set(this,void 0),av.set(this,void 0),cv.set(this,void 0),Fp.set(this,void 0),this.tag=kr.CertificateRequestTag}onInit(e){}getAttribute(e){for(let r of this.attributes)if(r.type===e)return r;return null}getAttributes(e){return this.attributes.filter(r=>r.type===e)}getExtension(e){for(let r of this.extensions)if(r.type===e)return r;return null}getExtensions(e){return this.extensions.filter(r=>r.type===e)}async verify(e=Ut.get()){let r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],e),o=At.container.resolveAll(Os).reverse(),i=null;for(let a of o)if(i=a.toWebSignature(r,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,n,i,this.tbs)}toTextObject(){let e=this.toTextObjectEmpty(),r=j.AsnConvert.parse(this.rawData,wk.CertificationRequest),n=r.certificationRequestInfo,o=new Me("",{Version:`${Q.Version[n.version]} (${n.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){let i=new Me("");for(let s of this.attributes){let a=s.toTextObject();i[a[Me.NAME]]=a}o.Attributes=i}return e.Data=o,e.Signature=new Me("",{Algorithm:oi.serializeAlgorithm(r.signatureAlgorithm),"":r.signature}),e}};rv=new WeakMap,nv=new WeakMap,ov=new WeakMap,iv=new WeakMap,sv=new WeakMap,av=new WeakMap,cv=new WeakMap,Fp=new WeakMap;Lv.NAME="PKCS#10 Certificate Request";var FR=class{static async create(e,r=Ut.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'publicKey' is empty");let n=await r.subtle.exportKey("spki",e.keys.publicKey),o=new wk.CertificationRequest({certificationRequestInfo:new wk.CertificationRequestInfo({subjectPKInfo:j.AsnConvert.parse(n,Q.SubjectPublicKeyInfo)})});if(e.name){let d=e.name instanceof vr?e.name:new vr(e.name);o.certificationRequestInfo.subject=j.AsnConvert.parse(d.toArrayBuffer(),Q.Name)}if(e.attributes)for(let d of e.attributes)o.certificationRequestInfo.attributes.push(j.AsnConvert.parse(d.rawData,Q.Attribute));if(e.extensions&&e.extensions.length){let d=new Q.Attribute({type:GR.id_pkcs9_at_extensionRequest}),p=new Q.Extensions;for(let f of e.extensions)p.push(j.AsnConvert.parse(f.rawData,Q.Extension));d.values.push(j.AsnConvert.serialize(p)),o.certificationRequestInfo.attributes.push(d)}let i={...e.signingAlgorithm,...e.keys.privateKey.algorithm},s=At.container.resolve(ni);o.signatureAlgorithm=s.toAsnAlgorithm(i);let a=j.AsnConvert.serialize(o.certificationRequestInfo),c=await r.subtle.sign(i,e.keys.privateKey,a),l=At.container.resolveAll(Os).reverse(),u=null;for(let d of l)if(u=d.toAsnSignature(i,c),u)break;if(!u)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return o.signature=u,new Lv(j.AsnConvert.serialize(o))}},lv,uv,dv,pv,fv,mv,hv,gv,yv,vv,Vp,_v,Na=class extends Nn{get publicKey(){return z.__classPrivateFieldGet(this,_v,"f")||z.__classPrivateFieldSet(this,_v,new ri(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),z.__classPrivateFieldGet(this,_v,"f")}get serialNumber(){if(!z.__classPrivateFieldGet(this,uv,"f")){let e=this.asn.tbsCertificate,r=new Uint8Array(e.serialNumber);r.length>1&&r[0]===0&&r[1]>127&&(r=r.slice(1)),z.__classPrivateFieldSet(this,uv,q.Convert.ToHex(r),"f")}return z.__classPrivateFieldGet(this,uv,"f")}get subjectName(){return z.__classPrivateFieldGet(this,dv,"f")||z.__classPrivateFieldSet(this,dv,new vr(this.asn.tbsCertificate.subject),"f"),z.__classPrivateFieldGet(this,dv,"f")}get subject(){return z.__classPrivateFieldGet(this,pv,"f")||z.__classPrivateFieldSet(this,pv,this.subjectName.toString(),"f"),z.__classPrivateFieldGet(this,pv,"f")}get issuerName(){return z.__classPrivateFieldGet(this,fv,"f")||z.__classPrivateFieldSet(this,fv,new vr(this.asn.tbsCertificate.issuer),"f"),z.__classPrivateFieldGet(this,fv,"f")}get issuer(){return z.__classPrivateFieldGet(this,mv,"f")||z.__classPrivateFieldSet(this,mv,this.issuerName.toString(),"f"),z.__classPrivateFieldGet(this,mv,"f")}get notBefore(){if(!z.__classPrivateFieldGet(this,hv,"f")){let e=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!e)throw new Error("Cannot get 'notBefore' value");z.__classPrivateFieldSet(this,hv,e,"f")}return z.__classPrivateFieldGet(this,hv,"f")}get notAfter(){if(!z.__classPrivateFieldGet(this,gv,"f")){let e=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!e)throw new Error("Cannot get 'notAfter' value");z.__classPrivateFieldSet(this,gv,e,"f")}return z.__classPrivateFieldGet(this,gv,"f")}get signatureAlgorithm(){if(!z.__classPrivateFieldGet(this,yv,"f")){let e=At.container.resolve(ni);z.__classPrivateFieldSet(this,yv,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return z.__classPrivateFieldGet(this,yv,"f")}get signature(){return z.__classPrivateFieldGet(this,vv,"f")||z.__classPrivateFieldSet(this,vv,this.asn.signatureValue,"f"),z.__classPrivateFieldGet(this,vv,"f")}get extensions(){return z.__classPrivateFieldGet(this,Vp,"f")||(z.__classPrivateFieldSet(this,Vp,[],"f"),this.asn.tbsCertificate.extensions&&z.__classPrivateFieldSet(this,Vp,this.asn.tbsCertificate.extensions.map(e=>$r.create(j.AsnConvert.serialize(e))),"f")),z.__classPrivateFieldGet(this,Vp,"f")}get tbs(){return z.__classPrivateFieldGet(this,lv,"f")||z.__classPrivateFieldSet(this,lv,this.asn.tbsCertificateRaw||j.AsnConvert.serialize(this.asn.tbsCertificate),"f"),z.__classPrivateFieldGet(this,lv,"f")}constructor(e){let r=Nn.isAsnEncoded(e)?[e,Q.Certificate]:[e];super(r[0],r[1]),lv.set(this,void 0),uv.set(this,void 0),dv.set(this,void 0),pv.set(this,void 0),fv.set(this,void 0),mv.set(this,void 0),hv.set(this,void 0),gv.set(this,void 0),yv.set(this,void 0),vv.set(this,void 0),Vp.set(this,void 0),_v.set(this,void 0),this.tag=kr.CertificateTag}onInit(e){}getExtension(e){for(let r of this.extensions)if(typeof e=="string"){if(r.type===e)return r}else if(r instanceof e)return r;return null}getExtensions(e){return this.extensions.filter(r=>typeof e=="string"?r.type===e:r instanceof e)}async verify(e={},r=Ut.get()){let n,o,i=e.publicKey;try{if(!i)n={...this.publicKey.algorithm,...this.signatureAlgorithm},o=await this.publicKey.export(n,["verify"],r);else if("publicKey"in i)n={...i.publicKey.algorithm,...this.signatureAlgorithm},o=await i.publicKey.export(n,["verify"],r);else if(i instanceof ri)n={...i.algorithm,...this.signatureAlgorithm},o=await i.export(n,["verify"],r);else if(q.BufferSourceConverter.isBufferSource(i)){let l=new ri(i);n={...l.algorithm,...this.signatureAlgorithm},o=await l.export(n,["verify"],r)}else n={...i.algorithm,...this.signatureAlgorithm},o=i}catch{return!1}let s=At.container.resolveAll(Os).reverse(),a=null;for(let l of s)if(a=l.toWebSignature(n,this.signature),a)break;if(!a)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let c=await r.subtle.verify(this.signatureAlgorithm,o,a,this.tbs);if(e.signatureOnly)return c;{let u=(e.date||new Date).getTime();return c&&this.notBefore.getTime()<u&&u<this.notAfter.getTime()}}async getThumbprint(...e){let r,n="SHA-1";return e[0]&&(e[0].subtle?r=e[0]:(n=e[0]||n,r=e[1])),r??(r=Ut.get()),await r.subtle.digest(n,this.rawData)}async isSelfSigned(e=Ut.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),r=j.AsnConvert.parse(this.rawData,Q.Certificate),n=r.tbsCertificate,o=new Me("",{Version:`${Q.Version[n.version]} (${n.version})`,"Serial Number":n.serialNumber,"Signature Algorithm":oi.serializeAlgorithm(n.signature),Issuer:this.issuer,Validity:new Me("",{"Not Before":n.validity.notBefore.getTime(),"Not After":n.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(n.issuerUniqueID&&(o["Issuer Unique ID"]=n.issuerUniqueID),n.subjectUniqueID&&(o["Subject Unique ID"]=n.subjectUniqueID),this.extensions.length){let i=new Me("");for(let s of this.extensions){let a=s.toTextObject();i[a[Me.NAME]]=a}o.Extensions=i}return e.Data=o,e.Signature=new Me("",{Algorithm:oi.serializeAlgorithm(r.signatureAlgorithm),"":r.signatureValue}),e}};lv=new WeakMap,uv=new WeakMap,dv=new WeakMap,pv=new WeakMap,fv=new WeakMap,mv=new WeakMap,hv=new WeakMap,gv=new WeakMap,yv=new WeakMap,vv=new WeakMap,Vp=new WeakMap,_v=new WeakMap;Na.NAME="Certificate";var $k=class extends Array{constructor(e){if(super(),Nn.isAsnEncoded(e))this.import(e);else if(e instanceof Na)this.push(e);else if(Array.isArray(e))for(let r of e)this.push(r)}export(e){let r=new Tn.SignedData;r.version=1,r.encapContentInfo.eContentType=Tn.id_data,r.encapContentInfo.eContent=new Tn.EncapsulatedContent({single:new j.OctetString}),r.certificates=new Tn.CertificateSet(this.map(i=>new Tn.CertificateChoices({certificate:j.AsnConvert.parse(i.rawData,Q.Certificate)})));let n=new Tn.ContentInfo({contentType:Tn.id_signedData,content:j.AsnConvert.serialize(r)}),o=j.AsnConvert.serialize(n);return e==="raw"?o:this.toString(e)}import(e){let r=Nn.toArrayBuffer(e),n=j.AsnConvert.parse(r,Tn.ContentInfo);if(n.contentType!==Tn.id_signedData)throw new TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");let o=j.AsnConvert.parse(n.content,Tn.SignedData);this.clear();for(let i of o.certificates||[])i.certificate&&this.push(new Na(i.certificate))}clear(){for(;this.pop(););}toString(e="pem"){let r=this.export("raw");switch(e){case"pem":return kr.encode(r,"CMS");case"pem-chain":return this.map(n=>n.toString("pem")).join(`
`);case"asn":return j.AsnConvert.toString(r);case"hex":return q.Convert.ToHex(r);case"base64":return q.Convert.ToBase64(r);case"base64url":return q.Convert.ToBase64Url(r);case"text":return oi.serialize(this.toTextObject());default:throw TypeError("Argument 'format' is unsupported value")}}toTextObject(){let e=j.AsnConvert.parse(this.export("raw"),Tn.ContentInfo),r=j.AsnConvert.parse(e.content,Tn.SignedData);return new Me("X509Certificates",{"Content Type":ko.toString(e.contentType),Content:new Me("",{Version:`${Tn.CMSVersion[r.version]} (${r.version})`,Certificates:new Me("",{Certificate:this.map(o=>o.toTextObject())})})})}},VR=class{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e,r=Ut.get()){let n=new $k(e),o=e;for(;o=await this.findIssuer(o,r);){let i=await o.getThumbprint(r);for(let s of n){let a=await s.getThumbprint(r);if(q.isEqual(i,a))throw new Error("Cannot build a certificate chain. Circular dependency.")}n.push(o)}return n}async findIssuer(e,r=Ut.get()){if(!await e.isSelfSigned(r)){let n=e.getExtension(O.id_ce_authorityKeyIdentifier);for(let o of this.certificates)if(o.subject===e.issuer){if(n){if(n.keyId){let i=o.getExtension(O.id_ce_subjectKeyIdentifier);if(i&&i.keyId!==n.keyId)continue}else if(n.certId){let i=o.getExtension(O.id_ce_subjectAltName);if(i&&!(n.certId.serialNumber===o.serialNumber&&q.isEqual(j.AsnConvert.serialize(n.certId.name),j.AsnConvert.serialize(i))))continue}}try{let i={...o.publicKey.algorithm,...e.signatureAlgorithm},s=await o.publicKey.export(i,["verify"],r);if(!await e.verify({publicKey:s,signatureOnly:!0},r))continue}catch{continue}return o}}return null}};function WR(t,e=Ut.get()){let r=q.BufferSourceConverter.toUint8Array(q.Convert.FromHex(t||"")),n=r&&r.length&&r.some(i=>i>0)?new Uint8Array(r):void 0;n||(n=e.getRandomValues(new Uint8Array(16)));let o=0;for(;o<n.length-1&&n[o]===0;)o++;if(n=n.slice(o),n[0]>127){let i=new Uint8Array(n.length+1);i[0]=0,i.set(n,1),n=i}return n.buffer}var ZR=class{static async createSelfSigned(e,r=Ut.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'publicKey' is empty");return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},r)}static async create(e,r=Ut.get()){var n;let o;e.publicKey instanceof ri?o=e.publicKey.rawData:"publicKey"in e.publicKey?o=e.publicKey.publicKey.rawData:q.BufferSourceConverter.isBufferSource(e.publicKey)?o=e.publicKey:o=await r.subtle.exportKey("spki",e.publicKey);let i=WR(e.serialNumber,r),s=e.notBefore||new Date,a=e.notAfter||new Date(s.getTime()+31536e6),c=new O.Certificate({tbsCertificate:new O.TBSCertificate({version:O.Version.v3,serialNumber:i,validity:new O.Validity({notBefore:s,notAfter:a}),extensions:new O.Extensions(((n=e.extensions)===null||n===void 0?void 0:n.map(y=>j.AsnConvert.parse(y.rawData,O.Extension)))||[]),subjectPublicKeyInfo:j.AsnConvert.parse(o,O.SubjectPublicKeyInfo)})});if(e.subject){let y=e.subject instanceof vr?e.subject:new vr(e.subject);c.tbsCertificate.subject=j.AsnConvert.parse(y.toArrayBuffer(),O.Name)}if(e.issuer){let y=e.issuer instanceof vr?e.issuer:new vr(e.issuer);c.tbsCertificate.issuer=j.AsnConvert.parse(y.toArrayBuffer(),O.Name)}let l={hash:"SHA-256"},u="signingKey"in e?{...l,...e.signingAlgorithm,...e.signingKey.algorithm}:{...l,...e.signingAlgorithm},d=At.container.resolve(ni);c.tbsCertificate.signature=c.signatureAlgorithm=d.toAsnAlgorithm(u);let p=j.AsnConvert.serialize(c.tbsCertificate),f="signingKey"in e?await r.subtle.sign(u,e.signingKey,p):e.signature,h=At.container.resolveAll(Os).reverse(),m=null;for(let y of h)if(m=y.toAsnSignature(u,f),m)break;if(!m)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return c.signatureValue=m,new Na(j.AsnConvert.serialize(c))}},bv,wv,Zp,Hp,Gp;B.X509CrlReason=void 0;(function(t){t[t.unspecified=0]="unspecified",t[t.keyCompromise=1]="keyCompromise",t[t.cACompromise=2]="cACompromise",t[t.affiliationChanged=3]="affiliationChanged",t[t.superseded=4]="superseded",t[t.cessationOfOperation=5]="cessationOfOperation",t[t.certificateHold=6]="certificateHold",t[t.removeFromCRL=8]="removeFromCRL",t[t.privilegeWithdrawn=9]="privilegeWithdrawn",t[t.aACompromise=10]="aACompromise"})(B.X509CrlReason||(B.X509CrlReason={}));var Qp=class extends qi{get serialNumber(){return z.__classPrivateFieldGet(this,bv,"f")||z.__classPrivateFieldSet(this,bv,q.Convert.ToHex(this.asn.userCertificate),"f"),z.__classPrivateFieldGet(this,bv,"f")}get revocationDate(){return z.__classPrivateFieldGet(this,wv,"f")||z.__classPrivateFieldSet(this,wv,this.asn.revocationDate.getTime(),"f"),z.__classPrivateFieldGet(this,wv,"f")}get reason(){return z.__classPrivateFieldGet(this,Zp,"f")===void 0&&this.extensions,z.__classPrivateFieldGet(this,Zp,"f")}get invalidity(){return z.__classPrivateFieldGet(this,Hp,"f")===void 0&&this.extensions,z.__classPrivateFieldGet(this,Hp,"f")}get extensions(){return z.__classPrivateFieldGet(this,Gp,"f")||(z.__classPrivateFieldSet(this,Gp,[],"f"),this.asn.crlEntryExtensions&&z.__classPrivateFieldSet(this,Gp,this.asn.crlEntryExtensions.map(e=>{let r=$r.create(j.AsnConvert.serialize(e));switch(r.type){case Q.id_ce_cRLReasons:z.__classPrivateFieldGet(this,Zp,"f")===void 0&&z.__classPrivateFieldSet(this,Zp,j.AsnConvert.parse(r.value,Q.CRLReason).reason,"f");break;case Q.id_ce_invalidityDate:z.__classPrivateFieldGet(this,Hp,"f")===void 0&&z.__classPrivateFieldSet(this,Hp,j.AsnConvert.parse(r.value,Q.InvalidityDate).value,"f");break}return r}),"f")),z.__classPrivateFieldGet(this,Gp,"f")}constructor(...e){let r;if(q.BufferSourceConverter.isBufferSource(e[0])?r=q.BufferSourceConverter.toArrayBuffer(e[0]):typeof e[0]=="string"?r=j.AsnConvert.serialize(new Q.RevokedCertificate({userCertificate:WR(e[0]),revocationDate:new Q.Time(e[1]),crlEntryExtensions:e[2]})):e[0]instanceof Q.RevokedCertificate&&(r=e[0]),!r)throw new TypeError("Cannot create X509CrlEntry instance. Wrong constructor arguments.");super(r,Q.RevokedCertificate),bv.set(this,void 0),wv.set(this,void 0),Zp.set(this,void 0),Hp.set(this,void 0),Gp.set(this,void 0)}onInit(e){}};bv=new WeakMap,wv=new WeakMap,Zp=new WeakMap,Hp=new WeakMap,Gp=new WeakMap;var xv,Sv,kv,$v,Av,Pv,Wp,Ak=class extends Nn{get version(){return this.asn.tbsCertList.version}get signatureAlgorithm(){if(!z.__classPrivateFieldGet(this,Sv,"f")){let e=At.container.resolve(ni);z.__classPrivateFieldSet(this,Sv,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return z.__classPrivateFieldGet(this,Sv,"f")}get signature(){return this.asn.signature}get issuer(){return this.issuerName.toString()}get issuerName(){return z.__classPrivateFieldGet(this,kv,"f")||z.__classPrivateFieldSet(this,kv,new vr(this.asn.tbsCertList.issuer),"f"),z.__classPrivateFieldGet(this,kv,"f")}get thisUpdate(){if(!z.__classPrivateFieldGet(this,$v,"f")){let e=this.asn.tbsCertList.thisUpdate.getTime();if(!e)throw new Error("Cannot get 'thisUpdate' value");z.__classPrivateFieldSet(this,$v,e,"f")}return z.__classPrivateFieldGet(this,$v,"f")}get nextUpdate(){var e;return z.__classPrivateFieldGet(this,Av,"f")===void 0&&z.__classPrivateFieldSet(this,Av,((e=this.asn.tbsCertList.nextUpdate)===null||e===void 0?void 0:e.getTime())||void 0,"f"),z.__classPrivateFieldGet(this,Av,"f")}get entries(){var e;return z.__classPrivateFieldGet(this,Pv,"f")||z.__classPrivateFieldSet(this,Pv,((e=this.asn.tbsCertList.revokedCertificates)===null||e===void 0?void 0:e.map(r=>new Qp(r)))||[],"f"),z.__classPrivateFieldGet(this,Pv,"f")}get extensions(){return z.__classPrivateFieldGet(this,Wp,"f")||(z.__classPrivateFieldSet(this,Wp,[],"f"),this.asn.tbsCertList.crlExtensions&&z.__classPrivateFieldSet(this,Wp,this.asn.tbsCertList.crlExtensions.map(e=>$r.create(j.AsnConvert.serialize(e))),"f")),z.__classPrivateFieldGet(this,Wp,"f")}get tbs(){return z.__classPrivateFieldGet(this,xv,"f")||z.__classPrivateFieldSet(this,xv,this.asn.tbsCertListRaw||j.AsnConvert.serialize(this.asn.tbsCertList),"f"),z.__classPrivateFieldGet(this,xv,"f")}get tbsCertListSignatureAlgorithm(){return this.asn.tbsCertList.signature}get certListSignatureAlgorithm(){return this.asn.signatureAlgorithm}constructor(e){super(e,Nn.isAsnEncoded(e)?Q.CertificateList:void 0),this.tag=kr.CrlTag,xv.set(this,void 0),Sv.set(this,void 0),kv.set(this,void 0),$v.set(this,void 0),Av.set(this,void 0),Pv.set(this,void 0),Wp.set(this,void 0)}onInit(e){}getExtension(e){for(let r of this.extensions)if(typeof e=="string"){if(r.type===e)return r}else if(r instanceof e)return r;return null}getExtensions(e){return this.extensions.filter(r=>typeof e=="string"?r.type===e:r instanceof e)}async verify(e,r=Ut.get()){if(!this.certListSignatureAlgorithm.isEqual(this.tbsCertListSignatureAlgorithm))throw new Error("algorithm identifier in the sequence tbsCertList and CertificateList mismatch");let n,o,i=e.publicKey;try{i instanceof Na?(n={...i.publicKey.algorithm,...i.signatureAlgorithm},o=await i.publicKey.export(n,["verify"])):i instanceof ri?(n={...i.algorithm,...this.signatureAlgorithm},o=await i.export(n,["verify"])):(n={...i.algorithm,...this.signatureAlgorithm},o=i)}catch{return!1}let s=At.container.resolveAll(Os).reverse(),a=null;for(let c of s)if(a=c.toWebSignature(n,this.signature),a)break;if(!a)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return await r.subtle.verify(this.signatureAlgorithm,o,a,this.tbs)}async getThumbprint(...e){let r,n="SHA-1";return e[0]&&(e[0].subtle?r=e[0]:(n=e[0]||n,r=e[1])),r??(r=Ut.get()),await r.subtle.digest(n,this.rawData)}findRevoked(e){let r=typeof e=="string"?e:e.serialNumber,n=WR(r);for(let o of this.asn.tbsCertList.revokedCertificates||[])if(q.BufferSourceConverter.isEqual(o.userCertificate,n))return new Qp(j.AsnConvert.serialize(o));return null}};xv=new WeakMap,Sv=new WeakMap,kv=new WeakMap,$v=new WeakMap,Av=new WeakMap,Pv=new WeakMap,Wp=new WeakMap;var HR=class{static async create(e,r=Ut.get()){var n;let o=e.issuer instanceof vr?e.issuer:new vr(e.issuer),i=new O.CertificateList({tbsCertList:new O.TBSCertList({version:O.Version.v2,issuer:j.AsnConvert.parse(o.toArrayBuffer(),O.Name),thisUpdate:new Q.Time(e.thisUpdate||new Date)})});if(e.nextUpdate&&(i.tbsCertList.nextUpdate=new Q.Time(e.nextUpdate)),e.extensions&&e.extensions.length&&(i.tbsCertList.crlExtensions=new O.Extensions(e.extensions.map(p=>j.AsnConvert.parse(p.rawData,O.Extension))||[])),e.entries&&e.entries.length){i.tbsCertList.revokedCertificates=[];for(let p of e.entries){let f=Nn.toArrayBuffer(p.serialNumber);if(i.tbsCertList.revokedCertificates.findIndex(y=>q.isEqual(y.userCertificate,f))>-1)throw new Error(`Certificate serial number ${p.serialNumber} already exists in tbsCertList`);let m=new Q.RevokedCertificate({userCertificate:f,revocationDate:new Q.Time(p.revocationDate||new Date)});if("extensions"in p&&(!((n=p.extensions)===null||n===void 0)&&n.length)?m.crlEntryExtensions=p.extensions.map(y=>j.AsnConvert.parse(y.rawData,O.Extension)):m.crlEntryExtensions=[],!(p instanceof Qp)&&(p.reason&&m.crlEntryExtensions.push(new O.Extension({extnID:O.id_ce_cRLReasons,critical:!1,extnValue:new j.OctetString(j.AsnConvert.serialize(new O.CRLReason(p.reason)))})),p.invalidity&&m.crlEntryExtensions.push(new O.Extension({extnID:O.id_ce_invalidityDate,critical:!1,extnValue:new j.OctetString(j.AsnConvert.serialize(new O.InvalidityDate(p.invalidity)))})),p.issuer)){let y=e.issuer instanceof vr?e.issuer:new vr(e.issuer);m.crlEntryExtensions.push(new O.Extension({extnID:O.id_ce_certificateIssuer,critical:!1,extnValue:new j.OctetString(j.AsnConvert.serialize(j.AsnConvert.parse(y.toArrayBuffer(),O.Name)))}))}i.tbsCertList.revokedCertificates.push(m)}}let s={...e.signingAlgorithm,...e.signingKey.algorithm},a=At.container.resolve(ni);i.tbsCertList.signature=i.signatureAlgorithm=a.toAsnAlgorithm(s);let c=j.AsnConvert.serialize(i.tbsCertList),l=await r.subtle.sign(s,e.signingKey,c),u=At.container.resolveAll(Os).reverse(),d=null;for(let p of u)if(d=p.toAsnSignature(s,l),d)break;if(!d)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return i.signature=d,new Ak(j.AsnConvert.serialize(i))}};$r.register(O.id_ce_basicConstraints,Ov);$r.register(O.id_ce_extKeyUsage,jv);$r.register(O.id_ce_keyUsage,Nv);$r.register(O.id_ce_subjectKeyIdentifier,zv);$r.register(O.id_ce_authorityKeyIdentifier,Ev);$r.register(O.id_ce_subjectAltName,Rv);$r.register(O.id_ce_cRLDistributionPoints,qv);$r.register(O.id_pe_authorityInfoAccess,Dv);$r.register(O.id_ce_issuerAltName,Bv);Ul.register(Kp.id_pkcs9_at_challengePassword,Uv);Ul.register(Kp.id_pkcs9_at_extensionRequest,Xp);At.container.registerSingleton(Os,kk);At.container.registerSingleton(Os,Bi);Bi.namedCurveSize.set("P-256",32);Bi.namedCurveSize.set("K-256",32);Bi.namedCurveSize.set("P-384",48);Bi.namedCurveSize.set("P-521",66);B.AlgorithmProvider=xk;B.AsnData=qi;B.AsnDefaultSignatureFormatter=kk;B.AsnEcSignatureFormatter=Bi;B.Attribute=Bl;B.AttributeFactory=Ul;B.AuthorityInfoAccessExtension=Dv;B.AuthorityKeyIdentifierExtension=Ev;B.BasicConstraintsExtension=Ov;B.CRLDistributionPointsExtension=qv;B.CertificatePolicyExtension=Mv;B.ChallengePasswordAttribute=Uv;B.CryptoProvider=Jp;B.DN=dk;B.DNS=uk;B.DefaultAlgorithmSerializer=Sk;B.EMAIL=pk;B.ExtendedKeyUsageExtension=jv;B.Extension=On;B.ExtensionFactory=$r;B.ExtensionsAttribute=Xp;B.GUID=hk;B.GeneralName=ti;B.GeneralNames=Di;B.IP=fk;B.IssuerAlternativeNameExtension=Bv;B.KeyUsagesExtension=Nv;B.Name=vr;B.NameIdentifier=Iv;B.OidSerializer=ko;B.PemConverter=kr;B.PemData=Nn;B.Pkcs10CertificateRequest=Lv;B.Pkcs10CertificateRequestGenerator=FR;B.PublicKey=ri;B.REGISTERED_ID=tv;B.SubjectAlternativeNameExtension=Rv;B.SubjectKeyIdentifierExtension=zv;B.TextConverter=oi;B.TextObject=Me;B.UPN=gk;B.URL=mk;B.X509Certificate=Na;B.X509CertificateGenerator=ZR;B.X509Certificates=$k;B.X509ChainBuilder=VR;B.X509Crl=Ak;B.X509CrlEntry=Qp;B.X509CrlGenerator=HR;B.cryptoProvider=Ut;B.diAlgorithm=ef;B.diAlgorithmProvider=ni;B.diAsnSignatureFormatter=Os;B.idEd25519=_k;B.idEd448=LR;B.idX25519=vk;B.idX448=UR});var M8=g(R8=>{var{X509CertificateGenerator:KR,X509Certificate:JR,X509ChainBuilder:_he,BasicConstraintsExtension:bhe,KeyUsagesExtension:whe,KeyUsageFlags:E8,ExtendedKeyUsageExtension:xhe,ExtendedKeyUsage:O8,SubjectAlternativeNameExtension:She,GeneralName:QEe}=T8(),XR=require("crypto"),$o=XR.webcrypto;function j8(t){var e=parseInt(t[0],16);return e<8?t:(e-=8,e.toString()+t.substring(1))}function tf(t){switch(t){case"sha256":return"SHA-256";case"sha384":return"SHA-384";case"sha512":return"SHA-512";default:return"SHA-1"}}function N8(t){return{name:"RSASSA-PKCS1-v1_5",hash:tf(t)}}function YR(t){let e={commonName:"CN",countryName:"C",ST:"ST",localityName:"L",organizationName:"O",OU:"OU"};return t.map(r=>{let n=r.name||r.shortName;return`${e[n]||n}=${r.value}`}).join(", ")}async function z8(t,e){let r=t.match(/-----BEGIN PRIVATE KEY-----([\s\S]*?)-----END PRIVATE KEY-----/),n=t.match(/-----BEGIN RSA PRIVATE KEY-----([\s\S]*?)-----END RSA PRIVATE KEY-----/);if(r){let o=r[1].replace(/\s/g,""),i=Buffer.from(o,"base64");return await $o.subtle.importKey("pkcs8",i,{name:"RSASSA-PKCS1-v1_5",hash:tf(e)},!0,["sign"])}else if(n){let s=XR.createPrivateKey(t).export({type:"pkcs8",format:"pem"}).replace(/-----BEGIN PRIVATE KEY-----/,"").replace(/-----END PRIVATE KEY-----/,"").replace(/\s/g,""),a=Buffer.from(s,"base64");return await $o.subtle.importKey("pkcs8",a,{name:"RSASSA-PKCS1-v1_5",hash:tf(e)},!0,["sign"])}else throw new Error("Unsupported private key format. Expected PKCS#8 or PKCS#1 RSA key.")}async function khe(t,e){let r=t.replace(/-----BEGIN PUBLIC KEY-----/,"").replace(/-----END PUBLIC KEY-----/,"").replace(/\s/g,""),n=Buffer.from(r,"base64");return await $o.subtle.importKey("spki",n,{name:"RSASSA-PKCS1-v1_5",hash:tf(e)},!0,["verify"])}async function $he(t,e,r,n){let{privateKey:o,publicKey:i}=t,s=$o.getRandomValues(new Uint8Array(9)),a=j8(Buffer.from(s).toString("hex")),c=r.notBeforeDate||new Date,l;r.notAfterDate?l=r.notAfterDate:(l=new Date(c),l.setDate(l.getDate()+365)),e=e||[{name:"commonName",value:"example.org"},{name:"countryName",value:"US"},{shortName:"ST",value:"Virginia"},{name:"localityName",value:"Blacksburg"},{name:"organizationName",value:"Test"},{shortName:"OU",value:"Test"}];let u=YR(e),d=N8(r.algorithm),p=e.find(Wt=>Wt.name==="commonName"||Wt.shortName==="CN"),f=p?p.value:"localhost",h=[new bhe(!1,void 0,!0),new whe(E8.digitalSignature|E8.keyEncipherment,!0),new xhe([O8.serverAuth,O8.clientAuth],!1),new She([{type:"dns",value:f},...f==="localhost"?[{type:"ip",value:"127.0.0.1"}]:[]],!1)],m;if(n){let Wt=new JR(n.cert),ii=await z8(n.key,r.algorithm||"sha256");m=await KR.create({serialNumber:a,subject:u,issuer:Wt.subject,notBefore:c,notAfter:l,signingAlgorithm:d,publicKey:i,signingKey:ii,extensions:h})}else m=await KR.createSelfSigned({serialNumber:a,name:u,notBefore:c,notAfter:l,signingAlgorithm:d,keys:{privateKey:o,publicKey:i},extensions:h});let y=m.rawData,v=await $o.subtle.digest("SHA-1",y),w=Buffer.from(v).toString("hex").match(/.{2}/g).join(":"),$=await $o.subtle.exportKey("pkcs8",o),R=await $o.subtle.exportKey("spki",i),P;r.passphrase?P=XR.createPrivateKey({key:Buffer.from($),format:"der",type:"pkcs8"}).export({type:"pkcs8",format:"pem",cipher:"aes-256-cbc",passphrase:r.passphrase}):P=`-----BEGIN PRIVATE KEY-----
`+Buffer.from($).toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PRIVATE KEY-----
`;let ce=`-----BEGIN PUBLIC KEY-----
`+Buffer.from(R).toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PUBLIC KEY-----
`,Te=m.toString("pem"),be={private:P,public:ce,cert:Te,fingerprint:w};if(r&&r.clientCertificate){let Wt=typeof r.clientCertificate=="object"?r.clientCertificate:{},ii=Wt.keySize||r.clientCertificateKeySize||2048,Zl=Wt.algorithm||r.algorithm||"sha1",Hv=Wt.cn||r.clientCertificateCN||"John Doe jdoe123",Hl=await $o.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:ii,publicExponent:new Uint8Array([1,0,1]),hash:tf(Zl)},!0,["sign","verify"]),Gv=$o.getRandomValues(new Uint8Array(9)),Wv=j8(Buffer.from(Gv).toString("hex")),Gl=Wt.notBeforeDate||new Date,Ra;Wt.notAfterDate?Ra=Wt.notAfterDate:(Ra=new Date(Gl),Ra.setFullYear(Gl.getFullYear()+1));let ue=JSON.parse(JSON.stringify(e));for(let Wl=0;Wl<ue.length;Wl++)ue[Wl].name==="commonName"&&(ue[Wl]={name:"commonName",value:Hv});let js=YR(ue),Nk=YR(e),Zt=N8(Zl),zk=await KR.create({serialNumber:Wv,subject:js,issuer:Nk,notBefore:Gl,notAfter:Ra,signingAlgorithm:Zt,publicKey:Hl.publicKey,signingKey:o}),Rk=await $o.subtle.exportKey("pkcs8",Hl.privateKey),Kv=await $o.subtle.exportKey("spki",Hl.publicKey);be.clientprivate=`-----BEGIN PRIVATE KEY-----
`+Buffer.from(Rk).toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PRIVATE KEY-----
`,be.clientpublic=`-----BEGIN PUBLIC KEY-----
`+Buffer.from(Kv).toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PUBLIC KEY-----
`,be.clientcert=zk.toString("pem")}let et=new JR(m.rawData),Ge=[et];if(n){let Wt=new JR(n.cert);Ge.push(Wt)}if((await new _he({certificates:Ge}).build(et)).length===0)throw new Error("Certificate could not be verified.");return be}R8.generate=async function(e,r){e=e||void 0,r=r||{};let n=r.keySize||2048,o;return r.keyPair?o={privateKey:await z8(r.keyPair.privateKey,r.algorithm||"sha1"),publicKey:await khe(r.keyPair.publicKey,r.algorithm||"sha1")}:o=await $o.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:tf(r.algorithm||"sha1")},!0,["sign","verify"]),await $he(o,e,r,r.ca)}});var Ohe={};Ui(Ohe,{activate:()=>The,deactivate:()=>Ehe});module.exports=C(Ohe);var $e=it(require("vscode"));var Yr=require("crypto"),QR=require("http"),D8=require("https"),Fl=it(require("os")),A=it(require("vscode")),_r=it(require("fs")),qr=it(require("path"));var Mn=it(require("fs")),Jl=it(require("path")),hM=it(require("vscode")),Yv=class{storageDir;writeQueue=[];flushInterval;FLUSH_MS=2e3;constructor(e){this.storageDir=Jl.join(e.globalStorageUri.fsPath,"audit_logs"),this.ensureStorageDir(),this.startPeriodicFlush(),this.cleanupOldLogs().catch(r=>console.error("Failed to cleanup old logs:",r))}async cleanupOldLogs(){let r=hM.workspace.getConfiguration("githubCopilotApi.audit").get("retentionDays",30);if(!(r<=0))try{let n=await Mn.promises.readdir(this.storageDir),o=Date.now(),i=r*24*60*60*1e3;for(let s of n){if(!s.startsWith("audit-")||!s.endsWith(".jsonl"))continue;let a=s.slice(6,-6),c=new Date(a).getTime();if(!isNaN(c)&&o-c>i){let l=Jl.join(this.storageDir,s);await Mn.promises.unlink(l)}}}catch(n){console.error("Error cleaning up old audit logs:",n)}}ensureStorageDir(){Mn.existsSync(this.storageDir)||Mn.mkdirSync(this.storageDir,{recursive:!0})}async logRequest(e){this.writeQueue.push(e)}startPeriodicFlush(){this.flushInterval&&clearInterval(this.flushInterval),this.flushInterval=setInterval(()=>this.flush(),this.FLUSH_MS)}async flush(){if(this.writeQueue.length===0)return;let e=[...this.writeQueue];this.writeQueue=[];let r=new Map;for(let n of e){let o=n.timestamp.split("T")[0];r.has(o)||r.set(o,[]),r.get(o).push(n)}for(let[n,o]of r){let i=Jl.join(this.storageDir,`audit-${n}.jsonl`),s=o.map(a=>JSON.stringify(a)).join(`
`)+`
`;try{await Mn.promises.appendFile(i,s,"utf8")}catch(a){console.error(`Failed to write audit logs for ${n}:`,a)}}}async getDailyStats(e=30){let r=[],n=new Date;for(let o=0;o<e;o++){let i=new Date(n);i.setDate(i.getDate()-o);let s=i.toISOString().split("T")[0],a=Jl.join(this.storageDir,`audit-${s}.jsonl`);if(Mn.existsSync(a))try{let l=(await Mn.promises.readFile(a,"utf8")).trim().split(`
`),u=0,d=0,p=0,f=0,h=0,m=new Set;for(let y of l)if(y)try{let v=JSON.parse(y);u++,d+=v.durationMs,v.tokensIn&&(p+=v.tokensIn),v.tokensOut&&(f+=v.tokensOut),v.status>=400&&h++,v.ip&&m.add(v.ip)}catch{}r.push({date:s,totalRequests:u,avgLatency:u>0?Math.round(d/u):0,tokensIn:p,tokensOut:f,totalTokens:p+f,errorCount:h,uniqueIps:m.size})}catch(c){console.error(`Error reading log ${a}`,c)}else r.push({date:s,totalRequests:0,avgLatency:0,tokensIn:0,tokensOut:0,totalTokens:0,errorCount:0,uniqueIps:0})}return r.sort((o,i)=>o.date.localeCompare(i.date))}async getLogEntries(e=1,r=10){try{if(!Mn.existsSync(this.storageDir))return{total:0,entries:[]};let o=(await Mn.promises.readdir(this.storageDir)).filter(l=>l.startsWith("audit-")&&l.endsWith(".jsonl")).sort().reverse(),i=[];for(let l of o.slice(0,14))try{let u=await Mn.promises.readFile(Jl.join(this.storageDir,l),"utf8"),d=[];u.split(`
`).forEach(p=>{if(p.trim())try{let f=JSON.parse(p);f&&f.timestamp&&d.push(f)}catch{}}),i=i.concat(d.reverse())}catch(u){console.error(`[AuditService] Error reading ${l}`,u)}i.sort((l,u)=>new Date(u.timestamp).getTime()-new Date(l.timestamp).getTime());let s=i.length,a=(e-1)*r,c=a+r;return{total:s,entries:i.slice(a,c)}}catch(n){return console.error("[AuditService] Failed to get logs:",n),{total:0,entries:[]}}}getLogFolderPath(){return this.storageDir}async getLifetimeStats(){return(await this.getDailyStats(365)).reduce((r,n)=>({totalRequests:r.totalRequests+n.totalRequests,totalTokensIn:r.totalTokensIn+n.tokensIn,totalTokensOut:r.totalTokensOut+n.tokensOut}),{totalRequests:0,totalTokensIn:0,totalTokensOut:0})}dispose(){this.flushInterval&&(clearInterval(this.flushInterval),this.flush())}};var LF=it(require("vscode"));var Fe;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let i={};for(let s of o)i[s]=s;return i},t.getValidEnumValues=o=>{let i=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),s={};for(let a of i)s[a]=o[a];return t.objectValues(s)},t.objectValues=o=>t.objectKeys(o).map(function(i){return o[i]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let i=[];for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&i.push(s);return i},t.find=(o,i)=>{for(let s of o)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,i=" | "){return o.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(o,i)=>typeof i=="bigint"?i.toString():i})(Fe||(Fe={}));var gM;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(gM||(gM={}));var W=Fe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Li=t=>{switch(typeof t){case"undefined":return W.undefined;case"string":return W.string;case"number":return Number.isNaN(t)?W.nan:W.number;case"boolean":return W.boolean;case"function":return W.function;case"bigint":return W.bigint;case"symbol":return W.symbol;case"object":return Array.isArray(t)?W.array:t===null?W.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?W.promise:typeof Map<"u"&&t instanceof Map?W.map:typeof Set<"u"&&t instanceof Set?W.set:typeof Date<"u"&&t instanceof Date?W.date:W.object;default:return W.unknown}};var M=Fe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);var qn=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(i){return i.message},n={_errors:[]},o=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(o);else if(s.code==="invalid_return_type")o(s.returnTypeError);else if(s.code==="invalid_arguments")o(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let a=n,c=0;for(;c<s.path.length;){let l=s.path[c];c===s.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(r(s))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Fe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r=Object.create(null),n=[];for(let o of this.issues)if(o.path.length>0){let i=o.path[0];r[i]=r[i]||[],r[i].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};qn.create=t=>new qn(t);var yG=(t,e)=>{let r;switch(t.code){case M.invalid_type:t.received===W.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case M.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Fe.jsonStringifyReplacer)}`;break;case M.unrecognized_keys:r=`Unrecognized key(s) in object: ${Fe.joinValues(t.keys,", ")}`;break;case M.invalid_union:r="Invalid input";break;case M.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Fe.joinValues(t.options)}`;break;case M.invalid_enum_value:r=`Invalid enum value. Expected ${Fe.joinValues(t.options)}, received '${t.received}'`;break;case M.invalid_arguments:r="Invalid function arguments";break;case M.invalid_return_type:r="Invalid function return type";break;case M.invalid_date:r="Invalid date";break;case M.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Fe.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case M.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case M.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case M.custom:r="Invalid input";break;case M.invalid_intersection_types:r="Intersection results could not be merged";break;case M.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case M.not_finite:r="Number must be finite";break;default:r=e.defaultError,Fe.assertNever(t)}return{message:r}},Ns=yG;var vG=Ns;function nf(){return vG}var Xv=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,i=[...r,...o.path||[]],s={...o,path:i};if(o.message!==void 0)return{...o,path:i,message:o.message};let a="",c=n.filter(l=>!!l).slice().reverse();for(let l of c)a=l(s,{data:e,defaultError:a}).message;return{...o,path:i,message:a}};function Z(t,e){let r=nf(),n=Xv({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Ns?void 0:Ns].filter(o=>!!o)});t.common.issues.push(n)}var Dr=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return fe;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let i=await o.key,s=await o.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:i,value:s}=o;if(i.status==="aborted"||s.status==="aborted")return fe;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||o.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},fe=Object.freeze({status:"aborted"}),Yl=t=>({status:"dirty",value:t}),Qr=t=>({status:"valid",value:t}),Bk=t=>t.status==="aborted",Uk=t=>t.status==="dirty",Ma=t=>t.status==="valid",of=t=>typeof Promise<"u"&&t instanceof Promise;var te;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(te||(te={}));var Xn=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yM=(t,e)=>{if(Ma(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new qn(t.common.issues);return this._error=r,this._error}}};function ke(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(s,a)=>{let{message:c}=t;return s.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:s.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var Ee=class{get description(){return this._def.description}_getType(e){return Li(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Li(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Dr,ctx:{common:e.parent.common,data:e.data,parsedType:Li(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(of(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Li(e)},o=this._parseSync({data:e,path:n.path,parent:n});return yM(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Li(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Ma(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Ma(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Li(e)},o=this._parse({data:e,path:n.path,parent:n}),i=await(of(o)?o:Promise.resolve(o));return yM(n,i)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,i)=>{let s=e(o),a=()=>i.addIssue({code:M.custom,...n(o)});return typeof Promise<"u"&&s instanceof Promise?s.then(c=>c?!0:(a(),!1)):s?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Co({schema:this,typeName:de.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Po.create(this,this._def)}nullable(){return Zi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Rs.create(this)}promise(){return qa.create(this,this._def)}or(e){return ru.create([this,e],this._def)}and(e){return nu.create(this,e,this._def)}transform(e){return new Co({...ke(this._def),schema:this,typeName:de.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new cu({...ke(this._def),innerType:this,defaultValue:r,typeName:de.ZodDefault})}brand(){return new Qv({typeName:de.ZodBranded,type:this,...ke(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new lu({...ke(this._def),innerType:this,catchValue:r,typeName:de.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return e_.create(this,e)}readonly(){return uu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},_G=/^c[^\s-]{8,}$/i,bG=/^[0-9a-z]+$/,wG=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,SG=/^[a-z0-9_-]{21}$/i,kG=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,$G=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,AG=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,PG="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Lk,CG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,IG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,TG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,EG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,OG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,jG=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,vM="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",NG=new RegExp(`^${vM}$`);function _M(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function zG(t){return new RegExp(`^${_M(t)}$`)}function RG(t){let e=`${vM}T${_M(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function MG(t,e){return!!((e==="v4"||!e)&&CG.test(t)||(e==="v6"||!e)&&TG.test(t))}function qG(t,e){if(!kG.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function DG(t,e){return!!((e==="v4"||!e)&&IG.test(t)||(e==="v6"||!e)&&EG.test(t))}var Ql=class t extends Ee{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==W.string){let i=this._getOrReturnCtx(e);return Z(i,{code:M.invalid_type,expected:W.string,received:i.parsedType}),fe}let n=new Dr,o;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(o=this._getOrReturnCtx(e,o),Z(o,{code:M.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(o=this._getOrReturnCtx(e,o),Z(o,{code:M.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,a=e.data.length<i.value;(s||a)&&(o=this._getOrReturnCtx(e,o),s?Z(o,{code:M.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Z(o,{code:M.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")AG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"email",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Lk||(Lk=new RegExp(PG,"u")),Lk.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"emoji",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")xG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"uuid",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")SG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"nanoid",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")_G.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"cuid",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")bG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"cuid2",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")wG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"ulid",code:M.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),Z(o,{validation:"url",code:M.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"regex",code:M.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?RG(i).test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?NG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?zG(i).test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{code:M.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?$G.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"duration",code:M.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?MG(e.data,i.version)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"ip",code:M.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?qG(e.data,i.alg)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"jwt",code:M.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?DG(e.data,i.version)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"cidr",code:M.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?OG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"base64",code:M.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?jG.test(e.data)||(o=this._getOrReturnCtx(e,o),Z(o,{validation:"base64url",code:M.invalid_string,message:i.message}),n.dirty()):Fe.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:M.invalid_string,...te.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...te.errToObj(e)})}url(e){return this._addCheck({kind:"url",...te.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...te.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...te.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...te.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...te.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...te.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...te.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...te.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...te.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...te.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...te.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...te.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...te.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...te.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...te.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...te.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...te.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...te.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...te.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...te.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...te.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...te.errToObj(r)})}nonempty(e){return this.min(1,te.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Ql.create=t=>new Ql({checks:[],typeName:de.ZodString,coerce:t?.coerce??!1,...ke(t)});function BG(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,i=Number.parseInt(t.toFixed(o).replace(".","")),s=Number.parseInt(e.toFixed(o).replace(".",""));return i%s/10**o}var sf=class t extends Ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==W.number){let i=this._getOrReturnCtx(e);return Z(i,{code:M.invalid_type,expected:W.number,received:i.parsedType}),fe}let n,o=new Dr;for(let i of this._def.checks)i.kind==="int"?Fe.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),Z(n,{code:M.invalid_type,expected:"integer",received:"float",message:i.message}),o.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),o.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),o.dirty()):i.kind==="multipleOf"?BG(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.not_multiple_of,multipleOf:i.value,message:i.message}),o.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),Z(n,{code:M.not_finite,message:i.message}),o.dirty()):Fe.assertNever(i);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,te.toString(r))}gt(e,r){return this.setLimit("min",e,!1,te.toString(r))}lte(e,r){return this.setLimit("max",e,!0,te.toString(r))}lt(e,r){return this.setLimit("max",e,!1,te.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:te.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:te.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:te.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:te.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:te.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:te.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:te.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Fe.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};sf.create=t=>new sf({checks:[],typeName:de.ZodNumber,coerce:t?.coerce||!1,...ke(t)});var af=class t extends Ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==W.bigint)return this._getInvalidInput(e);let n,o=new Dr;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),o.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),o.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),Z(n,{code:M.not_multiple_of,multipleOf:i.value,message:i.message}),o.dirty()):Fe.assertNever(i);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return Z(r,{code:M.invalid_type,expected:W.bigint,received:r.parsedType}),fe}gte(e,r){return this.setLimit("min",e,!0,te.toString(r))}gt(e,r){return this.setLimit("min",e,!1,te.toString(r))}lte(e,r){return this.setLimit("max",e,!0,te.toString(r))}lt(e,r){return this.setLimit("max",e,!1,te.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:te.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:te.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:te.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};af.create=t=>new af({checks:[],typeName:de.ZodBigInt,coerce:t?.coerce??!1,...ke(t)});var cf=class extends Ee{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==W.boolean){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.boolean,received:n.parsedType}),fe}return Qr(e.data)}};cf.create=t=>new cf({typeName:de.ZodBoolean,coerce:t?.coerce||!1,...ke(t)});var lf=class t extends Ee{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==W.date){let i=this._getOrReturnCtx(e);return Z(i,{code:M.invalid_type,expected:W.date,received:i.parsedType}),fe}if(Number.isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return Z(i,{code:M.invalid_date}),fe}let n=new Dr,o;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(o=this._getOrReturnCtx(e,o),Z(o,{code:M.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(o=this._getOrReturnCtx(e,o),Z(o,{code:M.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Fe.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:te.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:te.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};lf.create=t=>new lf({checks:[],coerce:t?.coerce||!1,typeName:de.ZodDate,...ke(t)});var uf=class extends Ee{_parse(e){if(this._getType(e)!==W.symbol){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.symbol,received:n.parsedType}),fe}return Qr(e.data)}};uf.create=t=>new uf({typeName:de.ZodSymbol,...ke(t)});var eu=class extends Ee{_parse(e){if(this._getType(e)!==W.undefined){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.undefined,received:n.parsedType}),fe}return Qr(e.data)}};eu.create=t=>new eu({typeName:de.ZodUndefined,...ke(t)});var tu=class extends Ee{_parse(e){if(this._getType(e)!==W.null){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.null,received:n.parsedType}),fe}return Qr(e.data)}};tu.create=t=>new tu({typeName:de.ZodNull,...ke(t)});var df=class extends Ee{constructor(){super(...arguments),this._any=!0}_parse(e){return Qr(e.data)}};df.create=t=>new df({typeName:de.ZodAny,...ke(t)});var zs=class extends Ee{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Qr(e.data)}};zs.create=t=>new zs({typeName:de.ZodUnknown,...ke(t)});var ai=class extends Ee{_parse(e){let r=this._getOrReturnCtx(e);return Z(r,{code:M.invalid_type,expected:W.never,received:r.parsedType}),fe}};ai.create=t=>new ai({typeName:de.ZodNever,...ke(t)});var pf=class extends Ee{_parse(e){if(this._getType(e)!==W.undefined){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.void,received:n.parsedType}),fe}return Qr(e.data)}};pf.create=t=>new pf({typeName:de.ZodVoid,...ke(t)});var Rs=class t extends Ee{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==W.array)return Z(r,{code:M.invalid_type,expected:W.array,received:r.parsedType}),fe;if(o.exactLength!==null){let s=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(s||a)&&(Z(r,{code:s?M.too_big:M.too_small,minimum:a?o.exactLength.value:void 0,maximum:s?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(Z(r,{code:M.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(Z(r,{code:M.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((s,a)=>o.type._parseAsync(new Xn(r,s,r.path,a)))).then(s=>Dr.mergeArray(n,s));let i=[...r.data].map((s,a)=>o.type._parseSync(new Xn(r,s,r.path,a)));return Dr.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:te.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:te.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:te.toString(r)}})}nonempty(e){return this.min(1,e)}};Rs.create=(t,e)=>new Rs({type:t,minLength:null,maxLength:null,exactLength:null,typeName:de.ZodArray,...ke(e)});function Xl(t){if(t instanceof Dn){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Po.create(Xl(n))}return new Dn({...t._def,shape:()=>e})}else return t instanceof Rs?new Rs({...t._def,type:Xl(t.element)}):t instanceof Po?Po.create(Xl(t.unwrap())):t instanceof Zi?Zi.create(Xl(t.unwrap())):t instanceof Vi?Vi.create(t.items.map(e=>Xl(e))):t}var Dn=class t extends Ee{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=Fe.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==W.object){let l=this._getOrReturnCtx(e);return Z(l,{code:M.invalid_type,expected:W.object,received:l.parsedType}),fe}let{status:n,ctx:o}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),a=[];if(!(this._def.catchall instanceof ai&&this._def.unknownKeys==="strip"))for(let l in o.data)s.includes(l)||a.push(l);let c=[];for(let l of s){let u=i[l],d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Xn(o,d,o.path,l)),alwaysSet:l in o.data})}if(this._def.catchall instanceof ai){let l=this._def.unknownKeys;if(l==="passthrough")for(let u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:o.data[u]}});else if(l==="strict")a.length>0&&(Z(o,{code:M.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let l=this._def.catchall;for(let u of a){let d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Xn(o,d,o.path,u)),alwaysSet:u in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let l=[];for(let u of c){let d=await u.key,p=await u.value;l.push({key:d,value:p,alwaysSet:u.alwaysSet})}return l}).then(l=>Dr.mergeObjectSync(n,l)):Dr.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return te.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:te.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:de.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of Fe.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of Fe.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Xl(this)}partial(e){let r={};for(let n of Fe.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of Fe.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Po;)i=i._def.innerType;r[n]=i}return new t({...this._def,shape:()=>r})}keyof(){return bM(Fe.objectKeys(this.shape))}};Dn.create=(t,e)=>new Dn({shape:()=>t,unknownKeys:"strip",catchall:ai.create(),typeName:de.ZodObject,...ke(e)});Dn.strictCreate=(t,e)=>new Dn({shape:()=>t,unknownKeys:"strict",catchall:ai.create(),typeName:de.ZodObject,...ke(e)});Dn.lazycreate=(t,e)=>new Dn({shape:t,unknownKeys:"strip",catchall:ai.create(),typeName:de.ZodObject,...ke(e)});var ru=class extends Ee{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let s=i.map(a=>new qn(a.ctx.common.issues));return Z(r,{code:M.invalid_union,unionErrors:s}),fe}if(r.common.async)return Promise.all(n.map(async i=>{let s={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:s}),ctx:s}})).then(o);{let i,s=[];for(let c of n){let l={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&s.push(l.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;let a=s.map(c=>new qn(c));return Z(r,{code:M.invalid_union,unionErrors:a}),fe}}get options(){return this._def.options}};ru.create=(t,e)=>new ru({options:t,typeName:de.ZodUnion,...ke(e)});var Fi=t=>t instanceof ou?Fi(t.schema):t instanceof Co?Fi(t.innerType()):t instanceof iu?[t.value]:t instanceof su?t.options:t instanceof au?Fe.objectValues(t.enum):t instanceof cu?Fi(t._def.innerType):t instanceof eu?[void 0]:t instanceof tu?[null]:t instanceof Po?[void 0,...Fi(t.unwrap())]:t instanceof Zi?[null,...Fi(t.unwrap())]:t instanceof Qv||t instanceof uu?Fi(t.unwrap()):t instanceof lu?Fi(t._def.innerType):[],Fk=class t extends Ee{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.object)return Z(r,{code:M.invalid_type,expected:W.object,received:r.parsedType}),fe;let n=this.discriminator,o=r.data[n],i=this.optionsMap.get(o);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(Z(r,{code:M.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),fe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let i of r){let s=Fi(i.shape[e]);if(!s.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of s){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,i)}}return new t({typeName:de.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...ke(n)})}};function Vk(t,e){let r=Li(t),n=Li(e);if(t===e)return{valid:!0,data:t};if(r===W.object&&n===W.object){let o=Fe.objectKeys(e),i=Fe.objectKeys(t).filter(a=>o.indexOf(a)!==-1),s={...t,...e};for(let a of i){let c=Vk(t[a],e[a]);if(!c.valid)return{valid:!1};s[a]=c.data}return{valid:!0,data:s}}else if(r===W.array&&n===W.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let i=0;i<t.length;i++){let s=t[i],a=e[i],c=Vk(s,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===W.date&&n===W.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var nu=class extends Ee{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(i,s)=>{if(Bk(i)||Bk(s))return fe;let a=Vk(i.value,s.value);return a.valid?((Uk(i)||Uk(s))&&r.dirty(),{status:r.value,value:a.data}):(Z(n,{code:M.invalid_intersection_types}),fe)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,s])=>o(i,s)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};nu.create=(t,e,r)=>new nu({left:t,right:e,typeName:de.ZodIntersection,...ke(r)});var Vi=class t extends Ee{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.array)return Z(n,{code:M.invalid_type,expected:W.array,received:n.parsedType}),fe;if(n.data.length<this._def.items.length)return Z(n,{code:M.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),fe;!this._def.rest&&n.data.length>this._def.items.length&&(Z(n,{code:M.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let i=[...n.data].map((s,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Xn(n,s,n.path,a)):null}).filter(s=>!!s);return n.common.async?Promise.all(i).then(s=>Dr.mergeArray(r,s)):Dr.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Vi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Vi({items:t,typeName:de.ZodTuple,rest:null,...ke(e)})};var Zk=class t extends Ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.object)return Z(n,{code:M.invalid_type,expected:W.object,received:n.parsedType}),fe;let o=[],i=this._def.keyType,s=this._def.valueType;for(let a in n.data)o.push({key:i._parse(new Xn(n,a,n.path,a)),value:s._parse(new Xn(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Dr.mergeObjectAsync(r,o):Dr.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof Ee?new t({keyType:e,valueType:r,typeName:de.ZodRecord,...ke(n)}):new t({keyType:Ql.create(),valueType:e,typeName:de.ZodRecord,...ke(r)})}},ff=class extends Ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.map)return Z(n,{code:M.invalid_type,expected:W.map,received:n.parsedType}),fe;let o=this._def.keyType,i=this._def.valueType,s=[...n.data.entries()].map(([a,c],l)=>({key:o._parse(new Xn(n,a,n.path,[l,"key"])),value:i._parse(new Xn(n,c,n.path,[l,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of s){let l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return fe;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(l.value,u.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of s){let l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return fe;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(l.value,u.value)}return{status:r.value,value:a}}}};ff.create=(t,e,r)=>new ff({valueType:e,keyType:t,typeName:de.ZodMap,...ke(r)});var mf=class t extends Ee{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.set)return Z(n,{code:M.invalid_type,expected:W.set,received:n.parsedType}),fe;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(Z(n,{code:M.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(Z(n,{code:M.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let i=this._def.valueType;function s(c){let l=new Set;for(let u of c){if(u.status==="aborted")return fe;u.status==="dirty"&&r.dirty(),l.add(u.value)}return{status:r.value,value:l}}let a=[...n.data.values()].map((c,l)=>i._parse(new Xn(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>s(c)):s(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:te.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:te.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};mf.create=(t,e)=>new mf({valueType:t,minSize:null,maxSize:null,typeName:de.ZodSet,...ke(e)});var Hk=class t extends Ee{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.function)return Z(r,{code:M.invalid_type,expected:W.function,received:r.parsedType}),fe;function n(a,c){return Xv({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,nf(),Ns].filter(l=>!!l),issueData:{code:M.invalid_arguments,argumentsError:c}})}function o(a,c){return Xv({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,nf(),Ns].filter(l=>!!l),issueData:{code:M.invalid_return_type,returnTypeError:c}})}let i={errorMap:r.common.contextualErrorMap},s=r.data;if(this._def.returns instanceof qa){let a=this;return Qr(async function(...c){let l=new qn([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(n(c,f)),l}),d=await Reflect.apply(s,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(o(d,f)),l})})}else{let a=this;return Qr(function(...c){let l=a._def.args.safeParse(c,i);if(!l.success)throw new qn([n(c,l.error)]);let u=Reflect.apply(s,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new qn([o(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Vi.create(e).rest(zs.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||Vi.create([]).rest(zs.create()),returns:r||zs.create(),typeName:de.ZodFunction,...ke(n)})}},ou=class extends Ee{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};ou.create=(t,e)=>new ou({getter:t,typeName:de.ZodLazy,...ke(e)});var iu=class extends Ee{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return Z(r,{received:r.data,code:M.invalid_literal,expected:this._def.value}),fe}return{status:"valid",value:e.data}}get value(){return this._def.value}};iu.create=(t,e)=>new iu({value:t,typeName:de.ZodLiteral,...ke(e)});function bM(t,e){return new su({values:t,typeName:de.ZodEnum,...ke(e)})}var su=class t extends Ee{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return Z(r,{expected:Fe.joinValues(n),received:r.parsedType,code:M.invalid_type}),fe}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return Z(r,{received:r.data,code:M.invalid_enum_value,options:n}),fe}return Qr(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};su.create=bM;var au=class extends Ee{_parse(e){let r=Fe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==W.string&&n.parsedType!==W.number){let o=Fe.objectValues(r);return Z(n,{expected:Fe.joinValues(o),received:n.parsedType,code:M.invalid_type}),fe}if(this._cache||(this._cache=new Set(Fe.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=Fe.objectValues(r);return Z(n,{received:n.data,code:M.invalid_enum_value,options:o}),fe}return Qr(e.data)}get enum(){return this._def.values}};au.create=(t,e)=>new au({values:t,typeName:de.ZodNativeEnum,...ke(e)});var qa=class extends Ee{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.promise&&r.common.async===!1)return Z(r,{code:M.invalid_type,expected:W.promise,received:r.parsedType}),fe;let n=r.parsedType===W.promise?r.data:Promise.resolve(r.data);return Qr(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};qa.create=(t,e)=>new qa({type:t,typeName:de.ZodPromise,...ke(e)});var Co=class extends Ee{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===de.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,i={addIssue:s=>{Z(n,s),s.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),o.type==="preprocess"){let s=o.transform(n.data,i);if(n.common.async)return Promise.resolve(s).then(async a=>{if(r.value==="aborted")return fe;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?fe:c.status==="dirty"?Yl(c.value):r.value==="dirty"?Yl(c.value):c});{if(r.value==="aborted")return fe;let a=this._def.schema._parseSync({data:s,path:n.path,parent:n});return a.status==="aborted"?fe:a.status==="dirty"?Yl(a.value):r.value==="dirty"?Yl(a.value):a}}if(o.type==="refinement"){let s=a=>{let c=o.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?fe:(a.status==="dirty"&&r.dirty(),s(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?fe:(a.status==="dirty"&&r.dirty(),s(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ma(s))return fe;let a=o.transform(s.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>Ma(s)?Promise.resolve(o.transform(s.value,i)).then(a=>({status:r.value,value:a})):fe);Fe.assertNever(o)}};Co.create=(t,e,r)=>new Co({schema:t,typeName:de.ZodEffects,effect:e,...ke(r)});Co.createWithPreprocess=(t,e,r)=>new Co({schema:e,effect:{type:"preprocess",transform:t},typeName:de.ZodEffects,...ke(r)});var Po=class extends Ee{_parse(e){return this._getType(e)===W.undefined?Qr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Po.create=(t,e)=>new Po({innerType:t,typeName:de.ZodOptional,...ke(e)});var Zi=class extends Ee{_parse(e){return this._getType(e)===W.null?Qr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Zi.create=(t,e)=>new Zi({innerType:t,typeName:de.ZodNullable,...ke(e)});var cu=class extends Ee{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===W.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};cu.create=(t,e)=>new cu({innerType:t,typeName:de.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ke(e)});var lu=class extends Ee{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return of(o)?o.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new qn(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new qn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};lu.create=(t,e)=>new lu({innerType:t,typeName:de.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ke(e)});var hf=class extends Ee{_parse(e){if(this._getType(e)!==W.nan){let n=this._getOrReturnCtx(e);return Z(n,{code:M.invalid_type,expected:W.nan,received:n.parsedType}),fe}return{status:"valid",value:e.data}}};hf.create=t=>new hf({typeName:de.ZodNaN,...ke(t)});var Qv=class extends Ee{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},e_=class t extends Ee{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?fe:i.status==="dirty"?(r.dirty(),Yl(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?fe:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:de.ZodPipeline})}},uu=class extends Ee{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Ma(o)&&(o.value=Object.freeze(o.value)),o);return of(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};uu.create=(t,e)=>new uu({innerType:t,typeName:de.ZodReadonly,...ke(e)});var Xhe={object:Dn.lazycreate},de;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(de||(de={}));var Qhe=Ql.create,ege=sf.create,tge=hf.create,rge=af.create,nge=cf.create,oge=lf.create,ige=uf.create,sge=eu.create,age=tu.create,cge=df.create,lge=zs.create,uge=ai.create,dge=pf.create,pge=Rs.create,UG=Dn.create,fge=Dn.strictCreate,mge=ru.create,hge=Fk.create,gge=nu.create,yge=Vi.create,vge=Zk.create,_ge=ff.create,bge=mf.create,wge=Hk.create,xge=ou.create,Sge=iu.create,kge=su.create,$ge=au.create,Age=qa.create,Pge=Co.create,Cge=Po.create,Ige=Zi.create,Tge=Co.createWithPreprocess,Ege=e_.create;var r_=Object.freeze({status:"aborted"});function x(t,e,r){function n(a,c){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:c,constr:s,traits:new Set},enumerable:!1}),a._zod.traits.has(t))return;a._zod.traits.add(t),e(a,c);let l=s.prototype,u=Object.keys(l);for(let d=0;d<u.length;d++){let p=u[d];p in a||(a[p]=l[p].bind(a))}}let o=r?.Parent??Object;class i extends o{}Object.defineProperty(i,"name",{value:t});function s(a){var c;let l=r?.Parent?new i:this;n(l,a),(c=l._zod).deferred??(c.deferred=[]);for(let u of l._zod.deferred)u();return l}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}var ci=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Da=class extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}},t_={};function fr(t){return t&&Object.assign(t_,t),t_}var D={};Ui(D,{BIGINT_FORMAT_RANGES:()=>t$,Class:()=>Wk,NUMBER_FORMAT_RANGES:()=>e$,aborted:()=>Us,allowsEval:()=>Yk,assert:()=>WG,assertEqual:()=>VG,assertIs:()=>HG,assertNever:()=>GG,assertNotEqual:()=>ZG,assignProp:()=>qs,base64ToUint8Array:()=>SM,base64urlToUint8Array:()=>dW,cached:()=>pu,captureStackTrace:()=>o_,cleanEnum:()=>uW,cleanRegex:()=>vf,clone:()=>en,cloneDef:()=>JG,createTransparentProxy:()=>rW,defineLazy:()=>De,esc:()=>n_,escapeRegex:()=>Qn,extend:()=>iW,finalizeIssue:()=>pn,floatSafeRemainder:()=>Kk,getElementAtPath:()=>YG,getEnumValues:()=>yf,getLengthableOrigin:()=>wf,getParsedType:()=>tW,getSizableOrigin:()=>bf,hexToUint8Array:()=>fW,isObject:()=>Ba,isPlainObject:()=>Bs,issue:()=>fu,joinValues:()=>me,jsonStringifyReplacer:()=>du,merge:()=>aW,mergeDefs:()=>Ds,normalizeParams:()=>F,nullish:()=>Ms,numKeys:()=>eW,objectClone:()=>KG,omit:()=>oW,optionalKeys:()=>Qk,partial:()=>cW,pick:()=>nW,prefixIssues:()=>Bn,primitiveTypes:()=>Xk,promiseAllObject:()=>XG,propertyKeyTypes:()=>_f,randomString:()=>QG,required:()=>lW,safeExtend:()=>sW,shallowClone:()=>xM,slugify:()=>Jk,stringifyPrimitive:()=>he,uint8ArrayToBase64:()=>kM,uint8ArrayToBase64url:()=>pW,uint8ArrayToHex:()=>mW,unwrapMessage:()=>gf});function VG(t){return t}function ZG(t){return t}function HG(t){}function GG(t){throw new Error("Unexpected value in exhaustive check")}function WG(t){}function yf(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function me(t,e="|"){return t.map(r=>he(r)).join(e)}function du(t,e){return typeof e=="bigint"?e.toString():e}function pu(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function Ms(t){return t==null}function vf(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Kk(t,e){let r=(t.toString().split(".")[1]||"").length,n=e.toString(),o=(n.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(n)){let c=n.match(/\d?e-(\d?)/);c?.[1]&&(o=Number.parseInt(c[1]))}let i=r>o?r:o,s=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return s%a/10**i}var wM=Symbol("evaluating");function De(t,e,r){let n;Object.defineProperty(t,e,{get(){if(n!==wM)return n===void 0&&(n=wM,n=r()),n},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function KG(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function qs(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Ds(...t){let e={};for(let r of t){let n=Object.getOwnPropertyDescriptors(r);Object.assign(e,n)}return Object.defineProperties({},e)}function JG(t){return Ds(t._zod.def)}function YG(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function XG(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let i=0;i<e.length;i++)o[e[i]]=n[i];return o})}function QG(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function n_(t){return JSON.stringify(t)}function Jk(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}var o_="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Ba(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Yk=pu(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Bs(t){if(Ba(t)===!1)return!1;let e=t.constructor;if(e===void 0||typeof e!="function")return!0;let r=e.prototype;return!(Ba(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function xM(t){return Bs(t)?{...t}:Array.isArray(t)?[...t]:t}function eW(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var tW=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},_f=new Set(["string","number","symbol"]),Xk=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Qn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function en(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function F(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function rW(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,i){return e??(e=t()),Reflect.set(e,n,o,i)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function he(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Qk(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var e$={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},t$={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function nW(t,e){let r=t._zod.def,n=Ds(t._zod.def,{get shape(){let o={};for(let i in e){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(o[i]=r.shape[i])}return qs(this,"shape",o),o},checks:[]});return en(t,n)}function oW(t,e){let r=t._zod.def,n=Ds(t._zod.def,{get shape(){let o={...t._zod.def.shape};for(let i in e){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete o[i]}return qs(this,"shape",o),o},checks:[]});return en(t,n)}function iW(t,e){if(!Bs(e))throw new Error("Invalid input to extend: expected a plain object");let r=t._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");let o=Ds(t._zod.def,{get shape(){let i={...t._zod.def.shape,...e};return qs(this,"shape",i),i},checks:[]});return en(t,o)}function sW(t,e){if(!Bs(e))throw new Error("Invalid input to safeExtend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return qs(this,"shape",n),n},checks:t._zod.def.checks};return en(t,r)}function aW(t,e){let r=Ds(t._zod.def,{get shape(){let n={...t._zod.def.shape,...e._zod.def.shape};return qs(this,"shape",n),n},get catchall(){return e._zod.def.catchall},checks:[]});return en(t,r)}function cW(t,e,r){let n=Ds(e._zod.def,{get shape(){let o=e._zod.def.shape,i={...o};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(i[s]=t?new t({type:"optional",innerType:o[s]}):o[s])}else for(let s in o)i[s]=t?new t({type:"optional",innerType:o[s]}):o[s];return qs(this,"shape",i),i},checks:[]});return en(e,n)}function lW(t,e,r){let n=Ds(e._zod.def,{get shape(){let o=e._zod.def.shape,i={...o};if(r)for(let s in r){if(!(s in i))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(i[s]=new t({type:"nonoptional",innerType:o[s]}))}else for(let s in o)i[s]=new t({type:"nonoptional",innerType:o[s]});return qs(this,"shape",i),i},checks:[]});return en(e,n)}function Us(t,e=0){if(t.aborted===!0)return!0;for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Bn(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function gf(t){return typeof t=="string"?t:t?.message}function pn(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=gf(t.inst?._zod.def?.error?.(t))??gf(e?.error?.(t))??gf(r.customError?.(t))??gf(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function bf(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function wf(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function fu(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function uW(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function SM(t){let e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}function kM(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function dW(t){let e=t.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-e.length%4)%4);return SM(e+r)}function pW(t){return kM(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function fW(t){let e=t.replace(/^0x/,"");if(e.length%2!==0)throw new Error("Invalid hex string length");let r=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)r[n/2]=Number.parseInt(e.slice(n,n+2),16);return r}function mW(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}var Wk=class{constructor(...e){}};var $M=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,du,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},i_=x("$ZodError",$M),xf=x("$ZodError",$M,{Parent:Error});function s_(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function a_(t,e=r=>r.message){let r={_errors:[]},n=o=>{for(let i of o.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(s=>n({issues:s}));else if(i.code==="invalid_key")n({issues:i.issues});else if(i.code==="invalid_element")n({issues:i.issues});else if(i.path.length===0)r._errors.push(e(i));else{let s=r,a=0;for(;a<i.path.length;){let c=i.path[a];a===i.path.length-1?(s[c]=s[c]||{_errors:[]},s[c]._errors.push(e(i))):s[c]=s[c]||{_errors:[]},s=s[c],a++}}};return n(t),r}var Sf=t=>(e,r,n,o)=>{let i=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},i);if(s instanceof Promise)throw new ci;if(s.issues.length){let a=new(o?.Err??t)(s.issues.map(c=>pn(c,i,fr())));throw o_(a,o?.callee),a}return s.value},kf=Sf(xf),$f=t=>async(e,r,n,o)=>{let i=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},i);if(s instanceof Promise&&(s=await s),s.issues.length){let a=new(o?.Err??t)(s.issues.map(c=>pn(c,i,fr())));throw o_(a,o?.callee),a}return s.value},Af=$f(xf),Pf=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise)throw new ci;return i.issues.length?{success:!1,error:new(t??i_)(i.issues.map(s=>pn(s,o,fr())))}:{success:!0,data:i.value}},mu=Pf(xf),Cf=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},o);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new t(i.issues.map(s=>pn(s,o,fr())))}:{success:!0,data:i.value}},If=Cf(xf),AM=t=>(e,r,n)=>{let o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Sf(t)(e,r,o)};var PM=t=>(e,r,n)=>Sf(t)(e,r,n);var CM=t=>async(e,r,n)=>{let o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return $f(t)(e,r,o)};var IM=t=>async(e,r,n)=>$f(t)(e,r,n);var TM=t=>(e,r,n)=>{let o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Pf(t)(e,r,o)};var EM=t=>(e,r,n)=>Pf(t)(e,r,n);var OM=t=>async(e,r,n)=>{let o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Cf(t)(e,r,o)};var jM=t=>async(e,r,n)=>Cf(t)(e,r,n);var eo={};Ui(eo,{base64:()=>y$,base64url:()=>c_,bigint:()=>S$,boolean:()=>A$,browserEmail:()=>SW,cidrv4:()=>h$,cidrv6:()=>g$,cuid:()=>r$,cuid2:()=>n$,date:()=>_$,datetime:()=>w$,domain:()=>AW,duration:()=>c$,e164:()=>v$,email:()=>u$,emoji:()=>d$,extendedDuration:()=>gW,guid:()=>l$,hex:()=>PW,hostname:()=>$W,html5Email:()=>bW,idnEmail:()=>xW,integer:()=>k$,ipv4:()=>p$,ipv6:()=>f$,ksuid:()=>s$,lowercase:()=>I$,mac:()=>m$,md5_base64:()=>IW,md5_base64url:()=>TW,md5_hex:()=>CW,nanoid:()=>a$,null:()=>P$,number:()=>$$,rfc5322Email:()=>wW,sha1_base64:()=>OW,sha1_base64url:()=>jW,sha1_hex:()=>EW,sha256_base64:()=>zW,sha256_base64url:()=>RW,sha256_hex:()=>NW,sha384_base64:()=>qW,sha384_base64url:()=>DW,sha384_hex:()=>MW,sha512_base64:()=>UW,sha512_base64url:()=>LW,sha512_hex:()=>BW,string:()=>x$,time:()=>b$,ulid:()=>o$,undefined:()=>C$,unicodeEmail:()=>NM,uppercase:()=>T$,uuid:()=>Ua,uuid4:()=>yW,uuid6:()=>vW,uuid7:()=>_W,xid:()=>i$});var r$=/^[cC][^\s-]{8,}$/,n$=/^[0-9a-z]+$/,o$=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,i$=/^[0-9a-vA-V]{20}$/,s$=/^[A-Za-z0-9]{27}$/,a$=/^[a-zA-Z0-9_-]{21}$/,c$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,gW=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,l$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ua=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,yW=Ua(4),vW=Ua(6),_W=Ua(7),u$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,bW=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,wW=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,NM=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,xW=NM,SW=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,kW="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function d$(){return new RegExp(kW,"u")}var p$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,m$=t=>{let e=Qn(t??":");return new RegExp(`^(?:[0-9A-F]{2}${e}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${e}){5}[0-9a-f]{2}$`)},h$=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,g$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,y$=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,c_=/^[A-Za-z0-9_-]*$/,$W=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,AW=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,v$=/^\+(?:[0-9]){6,14}[0-9]$/,zM="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",_$=new RegExp(`^${zM}$`);function RM(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function b$(t){return new RegExp(`^${RM(t)}$`)}function w$(t){let e=RM({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${zM}T(?:${n})$`)}var x$=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},S$=/^-?\d+n?$/,k$=/^-?\d+$/,$$=/^-?\d+(?:\.\d+)?/,A$=/^(?:true|false)$/i,P$=/^null$/i;var C$=/^undefined$/i;var I$=/^[^A-Z]*$/,T$=/^[^a-z]*$/,PW=/^[0-9a-fA-F]*$/;function Tf(t,e){return new RegExp(`^[A-Za-z0-9+/]{${t}}${e}$`)}function Ef(t){return new RegExp(`^[A-Za-z0-9_-]{${t}}$`)}var CW=/^[0-9a-fA-F]{32}$/,IW=Tf(22,"=="),TW=Ef(22),EW=/^[0-9a-fA-F]{40}$/,OW=Tf(27,"="),jW=Ef(27),NW=/^[0-9a-fA-F]{64}$/,zW=Tf(43,"="),RW=Ef(43),MW=/^[0-9a-fA-F]{96}$/,qW=Tf(64,""),DW=Ef(64),BW=/^[0-9a-fA-F]{128}$/,UW=Tf(86,"=="),LW=Ef(86);var yt=x("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),qM={number:"number",bigint:"bigint",object:"date"},E$=x("$ZodCheckLessThan",(t,e)=>{yt.init(t,e);let r=qM[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,i=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<i&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),O$=x("$ZodCheckGreaterThan",(t,e)=>{yt.init(t,e);let r=qM[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,i=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>i&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),DM=x("$ZodCheckMultipleOf",(t,e)=>{yt.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Kk(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),BM=x("$ZodCheckNumberFormat",(t,e)=>{yt.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,i]=e$[e.format];t._zod.onattach.push(s=>{let a=s._zod.bag;a.format=e.format,a.minimum=o,a.maximum=i,r&&(a.pattern=k$)}),t._zod.check=s=>{let a=s.value;if(r){if(!Number.isInteger(a)){s.issues.push({expected:n,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?s.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&s.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>i&&s.issues.push({origin:"number",input:a,code:"too_big",maximum:i,inst:t})}}),UM=x("$ZodCheckBigIntFormat",(t,e)=>{yt.init(t,e);let[r,n]=t$[e.format];t._zod.onattach.push(o=>{let i=o._zod.bag;i.format=e.format,i.minimum=r,i.maximum=n}),t._zod.check=o=>{let i=o.value;i<r&&o.issues.push({origin:"bigint",input:i,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),i>n&&o.issues.push({origin:"bigint",input:i,code:"too_big",maximum:n,inst:t})}}),LM=x("$ZodCheckMaxSize",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.size!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;o.size<=e.maximum||n.issues.push({origin:bf(o),code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),FM=x("$ZodCheckMinSize",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.size!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;o.size>=e.minimum||n.issues.push({origin:bf(o),code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),VM=x("$ZodCheckSizeEquals",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.size!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.size,o.maximum=e.size,o.size=e.size}),t._zod.check=n=>{let o=n.value,i=o.size;if(i===e.size)return;let s=i>e.size;n.issues.push({origin:bf(o),...s?{code:"too_big",maximum:e.size}:{code:"too_small",minimum:e.size},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),ZM=x("$ZodCheckMaxLength",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let s=wf(o);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),HM=x("$ZodCheckMinLength",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let s=wf(o);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),GM=x("$ZodCheckLengthEquals",(t,e)=>{var r;yt.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Ms(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,i=o.length;if(i===e.length)return;let s=wf(o),a=i>e.length;n.issues.push({origin:s,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Of=x("$ZodCheckStringFormat",(t,e)=>{var r,n;yt.init(t,e),t._zod.onattach.push(o=>{let i=o._zod.bag;i.format=e.format,e.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),WM=x("$ZodCheckRegex",(t,e)=>{Of.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),KM=x("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=I$),Of.init(t,e)}),JM=x("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=T$),Of.init(t,e)}),YM=x("$ZodCheckIncludes",(t,e)=>{yt.init(t,e);let r=Qn(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let i=o._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),XM=x("$ZodCheckStartsWith",(t,e)=>{yt.init(t,e);let r=new RegExp(`^${Qn(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),QM=x("$ZodCheckEndsWith",(t,e)=>{yt.init(t,e);let r=new RegExp(`.*${Qn(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});function MM(t,e,r){t.issues.length&&e.issues.push(...Bn(r,t.issues))}var eq=x("$ZodCheckProperty",(t,e)=>{yt.init(t,e),t._zod.check=r=>{let n=e.schema._zod.run({value:r.value[e.property],issues:[]},{});if(n instanceof Promise)return n.then(o=>MM(o,r,e.property));MM(n,r,e.property)}}),tq=x("$ZodCheckMimeType",(t,e)=>{yt.init(t,e);let r=new Set(e.mime);t._zod.onattach.push(n=>{n._zod.bag.mime=e.mime}),t._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:e.mime,input:n.value.type,inst:t,continue:!e.abort})}}),rq=x("$ZodCheckOverwrite",(t,e)=>{yt.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var l_=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(s=>s),o=Math.min(...n.map(s=>s.length-s.trimStart().length)),i=n.map(s=>s.slice(o)).map(s=>" ".repeat(this.indent*2)+s);for(let s of i)this.content.push(s)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(i=>`  ${i}`)];return new e(...r,o.join(`
`))}};var oq={major:4,minor:2,patch:1};var we=x("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=oq;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let i of o._zod.onattach)i(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,a,c)=>{let l=Us(s),u;for(let d of a){if(d._zod.def.when){if(!d._zod.def.when(s))continue}else if(l)continue;let p=s.issues.length,f=d._zod.check(s);if(f instanceof Promise&&c?.async===!1)throw new ci;if(u||f instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await f,s.issues.length!==p&&(l||(l=Us(s,p)))});else{if(s.issues.length===p)continue;l||(l=Us(s,p))}}return u?u.then(()=>s):s},i=(s,a,c)=>{if(Us(s))return s.aborted=!0,s;let l=o(a,n,c);if(l instanceof Promise){if(c.async===!1)throw new ci;return l.then(u=>t._zod.parse(u,c))}return t._zod.parse(l,c)};t._zod.run=(s,a)=>{if(a.skipChecks)return t._zod.parse(s,a);if(a.direction==="backward"){let l=t._zod.parse({value:s.value,issues:[]},{...a,skipChecks:!0});return l instanceof Promise?l.then(u=>i(u,s,a)):i(l,s,a)}let c=t._zod.parse(s,a);if(c instanceof Promise){if(a.async===!1)throw new ci;return c.then(l=>o(l,n,a))}return o(c,n,a)}}t["~standard"]={validate:o=>{try{let i=mu(t,o);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return If(t,o).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),La=x("$ZodString",(t,e)=>{we.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??x$(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),pt=x("$ZodStringFormat",(t,e)=>{Of.init(t,e),La.init(t,e)}),N$=x("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=l$),pt.init(t,e)}),z$=x("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Ua(n))}else e.pattern??(e.pattern=Ua());pt.init(t,e)}),R$=x("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=u$),pt.init(t,e)}),M$=x("$ZodURL",(t,e)=>{pt.init(t,e),t._zod.check=r=>{try{let n=r.value.trim(),o=new URL(n);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),e.normalize?r.value=o.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),q$=x("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=d$()),pt.init(t,e)}),D$=x("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=a$),pt.init(t,e)}),B$=x("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=r$),pt.init(t,e)}),U$=x("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=n$),pt.init(t,e)}),L$=x("$ZodULID",(t,e)=>{e.pattern??(e.pattern=o$),pt.init(t,e)}),F$=x("$ZodXID",(t,e)=>{e.pattern??(e.pattern=i$),pt.init(t,e)}),V$=x("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=s$),pt.init(t,e)}),Z$=x("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=w$(e)),pt.init(t,e)}),H$=x("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=_$),pt.init(t,e)}),G$=x("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=b$(e)),pt.init(t,e)}),W$=x("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=c$),pt.init(t,e)}),K$=x("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=p$),pt.init(t,e),t._zod.bag.format="ipv4"}),J$=x("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=f$),pt.init(t,e),t._zod.bag.format="ipv6",t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),Y$=x("$ZodMAC",(t,e)=>{e.pattern??(e.pattern=m$(e.delimiter)),pt.init(t,e),t._zod.bag.format="mac"}),X$=x("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=h$),pt.init(t,e)}),Q$=x("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=g$),pt.init(t,e),t._zod.check=r=>{let n=r.value.split("/");try{if(n.length!==2)throw new Error;let[o,i]=n;if(!i)throw new Error;let s=Number(i);if(`${s}`!==i)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${o}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function gq(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var eA=x("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=y$),pt.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=r=>{gq(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function FW(t){if(!c_.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return gq(r)}var tA=x("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=c_),pt.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=r=>{FW(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),rA=x("$ZodE164",(t,e)=>{e.pattern??(e.pattern=v$),pt.init(t,e)});function VW(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var nA=x("$ZodJWT",(t,e)=>{pt.init(t,e),t._zod.check=r=>{VW(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),oA=x("$ZodCustomStringFormat",(t,e)=>{pt.init(t,e),t._zod.check=r=>{e.fn(r.value)||r.issues.push({code:"invalid_format",format:e.format,input:r.value,inst:t,continue:!e.abort})}}),h_=x("$ZodNumber",(t,e)=>{we.init(t,e),t._zod.pattern=t._zod.bag.pattern??$$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let i=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...i?{received:i}:{}}),r}}),iA=x("$ZodNumberFormat",(t,e)=>{BM.init(t,e),h_.init(t,e)}),jf=x("$ZodBoolean",(t,e)=>{we.init(t,e),t._zod.pattern=A$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}}),g_=x("$ZodBigInt",(t,e)=>{we.init(t,e),t._zod.pattern=S$,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=BigInt(r.value)}catch{}return typeof r.value=="bigint"||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:t}),r}}),sA=x("$ZodBigIntFormat",(t,e)=>{UM.init(t,e),g_.init(t,e)}),aA=x("$ZodSymbol",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;return typeof o=="symbol"||r.issues.push({expected:"symbol",code:"invalid_type",input:o,inst:t}),r}}),cA=x("$ZodUndefined",(t,e)=>{we.init(t,e),t._zod.pattern=C$,t._zod.values=new Set([void 0]),t._zod.optin="optional",t._zod.optout="optional",t._zod.parse=(r,n)=>{let o=r.value;return typeof o>"u"||r.issues.push({expected:"undefined",code:"invalid_type",input:o,inst:t}),r}}),lA=x("$ZodNull",(t,e)=>{we.init(t,e),t._zod.pattern=P$,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}}),uA=x("$ZodAny",(t,e)=>{we.init(t,e),t._zod.parse=r=>r}),dA=x("$ZodUnknown",(t,e)=>{we.init(t,e),t._zod.parse=r=>r}),pA=x("$ZodNever",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),fA=x("$ZodVoid",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;return typeof o>"u"||r.issues.push({expected:"void",code:"invalid_type",input:o,inst:t}),r}}),mA=x("$ZodDate",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}let o=r.value,i=o instanceof Date;return i&&!Number.isNaN(o.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:o,...i?{received:"Invalid Date"}:{},inst:t}),r}});function iq(t,e,r){t.issues.length&&e.issues.push(...Bn(r,t.issues)),e.value[r]=t.value}var hA=x("$ZodArray",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let i=[];for(let s=0;s<o.length;s++){let a=o[s],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?i.push(c.then(l=>iq(l,r,s))):iq(c,r,s)}return i.length?Promise.all(i).then(()=>r):r}});function m_(t,e,r,n){t.issues.length&&e.issues.push(...Bn(r,t.issues)),t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}function yq(t){let e=Object.keys(t.shape);for(let n of e)if(!t.shape?.[n]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);let r=Qk(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(r)}}function vq(t,e,r,n,o,i){let s=[],a=o.keySet,c=o.catchall._zod,l=c.def.type;for(let u in e){if(a.has(u))continue;if(l==="never"){s.push(u);continue}let d=c.run({value:e[u],issues:[]},n);d instanceof Promise?t.push(d.then(p=>m_(p,r,u,e))):m_(d,r,u,e)}return s.length&&r.issues.push({code:"unrecognized_keys",keys:s,input:e,inst:i}),t.length?Promise.all(t).then(()=>r):r}var _q=x("$ZodObject",(t,e)=>{if(we.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){let a=e.shape;Object.defineProperty(e,"shape",{get:()=>{let c={...a};return Object.defineProperty(e,"shape",{value:c}),c}})}let n=pu(()=>yq(e));De(t._zod,"propValues",()=>{let a=e.shape,c={};for(let l in a){let u=a[l]._zod;if(u.values){c[l]??(c[l]=new Set);for(let d of u.values)c[l].add(d)}}return c});let o=Ba,i=e.catchall,s;t._zod.parse=(a,c)=>{s??(s=n.value);let l=a.value;if(!o(l))return a.issues.push({expected:"object",code:"invalid_type",input:l,inst:t}),a;a.value={};let u=[],d=s.shape;for(let p of s.keys){let h=d[p]._zod.run({value:l[p],issues:[]},c);h instanceof Promise?u.push(h.then(m=>m_(m,a,p,l))):m_(h,a,p,l)}return i?vq(u,l,a,c,n.value,t):u.length?Promise.all(u).then(()=>a):a}}),bq=x("$ZodObjectJIT",(t,e)=>{_q.init(t,e);let r=t._zod.parse,n=pu(()=>yq(e)),o=p=>{let f=new l_(["shape","payload","ctx"]),h=n.value,m=$=>{let R=n_($);return`shape[${R}]._zod.run({ value: input[${R}], issues: [] }, ctx)`};f.write("const input = payload.value;");let y=Object.create(null),v=0;for(let $ of h.keys)y[$]=`key_${v++}`;f.write("const newResult = {};");for(let $ of h.keys){let R=y[$],P=n_($);f.write(`const ${R} = ${m($)};`),f.write(`
        if (${R}.issues.length) {
          payload.issues = payload.issues.concat(${R}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${P}, ...iss.path] : [${P}]
          })));
        }
        
        
        if (${R}.value === undefined) {
          if (${P} in input) {
            newResult[${P}] = undefined;
          }
        } else {
          newResult[${P}] = ${R}.value;
        }
        
      `)}f.write("payload.value = newResult;"),f.write("return payload;");let w=f.compile();return($,R)=>w(p,$,R)},i,s=Ba,a=!t_.jitless,l=a&&Yk.value,u=e.catchall,d;t._zod.parse=(p,f)=>{d??(d=n.value);let h=p.value;return s(h)?a&&l&&f?.async===!1&&f.jitless!==!0?(i||(i=o(e.shape)),p=i(p,f),u?vq([],h,p,f,d,t):p):r(p,f):(p.issues.push({expected:"object",code:"invalid_type",input:h,inst:t}),p)}});function sq(t,e,r,n){for(let i of t)if(i.issues.length===0)return e.value=i.value,e;let o=t.filter(i=>!Us(i));return o.length===1?(e.value=o[0].value,o[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(s=>pn(s,n,fr())))}),e)}var Nf=x("$ZodUnion",(t,e)=>{we.init(t,e),De(t._zod,"optin",()=>e.options.some(o=>o._zod.optin==="optional")?"optional":void 0),De(t._zod,"optout",()=>e.options.some(o=>o._zod.optout==="optional")?"optional":void 0),De(t._zod,"values",()=>{if(e.options.every(o=>o._zod.values))return new Set(e.options.flatMap(o=>Array.from(o._zod.values)))}),De(t._zod,"pattern",()=>{if(e.options.every(o=>o._zod.pattern)){let o=e.options.map(i=>i._zod.pattern);return new RegExp(`^(${o.map(i=>vf(i.source)).join("|")})$`)}});let r=e.options.length===1,n=e.options[0]._zod.run;t._zod.parse=(o,i)=>{if(r)return n(o,i);let s=!1,a=[];for(let c of e.options){let l=c._zod.run({value:o.value,issues:[]},i);if(l instanceof Promise)a.push(l),s=!0;else{if(l.issues.length===0)return l;a.push(l)}}return s?Promise.all(a).then(c=>sq(c,o,t,i)):sq(a,o,t,i)}});function aq(t,e,r,n){let o=t.filter(i=>i.issues.length===0);return o.length===1?(e.value=o[0].value,e):(o.length===0?e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(s=>pn(s,n,fr())))}):e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:[],inclusive:!1}),e)}var gA=x("$ZodXor",(t,e)=>{Nf.init(t,e),e.inclusive=!1;let r=e.options.length===1,n=e.options[0]._zod.run;t._zod.parse=(o,i)=>{if(r)return n(o,i);let s=!1,a=[];for(let c of e.options){let l=c._zod.run({value:o.value,issues:[]},i);l instanceof Promise?(a.push(l),s=!0):a.push(l)}return s?Promise.all(a).then(c=>aq(c,o,t,i)):aq(a,o,t,i)}}),yA=x("$ZodDiscriminatedUnion",(t,e)=>{e.inclusive=!1,Nf.init(t,e);let r=t._zod.parse;De(t._zod,"propValues",()=>{let o={};for(let i of e.options){let s=i._zod.propValues;if(!s||Object.keys(s).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let[a,c]of Object.entries(s)){o[a]||(o[a]=new Set);for(let l of c)o[a].add(l)}}return o});let n=pu(()=>{let o=e.options,i=new Map;for(let s of o){let a=s._zod.propValues?.[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let c of a){if(i.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);i.set(c,s)}}return i});t._zod.parse=(o,i)=>{let s=o.value;if(!Ba(s))return o.issues.push({code:"invalid_type",expected:"object",input:s,inst:t}),o;let a=n.value.get(s?.[e.discriminator]);return a?a._zod.run(o,i):e.unionFallback?r(o,i):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:s,path:[e.discriminator],inst:t}),o)}}),vA=x("$ZodIntersection",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,i=e.left._zod.run({value:o,issues:[]},n),s=e.right._zod.run({value:o,issues:[]},n);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([c,l])=>cq(r,c,l)):cq(r,i,s)}});function j$(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Bs(t)&&Bs(e)){let r=Object.keys(e),n=Object.keys(t).filter(i=>r.indexOf(i)!==-1),o={...t,...e};for(let i of n){let s=j$(t[i],e[i]);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};o[i]=s.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],i=e[n],s=j$(o,i);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function cq(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),Us(t))return t;let n=j$(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var y_=x("$ZodTuple",(t,e)=>{we.init(t,e);let r=e.items;t._zod.parse=(n,o)=>{let i=n.value;if(!Array.isArray(i))return n.issues.push({input:i,inst:t,expected:"tuple",code:"invalid_type"}),n;n.value=[];let s=[],a=[...r].reverse().findIndex(u=>u._zod.optin!=="optional"),c=a===-1?0:r.length-a;if(!e.rest){let u=i.length>r.length,d=i.length<c-1;if(u||d)return n.issues.push({...u?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length},input:i,inst:t,origin:"array"}),n}let l=-1;for(let u of r){if(l++,l>=i.length&&l>=c)continue;let d=u._zod.run({value:i[l],issues:[]},o);d instanceof Promise?s.push(d.then(p=>u_(p,n,l))):u_(d,n,l)}if(e.rest){let u=i.slice(r.length);for(let d of u){l++;let p=e.rest._zod.run({value:d,issues:[]},o);p instanceof Promise?s.push(p.then(f=>u_(f,n,l))):u_(p,n,l)}}return s.length?Promise.all(s).then(()=>n):n}});function u_(t,e,r){t.issues.length&&e.issues.push(...Bn(r,t.issues)),e.value[r]=t.value}var _A=x("$ZodRecord",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Bs(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let i=[],s=e.keyType._zod.values;if(s){r.value={};let a=new Set;for(let l of s)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){a.add(typeof l=="number"?l.toString():l);let u=e.valueType._zod.run({value:o[l],issues:[]},n);u instanceof Promise?i.push(u.then(d=>{d.issues.length&&r.issues.push(...Bn(l,d.issues)),r.value[l]=d.value})):(u.issues.length&&r.issues.push(...Bn(l,u.issues)),r.value[l]=u.value)}let c;for(let l in o)a.has(l)||(c=c??[],c.push(l));c&&c.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:c})}else{r.value={};for(let a of Reflect.ownKeys(o)){if(a==="__proto__")continue;let c=e.keyType._zod.run({value:a,issues:[]},n);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){e.mode==="loose"?r.value[a]=o[a]:r.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(u=>pn(u,n,fr())),input:a,path:[a],inst:t});continue}let l=e.valueType._zod.run({value:o[a],issues:[]},n);l instanceof Promise?i.push(l.then(u=>{u.issues.length&&r.issues.push(...Bn(a,u.issues)),r.value[c.value]=u.value})):(l.issues.length&&r.issues.push(...Bn(a,l.issues)),r.value[c.value]=l.value)}}return i.length?Promise.all(i).then(()=>r):r}}),bA=x("$ZodMap",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!(o instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:o,inst:t}),r;let i=[];r.value=new Map;for(let[s,a]of o){let c=e.keyType._zod.run({value:s,issues:[]},n),l=e.valueType._zod.run({value:a,issues:[]},n);c instanceof Promise||l instanceof Promise?i.push(Promise.all([c,l]).then(([u,d])=>{lq(u,d,r,s,o,t,n)})):lq(c,l,r,s,o,t,n)}return i.length?Promise.all(i).then(()=>r):r}});function lq(t,e,r,n,o,i,s){t.issues.length&&(_f.has(typeof n)?r.issues.push(...Bn(n,t.issues)):r.issues.push({code:"invalid_key",origin:"map",input:o,inst:i,issues:t.issues.map(a=>pn(a,s,fr()))})),e.issues.length&&(_f.has(typeof n)?r.issues.push(...Bn(n,e.issues)):r.issues.push({origin:"map",code:"invalid_element",input:o,inst:i,key:n,issues:e.issues.map(a=>pn(a,s,fr()))})),r.value.set(t.value,e.value)}var wA=x("$ZodSet",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!(o instanceof Set))return r.issues.push({input:o,inst:t,expected:"set",code:"invalid_type"}),r;let i=[];r.value=new Set;for(let s of o){let a=e.valueType._zod.run({value:s,issues:[]},n);a instanceof Promise?i.push(a.then(c=>uq(c,r))):uq(a,r)}return i.length?Promise.all(i).then(()=>r):r}});function uq(t,e){t.issues.length&&e.issues.push(...t.issues),e.value.add(t.value)}var xA=x("$ZodEnum",(t,e)=>{we.init(t,e);let r=yf(e.entries),n=new Set(r);t._zod.values=n,t._zod.pattern=new RegExp(`^(${r.filter(o=>_f.has(typeof o)).map(o=>typeof o=="string"?Qn(o):o.toString()).join("|")})$`),t._zod.parse=(o,i)=>{let s=o.value;return n.has(s)||o.issues.push({code:"invalid_value",values:r,input:s,inst:t}),o}}),SA=x("$ZodLiteral",(t,e)=>{if(we.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");let r=new Set(e.values);t._zod.values=r,t._zod.pattern=new RegExp(`^(${e.values.map(n=>typeof n=="string"?Qn(n):n?Qn(n.toString()):String(n)).join("|")})$`),t._zod.parse=(n,o)=>{let i=n.value;return r.has(i)||n.issues.push({code:"invalid_value",values:e.values,input:i,inst:t}),n}}),kA=x("$ZodFile",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;return o instanceof File||r.issues.push({expected:"file",code:"invalid_type",input:o,inst:t}),r}}),$A=x("$ZodTransform",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Da(t.constructor.name);let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(s=>(r.value=s,r));if(o instanceof Promise)throw new ci;return r.value=o,r}});function dq(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}var AA=x("$ZodOptional",(t,e)=>{we.init(t,e),t._zod.optin="optional",t._zod.optout="optional",De(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),De(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${vf(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>{if(e.innerType._zod.optin==="optional"){let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(i=>dq(i,r.value)):dq(o,r.value)}return r.value===void 0?r:e.innerType._zod.run(r,n)}}),PA=x("$ZodNullable",(t,e)=>{we.init(t,e),De(t._zod,"optin",()=>e.innerType._zod.optin),De(t._zod,"optout",()=>e.innerType._zod.optout),De(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${vf(r.source)}|null)$`):void 0}),De(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),CA=x("$ZodDefault",(t,e)=>{we.init(t,e),t._zod.optin="optional",De(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(i=>pq(i,e)):pq(o,e)}});function pq(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var IA=x("$ZodPrefault",(t,e)=>{we.init(t,e),t._zod.optin="optional",De(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),TA=x("$ZodNonOptional",(t,e)=>{we.init(t,e),De(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(i=>fq(i,t)):fq(o,t)}});function fq(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var EA=x("$ZodSuccess",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Da("ZodSuccess");let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(i=>(r.value=i.issues.length===0,r)):(r.value=o.issues.length===0,r)}}),OA=x("$ZodCatch",(t,e)=>{we.init(t,e),De(t._zod,"optin",()=>e.innerType._zod.optin),De(t._zod,"optout",()=>e.innerType._zod.optout),De(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(i=>(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(s=>pn(s,n,fr()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(i=>pn(i,n,fr()))},input:r.value}),r.issues=[]),r)}}),jA=x("$ZodNaN",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>((typeof r.value!="number"||!Number.isNaN(r.value))&&r.issues.push({input:r.value,inst:t,expected:"nan",code:"invalid_type"}),r)}),NA=x("$ZodPipe",(t,e)=>{we.init(t,e),De(t._zod,"values",()=>e.in._zod.values),De(t._zod,"optin",()=>e.in._zod.optin),De(t._zod,"optout",()=>e.out._zod.optout),De(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{if(n.direction==="backward"){let i=e.out._zod.run(r,n);return i instanceof Promise?i.then(s=>d_(s,e.in,n)):d_(i,e.in,n)}let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(i=>d_(i,e.out,n)):d_(o,e.out,n)}});function d_(t,e,r){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},r)}var zf=x("$ZodCodec",(t,e)=>{we.init(t,e),De(t._zod,"values",()=>e.in._zod.values),De(t._zod,"optin",()=>e.in._zod.optin),De(t._zod,"optout",()=>e.out._zod.optout),De(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{if((n.direction||"forward")==="forward"){let i=e.in._zod.run(r,n);return i instanceof Promise?i.then(s=>p_(s,e,n)):p_(i,e,n)}else{let i=e.out._zod.run(r,n);return i instanceof Promise?i.then(s=>p_(s,e,n)):p_(i,e,n)}}});function p_(t,e,r){if(t.issues.length)return t.aborted=!0,t;if((r.direction||"forward")==="forward"){let o=e.transform(t.value,t);return o instanceof Promise?o.then(i=>f_(t,i,e.out,r)):f_(t,o,e.out,r)}else{let o=e.reverseTransform(t.value,t);return o instanceof Promise?o.then(i=>f_(t,i,e.in,r)):f_(t,o,e.in,r)}}function f_(t,e,r,n){return t.issues.length?(t.aborted=!0,t):r._zod.run({value:e,issues:t.issues},n)}var zA=x("$ZodReadonly",(t,e)=>{we.init(t,e),De(t._zod,"propValues",()=>e.innerType._zod.propValues),De(t._zod,"values",()=>e.innerType._zod.values),De(t._zod,"optin",()=>e.innerType?._zod?.optin),De(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(r,n)=>{if(n.direction==="backward")return e.innerType._zod.run(r,n);let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(mq):mq(o)}});function mq(t){return t.value=Object.freeze(t.value),t}var RA=x("$ZodTemplateLiteral",(t,e)=>{we.init(t,e);let r=[];for(let n of e.parts)if(typeof n=="object"&&n!==null){if(!n._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...n._zod.traits].shift()}`);let o=n._zod.pattern instanceof RegExp?n._zod.pattern.source:n._zod.pattern;if(!o)throw new Error(`Invalid template literal part: ${n._zod.traits}`);let i=o.startsWith("^")?1:0,s=o.endsWith("$")?o.length-1:o.length;r.push(o.slice(i,s))}else if(n===null||Xk.has(typeof n))r.push(Qn(`${n}`));else throw new Error(`Invalid template literal part: ${n}`);t._zod.pattern=new RegExp(`^${r.join("")}$`),t._zod.parse=(n,o)=>typeof n.value!="string"?(n.issues.push({input:n.value,inst:t,expected:"template_literal",code:"invalid_type"}),n):(t._zod.pattern.lastIndex=0,t._zod.pattern.test(n.value)||n.issues.push({input:n.value,inst:t,code:"invalid_format",format:e.format??"template_literal",pattern:t._zod.pattern.source}),n)}),MA=x("$ZodFunction",(t,e)=>(we.init(t,e),t._def=e,t._zod.def=e,t.implement=r=>{if(typeof r!="function")throw new Error("implement() must be called with a function");return function(...n){let o=t._def.input?kf(t._def.input,n):n,i=Reflect.apply(r,this,o);return t._def.output?kf(t._def.output,i):i}},t.implementAsync=r=>{if(typeof r!="function")throw new Error("implementAsync() must be called with a function");return async function(...n){let o=t._def.input?await Af(t._def.input,n):n,i=await Reflect.apply(r,this,o);return t._def.output?await Af(t._def.output,i):i}},t._zod.parse=(r,n)=>typeof r.value!="function"?(r.issues.push({code:"invalid_type",expected:"function",input:r.value,inst:t}),r):(t._def.output&&t._def.output._zod.def.type==="promise"?r.value=t.implementAsync(r.value):r.value=t.implement(r.value),r),t.input=(...r)=>{let n=t.constructor;return Array.isArray(r[0])?new n({type:"function",input:new y_({type:"tuple",items:r[0],rest:r[1]}),output:t._def.output}):new n({type:"function",input:r[0],output:t._def.output})},t.output=r=>{let n=t.constructor;return new n({type:"function",input:t._def.input,output:r})},t)),qA=x("$ZodPromise",(t,e)=>{we.init(t,e),t._zod.parse=(r,n)=>Promise.resolve(r.value).then(o=>e.innerType._zod.run({value:o,issues:[]},n))}),DA=x("$ZodLazy",(t,e)=>{we.init(t,e),De(t._zod,"innerType",()=>e.getter()),De(t._zod,"pattern",()=>t._zod.innerType?._zod?.pattern),De(t._zod,"propValues",()=>t._zod.innerType?._zod?.propValues),De(t._zod,"optin",()=>t._zod.innerType?._zod?.optin??void 0),De(t._zod,"optout",()=>t._zod.innerType?._zod?.optout??void 0),t._zod.parse=(r,n)=>t._zod.innerType._zod.run(r,n)}),BA=x("$ZodCustom",(t,e)=>{yt.init(t,e),we.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(i=>hq(i,r,n,t));hq(o,r,n,t)}});function hq(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(fu(o))}}var HW=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},GW=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",mac:"MAC address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${HW(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${he(n.values[0])}`:`Invalid option: expected one of ${me(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",i=e(n.origin);return i?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${i.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",i=e(n.origin);return i?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${i.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${me(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function UA(){return{localeError:GW()}}var wq;var FA=class{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};delete n.id;let o={...n,...this._map.get(e)};return Object.keys(o).length?o:void 0}return this._map.get(e)}has(e){return this._map.has(e)}};function VA(){return new FA}(wq=globalThis).__zod_globalRegistry??(wq.__zod_globalRegistry=VA());var fn=globalThis.__zod_globalRegistry;function ZA(t,e){return new t({type:"string",...F(e)})}function HA(t,e){return new t({type:"string",coerce:!0,...F(e)})}function v_(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...F(e)})}function Rf(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...F(e)})}function __(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...F(e)})}function b_(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...F(e)})}function w_(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...F(e)})}function x_(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...F(e)})}function Mf(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...F(e)})}function S_(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...F(e)})}function k_(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...F(e)})}function $_(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...F(e)})}function A_(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...F(e)})}function P_(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...F(e)})}function C_(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...F(e)})}function I_(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...F(e)})}function T_(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...F(e)})}function E_(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...F(e)})}function GA(t,e){return new t({type:"string",format:"mac",check:"string_format",abort:!1,...F(e)})}function O_(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...F(e)})}function j_(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...F(e)})}function N_(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...F(e)})}function z_(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...F(e)})}function R_(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...F(e)})}function M_(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...F(e)})}function WA(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...F(e)})}function KA(t,e){return new t({type:"string",format:"date",check:"string_format",...F(e)})}function JA(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...F(e)})}function YA(t,e){return new t({type:"string",format:"duration",check:"string_format",...F(e)})}function XA(t,e){return new t({type:"number",checks:[],...F(e)})}function QA(t,e){return new t({type:"number",coerce:!0,checks:[],...F(e)})}function eP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...F(e)})}function tP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float32",...F(e)})}function rP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float64",...F(e)})}function nP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"int32",...F(e)})}function oP(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"uint32",...F(e)})}function iP(t,e){return new t({type:"boolean",...F(e)})}function sP(t,e){return new t({type:"boolean",coerce:!0,...F(e)})}function aP(t,e){return new t({type:"bigint",...F(e)})}function cP(t,e){return new t({type:"bigint",coerce:!0,...F(e)})}function lP(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...F(e)})}function uP(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...F(e)})}function dP(t,e){return new t({type:"symbol",...F(e)})}function pP(t,e){return new t({type:"undefined",...F(e)})}function fP(t,e){return new t({type:"null",...F(e)})}function mP(t){return new t({type:"any"})}function hP(t){return new t({type:"unknown"})}function gP(t,e){return new t({type:"never",...F(e)})}function yP(t,e){return new t({type:"void",...F(e)})}function vP(t,e){return new t({type:"date",...F(e)})}function _P(t,e){return new t({type:"date",coerce:!0,...F(e)})}function bP(t,e){return new t({type:"nan",...F(e)})}function Hi(t,e){return new E$({check:"less_than",...F(e),value:t,inclusive:!1})}function Un(t,e){return new E$({check:"less_than",...F(e),value:t,inclusive:!0})}function Gi(t,e){return new O$({check:"greater_than",...F(e),value:t,inclusive:!1})}function tn(t,e){return new O$({check:"greater_than",...F(e),value:t,inclusive:!0})}function wP(t){return Gi(0,t)}function xP(t){return Hi(0,t)}function SP(t){return Un(0,t)}function kP(t){return tn(0,t)}function Fa(t,e){return new DM({check:"multiple_of",...F(e),value:t})}function hu(t,e){return new LM({check:"max_size",...F(e),maximum:t})}function Va(t,e){return new FM({check:"min_size",...F(e),minimum:t})}function qf(t,e){return new VM({check:"size_equals",...F(e),size:t})}function gu(t,e){return new ZM({check:"max_length",...F(e),maximum:t})}function Ls(t,e){return new HM({check:"min_length",...F(e),minimum:t})}function yu(t,e){return new GM({check:"length_equals",...F(e),length:t})}function Df(t,e){return new WM({check:"string_format",format:"regex",...F(e),pattern:t})}function Bf(t){return new KM({check:"string_format",format:"lowercase",...F(t)})}function Uf(t){return new JM({check:"string_format",format:"uppercase",...F(t)})}function Lf(t,e){return new YM({check:"string_format",format:"includes",...F(e),includes:t})}function Ff(t,e){return new XM({check:"string_format",format:"starts_with",...F(e),prefix:t})}function Vf(t,e){return new QM({check:"string_format",format:"ends_with",...F(e),suffix:t})}function $P(t,e,r){return new eq({check:"property",property:t,schema:e,...F(r)})}function Zf(t,e){return new tq({check:"mime_type",mime:t,...F(e)})}function li(t){return new rq({check:"overwrite",tx:t})}function Hf(t){return li(e=>e.normalize(t))}function Gf(){return li(t=>t.trim())}function Wf(){return li(t=>t.toLowerCase())}function Kf(){return li(t=>t.toUpperCase())}function q_(){return li(t=>Jk(t))}function xq(t,e,r){return new t({type:"array",element:e,...F(r)})}function AP(t,e){return new t({type:"file",...F(e)})}function PP(t,e,r){let n=F(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function CP(t,e,r){return new t({type:"custom",check:"custom",fn:e,...F(r)})}function IP(t){let e=YW(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(fu(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(fu(o))}},t(r.value,r)));return e}function YW(t,e){let r=new yt({check:"custom",...F(e)});return r._zod.check=t,r}function TP(t){let e=new yt({check:"describe"});return e._zod.onattach=[r=>{let n=fn.get(r)??{};fn.add(r,{...n,description:t})}],e._zod.check=()=>{},e}function EP(t){let e=new yt({check:"meta"});return e._zod.onattach=[r=>{let n=fn.get(r)??{};fn.add(r,{...n,...t})}],e._zod.check=()=>{},e}function OP(t,e){let r=F(e),n=r.truthy??["true","1","yes","on","y","enabled"],o=r.falsy??["false","0","no","off","n","disabled"];r.case!=="sensitive"&&(n=n.map(f=>typeof f=="string"?f.toLowerCase():f),o=o.map(f=>typeof f=="string"?f.toLowerCase():f));let i=new Set(n),s=new Set(o),a=t.Codec??zf,c=t.Boolean??jf,l=t.String??La,u=new l({type:"string",error:r.error}),d=new c({type:"boolean",error:r.error}),p=new a({type:"pipe",in:u,out:d,transform:((f,h)=>{let m=f;return r.case!=="sensitive"&&(m=m.toLowerCase()),i.has(m)?!0:s.has(m)?!1:(h.issues.push({code:"invalid_value",expected:"stringbool",values:[...i,...s],input:h.value,inst:p,continue:!1}),{})}),reverseTransform:((f,h)=>f===!0?n[0]||"true":o[0]||"false"),error:r.error});return p}function vu(t,e,r,n={}){let o=F(n),i={...F(n),check:"string_format",type:"string",format:e,fn:typeof r=="function"?r:a=>r.test(a),...o};return r instanceof RegExp&&(i.pattern=r),new t(i)}function D_(t){let e=t?.target??"draft-2020-12";return e==="draft-4"&&(e="draft-04"),e==="draft-7"&&(e="draft-07"),{processors:t.processors??{},metadataRegistry:t?.metadata??fn,target:e,unrepresentable:t?.unrepresentable??"throw",override:t?.override??(()=>{}),io:t?.io??"output",counter:0,seen:new Map,cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0}}function Et(t,e,r={path:[],schemaPath:[]}){var n;let o=t._zod.def,i=e.seen.get(t);if(i)return i.count++,r.schemaPath.includes(t)&&(i.cycle=r.path),i.schema;let s={schema:{},count:1,cycle:void 0,path:r.path};e.seen.set(t,s);let a=t._zod.toJSONSchema?.();if(a)s.schema=a;else{let u={...r,schemaPath:[...r.schemaPath,t],path:r.path},d=t._zod.parent;if(d)s.ref=d,Et(d,e,u),e.seen.get(d).isParent=!0;else if(t._zod.processJSONSchema)t._zod.processJSONSchema(e,s.schema,u);else{let p=s.schema,f=e.processors[o.type];if(!f)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${o.type}`);f(t,e,p,u)}}let c=e.metadataRegistry.get(t);return c&&Object.assign(s.schema,c),e.io==="input"&&rn(t)&&(delete s.schema.examples,delete s.schema.default),e.io==="input"&&s.schema._prefault&&((n=s.schema).default??(n.default=s.schema._prefault)),delete s.schema._prefault,e.seen.get(t).schema}function B_(t,e){let r=t.seen.get(e);if(!r)throw new Error("Unprocessed schema. This is a bug in Zod.");let n=i=>{let s=t.target==="draft-2020-12"?"$defs":"definitions";if(t.external){let u=t.external.registry.get(i[0])?.id,d=t.external.uri??(f=>f);if(u)return{ref:d(u)};let p=i[1].defId??i[1].schema.id??`schema${t.counter++}`;return i[1].defId=p,{defId:p,ref:`${d("__shared")}#/${s}/${p}`}}if(i[1]===r)return{ref:"#"};let c=`#/${s}/`,l=i[1].schema.id??`__schema${t.counter++}`;return{defId:l,ref:c+l}},o=i=>{if(i[1].schema.$ref)return;let s=i[1],{ref:a,defId:c}=n(i);s.def={...s.schema},c&&(s.defId=c);let l=s.schema;for(let u in l)delete l[u];l.$ref=a};if(t.cycles==="throw")for(let i of t.seen.entries()){let s=i[1];if(s.cycle)throw new Error(`Cycle detected: #/${s.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let i of t.seen.entries()){let s=i[1];if(e===i[0]){o(i);continue}if(t.external){let c=t.external.registry.get(i[0])?.id;if(e!==i[0]&&c){o(i);continue}}if(t.metadataRegistry.get(i[0])?.id){o(i);continue}if(s.cycle){o(i);continue}if(s.count>1&&t.reused==="ref"){o(i);continue}}}function U_(t,e){let r=t.seen.get(e);if(!r)throw new Error("Unprocessed schema. This is a bug in Zod.");let n=s=>{let a=t.seen.get(s),c=a.def??a.schema,l={...c};if(a.ref===null)return;let u=a.ref;if(a.ref=null,u){n(u);let d=t.seen.get(u).schema;d.$ref&&(t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0")?(c.allOf=c.allOf??[],c.allOf.push(d)):(Object.assign(c,d),Object.assign(c,l))}a.isParent||t.override({zodSchema:s,jsonSchema:c,path:a.path??[]})};for(let s of[...t.seen.entries()].reverse())n(s[0]);let o={};if(t.target==="draft-2020-12"?o.$schema="https://json-schema.org/draft/2020-12/schema":t.target==="draft-07"?o.$schema="http://json-schema.org/draft-07/schema#":t.target==="draft-04"?o.$schema="http://json-schema.org/draft-04/schema#":t.target,t.external?.uri){let s=t.external.registry.get(e)?.id;if(!s)throw new Error("Schema is missing an `id` property");o.$id=t.external.uri(s)}Object.assign(o,r.def??r.schema);let i=t.external?.defs??{};for(let s of t.seen.entries()){let a=s[1];a.def&&a.defId&&(i[a.defId]=a.def)}t.external||Object.keys(i).length>0&&(t.target==="draft-2020-12"?o.$defs=i:o.definitions=i);try{let s=JSON.parse(JSON.stringify(o));return Object.defineProperty(s,"~standard",{value:{...e["~standard"],jsonSchema:{input:Jf(e,"input"),output:Jf(e,"output")}},enumerable:!1,writable:!1}),s}catch{throw new Error("Error converting schema to JSON.")}}function rn(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let n=t._zod.def;if(n.type==="transform")return!0;if(n.type==="array")return rn(n.element,r);if(n.type==="set")return rn(n.valueType,r);if(n.type==="lazy")return rn(n.getter(),r);if(n.type==="promise"||n.type==="optional"||n.type==="nonoptional"||n.type==="nullable"||n.type==="readonly"||n.type==="default"||n.type==="prefault")return rn(n.innerType,r);if(n.type==="intersection")return rn(n.left,r)||rn(n.right,r);if(n.type==="record"||n.type==="map")return rn(n.keyType,r)||rn(n.valueType,r);if(n.type==="pipe")return rn(n.in,r)||rn(n.out,r);if(n.type==="object"){for(let o in n.shape)if(rn(n.shape[o],r))return!0;return!1}if(n.type==="union"){for(let o of n.options)if(rn(o,r))return!0;return!1}if(n.type==="tuple"){for(let o of n.items)if(rn(o,r))return!0;return!!(n.rest&&rn(n.rest,r))}return!1}var Sq=(t,e={})=>r=>{let n=D_({...r,processors:e});return Et(t,n),B_(n,t),U_(n,t)},Jf=(t,e)=>r=>{let{libraryOptions:n,target:o}=r??{},i=D_({...n??{},target:o,io:e,processors:{}});return Et(t,i),B_(i,t),U_(i,t)};var XW={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},kq=(t,e,r,n)=>{let o=r;o.type="string";let{minimum:i,maximum:s,format:a,patterns:c,contentEncoding:l}=t._zod.bag;if(typeof i=="number"&&(o.minLength=i),typeof s=="number"&&(o.maxLength=s),a&&(o.format=XW[a]??a,o.format===""&&delete o.format),l&&(o.contentEncoding=l),c&&c.size>0){let u=[...c];u.length===1?o.pattern=u[0].source:u.length>1&&(o.allOf=[...u.map(d=>({...e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0"?{type:"string"}:{},pattern:d.source}))])}},$q=(t,e,r,n)=>{let o=r,{minimum:i,maximum:s,format:a,multipleOf:c,exclusiveMaximum:l,exclusiveMinimum:u}=t._zod.bag;typeof a=="string"&&a.includes("int")?o.type="integer":o.type="number",typeof u=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(o.minimum=u,o.exclusiveMinimum=!0):o.exclusiveMinimum=u),typeof i=="number"&&(o.minimum=i,typeof u=="number"&&e.target!=="draft-04"&&(u>=i?delete o.minimum:delete o.exclusiveMinimum)),typeof l=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(o.maximum=l,o.exclusiveMaximum=!0):o.exclusiveMaximum=l),typeof s=="number"&&(o.maximum=s,typeof l=="number"&&e.target!=="draft-04"&&(l<=s?delete o.maximum:delete o.exclusiveMaximum)),typeof c=="number"&&(o.multipleOf=c)},Aq=(t,e,r,n)=>{r.type="boolean"},Pq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema")},Cq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema")},Iq=(t,e,r,n)=>{e.target==="openapi-3.0"?(r.type="string",r.nullable=!0,r.enum=[null]):r.type="null"},Tq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema")},Eq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema")},Oq=(t,e,r,n)=>{r.not={}},jq=(t,e,r,n)=>{},Nq=(t,e,r,n)=>{},zq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema")},Rq=(t,e,r,n)=>{let o=t._zod.def,i=yf(o.entries);i.every(s=>typeof s=="number")&&(r.type="number"),i.every(s=>typeof s=="string")&&(r.type="string"),r.enum=i},Mq=(t,e,r,n)=>{let o=t._zod.def,i=[];for(let s of o.values)if(s===void 0){if(e.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof s=="bigint"){if(e.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");i.push(Number(s))}else i.push(s);if(i.length!==0)if(i.length===1){let s=i[0];r.type=s===null?"null":typeof s,e.target==="draft-04"||e.target==="openapi-3.0"?r.enum=[s]:r.const=s}else i.every(s=>typeof s=="number")&&(r.type="number"),i.every(s=>typeof s=="string")&&(r.type="string"),i.every(s=>typeof s=="boolean")&&(r.type="boolean"),i.every(s=>s===null)&&(r.type="null"),r.enum=i},qq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema")},Dq=(t,e,r,n)=>{let o=r,i=t._zod.pattern;if(!i)throw new Error("Pattern not found in template literal");o.type="string",o.pattern=i.source},Bq=(t,e,r,n)=>{let o=r,i={type:"string",format:"binary",contentEncoding:"binary"},{minimum:s,maximum:a,mime:c}=t._zod.bag;s!==void 0&&(i.minLength=s),a!==void 0&&(i.maxLength=a),c?c.length===1?(i.contentMediaType=c[0],Object.assign(o,i)):o.anyOf=c.map(l=>({...i,contentMediaType:l})):Object.assign(o,i)},Uq=(t,e,r,n)=>{r.type="boolean"},Lq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},Fq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},Vq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Zq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},Hq=(t,e,r,n)=>{if(e.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema")},Gq=(t,e,r,n)=>{let o=r,i=t._zod.def,{minimum:s,maximum:a}=t._zod.bag;typeof s=="number"&&(o.minItems=s),typeof a=="number"&&(o.maxItems=a),o.type="array",o.items=Et(i.element,e,{...n,path:[...n.path,"items"]})},Wq=(t,e,r,n)=>{let o=r,i=t._zod.def;o.type="object",o.properties={};let s=i.shape;for(let l in s)o.properties[l]=Et(s[l],e,{...n,path:[...n.path,"properties",l]});let a=new Set(Object.keys(s)),c=new Set([...a].filter(l=>{let u=i.shape[l]._zod;return e.io==="input"?u.optin===void 0:u.optout===void 0}));c.size>0&&(o.required=Array.from(c)),i.catchall?._zod.def.type==="never"?o.additionalProperties=!1:i.catchall?i.catchall&&(o.additionalProperties=Et(i.catchall,e,{...n,path:[...n.path,"additionalProperties"]})):e.io==="output"&&(o.additionalProperties=!1)},jP=(t,e,r,n)=>{let o=t._zod.def,i=o.inclusive===!1,s=o.options.map((a,c)=>Et(a,e,{...n,path:[...n.path,i?"oneOf":"anyOf",c]}));i?r.oneOf=s:r.anyOf=s},Kq=(t,e,r,n)=>{let o=t._zod.def,i=Et(o.left,e,{...n,path:[...n.path,"allOf",0]}),s=Et(o.right,e,{...n,path:[...n.path,"allOf",1]}),a=l=>"allOf"in l&&Object.keys(l).length===1,c=[...a(i)?i.allOf:[i],...a(s)?s.allOf:[s]];r.allOf=c},Jq=(t,e,r,n)=>{let o=r,i=t._zod.def;o.type="array";let s=e.target==="draft-2020-12"?"prefixItems":"items",a=e.target==="draft-2020-12"||e.target==="openapi-3.0"?"items":"additionalItems",c=i.items.map((p,f)=>Et(p,e,{...n,path:[...n.path,s,f]})),l=i.rest?Et(i.rest,e,{...n,path:[...n.path,a,...e.target==="openapi-3.0"?[i.items.length]:[]]}):null;e.target==="draft-2020-12"?(o.prefixItems=c,l&&(o.items=l)):e.target==="openapi-3.0"?(o.items={anyOf:c},l&&o.items.anyOf.push(l),o.minItems=c.length,l||(o.maxItems=c.length)):(o.items=c,l&&(o.additionalItems=l));let{minimum:u,maximum:d}=t._zod.bag;typeof u=="number"&&(o.minItems=u),typeof d=="number"&&(o.maxItems=d)},Yq=(t,e,r,n)=>{let o=r,i=t._zod.def;o.type="object",(e.target==="draft-07"||e.target==="draft-2020-12")&&(o.propertyNames=Et(i.keyType,e,{...n,path:[...n.path,"propertyNames"]})),o.additionalProperties=Et(i.valueType,e,{...n,path:[...n.path,"additionalProperties"]})},Xq=(t,e,r,n)=>{let o=t._zod.def,i=Et(o.innerType,e,n),s=e.seen.get(t);e.target==="openapi-3.0"?(s.ref=o.innerType,r.nullable=!0):r.anyOf=[i,{type:"null"}]},Qq=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType},eD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType,r.default=JSON.parse(JSON.stringify(o.defaultValue))},tD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType,e.io==="input"&&(r._prefault=JSON.parse(JSON.stringify(o.defaultValue)))},rD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType;let s;try{s=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}r.default=s},nD=(t,e,r,n)=>{let o=t._zod.def,i=e.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;Et(i,e,n);let s=e.seen.get(t);s.ref=i},oD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType,r.readOnly=!0},iD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType},sD=(t,e,r,n)=>{let o=t._zod.def;Et(o.innerType,e,n);let i=e.seen.get(t);i.ref=o.innerType},aD=(t,e,r,n)=>{let o=t._zod.innerType;Et(o,e,n);let i=e.seen.get(t);i.ref=o};function _u(t){return!!t._zod}function To(t,e){return _u(t)?mu(t,e):t.safeParse(e)}function L_(t){if(!t)return;let e;if(_u(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function dD(t){if(_u(t)){let i=t._zod?.def;if(i){if(i.value!==void 0)return i.value;if(Array.isArray(i.values)&&i.values.length>0)return i.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var Yf={};Ui(Yf,{ZodAny:()=>ID,ZodArray:()=>jD,ZodBase64:()=>o1,ZodBase64URL:()=>i1,ZodBigInt:()=>nm,ZodBigIntFormat:()=>c1,ZodBoolean:()=>rm,ZodCIDRv4:()=>r1,ZodCIDRv6:()=>n1,ZodCUID:()=>KP,ZodCUID2:()=>JP,ZodCatch:()=>YD,ZodCodec:()=>h1,ZodCustom:()=>Q_,ZodCustomStringFormat:()=>em,ZodDate:()=>W_,ZodDefault:()=>ZD,ZodDiscriminatedUnion:()=>zD,ZodE164:()=>s1,ZodEmail:()=>ZP,ZodEmoji:()=>GP,ZodEnum:()=>Xf,ZodFile:()=>LD,ZodFunction:()=>s4,ZodGUID:()=>V_,ZodIPv4:()=>e1,ZodIPv6:()=>t1,ZodIntersection:()=>RD,ZodJWT:()=>a1,ZodKSUID:()=>QP,ZodLazy:()=>n4,ZodLiteral:()=>UD,ZodMAC:()=>$D,ZodMap:()=>DD,ZodNaN:()=>QD,ZodNanoID:()=>WP,ZodNever:()=>ED,ZodNonOptional:()=>f1,ZodNull:()=>CD,ZodNullable:()=>VD,ZodNumber:()=>tm,ZodNumberFormat:()=>bu,ZodObject:()=>K_,ZodOptional:()=>p1,ZodPipe:()=>m1,ZodPrefault:()=>GD,ZodPromise:()=>i4,ZodReadonly:()=>e4,ZodRecord:()=>X_,ZodSet:()=>BD,ZodString:()=>Qf,ZodStringFormat:()=>vt,ZodSuccess:()=>JD,ZodSymbol:()=>AD,ZodTemplateLiteral:()=>r4,ZodTransform:()=>FD,ZodTuple:()=>MD,ZodType:()=>Ce,ZodULID:()=>YP,ZodURL:()=>G_,ZodUUID:()=>Wi,ZodUndefined:()=>PD,ZodUnion:()=>J_,ZodUnknown:()=>TD,ZodVoid:()=>OD,ZodXID:()=>XP,ZodXor:()=>ND,_ZodString:()=>VP,_default:()=>HD,_function:()=>lJ,any:()=>l1,array:()=>L,base64:()=>IK,base64url:()=>TK,bigint:()=>UK,boolean:()=>lt,catch:()=>XD,check:()=>uJ,cidrv4:()=>PK,cidrv6:()=>CK,codec:()=>sJ,cuid:()=>_K,cuid2:()=>bK,custom:()=>g1,date:()=>GK,describe:()=>dJ,discriminatedUnion:()=>Y_,e164:()=>EK,email:()=>uK,emoji:()=>yK,enum:()=>Br,file:()=>rJ,float32:()=>MK,float64:()=>qK,function:()=>lJ,guid:()=>dK,hash:()=>RK,hex:()=>zK,hostname:()=>NK,httpUrl:()=>gK,instanceof:()=>fJ,int:()=>FP,int32:()=>DK,int64:()=>LK,intersection:()=>im,ipv4:()=>kK,ipv6:()=>AK,json:()=>hJ,jwt:()=>OK,keyof:()=>WK,ksuid:()=>SK,lazy:()=>o4,literal:()=>re,looseObject:()=>cr,looseRecord:()=>XK,mac:()=>$K,map:()=>QK,meta:()=>pJ,nan:()=>iJ,nanoid:()=>vK,nativeEnum:()=>tJ,never:()=>u1,nonoptional:()=>KD,null:()=>om,nullable:()=>Z_,nullish:()=>nJ,number:()=>We,object:()=>V,optional:()=>Ot,partialRecord:()=>YK,pipe:()=>H_,prefault:()=>WD,preprocess:()=>eb,promise:()=>cJ,readonly:()=>t4,record:()=>Pt,refine:()=>a4,set:()=>eJ,strictObject:()=>KK,string:()=>_,stringFormat:()=>jK,stringbool:()=>mJ,success:()=>oJ,superRefine:()=>c4,symbol:()=>VK,templateLiteral:()=>aJ,transform:()=>d1,tuple:()=>qD,uint32:()=>BK,uint64:()=>FK,ulid:()=>wK,undefined:()=>ZK,union:()=>ft,unknown:()=>_t,url:()=>HP,uuid:()=>pK,uuidv4:()=>fK,uuidv6:()=>mK,uuidv7:()=>hK,void:()=>HK,xid:()=>xK,xor:()=>JK});var F_={};Ui(F_,{endsWith:()=>Vf,gt:()=>Gi,gte:()=>tn,includes:()=>Lf,length:()=>yu,lowercase:()=>Bf,lt:()=>Hi,lte:()=>Un,maxLength:()=>gu,maxSize:()=>hu,mime:()=>Zf,minLength:()=>Ls,minSize:()=>Va,multipleOf:()=>Fa,negative:()=>xP,nonnegative:()=>kP,nonpositive:()=>SP,normalize:()=>Hf,overwrite:()=>li,positive:()=>wP,property:()=>$P,regex:()=>Df,size:()=>qf,slugify:()=>q_,startsWith:()=>Ff,toLowerCase:()=>Wf,toUpperCase:()=>Kf,trim:()=>Gf,uppercase:()=>Uf});var Za={};Ui(Za,{ZodISODate:()=>MP,ZodISODateTime:()=>zP,ZodISODuration:()=>UP,ZodISOTime:()=>DP,date:()=>qP,datetime:()=>RP,duration:()=>LP,time:()=>BP});var zP=x("ZodISODateTime",(t,e)=>{Z$.init(t,e),vt.init(t,e)});function RP(t){return WA(zP,t)}var MP=x("ZodISODate",(t,e)=>{H$.init(t,e),vt.init(t,e)});function qP(t){return KA(MP,t)}var DP=x("ZodISOTime",(t,e)=>{G$.init(t,e),vt.init(t,e)});function BP(t){return JA(DP,t)}var UP=x("ZodISODuration",(t,e)=>{W$.init(t,e),vt.init(t,e)});function LP(t){return YA(UP,t)}var pD=(t,e)=>{i_.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>a_(t,r)},flatten:{value:r=>s_(t,r)},addIssue:{value:r=>{t.issues.push(r),t.message=JSON.stringify(t.issues,du,2)}},addIssues:{value:r=>{t.issues.push(...r),t.message=JSON.stringify(t.issues,du,2)}},isEmpty:{get(){return t.issues.length===0}}})},Tbe=x("ZodError",pD),Ln=x("ZodError",pD,{Parent:Error});var fD=Sf(Ln),mD=$f(Ln),hD=Pf(Ln),gD=Cf(Ln),yD=AM(Ln),vD=PM(Ln),_D=CM(Ln),bD=IM(Ln),wD=TM(Ln),xD=EM(Ln),SD=OM(Ln),kD=jM(Ln);var Ce=x("ZodType",(t,e)=>(we.init(t,e),Object.assign(t["~standard"],{jsonSchema:{input:Jf(t,"input"),output:Jf(t,"output")}}),t.toJSONSchema=Sq(t,{}),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone(D.mergeDefs(e,{checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),t.clone=(r,n)=>en(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>fD(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>hD(t,r,n),t.parseAsync=async(r,n)=>mD(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>gD(t,r,n),t.spa=t.safeParseAsync,t.encode=(r,n)=>yD(t,r,n),t.decode=(r,n)=>vD(t,r,n),t.encodeAsync=async(r,n)=>_D(t,r,n),t.decodeAsync=async(r,n)=>bD(t,r,n),t.safeEncode=(r,n)=>wD(t,r,n),t.safeDecode=(r,n)=>xD(t,r,n),t.safeEncodeAsync=async(r,n)=>SD(t,r,n),t.safeDecodeAsync=async(r,n)=>kD(t,r,n),t.refine=(r,n)=>t.check(a4(r,n)),t.superRefine=r=>t.check(c4(r)),t.overwrite=r=>t.check(li(r)),t.optional=()=>Ot(t),t.nullable=()=>Z_(t),t.nullish=()=>Ot(Z_(t)),t.nonoptional=r=>KD(t,r),t.array=()=>L(t),t.or=r=>ft([t,r]),t.and=r=>im(t,r),t.transform=r=>H_(t,d1(r)),t.default=r=>HD(t,r),t.prefault=r=>WD(t,r),t.catch=r=>XD(t,r),t.pipe=r=>H_(t,r),t.readonly=()=>t4(t),t.describe=r=>{let n=t.clone();return fn.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return fn.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return fn.get(t);let n=t.clone();return fn.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),VP=x("_ZodString",(t,e)=>{La.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(n,o,i)=>kq(t,n,o,i);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(Df(...n)),t.includes=(...n)=>t.check(Lf(...n)),t.startsWith=(...n)=>t.check(Ff(...n)),t.endsWith=(...n)=>t.check(Vf(...n)),t.min=(...n)=>t.check(Ls(...n)),t.max=(...n)=>t.check(gu(...n)),t.length=(...n)=>t.check(yu(...n)),t.nonempty=(...n)=>t.check(Ls(1,...n)),t.lowercase=n=>t.check(Bf(n)),t.uppercase=n=>t.check(Uf(n)),t.trim=()=>t.check(Gf()),t.normalize=(...n)=>t.check(Hf(...n)),t.toLowerCase=()=>t.check(Wf()),t.toUpperCase=()=>t.check(Kf()),t.slugify=()=>t.check(q_())}),Qf=x("ZodString",(t,e)=>{La.init(t,e),VP.init(t,e),t.email=r=>t.check(v_(ZP,r)),t.url=r=>t.check(Mf(G_,r)),t.jwt=r=>t.check(M_(a1,r)),t.emoji=r=>t.check(S_(GP,r)),t.guid=r=>t.check(Rf(V_,r)),t.uuid=r=>t.check(__(Wi,r)),t.uuidv4=r=>t.check(b_(Wi,r)),t.uuidv6=r=>t.check(w_(Wi,r)),t.uuidv7=r=>t.check(x_(Wi,r)),t.nanoid=r=>t.check(k_(WP,r)),t.guid=r=>t.check(Rf(V_,r)),t.cuid=r=>t.check($_(KP,r)),t.cuid2=r=>t.check(A_(JP,r)),t.ulid=r=>t.check(P_(YP,r)),t.base64=r=>t.check(N_(o1,r)),t.base64url=r=>t.check(z_(i1,r)),t.xid=r=>t.check(C_(XP,r)),t.ksuid=r=>t.check(I_(QP,r)),t.ipv4=r=>t.check(T_(e1,r)),t.ipv6=r=>t.check(E_(t1,r)),t.cidrv4=r=>t.check(O_(r1,r)),t.cidrv6=r=>t.check(j_(n1,r)),t.e164=r=>t.check(R_(s1,r)),t.datetime=r=>t.check(RP(r)),t.date=r=>t.check(qP(r)),t.time=r=>t.check(BP(r)),t.duration=r=>t.check(LP(r))});function _(t){return ZA(Qf,t)}var vt=x("ZodStringFormat",(t,e)=>{pt.init(t,e),VP.init(t,e)}),ZP=x("ZodEmail",(t,e)=>{R$.init(t,e),vt.init(t,e)});function uK(t){return v_(ZP,t)}var V_=x("ZodGUID",(t,e)=>{N$.init(t,e),vt.init(t,e)});function dK(t){return Rf(V_,t)}var Wi=x("ZodUUID",(t,e)=>{z$.init(t,e),vt.init(t,e)});function pK(t){return __(Wi,t)}function fK(t){return b_(Wi,t)}function mK(t){return w_(Wi,t)}function hK(t){return x_(Wi,t)}var G_=x("ZodURL",(t,e)=>{M$.init(t,e),vt.init(t,e)});function HP(t){return Mf(G_,t)}function gK(t){return Mf(G_,{protocol:/^https?$/,hostname:eo.domain,...D.normalizeParams(t)})}var GP=x("ZodEmoji",(t,e)=>{q$.init(t,e),vt.init(t,e)});function yK(t){return S_(GP,t)}var WP=x("ZodNanoID",(t,e)=>{D$.init(t,e),vt.init(t,e)});function vK(t){return k_(WP,t)}var KP=x("ZodCUID",(t,e)=>{B$.init(t,e),vt.init(t,e)});function _K(t){return $_(KP,t)}var JP=x("ZodCUID2",(t,e)=>{U$.init(t,e),vt.init(t,e)});function bK(t){return A_(JP,t)}var YP=x("ZodULID",(t,e)=>{L$.init(t,e),vt.init(t,e)});function wK(t){return P_(YP,t)}var XP=x("ZodXID",(t,e)=>{F$.init(t,e),vt.init(t,e)});function xK(t){return C_(XP,t)}var QP=x("ZodKSUID",(t,e)=>{V$.init(t,e),vt.init(t,e)});function SK(t){return I_(QP,t)}var e1=x("ZodIPv4",(t,e)=>{K$.init(t,e),vt.init(t,e)});function kK(t){return T_(e1,t)}var $D=x("ZodMAC",(t,e)=>{Y$.init(t,e),vt.init(t,e)});function $K(t){return GA($D,t)}var t1=x("ZodIPv6",(t,e)=>{J$.init(t,e),vt.init(t,e)});function AK(t){return E_(t1,t)}var r1=x("ZodCIDRv4",(t,e)=>{X$.init(t,e),vt.init(t,e)});function PK(t){return O_(r1,t)}var n1=x("ZodCIDRv6",(t,e)=>{Q$.init(t,e),vt.init(t,e)});function CK(t){return j_(n1,t)}var o1=x("ZodBase64",(t,e)=>{eA.init(t,e),vt.init(t,e)});function IK(t){return N_(o1,t)}var i1=x("ZodBase64URL",(t,e)=>{tA.init(t,e),vt.init(t,e)});function TK(t){return z_(i1,t)}var s1=x("ZodE164",(t,e)=>{rA.init(t,e),vt.init(t,e)});function EK(t){return R_(s1,t)}var a1=x("ZodJWT",(t,e)=>{nA.init(t,e),vt.init(t,e)});function OK(t){return M_(a1,t)}var em=x("ZodCustomStringFormat",(t,e)=>{oA.init(t,e),vt.init(t,e)});function jK(t,e,r={}){return vu(em,t,e,r)}function NK(t){return vu(em,"hostname",eo.hostname,t)}function zK(t){return vu(em,"hex",eo.hex,t)}function RK(t,e){let r=e?.enc??"hex",n=`${t}_${r}`,o=eo[n];if(!o)throw new Error(`Unrecognized hash format: ${n}`);return vu(em,n,o,e)}var tm=x("ZodNumber",(t,e)=>{h_.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(n,o,i)=>$q(t,n,o,i),t.gt=(n,o)=>t.check(Gi(n,o)),t.gte=(n,o)=>t.check(tn(n,o)),t.min=(n,o)=>t.check(tn(n,o)),t.lt=(n,o)=>t.check(Hi(n,o)),t.lte=(n,o)=>t.check(Un(n,o)),t.max=(n,o)=>t.check(Un(n,o)),t.int=n=>t.check(FP(n)),t.safe=n=>t.check(FP(n)),t.positive=n=>t.check(Gi(0,n)),t.nonnegative=n=>t.check(tn(0,n)),t.negative=n=>t.check(Hi(0,n)),t.nonpositive=n=>t.check(Un(0,n)),t.multipleOf=(n,o)=>t.check(Fa(n,o)),t.step=(n,o)=>t.check(Fa(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function We(t){return XA(tm,t)}var bu=x("ZodNumberFormat",(t,e)=>{iA.init(t,e),tm.init(t,e)});function FP(t){return eP(bu,t)}function MK(t){return tP(bu,t)}function qK(t){return rP(bu,t)}function DK(t){return nP(bu,t)}function BK(t){return oP(bu,t)}var rm=x("ZodBoolean",(t,e)=>{jf.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Aq(t,r,n,o)});function lt(t){return iP(rm,t)}var nm=x("ZodBigInt",(t,e)=>{g_.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(n,o,i)=>Pq(t,n,o,i),t.gte=(n,o)=>t.check(tn(n,o)),t.min=(n,o)=>t.check(tn(n,o)),t.gt=(n,o)=>t.check(Gi(n,o)),t.gte=(n,o)=>t.check(tn(n,o)),t.min=(n,o)=>t.check(tn(n,o)),t.lt=(n,o)=>t.check(Hi(n,o)),t.lte=(n,o)=>t.check(Un(n,o)),t.max=(n,o)=>t.check(Un(n,o)),t.positive=n=>t.check(Gi(BigInt(0),n)),t.negative=n=>t.check(Hi(BigInt(0),n)),t.nonpositive=n=>t.check(Un(BigInt(0),n)),t.nonnegative=n=>t.check(tn(BigInt(0),n)),t.multipleOf=(n,o)=>t.check(Fa(n,o));let r=t._zod.bag;t.minValue=r.minimum??null,t.maxValue=r.maximum??null,t.format=r.format??null});function UK(t){return aP(nm,t)}var c1=x("ZodBigIntFormat",(t,e)=>{sA.init(t,e),nm.init(t,e)});function LK(t){return lP(c1,t)}function FK(t){return uP(c1,t)}var AD=x("ZodSymbol",(t,e)=>{aA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Cq(t,r,n,o)});function VK(t){return dP(AD,t)}var PD=x("ZodUndefined",(t,e)=>{cA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Tq(t,r,n,o)});function ZK(t){return pP(PD,t)}var CD=x("ZodNull",(t,e)=>{lA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Iq(t,r,n,o)});function om(t){return fP(CD,t)}var ID=x("ZodAny",(t,e)=>{uA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>jq(t,r,n,o)});function l1(){return mP(ID)}var TD=x("ZodUnknown",(t,e)=>{dA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Nq(t,r,n,o)});function _t(){return hP(TD)}var ED=x("ZodNever",(t,e)=>{pA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Oq(t,r,n,o)});function u1(t){return gP(ED,t)}var OD=x("ZodVoid",(t,e)=>{fA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Eq(t,r,n,o)});function HK(t){return yP(OD,t)}var W_=x("ZodDate",(t,e)=>{mA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(n,o,i)=>zq(t,n,o,i),t.min=(n,o)=>t.check(tn(n,o)),t.max=(n,o)=>t.check(Un(n,o));let r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function GK(t){return vP(W_,t)}var jD=x("ZodArray",(t,e)=>{hA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Gq(t,r,n,o),t.element=e.element,t.min=(r,n)=>t.check(Ls(r,n)),t.nonempty=r=>t.check(Ls(1,r)),t.max=(r,n)=>t.check(gu(r,n)),t.length=(r,n)=>t.check(yu(r,n)),t.unwrap=()=>t.element});function L(t,e){return xq(jD,t,e)}function WK(t){let e=t._zod.def.shape;return Br(Object.keys(e))}var K_=x("ZodObject",(t,e)=>{bq.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Wq(t,r,n,o),D.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Br(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:_t()}),t.loose=()=>t.clone({...t._zod.def,catchall:_t()}),t.strict=()=>t.clone({...t._zod.def,catchall:u1()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>D.extend(t,r),t.safeExtend=r=>D.safeExtend(t,r),t.merge=r=>D.merge(t,r),t.pick=r=>D.pick(t,r),t.omit=r=>D.omit(t,r),t.partial=(...r)=>D.partial(p1,t,r[0]),t.required=(...r)=>D.required(f1,t,r[0])});function V(t,e){let r={type:"object",shape:t??{},...D.normalizeParams(e)};return new K_(r)}function KK(t,e){return new K_({type:"object",shape:t,catchall:u1(),...D.normalizeParams(e)})}function cr(t,e){return new K_({type:"object",shape:t,catchall:_t(),...D.normalizeParams(e)})}var J_=x("ZodUnion",(t,e)=>{Nf.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>jP(t,r,n,o),t.options=e.options});function ft(t,e){return new J_({type:"union",options:t,...D.normalizeParams(e)})}var ND=x("ZodXor",(t,e)=>{J_.init(t,e),gA.init(t,e),t._zod.processJSONSchema=(r,n,o)=>jP(t,r,n,o),t.options=e.options});function JK(t,e){return new ND({type:"union",options:t,inclusive:!1,...D.normalizeParams(e)})}var zD=x("ZodDiscriminatedUnion",(t,e)=>{J_.init(t,e),yA.init(t,e)});function Y_(t,e,r){return new zD({type:"union",options:e,discriminator:t,...D.normalizeParams(r)})}var RD=x("ZodIntersection",(t,e)=>{vA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Kq(t,r,n,o)});function im(t,e){return new RD({type:"intersection",left:t,right:e})}var MD=x("ZodTuple",(t,e)=>{y_.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Jq(t,r,n,o),t.rest=r=>t.clone({...t._zod.def,rest:r})});function qD(t,e,r){let n=e instanceof we,o=n?r:e,i=n?e:null;return new MD({type:"tuple",items:t,rest:i,...D.normalizeParams(o)})}var X_=x("ZodRecord",(t,e)=>{_A.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Yq(t,r,n,o),t.keyType=e.keyType,t.valueType=e.valueType});function Pt(t,e,r){return new X_({type:"record",keyType:t,valueType:e,...D.normalizeParams(r)})}function YK(t,e,r){let n=en(t);return n._zod.values=void 0,new X_({type:"record",keyType:n,valueType:e,...D.normalizeParams(r)})}function XK(t,e,r){return new X_({type:"record",keyType:t,valueType:e,mode:"loose",...D.normalizeParams(r)})}var DD=x("ZodMap",(t,e)=>{bA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Zq(t,r,n,o),t.keyType=e.keyType,t.valueType=e.valueType});function QK(t,e,r){return new DD({type:"map",keyType:t,valueType:e,...D.normalizeParams(r)})}var BD=x("ZodSet",(t,e)=>{wA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Hq(t,r,n,o),t.min=(...r)=>t.check(Va(...r)),t.nonempty=r=>t.check(Va(1,r)),t.max=(...r)=>t.check(hu(...r)),t.size=(...r)=>t.check(qf(...r))});function eJ(t,e){return new BD({type:"set",valueType:t,...D.normalizeParams(e)})}var Xf=x("ZodEnum",(t,e)=>{xA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(n,o,i)=>Rq(t,n,o,i),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let i={};for(let s of n)if(r.has(s))i[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new Xf({...e,checks:[],...D.normalizeParams(o),entries:i})},t.exclude=(n,o)=>{let i={...e.entries};for(let s of n)if(r.has(s))delete i[s];else throw new Error(`Key ${s} not found in enum`);return new Xf({...e,checks:[],...D.normalizeParams(o),entries:i})}});function Br(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new Xf({type:"enum",entries:r,...D.normalizeParams(e)})}function tJ(t,e){return new Xf({type:"enum",entries:t,...D.normalizeParams(e)})}var UD=x("ZodLiteral",(t,e)=>{SA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Mq(t,r,n,o),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function re(t,e){return new UD({type:"literal",values:Array.isArray(t)?t:[t],...D.normalizeParams(e)})}var LD=x("ZodFile",(t,e)=>{kA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Bq(t,r,n,o),t.min=(r,n)=>t.check(Va(r,n)),t.max=(r,n)=>t.check(hu(r,n)),t.mime=(r,n)=>t.check(Zf(Array.isArray(r)?r:[r],n))});function rJ(t){return AP(LD,t)}var FD=x("ZodTransform",(t,e)=>{$A.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Vq(t,r,n,o),t._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Da(t.constructor.name);r.addIssue=i=>{if(typeof i=="string")r.issues.push(D.issue(i,r.value,e));else{let s=i;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),r.issues.push(D.issue(s))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(i=>(r.value=i,r)):(r.value=o,r)}});function d1(t){return new FD({type:"transform",transform:t})}var p1=x("ZodOptional",(t,e)=>{AA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>sD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function Ot(t){return new p1({type:"optional",innerType:t})}var VD=x("ZodNullable",(t,e)=>{PA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Xq(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function Z_(t){return new VD({type:"nullable",innerType:t})}function nJ(t){return Ot(Z_(t))}var ZD=x("ZodDefault",(t,e)=>{CA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>eD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function HD(t,e){return new ZD({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():D.shallowClone(e)}})}var GD=x("ZodPrefault",(t,e)=>{IA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>tD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function WD(t,e){return new GD({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():D.shallowClone(e)}})}var f1=x("ZodNonOptional",(t,e)=>{TA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Qq(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function KD(t,e){return new f1({type:"nonoptional",innerType:t,...D.normalizeParams(e)})}var JD=x("ZodSuccess",(t,e)=>{EA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Uq(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function oJ(t){return new JD({type:"success",innerType:t})}var YD=x("ZodCatch",(t,e)=>{OA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>rD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function XD(t,e){return new YD({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var QD=x("ZodNaN",(t,e)=>{jA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>qq(t,r,n,o)});function iJ(t){return bP(QD,t)}var m1=x("ZodPipe",(t,e)=>{NA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>nD(t,r,n,o),t.in=e.in,t.out=e.out});function H_(t,e){return new m1({type:"pipe",in:t,out:e})}var h1=x("ZodCodec",(t,e)=>{m1.init(t,e),zf.init(t,e)});function sJ(t,e,r){return new h1({type:"pipe",in:t,out:e,transform:r.decode,reverseTransform:r.encode})}var e4=x("ZodReadonly",(t,e)=>{zA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>oD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function t4(t){return new e4({type:"readonly",innerType:t})}var r4=x("ZodTemplateLiteral",(t,e)=>{RA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Dq(t,r,n,o)});function aJ(t,e){return new r4({type:"template_literal",parts:t,...D.normalizeParams(e)})}var n4=x("ZodLazy",(t,e)=>{DA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>aD(t,r,n,o),t.unwrap=()=>t._zod.def.getter()});function o4(t){return new n4({type:"lazy",getter:t})}var i4=x("ZodPromise",(t,e)=>{qA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>iD(t,r,n,o),t.unwrap=()=>t._zod.def.innerType});function cJ(t){return new i4({type:"promise",innerType:t})}var s4=x("ZodFunction",(t,e)=>{MA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Fq(t,r,n,o)});function lJ(t){return new s4({type:"function",input:Array.isArray(t?.input)?qD(t?.input):t?.input??L(_t()),output:t?.output??_t()})}var Q_=x("ZodCustom",(t,e)=>{BA.init(t,e),Ce.init(t,e),t._zod.processJSONSchema=(r,n,o)=>Lq(t,r,n,o)});function uJ(t){let e=new yt({check:"custom"});return e._zod.check=t,e}function g1(t,e){return PP(Q_,t??(()=>!0),e)}function a4(t,e={}){return CP(Q_,t,e)}function c4(t){return IP(t)}var dJ=TP,pJ=EP;function fJ(t,e={error:`Input not instance of ${t.name}`}){let r=new Q_({type:"custom",check:"custom",fn:n=>n instanceof t,abort:!0,...D.normalizeParams(e)});return r._zod.bag.Class=t,r}var mJ=(...t)=>OP({Codec:h1,Boolean:rm,String:Qf},...t);function hJ(t){let e=o4(()=>ft([_(t),We(),lt(),om(),L(e),Pt(_(),e)]));return e}function eb(t,e){return H_(d1(t),e)}var u4={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};var l4;l4||(l4={});var Mbe={...Yf,...F_,iso:Za};var tb={};Ui(tb,{bigint:()=>_J,boolean:()=>vJ,date:()=>bJ,number:()=>yJ,string:()=>gJ});function gJ(t){return HA(Qf,t)}function yJ(t){return QA(tm,t)}function vJ(t){return sP(rm,t)}function _J(t){return cP(nm,t)}function bJ(t){return _P(W_,t)}fr(UA());var xu="2025-11-25";var p4=[xu,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Fs="io.modelcontextprotocol/related-task",nb="2.0",Ar=g1(t=>t!==null&&(typeof t=="object"||typeof t=="function")),f4=ft([_(),We().int()]),m4=_(),rwe=cr({ttl:ft([We(),om()]).optional(),pollInterval:We().optional()}),xJ=V({ttl:We().optional()}),SJ=V({taskId:_()}),v1=cr({progressToken:f4.optional(),[Fs]:SJ.optional()}),Fn=V({_meta:v1.optional()}),sm=Fn.extend({task:xJ.optional()}),h4=t=>sm.safeParse(t).success,Pr=V({method:_(),params:Fn.loose().optional()}),to=V({_meta:v1.optional()}),ro=V({method:_(),params:to.loose().optional()}),Cr=cr({_meta:v1.optional()}),ob=ft([_(),We().int()]),g4=V({jsonrpc:re(nb),id:ob,...Pr.shape}).strict(),_1=t=>g4.safeParse(t).success,y4=V({jsonrpc:re(nb),...ro.shape}).strict(),v4=t=>y4.safeParse(t).success,b1=V({jsonrpc:re(nb),id:ob,result:Cr}).strict(),am=t=>b1.safeParse(t).success;var ye;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(ye||(ye={}));var w1=V({jsonrpc:re(nb),id:ob.optional(),error:V({code:We().int(),message:_(),data:_t().optional()})}).strict();var _4=t=>w1.safeParse(t).success;var ib=ft([g4,y4,b1,w1]),nwe=ft([b1,w1]),Ha=Cr.strict(),kJ=to.extend({requestId:ob.optional(),reason:_().optional()}),sb=ro.extend({method:re("notifications/cancelled"),params:kJ}),$J=V({src:_(),mimeType:_().optional(),sizes:L(_()).optional(),theme:Br(["light","dark"]).optional()}),cm=V({icons:L($J).optional()}),wu=V({name:_(),title:_().optional()}),b4=wu.extend({...wu.shape,...cm.shape,version:_(),websiteUrl:_().optional(),description:_().optional()}),AJ=im(V({applyDefaults:lt().optional()}),Pt(_(),_t())),PJ=eb(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,im(V({form:AJ.optional(),url:Ar.optional()}),Pt(_(),_t()).optional())),CJ=cr({list:Ar.optional(),cancel:Ar.optional(),requests:cr({sampling:cr({createMessage:Ar.optional()}).optional(),elicitation:cr({create:Ar.optional()}).optional()}).optional()}),IJ=cr({list:Ar.optional(),cancel:Ar.optional(),requests:cr({tools:cr({call:Ar.optional()}).optional()}).optional()}),TJ=V({experimental:Pt(_(),Ar).optional(),sampling:V({context:Ar.optional(),tools:Ar.optional()}).optional(),elicitation:PJ.optional(),roots:V({listChanged:lt().optional()}).optional(),tasks:CJ.optional()}),EJ=Fn.extend({protocolVersion:_(),capabilities:TJ,clientInfo:b4}),OJ=Pr.extend({method:re("initialize"),params:EJ});var jJ=V({experimental:Pt(_(),Ar).optional(),logging:Ar.optional(),completions:Ar.optional(),prompts:V({listChanged:lt().optional()}).optional(),resources:V({subscribe:lt().optional(),listChanged:lt().optional()}).optional(),tools:V({listChanged:lt().optional()}).optional(),tasks:IJ.optional()}),x1=Cr.extend({protocolVersion:_(),capabilities:jJ,serverInfo:b4,instructions:_().optional()}),NJ=ro.extend({method:re("notifications/initialized"),params:to.optional()});var ab=Pr.extend({method:re("ping"),params:Fn.optional()}),zJ=V({progress:We(),total:Ot(We()),message:Ot(_())}),RJ=V({...to.shape,...zJ.shape,progressToken:f4}),cb=ro.extend({method:re("notifications/progress"),params:RJ}),MJ=Fn.extend({cursor:m4.optional()}),lm=Pr.extend({params:MJ.optional()}),um=Cr.extend({nextCursor:m4.optional()}),qJ=Br(["working","input_required","completed","failed","cancelled"]),dm=V({taskId:_(),status:qJ,ttl:ft([We(),om()]),createdAt:_(),lastUpdatedAt:_(),pollInterval:Ot(We()),statusMessage:Ot(_())}),Ga=Cr.extend({task:dm}),DJ=to.merge(dm),pm=ro.extend({method:re("notifications/tasks/status"),params:DJ}),lb=Pr.extend({method:re("tasks/get"),params:Fn.extend({taskId:_()})}),ub=Cr.merge(dm),db=Pr.extend({method:re("tasks/result"),params:Fn.extend({taskId:_()})}),owe=Cr.loose(),pb=lm.extend({method:re("tasks/list")}),fb=um.extend({tasks:L(dm)}),mb=Pr.extend({method:re("tasks/cancel"),params:Fn.extend({taskId:_()})}),w4=Cr.merge(dm),x4=V({uri:_(),mimeType:Ot(_()),_meta:Pt(_(),_t()).optional()}),S4=x4.extend({text:_()}),S1=_().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),k4=x4.extend({blob:S1}),fm=Br(["user","assistant"]),Su=V({audience:L(fm).optional(),priority:We().min(0).max(1).optional(),lastModified:Za.datetime({offset:!0}).optional()}),$4=V({...wu.shape,...cm.shape,uri:_(),description:Ot(_()),mimeType:Ot(_()),annotations:Su.optional(),_meta:Ot(cr({}))}),BJ=V({...wu.shape,...cm.shape,uriTemplate:_(),description:Ot(_()),mimeType:Ot(_()),annotations:Su.optional(),_meta:Ot(cr({}))}),UJ=lm.extend({method:re("resources/list")}),k1=um.extend({resources:L($4)}),LJ=lm.extend({method:re("resources/templates/list")}),$1=um.extend({resourceTemplates:L(BJ)}),A1=Fn.extend({uri:_()}),FJ=A1,VJ=Pr.extend({method:re("resources/read"),params:FJ}),P1=Cr.extend({contents:L(ft([S4,k4]))}),C1=ro.extend({method:re("notifications/resources/list_changed"),params:to.optional()}),ZJ=A1,HJ=Pr.extend({method:re("resources/subscribe"),params:ZJ}),GJ=A1,WJ=Pr.extend({method:re("resources/unsubscribe"),params:GJ}),KJ=to.extend({uri:_()}),JJ=ro.extend({method:re("notifications/resources/updated"),params:KJ}),YJ=V({name:_(),description:Ot(_()),required:Ot(lt())}),XJ=V({...wu.shape,...cm.shape,description:Ot(_()),arguments:Ot(L(YJ)),_meta:Ot(cr({}))}),QJ=lm.extend({method:re("prompts/list")}),I1=um.extend({prompts:L(XJ)}),e7=Fn.extend({name:_(),arguments:Pt(_(),_()).optional()}),t7=Pr.extend({method:re("prompts/get"),params:e7}),T1=V({type:re("text"),text:_(),annotations:Su.optional(),_meta:Pt(_(),_t()).optional()}),E1=V({type:re("image"),data:S1,mimeType:_(),annotations:Su.optional(),_meta:Pt(_(),_t()).optional()}),O1=V({type:re("audio"),data:S1,mimeType:_(),annotations:Su.optional(),_meta:Pt(_(),_t()).optional()}),r7=V({type:re("tool_use"),name:_(),id:_(),input:Pt(_(),_t()),_meta:Pt(_(),_t()).optional()}),n7=V({type:re("resource"),resource:ft([S4,k4]),annotations:Su.optional(),_meta:Pt(_(),_t()).optional()}),o7=$4.extend({type:re("resource_link")}),j1=ft([T1,E1,O1,o7,n7]),i7=V({role:fm,content:j1}),N1=Cr.extend({description:_().optional(),messages:L(i7)}),z1=ro.extend({method:re("notifications/prompts/list_changed"),params:to.optional()}),s7=V({title:_().optional(),readOnlyHint:lt().optional(),destructiveHint:lt().optional(),idempotentHint:lt().optional(),openWorldHint:lt().optional()}),a7=V({taskSupport:Br(["required","optional","forbidden"]).optional()}),A4=V({...wu.shape,...cm.shape,description:_().optional(),inputSchema:V({type:re("object"),properties:Pt(_(),Ar).optional(),required:L(_()).optional()}).catchall(_t()),outputSchema:V({type:re("object"),properties:Pt(_(),Ar).optional(),required:L(_()).optional()}).catchall(_t()).optional(),annotations:s7.optional(),execution:a7.optional(),_meta:Pt(_(),_t()).optional()}),c7=lm.extend({method:re("tools/list")}),mm=um.extend({tools:L(A4)}),Vs=Cr.extend({content:L(j1).default([]),structuredContent:Pt(_(),_t()).optional(),isError:lt().optional()}),iwe=Vs.or(Cr.extend({toolResult:_t()})),l7=sm.extend({name:_(),arguments:Pt(_(),_t()).optional()}),u7=Pr.extend({method:re("tools/call"),params:l7}),R1=ro.extend({method:re("notifications/tools/list_changed"),params:to.optional()}),P4=V({autoRefresh:lt().default(!0),debounceMs:We().int().nonnegative().default(300)}),C4=Br(["debug","info","notice","warning","error","critical","alert","emergency"]),d7=Fn.extend({level:C4}),p7=Pr.extend({method:re("logging/setLevel"),params:d7}),f7=to.extend({level:C4,logger:_().optional(),data:_t()}),m7=ro.extend({method:re("notifications/message"),params:f7}),h7=V({name:_().optional()}),g7=V({hints:L(h7).optional(),costPriority:We().min(0).max(1).optional(),speedPriority:We().min(0).max(1).optional(),intelligencePriority:We().min(0).max(1).optional()}),y7=V({mode:Br(["auto","required","none"]).optional()}),v7=V({type:re("tool_result"),toolUseId:_().describe("The unique identifier for the corresponding tool call."),content:L(j1).default([]),structuredContent:V({}).loose().optional(),isError:lt().optional(),_meta:Pt(_(),_t()).optional()}),_7=Y_("type",[T1,E1,O1]),rb=Y_("type",[T1,E1,O1,r7,v7]),b7=V({role:fm,content:ft([rb,L(rb)]),_meta:Pt(_(),_t()).optional()}),w7=sm.extend({messages:L(b7),modelPreferences:g7.optional(),systemPrompt:_().optional(),includeContext:Br(["none","thisServer","allServers"]).optional(),temperature:We().optional(),maxTokens:We().int(),stopSequences:L(_()).optional(),metadata:Ar.optional(),tools:L(A4).optional(),toolChoice:y7.optional()}),M1=Pr.extend({method:re("sampling/createMessage"),params:w7}),q1=Cr.extend({model:_(),stopReason:Ot(Br(["endTurn","stopSequence","maxTokens"]).or(_())),role:fm,content:_7}),x7=Cr.extend({model:_(),stopReason:Ot(Br(["endTurn","stopSequence","maxTokens","toolUse"]).or(_())),role:fm,content:ft([rb,L(rb)])}),S7=V({type:re("boolean"),title:_().optional(),description:_().optional(),default:lt().optional()}),k7=V({type:re("string"),title:_().optional(),description:_().optional(),minLength:We().optional(),maxLength:We().optional(),format:Br(["email","uri","date","date-time"]).optional(),default:_().optional()}),$7=V({type:Br(["number","integer"]),title:_().optional(),description:_().optional(),minimum:We().optional(),maximum:We().optional(),default:We().optional()}),A7=V({type:re("string"),title:_().optional(),description:_().optional(),enum:L(_()),default:_().optional()}),P7=V({type:re("string"),title:_().optional(),description:_().optional(),oneOf:L(V({const:_(),title:_()})),default:_().optional()}),C7=V({type:re("string"),title:_().optional(),description:_().optional(),enum:L(_()),enumNames:L(_()).optional(),default:_().optional()}),I7=ft([A7,P7]),T7=V({type:re("array"),title:_().optional(),description:_().optional(),minItems:We().optional(),maxItems:We().optional(),items:V({type:re("string"),enum:L(_())}),default:L(_()).optional()}),E7=V({type:re("array"),title:_().optional(),description:_().optional(),minItems:We().optional(),maxItems:We().optional(),items:V({anyOf:L(V({const:_(),title:_()}))}),default:L(_()).optional()}),O7=ft([T7,E7]),j7=ft([C7,I7,O7]),N7=ft([j7,S7,k7,$7]),z7=sm.extend({mode:re("form").optional(),message:_(),requestedSchema:V({type:re("object"),properties:Pt(_(),N7),required:L(_()).optional()})}),R7=sm.extend({mode:re("url"),message:_(),elicitationId:_(),url:_().url()}),M7=ft([z7,R7]),D1=Pr.extend({method:re("elicitation/create"),params:M7}),q7=to.extend({elicitationId:_()}),D7=ro.extend({method:re("notifications/elicitation/complete"),params:q7}),B1=Cr.extend({action:Br(["accept","decline","cancel"]),content:eb(t=>t===null?void 0:t,Pt(_(),ft([_(),We(),lt(),L(_())])).optional())}),B7=V({type:re("ref/resource"),uri:_()});var U7=V({type:re("ref/prompt"),name:_()}),L7=Fn.extend({ref:ft([U7,B7]),argument:V({name:_(),value:_()}),context:V({arguments:Pt(_(),_()).optional()}).optional()}),F7=Pr.extend({method:re("completion/complete"),params:L7});var U1=Cr.extend({completion:cr({values:L(_()).max(100),total:Ot(We().int()),hasMore:Ot(lt())})}),V7=V({uri:_().startsWith("file://"),name:_().optional(),_meta:Pt(_(),_t()).optional()}),Z7=Pr.extend({method:re("roots/list"),params:Fn.optional()}),H7=Cr.extend({roots:L(V7)}),G7=ro.extend({method:re("notifications/roots/list_changed"),params:to.optional()}),swe=ft([ab,OJ,F7,p7,t7,QJ,UJ,LJ,VJ,HJ,WJ,u7,c7,lb,db,pb,mb]),awe=ft([sb,cb,NJ,G7,pm]),cwe=ft([Ha,q1,x7,B1,H7,ub,fb,Ga]),lwe=ft([ab,M1,D1,Z7,lb,db,pb,mb]),uwe=ft([sb,cb,m7,JJ,C1,R1,z1,pm,D7]),dwe=ft([Ha,x1,U1,N1,I1,k1,$1,P1,Vs,mm,ub,fb,Ga]),le=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===ye.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new y1(o.elicitations,r)}return new t(e,r,n)}},y1=class extends le{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(ye.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function Zs(t){return t==="completed"||t==="failed"||t==="cancelled"}var Zwe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function L1(t){let r=L_(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=dD(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function F1(t,e){let r=To(t,e);if(!r.success)throw r.error;return r.data}var Q7=6e4,hb=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(sb,r=>{this._oncancel(r)}),this.setNotificationHandler(cb,r=>{this._onprogress(r)}),this.setRequestHandler(ab,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(lb,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new le(ye.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(db,async(r,n)=>{let o=async()=>{let i=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(i,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,l=c.id,u=this._requestResolvers.get(l);if(u)if(this._requestResolvers.delete(l),a.type==="response")u(c);else{let d=c,p=new le(d.error.code,d.error.message,d.error.data);u(p)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${l}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let s=await this._taskStore.getTask(i,n.sessionId);if(!s)throw new le(ye.InvalidParams,`Task not found: ${i}`);if(!Zs(s.status))return await this._waitForTaskUpdate(i,n.signal),await o();if(Zs(s.status)){let a=await this._taskStore.getTaskResult(i,n.sessionId);return this._clearTaskQueue(i),{...a,_meta:{...a._meta,[Fs]:{taskId:i}}}}return await o()};return await o()}),this.setRequestHandler(pb,async(r,n)=>{try{let{tasks:o,nextCursor:i}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:i,_meta:{}}}catch(o){throw new le(ye.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(mb,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new le(ye.InvalidParams,`Task not found: ${r.params.taskId}`);if(Zs(o.status))throw new le(ye.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let i=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!i)throw new le(ye.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...i}}catch(o){throw o instanceof le?o:new le(ye.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,i=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:i,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),le.fromError(ye.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=i=>{n?.(i),this._onerror(i)};let o=this._transport?.onmessage;this._transport.onmessage=(i,s)=>{o?.(i,s),am(i)||_4(i)?this._onresponse(i):_1(i)?this._onrequest(i,s):v4(i)?this._onnotification(i):this._onerror(new Error(`Unknown message type: ${JSON.stringify(i)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let r=le.fromError(ye.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,i=e.params?._meta?.[Fs]?.taskId;if(n===void 0){let u={jsonrpc:"2.0",id:e.id,error:{code:ye.MethodNotFound,message:"Method not found"}};i&&this._taskMessageQueue?this._enqueueTaskMessage(i,{type:"error",message:u,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(u).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let s=new AbortController;this._requestHandlerAbortControllers.set(e.id,s);let a=h4(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,l={signal:s.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async u=>{let d={relatedRequestId:e.id};i&&(d.relatedTask={taskId:i}),await this.notification(u,d)},sendRequest:async(u,d,p)=>{let f={...p,relatedRequestId:e.id};i&&!f.relatedTask&&(f.relatedTask={taskId:i});let h=f.relatedTask?.taskId??i;return h&&c&&await c.updateTaskStatus(h,"input_required"),await this.request(u,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:i,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,l)).then(async u=>{if(s.signal.aborted)return;let d={result:u,jsonrpc:"2.0",id:e.id};i&&this._taskMessageQueue?await this._enqueueTaskMessage(i,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async u=>{if(s.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:ye.InternalError,message:u.message??"Internal error",...u.data!==void 0&&{data:u.data}}};i&&this._taskMessageQueue?await this._enqueueTaskMessage(i,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),i=this._progressHandlers.get(o);if(!i){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let s=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&s&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),s(c);return}i(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),am(e))n(e);else{let s=new le(e.error.code,e.error.message,e.error.data);n(s)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let i=!1;if(am(e)&&e.result&&typeof e.result=="object"){let s=e.result;if(s.task&&typeof s.task=="object"){let a=s.task;typeof a.taskId=="string"&&(i=!0,this._taskProgressTokens.set(a.taskId,r))}}if(i||this._progressHandlers.delete(r),am(e))o(e);else{let s=le.fromError(e.error.code,e.error.message,e.error.data);o(s)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(s){yield{type:"error",error:s instanceof le?s:new le(ye.InternalError,String(s))}}return}let i;try{let s=await this.request(e,Ga,n);if(s.task)i=s.task.taskId,yield{type:"taskCreated",task:s.task};else throw new le(ye.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:i},n);if(yield{type:"taskStatus",task:a},Zs(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:i},r,n)}:a.status==="failed"?yield{type:"error",error:new le(ye.InternalError,`Task ${i} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new le(ye.InternalError,`Task ${i} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:i},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(l=>setTimeout(l,c)),n?.signal?.throwIfAborted()}}catch(s){yield{type:"error",error:s instanceof le?s:new le(ye.InternalError,String(s))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:i,onresumptiontoken:s,task:a,relatedTask:c}=n??{};return new Promise((l,u)=>{let d=w=>{u(w)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(w){d(w);return}n?.signal?.throwIfAborted();let p=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:p};n?.onprogress&&(this._progressHandlers.set(p,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:p}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Fs]:c}});let h=w=>{this._responseHandlers.delete(p),this._progressHandlers.delete(p),this._cleanupTimeout(p),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:p,reason:String(w)}},{relatedRequestId:o,resumptionToken:i,onresumptiontoken:s}).catch(R=>this._onerror(new Error(`Failed to send cancellation: ${R}`)));let $=w instanceof le?w:new le(ye.RequestTimeout,String(w));u($)};this._responseHandlers.set(p,w=>{if(!n?.signal?.aborted){if(w instanceof Error)return u(w);try{let $=To(r,w.result);$.success?l($.data):u($.error)}catch($){u($)}}}),n?.signal?.addEventListener("abort",()=>{h(n?.signal?.reason)});let m=n?.timeout??Q7,y=()=>h(le.fromError(ye.RequestTimeout,"Request timed out",{timeout:m}));this._setupTimeout(p,m,n?.maxTotalTimeout,y,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let w=$=>{let R=this._responseHandlers.get(p);R?R($):this._onerror(new Error(`Response handler missing for side-channeled request ${p}`))};this._requestResolvers.set(p,w),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch($=>{this._cleanupTimeout(p),u($)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:i,onresumptiontoken:s}).catch(w=>{this._cleanupTimeout(p),u(w)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},ub,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},fb,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},w4,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Fs]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Fs]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let s={...e,jsonrpc:"2.0"};r?.relatedTask&&(s={...s,params:{...s.params,_meta:{...s.params?._meta||{},[Fs]:r.relatedTask}}}),await this._transport.send(s,r)}setRequestHandler(e,r){let n=L1(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,i)=>{let s=F1(e,o);return Promise.resolve(r(s,i))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=L1(e);this._notificationHandlers.set(n,o=>{let i=F1(e,o);return Promise.resolve(r(i))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&_1(o.message)){let i=o.message.id,s=this._requestResolvers.get(i);s?(s(new le(ye.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(i)):this._onerror(new Error(`Resolver missing for request ${i} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,i)=>{if(r.aborted){i(new le(ye.InvalidRequest,"Request cancelled"));return}let s=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(s),i(new le(ye.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let i=await n.getTask(o,r);if(!i)throw new le(ye.InvalidParams,"Failed to retrieve task: Task not found");return i},storeTaskResult:async(o,i,s)=>{await n.storeTaskResult(o,i,s,r);let a=await n.getTask(o,r);if(a){let c=pm.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Zs(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,i,s)=>{let a=await n.getTask(o,r);if(!a)throw new le(ye.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Zs(a.status))throw new le(ye.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${i}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,i,s,r);let c=await n.getTask(o,r);if(c){let l=pm.parse({method:"notifications/tasks/status",params:c});await this.notification(l),Zs(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function I4(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function T4(t,e){let r={...t};for(let n in e){let o=n,i=e[o];if(i===void 0)continue;let s=r[o];I4(s)&&I4(i)?r[o]={...s,...i}:r[o]=i}return r}var T6=it(rU(),1),E6=it(I6(),1);function Mae(){let t=new T6.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,E6.default)(t),t}var Iw=class{constructor(e){this._ajv=e??Mae()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var Tw=class{constructor(e){this._client=e}async*callToolStream(e,r=Vs,n){let o=this._client,i={...n,task:n?.task??(o.isToolTask(e.name)?{}:void 0)},s=o.requestStream({method:"tools/call",params:e},r,i),a=o.getToolOutputValidator(e.name);for await(let c of s){if(c.type==="result"&&a){let l=c.result;if(!l.structuredContent&&!l.isError){yield{type:"error",error:new le(ye.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(l.structuredContent)try{let u=a(l.structuredContent);if(!u.valid){yield{type:"error",error:new le(ye.InvalidParams,`Structured content does not match the tool's output schema: ${u.errorMessage}`)};return}}catch(u){if(u instanceof le){yield{type:"error",error:u};return}yield{type:"error",error:new le(ye.InvalidParams,`Failed to validate structured content: ${u instanceof Error?u.message:String(u)}`)};return}}yield c}}async getTask(e,r){return this._client.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._client.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._client.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._client.cancelTask({taskId:e},r)}requestStream(e,r,n){return this._client.requestStream(e,r,n)}};function O6(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function j6(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}function Ew(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){let r=e,n=t.properties;for(let o of Object.keys(n)){let i=n[o];r[o]===void 0&&Object.prototype.hasOwnProperty.call(i,"default")&&(r[o]=i.default),r[o]!==void 0&&Ew(i,r[o])}}if(Array.isArray(t.anyOf))for(let r of t.anyOf)typeof r!="boolean"&&Ew(r,e);if(Array.isArray(t.oneOf))for(let r of t.oneOf)typeof r!="boolean"&&Ew(r,e)}}function qae(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};let e=t.form!==void 0,r=t.url!==void 0;return{supportsFormMode:e||!e&&!r,supportsUrlMode:r}}var Ow=class extends hb{constructor(e,r){super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._listChangedDebounceTimers=new Map,this._capabilities=r?.capabilities??{},this._jsonSchemaValidator=r?.jsonSchemaValidator??new Iw,r?.listChanged&&(this._pendingListChangedConfig=r.listChanged)}_setupListChangedHandlers(e){e.tools&&this._serverCapabilities?.tools?.listChanged&&this._setupListChangedHandler("tools",R1,e.tools,async()=>(await this.listTools()).tools),e.prompts&&this._serverCapabilities?.prompts?.listChanged&&this._setupListChangedHandler("prompts",z1,e.prompts,async()=>(await this.listPrompts()).prompts),e.resources&&this._serverCapabilities?.resources?.listChanged&&this._setupListChangedHandler("resources",C1,e.resources,async()=>(await this.listResources()).resources)}get experimental(){return this._experimental||(this._experimental={tasks:new Tw(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=T4(this._capabilities,e)}setRequestHandler(e,r){let o=L_(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let i;if(_u(o)){let a=o;i=a._zod?.def?.value??a.value}else{let a=o;i=a._def?.value??a.value}if(typeof i!="string")throw new Error("Schema method literal must be a string");let s=i;if(s==="elicitation/create"){let a=async(c,l)=>{let u=To(D1,c);if(!u.success){let w=u.error instanceof Error?u.error.message:String(u.error);throw new le(ye.InvalidParams,`Invalid elicitation request: ${w}`)}let{params:d}=u.data;d.mode=d.mode??"form";let{supportsFormMode:p,supportsUrlMode:f}=qae(this._capabilities.elicitation);if(d.mode==="form"&&!p)throw new le(ye.InvalidParams,"Client does not support form-mode elicitation requests");if(d.mode==="url"&&!f)throw new le(ye.InvalidParams,"Client does not support URL-mode elicitation requests");let h=await Promise.resolve(r(c,l));if(d.task){let w=To(Ga,h);if(!w.success){let $=w.error instanceof Error?w.error.message:String(w.error);throw new le(ye.InvalidParams,`Invalid task creation result: ${$}`)}return w.data}let m=To(B1,h);if(!m.success){let w=m.error instanceof Error?m.error.message:String(m.error);throw new le(ye.InvalidParams,`Invalid elicitation result: ${w}`)}let y=m.data,v=d.mode==="form"?d.requestedSchema:void 0;if(d.mode==="form"&&y.action==="accept"&&y.content&&v&&this._capabilities.elicitation?.form?.applyDefaults)try{Ew(v,y.content)}catch{}return y};return super.setRequestHandler(e,a)}if(s==="sampling/createMessage"){let a=async(c,l)=>{let u=To(M1,c);if(!u.success){let h=u.error instanceof Error?u.error.message:String(u.error);throw new le(ye.InvalidParams,`Invalid sampling request: ${h}`)}let{params:d}=u.data,p=await Promise.resolve(r(c,l));if(d.task){let h=To(Ga,p);if(!h.success){let m=h.error instanceof Error?h.error.message:String(h.error);throw new le(ye.InvalidParams,`Invalid task creation result: ${m}`)}return h.data}let f=To(q1,p);if(!f.success){let h=f.error instanceof Error?f.error.message:String(f.error);throw new le(ye.InvalidParams,`Invalid sampling result: ${h}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapability(e,r){if(!this._serverCapabilities?.[e])throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let n=await this.request({method:"initialize",params:{protocolVersion:xu,capabilities:this._capabilities,clientInfo:this._clientInfo}},x1,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!p4.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"}),this._pendingListChangedConfig&&(this._setupListChangedHandlers(this._pendingListChangedConfig),this._pendingListChangedConfig=void 0)}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){switch(e){case"logging/setLevel":if(!this._serverCapabilities?.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._serverCapabilities?.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!this._serverCapabilities?.resources)throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._serverCapabilities?.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!this._serverCapabilities?.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/roots/list_changed":if(!this._capabilities.roots?.listChanged)throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break;case"ping":break}}assertTaskCapability(e){O6(this._serverCapabilities?.tasks?.requests,e,"Server")}assertTaskHandlerCapability(e){this._capabilities&&j6(this._capabilities.tasks?.requests,e,"Client")}async ping(e){return this.request({method:"ping"},Ha,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},U1,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},Ha,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},N1,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},I1,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},k1,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},$1,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},P1,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},Ha,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},Ha,r)}async callTool(e,r=Vs,n){if(this.isToolTaskRequired(e.name))throw new le(ye.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);let o=await this.request({method:"tools/call",params:e},r,n),i=this.getToolOutputValidator(e.name);if(i){if(!o.structuredContent&&!o.isError)throw new le(ye.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(o.structuredContent)try{let s=i(o.structuredContent);if(!s.valid)throw new le(ye.InvalidParams,`Structured content does not match the tool's output schema: ${s.errorMessage}`)}catch(s){throw s instanceof le?s:new le(ye.InvalidParams,`Failed to validate structured content: ${s instanceof Error?s.message:String(s)}`)}}return o}isToolTask(e){return this._serverCapabilities?.tasks?.requests?.tools?.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(let r of e){if(r.outputSchema){let o=this._jsonSchemaValidator.getValidator(r.outputSchema);this._cachedToolOutputValidators.set(r.name,o)}let n=r.execution?.taskSupport;(n==="required"||n==="optional")&&this._cachedKnownTaskTools.add(r.name),n==="required"&&this._cachedRequiredTaskTools.add(r.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let n=await this.request({method:"tools/list",params:e},mm,r);return this.cacheToolMetadata(n.tools),n}_setupListChangedHandler(e,r,n,o){let i=P4.safeParse(n);if(!i.success)throw new Error(`Invalid ${e} listChanged options: ${i.error.message}`);if(typeof n.onChanged!="function")throw new Error(`Invalid ${e} listChanged options: onChanged must be a function`);let{autoRefresh:s,debounceMs:a}=i.data,{onChanged:c}=n,l=async()=>{if(!s){c(null,null);return}try{let d=await o();c(null,d)}catch(d){let p=d instanceof Error?d:new Error(String(d));c(p,null)}},u=()=>{if(a){let d=this._listChangedDebounceTimers.get(e);d&&clearTimeout(d);let p=setTimeout(l,a);this._listChangedDebounceTimers.set(e,p)}else l()};this.setNotificationHandler(r,u)}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var SF=it(wF(),1),_h=it(require("node:process"),1),kF=require("node:stream");var Nw=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),dce(r)}clear(){this._buffer=void 0}};function dce(t){return ib.parse(JSON.parse(t))}function xF(t){return JSON.stringify(t)+`
`}var pce=_h.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function fce(){let t={};for(let e of pce){let r=_h.default.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}var zw=class{constructor(e){this._readBuffer=new Nw,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new kF.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{this._process=(0,SF.default)(this._serverParams.command,this._serverParams.args??[],{env:{...fce(),...this._serverParams.env},stdio:["pipe","pipe",this._serverParams.stderr??"inherit"],shell:!1,windowsHide:_h.default.platform==="win32"&&mce(),cwd:this._serverParams.cwd}),this._process.on("error",n=>{r(n),this.onerror?.(n)}),this._process.on("spawn",()=>{e()}),this._process.on("close",n=>{this._process=void 0,this.onclose?.()}),this._process.stdin?.on("error",n=>{this.onerror?.(n)}),this._process.stdout?.on("data",n=>{this._readBuffer.append(n),this.processReadBuffer()}),this._process.stdout?.on("error",n=>{this.onerror?.(n)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){return this._stderrStream?this._stderrStream:this._process?.stderr??null}get pid(){return this._process?.pid??null}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){if(this._process){let e=this._process;this._process=void 0;let r=new Promise(n=>{e.once("close",()=>{n()})});try{e.stdin?.end()}catch{}if(await Promise.race([r,new Promise(n=>setTimeout(n,2e3).unref())]),e.exitCode===null){try{e.kill("SIGTERM")}catch{}await Promise.race([r,new Promise(n=>setTimeout(n,2e3).unref())])}if(e.exitCode===null)try{e.kill("SIGKILL")}catch{}}this._readBuffer.clear()}send(e){return new Promise(r=>{if(!this._process?.stdin)throw new Error("Not connected");let n=xF(e);this._process.stdin.write(n)?r():this._process.stdin.once("drain",r)})}};function mce(){return"type"in _h.default}var Rw=class extends Error{constructor(e,r){super(e),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}};function xE(t){}function $F(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:e=xE,onError:r=xE,onRetry:n=xE,onComment:o}=t,i="",s=!0,a,c="",l="";function u(m){let y=s?m.replace(/^\xEF\xBB\xBF/,""):m,[v,w]=hce(`${i}${y}`);for(let $ of v)d($);i=w,s=!1}function d(m){if(m===""){f();return}if(m.startsWith(":")){o&&o(m.slice(m.startsWith(": ")?2:1));return}let y=m.indexOf(":");if(y!==-1){let v=m.slice(0,y),w=m[y+1]===" "?2:1,$=m.slice(y+w);p(v,$,m);return}p(m,"",m)}function p(m,y,v){switch(m){case"event":l=y;break;case"data":c=`${c}${y}
`;break;case"id":a=y.includes("\0")?void 0:y;break;case"retry":/^\d+$/.test(y)?n(parseInt(y,10)):r(new Rw(`Invalid \`retry\` value: "${y}"`,{type:"invalid-retry",value:y,line:v}));break;default:r(new Rw(`Unknown field "${m.length>20?`${m.slice(0,20)}\u2026`:m}"`,{type:"unknown-field",field:m,value:y,line:v}));break}}function f(){c.length>0&&e({id:a,event:l||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),a=void 0,c="",l=""}function h(m={}){i&&m.consume&&d(i),s=!0,a=void 0,c="",l="",i=""}return{feed:u,reset:h}}function hce(t){let e=[],r="",n=0;for(;n<t.length;){let o=t.indexOf("\r",n),i=t.indexOf(`
`,n),s=-1;if(o!==-1&&i!==-1?s=Math.min(o,i):o!==-1?o===t.length-1?s=-1:s=o:i!==-1&&(s=i),s===-1){r=t.slice(n);break}else{let a=t.slice(n,s);e.push(a),n=s+1,t[n-1]==="\r"&&t[n]===`
`&&n++}}return[e,r]}var qw=class extends Event{constructor(e,r){var n,o;super(e),this.code=(n=r?.code)!=null?n:void 0,this.message=(o=r?.message)!=null?o:void 0}[Symbol.for("nodejs.util.inspect.custom")](e,r,n){return n(AF(this),r)}[Symbol.for("Deno.customInspect")](e,r){return e(AF(this),r)}};function gce(t){let e=globalThis.DOMException;return typeof e=="function"?new e(t,"SyntaxError"):new SyntaxError(t)}function SE(t){return t instanceof Error?"errors"in t&&Array.isArray(t.errors)?t.errors.map(SE).join(", "):"cause"in t&&t.cause instanceof Error?`${t}: ${SE(t.cause)}`:t.message:`${t}`}function AF(t){return{type:t.type,message:t.message,code:t.code,defaultPrevented:t.defaultPrevented,cancelable:t.cancelable,timeStamp:t.timeStamp}}var CF=t=>{throw TypeError(t)},EE=(t,e,r)=>e.has(t)||CF("Cannot "+r),Be=(t,e,r)=>(EE(t,e,"read from private field"),r?r.call(t):e.get(t)),mr=(t,e,r)=>e.has(t)?CF("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Lt=(t,e,r,n)=>(EE(t,e,"write to private field"),e.set(t,r),r),is=(t,e,r)=>(EE(t,e,"access private method"),r),xn,mc,rd,Mw,Dw,xh,id,Sh,aa,nd,sd,od,bh,Bo,kE,$E,AE,PF,PE,CE,wh,IE,TE,hc=class extends EventTarget{constructor(e,r){var n,o;super(),mr(this,Bo),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,mr(this,xn),mr(this,mc),mr(this,rd),mr(this,Mw),mr(this,Dw),mr(this,xh),mr(this,id),mr(this,Sh,null),mr(this,aa),mr(this,nd),mr(this,sd,null),mr(this,od,null),mr(this,bh,null),mr(this,$E,async i=>{var s;Be(this,nd).reset();let{body:a,redirected:c,status:l,headers:u}=i;if(l===204){is(this,Bo,wh).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(c?Lt(this,rd,new URL(i.url)):Lt(this,rd,void 0),l!==200){is(this,Bo,wh).call(this,`Non-200 status code (${l})`,l);return}if(!(u.get("content-type")||"").startsWith("text/event-stream")){is(this,Bo,wh).call(this,'Invalid content type, expected "text/event-stream"',l);return}if(Be(this,xn)===this.CLOSED)return;Lt(this,xn,this.OPEN);let d=new Event("open");if((s=Be(this,bh))==null||s.call(this,d),this.dispatchEvent(d),typeof a!="object"||!a||!("getReader"in a)){is(this,Bo,wh).call(this,"Invalid response body, expected a web ReadableStream",l),this.close();return}let p=new TextDecoder,f=a.getReader(),h=!0;do{let{done:m,value:y}=await f.read();y&&Be(this,nd).feed(p.decode(y,{stream:!m})),m&&(h=!1,Be(this,nd).reset(),is(this,Bo,IE).call(this))}while(h)}),mr(this,AE,i=>{Lt(this,aa,void 0),!(i.name==="AbortError"||i.type==="aborted")&&is(this,Bo,IE).call(this,SE(i))}),mr(this,PE,i=>{typeof i.id=="string"&&Lt(this,Sh,i.id);let s=new MessageEvent(i.event||"message",{data:i.data,origin:Be(this,rd)?Be(this,rd).origin:Be(this,mc).origin,lastEventId:i.id||""});Be(this,od)&&(!i.event||i.event==="message")&&Be(this,od).call(this,s),this.dispatchEvent(s)}),mr(this,CE,i=>{Lt(this,xh,i)}),mr(this,TE,()=>{Lt(this,id,void 0),Be(this,xn)===this.CONNECTING&&is(this,Bo,kE).call(this)});try{if(e instanceof URL)Lt(this,mc,e);else if(typeof e=="string")Lt(this,mc,new URL(e,yce()));else throw new Error("Invalid URL")}catch{throw gce("An invalid or illegal string was specified")}Lt(this,nd,$F({onEvent:Be(this,PE),onRetry:Be(this,CE)})),Lt(this,xn,this.CONNECTING),Lt(this,xh,3e3),Lt(this,Dw,(n=r?.fetch)!=null?n:globalThis.fetch),Lt(this,Mw,(o=r?.withCredentials)!=null?o:!1),is(this,Bo,kE).call(this)}get readyState(){return Be(this,xn)}get url(){return Be(this,mc).href}get withCredentials(){return Be(this,Mw)}get onerror(){return Be(this,sd)}set onerror(e){Lt(this,sd,e)}get onmessage(){return Be(this,od)}set onmessage(e){Lt(this,od,e)}get onopen(){return Be(this,bh)}set onopen(e){Lt(this,bh,e)}addEventListener(e,r,n){let o=r;super.addEventListener(e,o,n)}removeEventListener(e,r,n){let o=r;super.removeEventListener(e,o,n)}close(){Be(this,id)&&clearTimeout(Be(this,id)),Be(this,xn)!==this.CLOSED&&(Be(this,aa)&&Be(this,aa).abort(),Lt(this,xn,this.CLOSED),Lt(this,aa,void 0))}};xn=new WeakMap,mc=new WeakMap,rd=new WeakMap,Mw=new WeakMap,Dw=new WeakMap,xh=new WeakMap,id=new WeakMap,Sh=new WeakMap,aa=new WeakMap,nd=new WeakMap,sd=new WeakMap,od=new WeakMap,bh=new WeakMap,Bo=new WeakSet,kE=function(){Lt(this,xn,this.CONNECTING),Lt(this,aa,new AbortController),Be(this,Dw)(Be(this,mc),is(this,Bo,PF).call(this)).then(Be(this,$E)).catch(Be(this,AE))},$E=new WeakMap,AE=new WeakMap,PF=function(){var t;let e={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...Be(this,Sh)?{"Last-Event-ID":Be(this,Sh)}:void 0},cache:"no-store",signal:(t=Be(this,aa))==null?void 0:t.signal};return"window"in globalThis&&(e.credentials=this.withCredentials?"include":"same-origin"),e},PE=new WeakMap,CE=new WeakMap,wh=function(t,e){var r;Be(this,xn)!==this.CLOSED&&Lt(this,xn,this.CLOSED);let n=new qw("error",{code:e,message:t});(r=Be(this,sd))==null||r.call(this,n),this.dispatchEvent(n)},IE=function(t,e){var r;if(Be(this,xn)===this.CLOSED)return;Lt(this,xn,this.CONNECTING);let n=new qw("error",{code:e,message:t});(r=Be(this,sd))==null||r.call(this,n),this.dispatchEvent(n),Lt(this,id,setTimeout(Be(this,TE),Be(this,xh)))},TE=new WeakMap,hc.CONNECTING=0,hc.OPEN=1,hc.CLOSED=2;function yce(){let t="document"in globalThis?globalThis.document:void 0;return t&&typeof t=="object"&&"baseURI"in t&&typeof t.baseURI=="string"?t.baseURI:void 0}function Bw(t){return t?t instanceof Headers?Object.fromEntries(t.entries()):Array.isArray(t)?Object.fromEntries(t):{...t}:{}}function IF(t=fetch,e){return e?async(r,n)=>{let o={...e,...n,headers:n?.headers?{...Bw(e.headers),...Bw(n.headers)}:e.headers};return t(r,o)}:t}var OE;OE=globalThis.crypto?.webcrypto??globalThis.crypto??import("node:crypto").then(t=>t.webcrypto);async function vce(t){return(await OE).getRandomValues(new Uint8Array(t))}async function _ce(t){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r=Math.pow(2,8)-Math.pow(2,8)%e.length,n="";for(;n.length<t;){let o=await vce(t-n.length);for(let i of o)i<r&&(n+=e[i%e.length])}return n}async function bce(t){return await _ce(t)}async function wce(t){let e=await(await OE).subtle.digest("SHA-256",new TextEncoder().encode(t));return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function jE(t){if(t||(t=43),t<43||t>128)throw`Expected a length between 43 and 128. Received ${t}.`;let e=await bce(t),r=await wce(e);return{code_verifier:e,code_challenge:r}}var Nr=HP().superRefine((t,e)=>{if(!URL.canParse(t))return e.addIssue({code:u4.custom,message:"URL must be parseable",fatal:!0}),r_}).refine(t=>{let e=new URL(t);return e.protocol!=="javascript:"&&e.protocol!=="data:"&&e.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),EF=cr({resource:_().url(),authorization_servers:L(Nr).optional(),jwks_uri:_().url().optional(),scopes_supported:L(_()).optional(),bearer_methods_supported:L(_()).optional(),resource_signing_alg_values_supported:L(_()).optional(),resource_name:_().optional(),resource_documentation:_().optional(),resource_policy_uri:_().url().optional(),resource_tos_uri:_().url().optional(),tls_client_certificate_bound_access_tokens:lt().optional(),authorization_details_types_supported:L(_()).optional(),dpop_signing_alg_values_supported:L(_()).optional(),dpop_bound_access_tokens_required:lt().optional()}),NE=cr({issuer:_(),authorization_endpoint:Nr,token_endpoint:Nr,registration_endpoint:Nr.optional(),scopes_supported:L(_()).optional(),response_types_supported:L(_()),response_modes_supported:L(_()).optional(),grant_types_supported:L(_()).optional(),token_endpoint_auth_methods_supported:L(_()).optional(),token_endpoint_auth_signing_alg_values_supported:L(_()).optional(),service_documentation:Nr.optional(),revocation_endpoint:Nr.optional(),revocation_endpoint_auth_methods_supported:L(_()).optional(),revocation_endpoint_auth_signing_alg_values_supported:L(_()).optional(),introspection_endpoint:_().optional(),introspection_endpoint_auth_methods_supported:L(_()).optional(),introspection_endpoint_auth_signing_alg_values_supported:L(_()).optional(),code_challenge_methods_supported:L(_()).optional(),client_id_metadata_document_supported:lt().optional()}),xce=cr({issuer:_(),authorization_endpoint:Nr,token_endpoint:Nr,userinfo_endpoint:Nr.optional(),jwks_uri:Nr,registration_endpoint:Nr.optional(),scopes_supported:L(_()).optional(),response_types_supported:L(_()),response_modes_supported:L(_()).optional(),grant_types_supported:L(_()).optional(),acr_values_supported:L(_()).optional(),subject_types_supported:L(_()),id_token_signing_alg_values_supported:L(_()),id_token_encryption_alg_values_supported:L(_()).optional(),id_token_encryption_enc_values_supported:L(_()).optional(),userinfo_signing_alg_values_supported:L(_()).optional(),userinfo_encryption_alg_values_supported:L(_()).optional(),userinfo_encryption_enc_values_supported:L(_()).optional(),request_object_signing_alg_values_supported:L(_()).optional(),request_object_encryption_alg_values_supported:L(_()).optional(),request_object_encryption_enc_values_supported:L(_()).optional(),token_endpoint_auth_methods_supported:L(_()).optional(),token_endpoint_auth_signing_alg_values_supported:L(_()).optional(),display_values_supported:L(_()).optional(),claim_types_supported:L(_()).optional(),claims_supported:L(_()).optional(),service_documentation:_().optional(),claims_locales_supported:L(_()).optional(),ui_locales_supported:L(_()).optional(),claims_parameter_supported:lt().optional(),request_parameter_supported:lt().optional(),request_uri_parameter_supported:lt().optional(),require_request_uri_registration:lt().optional(),op_policy_uri:Nr.optional(),op_tos_uri:Nr.optional(),client_id_metadata_document_supported:lt().optional()}),OF=V({...xce.shape,...NE.pick({code_challenge_methods_supported:!0}).shape}),jF=V({access_token:_(),id_token:_().optional(),token_type:_(),expires_in:tb.number().optional(),scope:_().optional(),refresh_token:_().optional()}).strip(),NF=V({error:_(),error_description:_().optional(),error_uri:_().optional()}),TF=Nr.optional().or(re("").transform(()=>{})),Sce=V({redirect_uris:L(Nr),token_endpoint_auth_method:_().optional(),grant_types:L(_()).optional(),response_types:L(_()).optional(),client_name:_().optional(),client_uri:Nr.optional(),logo_uri:TF,scope:_().optional(),contacts:L(_()).optional(),tos_uri:TF,policy_uri:_().optional(),jwks_uri:Nr.optional(),jwks:l1().optional(),software_id:_().optional(),software_version:_().optional(),software_statement:_().optional()}).strip(),kce=V({client_id:_(),client_secret:_().optional(),client_id_issued_at:We().optional(),client_secret_expires_at:We().optional()}).strip(),zF=Sce.merge(kce),JAe=V({error:_(),error_description:_().optional()}).strip(),YAe=V({token:_(),token_type_hint:_().optional()}).strip();function RF(t){let e=typeof t=="string"?new URL(t):new URL(t.href);return e.hash="",e}function MF({requestedResource:t,configuredResource:e}){let r=typeof t=="string"?new URL(t):new URL(t.href),n=typeof e=="string"?new URL(e):new URL(e.href);if(r.origin!==n.origin||r.pathname.length<n.pathname.length)return!1;let o=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",i=n.pathname.endsWith("/")?n.pathname:n.pathname+"/";return o.startsWith(i)}var nr=class extends Error{constructor(e,r){super(e),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){let e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}},kh=class extends nr{};kh.errorCode="invalid_request";var gc=class extends nr{};gc.errorCode="invalid_client";var yc=class extends nr{};yc.errorCode="invalid_grant";var vc=class extends nr{};vc.errorCode="unauthorized_client";var $h=class extends nr{};$h.errorCode="unsupported_grant_type";var Ah=class extends nr{};Ah.errorCode="invalid_scope";var Ph=class extends nr{};Ph.errorCode="access_denied";var ss=class extends nr{};ss.errorCode="server_error";var Ch=class extends nr{};Ch.errorCode="temporarily_unavailable";var Ih=class extends nr{};Ih.errorCode="unsupported_response_type";var Th=class extends nr{};Th.errorCode="unsupported_token_type";var Eh=class extends nr{};Eh.errorCode="invalid_token";var Oh=class extends nr{};Oh.errorCode="method_not_allowed";var jh=class extends nr{};jh.errorCode="too_many_requests";var _c=class extends nr{};_c.errorCode="invalid_client_metadata";var Nh=class extends nr{};Nh.errorCode="insufficient_scope";var zh=class extends nr{};zh.errorCode="invalid_target";var qF={[kh.errorCode]:kh,[gc.errorCode]:gc,[yc.errorCode]:yc,[vc.errorCode]:vc,[$h.errorCode]:$h,[Ah.errorCode]:Ah,[Ph.errorCode]:Ph,[ss.errorCode]:ss,[Ch.errorCode]:Ch,[Ih.errorCode]:Ih,[Th.errorCode]:Th,[Eh.errorCode]:Eh,[Oh.errorCode]:Oh,[jh.errorCode]:jh,[_c.errorCode]:_c,[Nh.errorCode]:Nh,[zh.errorCode]:zh};var ca=class extends Error{constructor(e){super(e??"Unauthorized")}};function $ce(t){return["client_secret_basic","client_secret_post","none"].includes(t)}var zE="code",RE="S256";function Ace(t,e){let r=t.client_secret!==void 0;return e.length===0?r?"client_secret_post":"none":"token_endpoint_auth_method"in t&&t.token_endpoint_auth_method&&$ce(t.token_endpoint_auth_method)&&e.includes(t.token_endpoint_auth_method)?t.token_endpoint_auth_method:r&&e.includes("client_secret_basic")?"client_secret_basic":r&&e.includes("client_secret_post")?"client_secret_post":e.includes("none")?"none":r?"client_secret_post":"none"}function Pce(t,e,r,n){let{client_id:o,client_secret:i}=e;switch(t){case"client_secret_basic":Cce(o,i,r);return;case"client_secret_post":Ice(o,i,n);return;case"none":Tce(o,n);return;default:throw new Error(`Unsupported client authentication method: ${t}`)}}function Cce(t,e,r){if(!e)throw new Error("client_secret_basic authentication requires a client_secret");let n=btoa(`${t}:${e}`);r.set("Authorization",`Basic ${n}`)}function Ice(t,e,r){r.set("client_id",t),e&&r.set("client_secret",e)}function Tce(t,e){e.set("client_id",t)}async function BF(t){let e=t instanceof Response?t.status:void 0,r=t instanceof Response?await t.text():t;try{let n=NF.parse(JSON.parse(r)),{error:o,error_description:i,error_uri:s}=n,a=qF[o]||ss;return new a(i||"",s)}catch(n){let o=`${e?`HTTP ${e}: `:""}Invalid OAuth error response: ${n}. Raw body: ${r}`;return new ss(o)}}async function Uw(t,e){try{return await ME(t,e)}catch(r){if(r instanceof gc||r instanceof vc)return await t.invalidateCredentials?.("all"),await ME(t,e);if(r instanceof yc)return await t.invalidateCredentials?.("tokens"),await ME(t,e);throw r}}async function ME(t,{serverUrl:e,authorizationCode:r,scope:n,resourceMetadataUrl:o,fetchFn:i}){let s,a;try{s=await jce(e,{resourceMetadataUrl:o},i),s.authorization_servers&&s.authorization_servers.length>0&&(a=s.authorization_servers[0])}catch{}a||(a=new URL("/",e));let c=await Oce(e,t,s),l=await qce(a,{fetchFn:i}),u=await Promise.resolve(t.clientInformation());if(!u){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");let y=l?.client_id_metadata_document_supported===!0,v=t.clientMetadataUrl;if(v&&!Ece(v))throw new _c(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${v}`);if(y&&v)u={client_id:v},await t.saveClientInformation?.(u);else{if(!t.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");let $=await Fce(a,{metadata:l,clientMetadata:t.clientMetadata,fetchFn:i});await t.saveClientInformation($),u=$}}let d=!t.redirectUrl;if(r!==void 0||d){let y=await Lce(t,a,{metadata:l,resource:c,authorizationCode:r,fetchFn:i});return await t.saveTokens(y),"AUTHORIZED"}let p=await t.tokens();if(p?.refresh_token)try{let y=await Uce(a,{metadata:l,clientInformation:u,refreshToken:p.refresh_token,resource:c,addClientAuthentication:t.addClientAuthentication,fetchFn:i});return await t.saveTokens(y),"AUTHORIZED"}catch(y){if(!(!(y instanceof nr)||y instanceof ss))throw y}let f=t.state?await t.state():void 0,{authorizationUrl:h,codeVerifier:m}=await Dce(a,{metadata:l,clientInformation:u,state:f,redirectUrl:t.redirectUrl,scope:n||s?.scopes_supported?.join(" ")||t.clientMetadata.scope,resource:c});return await t.saveCodeVerifier(m),await t.redirectToAuthorization(h),"REDIRECT"}function Ece(t){if(!t)return!1;try{let e=new URL(t);return e.protocol==="https:"&&e.pathname!=="/"}catch{return!1}}async function Oce(t,e,r){let n=RF(t);if(e.validateResourceURL)return await e.validateResourceURL(n,r?.resource);if(r){if(!MF({requestedResource:n,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${n} (or origin)`);return new URL(r.resource)}}function DE(t){let e=t.headers.get("WWW-Authenticate");if(!e)return{};let[r,n]=e.split(" ");if(r.toLowerCase()!=="bearer"||!n)return{};let o=qE(t,"resource_metadata")||void 0,i;if(o)try{i=new URL(o)}catch{}let s=qE(t,"scope")||void 0,a=qE(t,"error")||void 0;return{resourceMetadataUrl:i,scope:s,error:a}}function qE(t,e){let r=t.headers.get("WWW-Authenticate");if(!r)return null;let n=new RegExp(`${e}=(?:"([^"]+)"|([^\\s,]+))`),o=r.match(n);return o?o[1]||o[2]:null}async function jce(t,e,r=fetch){let n=await Rce(t,"oauth-protected-resource",r,{protocolVersion:e?.protocolVersion,metadataUrl:e?.resourceMetadataUrl});if(!n||n.status===404)throw await n?.body?.cancel(),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!n.ok)throw await n.body?.cancel(),new Error(`HTTP ${n.status} trying to load well-known OAuth protected resource metadata.`);return EF.parse(await n.json())}async function BE(t,e,r=fetch){try{return await r(t,{headers:e})}catch(n){if(n instanceof TypeError)return e?BE(t,void 0,r):void 0;throw n}}function Nce(t,e="",r={}){return e.endsWith("/")&&(e=e.slice(0,-1)),r.prependPathname?`${e}/.well-known/${t}`:`/.well-known/${t}${e}`}async function DF(t,e,r=fetch){return await BE(t,{"MCP-Protocol-Version":e},r)}function zce(t,e){return!t||t.status>=400&&t.status<500&&e!=="/"}async function Rce(t,e,r,n){let o=new URL(t),i=n?.protocolVersion??xu,s;if(n?.metadataUrl)s=new URL(n.metadataUrl);else{let c=Nce(e,o.pathname);s=new URL(c,n?.metadataServerUrl??o),s.search=o.search}let a=await DF(s,i,r);if(!n?.metadataUrl&&zce(a,o.pathname)){let c=new URL(`/.well-known/${e}`,o);a=await DF(c,i,r)}return a}function Mce(t){let e=typeof t=="string"?new URL(t):t,r=e.pathname!=="/",n=[];if(!r)return n.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),n.push({url:new URL("/.well-known/openid-configuration",e.origin),type:"oidc"}),n;let o=e.pathname;return o.endsWith("/")&&(o=o.slice(0,-1)),n.push({url:new URL(`/.well-known/oauth-authorization-server${o}`,e.origin),type:"oauth"}),n.push({url:new URL(`/.well-known/openid-configuration${o}`,e.origin),type:"oidc"}),n.push({url:new URL(`${o}/.well-known/openid-configuration`,e.origin),type:"oidc"}),n}async function qce(t,{fetchFn:e=fetch,protocolVersion:r=xu}={}){let n={"MCP-Protocol-Version":r,Accept:"application/json"},o=Mce(t);for(let{url:i,type:s}of o){let a=await BE(i,n,e);if(a){if(!a.ok){if(await a.body?.cancel(),a.status>=400&&a.status<500)continue;throw new Error(`HTTP ${a.status} trying to load ${s==="oauth"?"OAuth":"OpenID provider"} metadata from ${i}`)}return s==="oauth"?NE.parse(await a.json()):OF.parse(await a.json())}}}async function Dce(t,{metadata:e,clientInformation:r,redirectUrl:n,scope:o,state:i,resource:s}){let a;if(e){if(a=new URL(e.authorization_endpoint),!e.response_types_supported.includes(zE))throw new Error(`Incompatible auth server: does not support response type ${zE}`);if(e.code_challenge_methods_supported&&!e.code_challenge_methods_supported.includes(RE))throw new Error(`Incompatible auth server: does not support code challenge method ${RE}`)}else a=new URL("/authorize",t);let c=await jE(),l=c.code_verifier,u=c.code_challenge;return a.searchParams.set("response_type",zE),a.searchParams.set("client_id",r.client_id),a.searchParams.set("code_challenge",u),a.searchParams.set("code_challenge_method",RE),a.searchParams.set("redirect_uri",String(n)),i&&a.searchParams.set("state",i),o&&a.searchParams.set("scope",o),o?.includes("offline_access")&&a.searchParams.append("prompt","consent"),s&&a.searchParams.set("resource",s.href),{authorizationUrl:a,codeVerifier:l}}function Bce(t,e,r){return new URLSearchParams({grant_type:"authorization_code",code:t,code_verifier:e,redirect_uri:String(r)})}async function UF(t,{metadata:e,tokenRequestParams:r,clientInformation:n,addClientAuthentication:o,resource:i,fetchFn:s}){let a=e?.token_endpoint?new URL(e.token_endpoint):new URL("/token",t),c=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(i&&r.set("resource",i.href),o)await o(c,r,a,e);else if(n){let u=e?.token_endpoint_auth_methods_supported??[],d=Ace(n,u);Pce(d,n,c,r)}let l=await(s??fetch)(a,{method:"POST",headers:c,body:r});if(!l.ok)throw await BF(l);return jF.parse(await l.json())}async function Uce(t,{metadata:e,clientInformation:r,refreshToken:n,resource:o,addClientAuthentication:i,fetchFn:s}){let a=new URLSearchParams({grant_type:"refresh_token",refresh_token:n}),c=await UF(t,{metadata:e,tokenRequestParams:a,clientInformation:r,addClientAuthentication:i,resource:o,fetchFn:s});return{refresh_token:n,...c}}async function Lce(t,e,{metadata:r,resource:n,authorizationCode:o,fetchFn:i}={}){let s=t.clientMetadata.scope,a;if(t.prepareTokenRequest&&(a=await t.prepareTokenRequest(s)),!a){if(!o)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!t.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");let l=await t.codeVerifier();a=Bce(o,l,t.redirectUrl)}let c=await t.clientInformation();return UF(e,{metadata:r,tokenRequestParams:a,clientInformation:c??void 0,addClientAuthentication:t.addClientAuthentication,resource:n,fetchFn:i})}async function Fce(t,{metadata:e,clientMetadata:r,fetchFn:n}){let o;if(e){if(!e.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");o=new URL(e.registration_endpoint)}else o=new URL("/register",t);let i=await(n??fetch)(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw await BF(i);return zF.parse(await i.json())}var UE=class extends Error{constructor(e,r,n){super(`SSE error: ${r}`),this.code=e,this.event=n}},Lw=class{constructor(e,r){this._url=e,this._resourceMetadataUrl=void 0,this._scope=void 0,this._eventSourceInit=r?.eventSourceInit,this._requestInit=r?.requestInit,this._authProvider=r?.authProvider,this._fetch=r?.fetch,this._fetchWithInit=IF(r?.fetch,r?.requestInit)}async _authThenStart(){if(!this._authProvider)throw new ca("No auth provider");let e;try{e=await Uw(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(r){throw this.onerror?.(r),r}if(e!=="AUTHORIZED")throw new ca;return await this._startOrAuth()}async _commonHeaders(){let e={};if(this._authProvider){let n=await this._authProvider.tokens();n&&(e.Authorization=`Bearer ${n.access_token}`)}this._protocolVersion&&(e["mcp-protocol-version"]=this._protocolVersion);let r=Bw(this._requestInit?.headers);return new Headers({...e,...r})}_startOrAuth(){let e=this?._eventSourceInit?.fetch??this._fetch??fetch;return new Promise((r,n)=>{this._eventSource=new hc(this._url.href,{...this._eventSourceInit,fetch:async(o,i)=>{let s=await this._commonHeaders();s.set("Accept","text/event-stream");let a=await e(o,{...i,headers:s});if(a.status===401&&a.headers.has("www-authenticate")){let{resourceMetadataUrl:c,scope:l}=DE(a);this._resourceMetadataUrl=c,this._scope=l}return a}}),this._abortController=new AbortController,this._eventSource.onerror=o=>{if(o.code===401&&this._authProvider){this._authThenStart().then(r,n);return}let i=new UE(o.code,o.message,o);n(i),this.onerror?.(i)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",o=>{let i=o;try{if(this._endpoint=new URL(i.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(s){n(s),this.onerror?.(s),this.close();return}r()}),this._eventSource.onmessage=o=>{let i=o,s;try{s=ib.parse(JSON.parse(i.data))}catch(a){this.onerror?.(a);return}this.onmessage?.(s)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(e){if(!this._authProvider)throw new ca("No auth provider");if(await Uw(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new ca("Failed to authorize")}async close(){this._abortController?.abort(),this._eventSource?.close(),this.onclose?.()}async send(e){if(!this._endpoint)throw new Error("Not connected");try{let r=await this._commonHeaders();r.set("content-type","application/json");let n={...this._requestInit,method:"POST",headers:r,body:JSON.stringify(e),signal:this._abortController?.signal},o=await(this._fetch??fetch)(this._endpoint,n);if(!o.ok){let i=await o.text().catch(()=>null);if(o.status===401&&this._authProvider){let{resourceMetadataUrl:s,scope:a}=DE(o);if(this._resourceMetadataUrl=s,this._scope=a,await Uw(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new ca;return this.send(e)}throw new Error(`Error POSTing to endpoint (HTTP ${o.status}): ${i}`)}await o.body?.cancel()}catch(r){throw this.onerror?.(r),r}}setProtocolVersion(e){this._protocolVersion=e}};var xt=it(require("vscode")),Fw=class{constructor(){}getTools(){return[{serverName:"vscode",name:"vscode_read_file",description:"Read the contents of a file in the workspace",inputSchema:{type:"object",properties:{uri:{type:"string",description:"The absolute path or URI of the file to read"}},required:["uri"]}},{serverName:"vscode",name:"vscode_list_files",description:"List files in a directory or search for files matching a pattern",inputSchema:{type:"object",properties:{folder:{type:"string",description:"The absolute path of the folder to list (optional)"},pattern:{type:"string",description:'Glob pattern to search for specific files (e.g. "**/*.ts")'}}}},{serverName:"vscode",name:"vscode_open_file",description:"Open a file in the editor",inputSchema:{type:"object",properties:{uri:{type:"string",description:"The absolute path or URI of the file to open"},range:{type:"array",items:{type:"number"},minItems:2,maxItems:2,description:"Line range to select [startLine, endLine] (0-indexed)"}},required:["uri"]}},{serverName:"vscode",name:"vscode_get_diagnostics",description:"Get validation errors, warnings, and information for files",inputSchema:{type:"object",properties:{max:{type:"number",description:"Maximum number of diagnostics to return (default: 50)"}}}},{serverName:"vscode",name:"vscode_get_active_editor",description:"Get information about the currently active text editor",inputSchema:{type:"object",properties:{}}}]}async callTool(e,r){switch(e){case"vscode_read_file":return this.readFile(r.uri);case"vscode_list_files":return this.listFiles(r.folder,r.pattern);case"vscode_open_file":return this.openFile(r.uri,r.range);case"vscode_get_diagnostics":return this.getDiagnostics(r.max);case"vscode_get_active_editor":return this.getActiveEditor();default:throw new Error(`Unknown tool: ${e}`)}}async readFile(e){let r=xt.Uri.file(e),n=await xt.workspace.openTextDocument(r);return{content:n.getText(),languageId:n.languageId,lineCount:n.lineCount}}async listFiles(e,r){if(r)return{files:(await xt.workspace.findFiles(r,null,50)).map(o=>o.fsPath)};if(e){let n=xt.Uri.file(e),o=await xt.workspace.fs.readDirectory(n);return{folder:e,entries:o.map(([i,s])=>({name:i,type:s===xt.FileType.Directory?"directory":"file"}))}}else return xt.workspace.workspaceFolders?{workspaceFolders:xt.workspace.workspaceFolders.map(n=>n.uri.fsPath)}:{error:"No workspace folders open"}}async openFile(e,r){let n=xt.Uri.file(e),o=await xt.workspace.openTextDocument(n),i=await xt.window.showTextDocument(o);if(r&&r.length===2){let s=new xt.Range(r[0],0,r[1],1e3);i.selection=new xt.Selection(s.start,s.end),i.revealRange(s,xt.TextEditorRevealType.InCenter)}return{success:!0,opened:e}}async getDiagnostics(e=50){let r=xt.languages.getDiagnostics(),n=[],o=0;for(let[i,s]of r){if(s.length===0)continue;let a=s.map(c=>({severity:xt.DiagnosticSeverity[c.severity],message:c.message,range:{startLine:c.range.start.line,endLine:c.range.end.line},source:c.source,code:c.code}));if(n.push({file:i.fsPath,diagnostics:a}),o+=a.length,o>=e)break}return{diagnostics:n}}async getActiveEditor(){let e=xt.window.activeTextEditor;return e?{active:!0,file:e.document.uri.fsPath,languageId:e.document.languageId,cursor:{line:e.selection.active.line,character:e.selection.active.character},selection:e.document.getText(e.selection)||null,preview:e.document.getText(new xt.Range(0,0,Math.min(20,e.document.lineCount),0))+`
...`}:{active:!1,reason:"No editor active"}}};var Vw=class{constructor(e){this.output=e;this.vscodeTools=new Fw}clients=new Map;cachedTools=[];disposables=[];vscodeTools;async initialize(){await this.refreshServers()}async refreshServers(){for(let o of this.clients.values())await o.close();this.clients.clear();let e=LF.workspace.getConfiguration("githubCopilotApi.mcp");if(!e.get("enabled",!0)){this.output.appendLine("[MCP] Disabled in configuration.");return}let n=e.get("servers",{});for(let[o,i]of Object.entries(n))try{await this.connectToServer(o,i)}catch(s){this.output.appendLine(`[MCP] Failed to connect to server "${o}": ${s}`)}this.cachedTools=await this.getAllTools()}getTools(){return this.cachedTools.length===0?this.vscodeTools.getTools():this.cachedTools}getConnectedServers(){return Array.from(this.clients.keys())}async connectToServer(e,r){let n;if(r.url)n=new Lw(new URL(r.url));else if(r.command)n=new zw({command:r.command,args:r.args||[],env:this.getCleanEnv(r.env)});else throw new Error(`Invalid configuration for MCP server "${e}"`);let o=new Ow({name:"github-copilot-api-gateway",version:"0.0.1"},{capabilities:{}});await o.connect(n),this.clients.set(e,o),this.output.appendLine(`[MCP] Connected to server "${e}"`)}async getAllTools(){let e=[];for(let[r,n]of this.clients.entries())try{let i=(await n.request({method:"tools/list"},mm)).tools.map(s=>({serverName:r,name:s.name,description:s.description,inputSchema:s.inputSchema}));e.push(...i)}catch(o){this.output.appendLine(`[MCP] Failed to list tools for server "${r}": ${o}`)}return[...e,...this.vscodeTools.getTools()]}async callTool(e,r,n){if(e==="vscode")return this.vscodeTools.callTool(r,n);let o=this.clients.get(e);if(!o)throw new Error(`MCP server "${e}" not found or not connected`);return await o.request({method:"tools/call",params:{name:r,arguments:n}},Vs)}getCleanEnv(e){let r={};for(let[n,o]of Object.entries(process.env))o!==void 0&&(r[n]=o);if(e)for(let[n,o]of Object.entries(e))o!==void 0&&(r[n]=o);return r}dispose(){for(let e of this.clients.values())e.close().catch(r=>console.error(`[MCP] Error closing client: ${r}`));this.clients.clear();for(let e of this.disposables)e.dispose()}};var cue=it(MV(),1),lue=it(XE(),1),uue=it(tO(),1),due=it(r0(),1),lO=it(HV(),1);var Ahe="GitHub.copilot-chat",Phe="@id:GitHub.copilot-chat",pe=class extends Error{constructor(r,n,o,i,s){super(n);this.status=r;this.type=o;this.code=i;this.details=s;this.name="ApiError"}},Che=[{id:"ssn",name:"US Social Security",pattern:"\\b\\d{3}-\\d{2}-\\d{4}\\b",enabled:!0,isBuiltin:!0},{id:"credit-card",name:"Credit/Debit Card",pattern:"\\b(?:\\d{4}[- ]?){3}\\d{4}\\b",enabled:!0,isBuiltin:!0},{id:"aadhaar",name:"Aadhaar Number",pattern:"\\b\\d{4}\\s?\\d{4}\\s?\\d{4}\\b",enabled:!0,isBuiltin:!0},{id:"passport-in",name:"Indian Passport",pattern:"\\b[A-Z]\\d{7}\\b",enabled:!0,isBuiltin:!0},{id:"passport-us",name:"US Passport",pattern:"\\b\\d{9}\\b",enabled:!0,isBuiltin:!0},{id:"email",name:"Email Address",pattern:"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",enabled:!0,isBuiltin:!0},{id:"url",name:"URLs",pattern:"https?://[^\\s]+",enabled:!0,isBuiltin:!0},{id:"phone-us",name:"US Phone Number",pattern:"\\b\\d{3}[-.]?\\d{3}[-.]?\\d{4}\\b",enabled:!0,isBuiltin:!0},{id:"phone-in",name:"Indian Phone",pattern:"\\b[6-9]\\d{9}\\b",enabled:!0,isBuiltin:!0},{id:"api-key",name:"API Keys",pattern:"(sk-[a-zA-Z0-9]{20,})|(api[_-]?key[=:]\\s*[\\w-]+)",enabled:!0,isBuiltin:!0},{id:"password-json",name:"Passwords in JSON",pattern:'"password"\\s*:\\s*"[^"]*"',enabled:!0,isBuiltin:!0},{id:"bearer-token",name:"Bearer Tokens",pattern:"Bearer\\s+[A-Za-z0-9\\-._~+/]+=*",enabled:!0,isBuiltin:!0}],Ihe={"gpt-4":"gpt-4o-copilot","gpt-4-turbo":"gpt-4o-copilot","gpt-4-turbo-preview":"gpt-4o-copilot","gpt-4o":"gpt-4o-copilot","gpt-4o-mini":"gpt-4o-mini-copilot","gpt-3.5-turbo":"gpt-4o-mini-copilot","gpt-3.5-turbo-16k":"gpt-4o-mini-copilot","claude-3-opus":"claude-3.5-sonnet-copilot","claude-3-sonnet":"claude-3.5-sonnet-copilot","claude-3-haiku":"claude-3.5-sonnet-copilot","claude-3.5-sonnet":"claude-3.5-sonnet-copilot",o1:"o1-copilot","o1-mini":"o1-mini-copilot","gemini-1.5-pro":"gpt-4o-copilot","gemini-1.5-flash":"gpt-4o-mini-copilot","o1-preview":"o1-copilot","o3-mini":"o3-mini-copilot"},Pk=class{constructor(e,r,n){this.output=e;this.statusItem=r;this.context=n,this.auditService=new Yv(n),this.mcpService=new Vw(e),this.mcpService.initialize().catch(i=>console.error("Failed to initialize MCP:",i)),this.loadHistory(),this.startStatsUpdater(),this.startDomainCacheRefresh();let o=A.workspace.onDidChangeConfiguration(i=>{if(i.affectsConfiguration("githubCopilotApi.server")){if(this.suppressRestart)return;this.restart().catch(s=>{this.logError("Failed to restart API server after configuration change",s)})}});this.disposables.push(o),this.initializeStats().catch(i=>console.error("Failed to initialize stats:",i))}httpServer;wsServer;disposables=[];config=q8();disposed=!1;activeRequests=0;isHttps=!1;suppressRestart=!1;_onDidChangeStatus=new A.EventEmitter;onDidChangeStatus=this._onDidChangeStatus.event;_onDidLogRequest=new A.EventEmitter;onDidLogRequest=this._onDidLogRequest.event;domainCache=new Map;domainRefreshInterval;usageStats={totalRequests:0,totalTokensIn:0,totalTokensOut:0,requestsByEndpoint:{},startTime:Date.now()};realtimeStats={requestsPerMinute:0,avgLatencyMs:0,latencyHistory:[],tokensPerMinute:0,errorRate:0,lastMinuteRequests:[],lastMinuteErrors:0};requestHistory=[];connections=new Set;isShuttingDown=!1;MAX_HISTORY_SIZE=100;context;rateLimitBucket=[];requestCache=new Map;CACHE_TTL_MS=5e3;statsInterval;activeConnectionsPerIp=new Map;auditService;mcpService;async initializeStats(){try{let e=await this.auditService.getLifetimeStats();this.usageStats.totalRequests=e.totalRequests,this.usageStats.totalTokensIn=e.totalTokensIn,this.usageStats.totalTokensOut=e.totalTokensOut}catch(e){console.error("Failed to load lifetime stats:",e)}}async getStatus(){return{running:!!this.httpServer,isHttps:this.isHttps,config:this.config,activeRequests:this.activeRequests,networkInfo:this.getNetworkInfo(),stats:this.getStats(),realtimeStats:this.realtimeStats,historyCount:this.requestHistory.length,mcp:this.getMcpStatus(),copilot:await this.getCopilotHealth()}}async getCopilotHealth(){let e=A.extensions.all,r=e.find(s=>s.id.toLowerCase()==="github.copilot"||s.id.toLowerCase()==="github.copilot-nightly"||s.packageJSON?.publisher==="GitHub"&&s.packageJSON?.name==="copilot"),n=e.find(s=>s.id.toLowerCase()==="github.copilot-chat"||s.packageJSON?.publisher==="GitHub"&&s.packageJSON?.name==="copilot-chat"),o=!1;try{let s=await A.lm.selectChatModels({vendor:"copilot"});o=s&&s.length>0}catch{o=!1}return{installed:!!r||o,chatInstalled:!!n||o,signedIn:o,ready:o||!!r&&!!n&&o}}getMcpStatus(){return{enabled:A.workspace.getConfiguration("githubCopilotApi.mcp").get("enabled",!0),servers:this.mcpService.getConnectedServers(),tools:this.mcpService.getTools()}}getStats(){return{...this.usageStats,uptimeMs:Date.now()-this.usageStats.startTime,avgLatencyMs:this.realtimeStats.avgLatencyMs,requestsPerMinute:this.realtimeStats.requestsPerMinute,errorRate:this.realtimeStats.errorRate,mcp:this.getMcpStatus()}}getHistory(e){let r=[...this.requestHistory].reverse();return e?r.slice(0,e):r}async getDailyStats(e){return this.auditService.getDailyStats(e)}async getAuditLogs(e,r){return this.auditService.getLogEntries(e,r)}getLogFolderPath(){return this.auditService.getLogFolderPath()}clearHistory(){this.requestHistory=[],this.saveHistory(),this._onDidChangeStatus.fire()}loadHistory(){if(!this.context)return;let e=this.context.globalState.get("requestHistory",[]);this.requestHistory=e.slice(-this.MAX_HISTORY_SIZE)}saveHistory(){this.context&&this.context.globalState.update("requestHistory",this.requestHistory.slice(-this.MAX_HISTORY_SIZE))}addHistoryEntry(e){let r=this.redactSensitiveData(e);this.requestHistory.push(r),this.requestHistory.length>this.MAX_HISTORY_SIZE&&(this.requestHistory=this.requestHistory.slice(-this.MAX_HISTORY_SIZE)),this.requestHistory.length%10===0&&this.saveHistory(),this._onDidChangeStatus.fire()}redactSensitiveData(e){let r=this.config.redactionPatterns.filter(i=>i.enabled);if(console.log(`[Redaction] ${this.config.redactionPatterns.length} total patterns, ${r.length} enabled`),!r.length)return e;let n=i=>{let s=i;for(let a of r)try{let c=new RegExp(a.pattern,"gi");s=s.replace(c,"[REDACTED]")}catch{}return s},o=i=>{if(typeof i=="string")return n(i);if(Array.isArray(i))return i.map(o);if(i&&typeof i=="object"){let s={};for(let[a,c]of Object.entries(i))s[a]=o(c);return s}return i};return o(e)}redactMessagesContent(e){let r=this.config.redactionPatterns.filter(o=>o.enabled);if(!r.length)return e;let n=o=>{let i=o;for(let s of r)try{let a=new RegExp(s.pattern,"gi");i=i.replace(a,"[REDACTED]")}catch{}return i};return e.map(o=>{let i=o.content;return typeof i=="string"?i=n(i):Array.isArray(i)&&(i=i.map(s=>typeof s=="string"?n(s):s&&typeof s=="object"&&typeof s.text=="string"?{...s,text:n(s.text)}:s)),{...o,content:i}})}redactPromptString(e){let r=this.config.redactionPatterns.filter(o=>o.enabled);if(!r.length)return e;let n=e;for(let o of r)try{let i=new RegExp(o.pattern,"gi");n=n.replace(i,"[REDACTED]")}catch{}return n}startStatsUpdater(){this.statsInterval=setInterval(()=>{this.updateRealtimeStats(),this._onDidChangeStatus.fire()},5e3)}startDomainCacheRefresh(){this.refreshDomainCache(),this.domainRefreshInterval=setInterval(()=>{this.refreshDomainCache()},300*1e3)}updateRealtimeStats(){let r=Date.now()-6e4;if(this.realtimeStats.latencyHistory=this.realtimeStats.latencyHistory.filter(n=>n.timestamp>r),this.realtimeStats.lastMinuteRequests=this.realtimeStats.lastMinuteRequests.filter(n=>n>r),this.realtimeStats.requestsPerMinute=this.realtimeStats.lastMinuteRequests.length,this.realtimeStats.latencyHistory.length>0){let n=this.realtimeStats.latencyHistory.reduce((o,i)=>o+i.latency,0);this.realtimeStats.avgLatencyMs=Math.round(n/this.realtimeStats.latencyHistory.length)}else this.realtimeStats.avgLatencyMs=0;this.realtimeStats.lastMinuteRequests.length>0?this.realtimeStats.errorRate=Math.round(this.realtimeStats.lastMinuteErrors/this.realtimeStats.lastMinuteRequests.length*100):this.realtimeStats.errorRate=0,this.realtimeStats.lastMinuteRequests.length===0&&(this.realtimeStats.lastMinuteErrors=0)}recordRequestStats(e,r,n,o){let i=Date.now();this.usageStats.totalRequests++,this.usageStats.totalTokensIn+=r,this.usageStats.totalTokensOut+=n,this.realtimeStats.lastMinuteRequests.push(i),this.realtimeStats.latencyHistory.push({timestamp:i,latency:e}),o&&this.realtimeStats.lastMinuteErrors++,this.realtimeStats.tokensPerMinute=Math.round((this.usageStats.totalTokensIn+this.usageStats.totalTokensOut)/Math.max(1,(i-this.usageStats.startTime)/6e4))}async addRedactionPattern(e,r){try{new RegExp(r);let n=this.config.redactionPatterns,i={id:`custom-${Date.now()}`,name:e,pattern:r,enabled:!0,isBuiltin:!1};return await this.updateServerConfig({redactionPatterns:[...n,i]}),!0}catch{return!1}}async removeRedactionPattern(e){let r=this.config.redactionPatterns.filter(n=>n.id!==e);await this.updateServerConfig({redactionPatterns:r})}async toggleRedactionPattern(e,r){let n=this.config.redactionPatterns.map(o=>o.id===e?{...o,enabled:r}:o);await this.updateServerConfig({redactionPatterns:n})}getRedactionPatterns(){return[...this.config.redactionPatterns]}async addIpAllowlistEntry(e){let r=e.trim();if(!r)return!1;let n=/^[\d\.\/]+$|^[\da-fA-F:\/]+$/.test(r),o=/^[a-zA-Z0-9]([a-zA-Z0-9\-]*[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9\-]*[a-zA-Z0-9])?)+$/.test(r);if(!n&&!o)return!1;let i=[...this.config.ipAllowlist,r];return await A.workspace.getConfiguration("githubCopilotApi").update("server.ipAllowlist",i,A.ConfigurationTarget.Global),!0}async removeIpAllowlistEntry(e){let r=this.config.ipAllowlist.filter(n=>n!==e);await this.updateServerConfig({ipAllowlist:r})}getNetworkInfo(){if(this.config.host!=="0.0.0.0")return null;let e=Fl.hostname(),r=[],n=Fl.networkInterfaces();for(let o of Object.keys(n)){let i=n[o];if(i)for(let s of i)!s.internal&&s.family==="IPv4"&&r.push(s.address)}return{hostname:e,localIPs:r}}async startServer(){await this.updateServerConfig({enabled:!0})}async stopServer(){await this.updateServerConfig({enabled:!1})}async toggleHttp(){await this.updateServerConfig({enableHttp:!this.config.enableHttp,enabled:!0})}async toggleWebSocket(){await this.updateServerConfig({enableWebSocket:!this.config.enableWebSocket,enabled:!0})}async toggleLogging(){await this.updateServerConfig({enableLogging:!this.config.enableLogging})}async toggleHttps(){await this.updateServerConfig({enableHttps:!this.config.enableHttps,enabled:!0})}async setApiKey(e){let r=(e??"").trim();await this.updateServerConfig({apiKey:r})}async setRateLimit(e){let r=Number.isFinite(e)?Math.max(0,Math.floor(e)):60;await this.updateServerConfig({rateLimitPerMinute:r})}getVersion(){return this.context?.extension.packageJSON.version||"0.0.1"}async setHost(e){let r=(e??"").trim();r&&await this.updateServerConfig({host:r,enabled:!0})}async setPort(e){let r=Number.isFinite(e)?Math.max(1,Math.min(65535,Math.floor(e))):this.config.port;await this.updateServerConfig({port:r,enabled:!0})}async toggleMcp(e){this.suppressRestart=!0,await A.workspace.getConfiguration("githubCopilotApi.mcp").update("enabled",e,A.ConfigurationTarget.Global),await this.mcpService.refreshServers(),this.config.mcpEnabled=e,this.suppressRestart=!1}async setDefaultModel(e){let r=(e??"").trim();r&&await this.updateServerConfig({defaultModel:r,enabled:!0})}async setRequestTimeout(e){let r=Number.isFinite(e)?Math.max(1,Math.floor(e)):180;await this.updateServerConfig({requestTimeoutSeconds:r})}async setMaxPayloadSize(e){let r=Number.isFinite(e)?Math.max(1,Math.floor(e)):1;await this.updateServerConfig({maxPayloadSizeMb:r})}async setMaxConnectionsPerIp(e){let r=Number.isFinite(e)?Math.max(1,Math.floor(e)):10;await this.updateServerConfig({maxConnectionsPerIp:r})}async setMaxConcurrency(e){let r=Number.isFinite(e)?Math.max(1,Math.floor(e)):4;await this.updateServerConfig({maxConcurrentRequests:r})}async start(){if(this.disposed)return;if(await this.stop(),this.config=q8(),!this.config.enabled){this.updateStatusBar("stopped","Server disabled in settings"),this._onDidChangeStatus.fire();return}this.updateStatusBar("starting"),this._onDidChangeStatus.fire();let e=(o,i)=>{this.connections.add(i),i.on("close",()=>this.connections.delete(i));let s=Date.now(),a=(0,Yr.randomUUID)().slice(0,8);this.handleHttpRequest(o,i,a,s).catch(c=>{let l=Date.now()-s;c instanceof pe?(this.logRequest(a,o.method||"UNKNOWN",o.url||"/",c.status,l,{error:c.message,requestHeaders:o.headers}),this.sendError(i,c)):(this.logRequest(a,o.method||"UNKNOWN",o.url||"/",500,l,{error:c instanceof Error?c.message:String(c),requestHeaders:o.headers}),this.logError("Unhandled error in HTTP request handler",c),this.sendError(i,new pe(500,"An unexpected error occurred.","server_error")))}).finally(()=>{this.activeRequests--,this._onDidChangeStatus.fire()}),this.activeRequests++,this._onDidChangeStatus.fire()},r=!1;if(this.config.enableHttps)try{let o=null;if(this.config.tlsCertPath&&this.config.tlsKeyPath){let i=this.config.tlsCertPath.startsWith("~")?qr.join(Fl.homedir(),this.config.tlsCertPath.slice(1)):this.config.tlsCertPath,s=this.config.tlsKeyPath.startsWith("~")?qr.join(Fl.homedir(),this.config.tlsKeyPath.slice(1)):this.config.tlsKeyPath;_r.existsSync(i)&&_r.existsSync(s)&&(o={cert:_r.readFileSync(i),key:_r.readFileSync(s)},this.logInfo(`HTTPS enabled with certificate from ${i}`))}if(!o){let i=M8(),s=[{name:"commonName",value:"localhost"}],a=i.generate(s,{days:365,keySize:2048,algorithm:"sha256"});o={cert:a.cert,key:a.private},this.logInfo("HTTPS enabled with auto-generated self-signed certificate (valid 365 days)")}this.httpServer=(0,D8.createServer)(o,e),r=!0}catch(o){this.logError("Failed to setup HTTPS, falling back to HTTP",o),this.httpServer=(0,QR.createServer)(e)}else this.httpServer=(0,QR.createServer)(e);this.isHttps=r,this.httpServer.on("error",o=>{this.logError("HTTP server error",o)}),this.wsServer=new lO.default({noServer:!0}),this.wsServer.on("connection",o=>this.handleWebSocketConnection(o)),this.wsServer.on("error",o=>{this.logError("WebSocket server error",o)}),this.httpServer.on("upgrade",(o,i,s)=>{if(!o.url){i.destroy();return}this.buildUrl(o.url).pathname==="/v1/realtime"&&this.config.enableWebSocket?this.wsServer?.handleUpgrade(o,i,s,c=>{this.wsServer?.emit("connection",c,o)}):i.destroy()}),await new Promise((o,i)=>{let s=a=>{this.httpServer?.off("error",s),i(a)};this.httpServer?.once("error",s),this.httpServer?.listen(this.config.port,this.config.host,()=>{this.httpServer?.off("error",s),o()})});let n=this.httpServer.address();if(n){let i=`${r?"https":"http"}://${n.address}:${n.port}`;this.logInfo(`${r?"HTTPS":"HTTP"} server listening on ${i}`),this.updateStatusBar("running",`${r?"HTTPS":"HTTP"}${this.config.enableWebSocket?"+WS":""} on ${i}`),this._onDidChangeStatus.fire()}}async restart(){this.disposed||(this.logInfo("Restarting API server to apply configuration changes..."),await this.start())}async stop(){this.wsServer&&await new Promise(e=>{for(let r of this.wsServer?.clients??[])r.close(1001,"Server shutting down");this.wsServer?.close(()=>e())}),this.httpServer&&await new Promise((e,r)=>{this.httpServer?.close(n=>{n?r(n):e()})}),this.httpServer=void 0,this.wsServer=void 0,this.activeRequests=0,this.updateStatusBar("stopped"),this._onDidChangeStatus.fire()}async dispose(){if(this.disposed=!0,this.isShuttingDown=!0,this.logInfo("Shutting down API Gateway..."),this.statsInterval&&(clearInterval(this.statsInterval),this.statsInterval=void 0),this.domainRefreshInterval&&(clearInterval(this.domainRefreshInterval),this.domainRefreshInterval=void 0),this.saveHistory(),this.activeRequests>0){this.logInfo(`Waiting for ${this.activeRequests} active requests to complete...`);let e=0;for(;this.activeRequests>0&&e<3e3;)await new Promise(r=>setTimeout(r,100)),e+=100;this.activeRequests>0&&this.logInfo(`Forcing close of ${this.activeRequests} remaining requests.`)}for(let e of this.connections)e.writableEnded||(e.writeHead(503,{"Content-Type":"application/json"}),e.end(JSON.stringify({error:{message:"Server is shutting down",type:"service_unavailable"}})));this.connections.clear(),await this.stop().catch(e=>{this.logError("Failed to stop API server during dispose",e)});for(let e of this.disposables.splice(0))e.dispose();await this.mcpService.dispose(),this._onDidChangeStatus.dispose(),this.logInfo("API Gateway shut down successfully.")}async handleHttpRequest(e,r,n,o){if(this.isShuttingDown){r.writeHead(503,{"Content-Type":"application/json"}),r.end(JSON.stringify({error:{message:"Server is shutting down",type:"service_unavailable"}}));return}if(this.setCorsHeaders(r),r.setHeader("X-Request-ID",n),e.method==="OPTIONS"){r.writeHead(204),r.end();return}if(!this.config.enableHttp)throw new pe(503,"HTTP API is disabled. Enable it from the Copilot API controls.","service_unavailable","http_disabled");let i=this.buildUrl(e.url),s=this.getClientIp(e),a=this.activeConnectionsPerIp.get(s)||0;if(a>=this.config.maxConnectionsPerIp)throw this.logRequest(n,e.method||"UNKNOWN",i.pathname,429,Date.now()-o,{requestHeaders:e.headers}),new pe(429,`Too many connections from your IP. Maximum ${this.config.maxConnectionsPerIp} concurrent connections allowed.`,"rate_limit_error","too_many_connections");if(this.activeConnectionsPerIp.set(s,a+1),r.on("close",()=>{let d=this.activeConnectionsPerIp.get(s)||1;d<=1?this.activeConnectionsPerIp.delete(s):this.activeConnectionsPerIp.set(s,d-1)}),this.config.apiKey&&i.pathname!=="/health"){let d=e.headers.authorization;if((d?.startsWith("Bearer ")?d.slice(7):null)!==this.config.apiKey)throw this.logRequest(n,e.method||"UNKNOWN",i.pathname,401,Date.now()-o,{requestHeaders:e.headers}),new pe(401,"Invalid or missing API key. Provide a valid Bearer token.","authentication_error","invalid_api_key")}if(!this.checkRateLimit())throw this.logRequest(n,e.method||"UNKNOWN",i.pathname,429,Date.now()-o,{requestHeaders:e.headers}),new pe(429,"Rate limit exceeded. Please try again later.","rate_limit_error","rate_limit_exceeded");if(!this.checkIpAllowlist(e))throw this.logRequest(n,e.method||"UNKNOWN",i.pathname,403,Date.now()-o,{requestHeaders:e.headers}),new pe(403,"Access denied. Your IP address is not allowed.","access_denied","ip_not_allowed");if(this.usageStats.totalRequests++,this.usageStats.requestsByEndpoint[i.pathname]=(this.usageStats.requestsByEndpoint[i.pathname]||0)+1,e.method==="GET"&&i.pathname==="/health"){try{let d=await A.lm.selectChatModels({vendor:"copilot"});d&&d.length>0?this.sendJson(r,200,{status:"ok",service:"github-copilot-api-vscode",copilot:"available",models:d.length}):this.sendJson(r,200,{status:"degraded",service:"github-copilot-api-vscode",copilot:"unavailable",message:"No Copilot models found. Check if GitHub Copilot is installed and signed in."})}catch{this.sendJson(r,200,{status:"degraded",service:"github-copilot-api-vscode",copilot:"error",message:"Failed to check Copilot availability."})}return}if(e.method==="GET"&&i.pathname==="/openapi.json"){this.sendJson(r,200,this.getOpenApiSpec());return}if(e.method==="GET"&&i.pathname==="/debug-paths"){this.sendDebugPaths(r);return}if(e.method==="GET"&&i.pathname==="/docs"){this.sendSwaggerUi(r);return}if(e.method==="GET"&&i.pathname.startsWith("/swagger-ui/")){this.serveStaticFile(e,r,i.pathname);return}if(e.method==="GET"&&i.pathname==="/v1/usage"){let d=Math.floor((Date.now()-this.usageStats.startTime)/1e3);this.sendJson(r,200,{object:"usage",total_requests:this.usageStats.totalRequests,total_tokens:{input:this.usageStats.totalTokensIn,output:this.usageStats.totalTokensOut,total:this.usageStats.totalTokensIn+this.usageStats.totalTokensOut},requests_by_endpoint:this.usageStats.requestsByEndpoint,uptime_seconds:d,active_requests:this.activeRequests});return}if(e.method==="GET"&&i.pathname==="/metrics"){let d=Math.floor((Date.now()-this.usageStats.startTime)/1e3),p=["# HELP copilot_api_requests_total Total number of API requests","# TYPE copilot_api_requests_total counter",`copilot_api_requests_total ${this.usageStats.totalRequests}`,"","# HELP copilot_api_active_requests Current number of active requests","# TYPE copilot_api_active_requests gauge",`copilot_api_active_requests ${this.activeRequests}`,"","# HELP copilot_api_tokens_input_total Total input tokens consumed","# TYPE copilot_api_tokens_input_total counter",`copilot_api_tokens_input_total ${this.usageStats.totalTokensIn}`,"","# HELP copilot_api_tokens_output_total Total output tokens generated","# TYPE copilot_api_tokens_output_total counter",`copilot_api_tokens_output_total ${this.usageStats.totalTokensOut}`,"","# HELP copilot_api_uptime_seconds Server uptime in seconds","# TYPE copilot_api_uptime_seconds gauge",`copilot_api_uptime_seconds ${d}`,"","# HELP copilot_api_requests_per_minute Rate of requests per minute","# TYPE copilot_api_requests_per_minute gauge",`copilot_api_requests_per_minute ${this.realtimeStats.requestsPerMinute}`,"","# HELP copilot_api_latency_avg_ms Average request latency in milliseconds","# TYPE copilot_api_latency_avg_ms gauge",`copilot_api_latency_avg_ms ${this.realtimeStats.avgLatencyMs}`,"","# HELP copilot_api_error_rate_percent Error rate percentage","# TYPE copilot_api_error_rate_percent gauge",`copilot_api_error_rate_percent ${this.realtimeStats.errorRate}`,""].join(`
`);r.writeHead(200,{"Content-Type":"text/plain; version=0.0.4; charset=utf-8"}),r.end(p);return}if(e.method==="GET"&&i.pathname==="/v1/models"){let d=await this.getAvailableModels();this.sendJson(r,200,{object:"list",data:d});return}let c=i.pathname.match(/^\/v1\/models\/(.+)$/);if(e.method==="GET"&&c){let d=decodeURIComponent(c[1]),f=(await this.getAvailableModels()).find(h=>h.id===d);if(!f)throw new pe(404,`Model '${d}' not found`,"not_found","model_not_found");this.sendJson(r,200,f);return}if(e.method==="POST"&&i.pathname==="/v1/chat/completions"){let d=await this.readJsonBody(e);if(d?.stream===!0)await this.processStreamingChatCompletion(d,e,r,n,o);else{let p=await this.processChatCompletion(d,{source:"http",endpoint:"/v1/chat/completions"});this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,tokensIn:p?.usage?.prompt_tokens,tokensOut:p?.usage?.completion_tokens,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p)}return}if(e.method==="POST"&&i.pathname==="/v1/messages"){let d=await this.readJsonBody(e);if(d?.model&&!this.resolveModel(d.model))throw new pe(400,`Model '${d.model}' is not supported.`,"invalid_request_error","model_not_found");if(d?.stream===!0)await this.processStreamingAnthropicMessages(d,e,r,n,o);else try{let p=await this.processAnthropicMessages(d);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,tokensIn:p?.usage?.input_tokens,tokensOut:p?.usage?.output_tokens,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p)}catch(p){let f=p instanceof pe?p:new pe(500,p.message||"Internal Server Error","api_error");this.sendJson(r,f.status,{type:"error",error:{type:f.code||"api_error",message:f.message}})}return}if(e.method==="POST"&&i.pathname==="/v1/completions"){let d=await this.readJsonBody(e),p=await this.processCompletion(d);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,tokensIn:p?.usage?.prompt_tokens,tokensOut:p?.usage?.completion_tokens,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p);return}if(e.method==="POST"&&i.pathname==="/v1/tokenize"){let d=await this.readJsonBody(e),p=await this.processTokenize(d);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p);return}if(e.method==="POST"&&i.pathname==="/v1/count_tokens"){let d=await this.readJsonBody(e),p=await this.processTokenize(d);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p);return}if(e.method==="POST"&&i.pathname==="/v1/responses"){let d=await this.readJsonBody(e),p=await this.processResponsesApi(d);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:d,responsePayload:p,tokensIn:p?.usage?.input_tokens,tokensOut:p?.usage?.output_tokens,model:d?.model,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,p);return}let l=i.pathname.match(/^\/v1beta\/models\/(.+):generateContent$/),u=i.pathname.match(/^\/v1beta\/models\/(.+):streamGenerateContent$/);if(e.method==="POST"&&(l||u)){let d=decodeURIComponent((l||u)[1]),p=await this.readJsonBody(e);if(d&&!this.resolveModel(d))throw new pe(400,`Model '${d}' is not supported.`,"invalid_request_error","model_not_found");if(u)await this.processStreamingGoogleGenerateContent(d,p,e,r,n,o);else try{let f=await this.processGoogleGenerateContent(d,p);this.logRequest(n,e.method,i.pathname,200,Date.now()-o,{requestPayload:p,responsePayload:f,tokensIn:f?.usageMetadata?.promptTokenCount,tokensOut:f?.usageMetadata?.candidatesTokenCount,model:d,requestHeaders:e.headers,responseHeaders:r.getHeaders()}),this.sendJson(r,200,f)}catch(f){let h=f instanceof pe?f:new pe(500,f.message||"Internal Server Error","server_error");this.sendJson(r,h.status,{error:{code:h.status,message:h.message,status:h.code||"INTERNAL"}})}return}throw e.method==="POST"&&i.pathname==="/v1/embeddings"?new pe(501,"Embeddings are not supported by Copilot.","not_implemented","embeddings_not_supported"):i.pathname.startsWith("/v1/images")?new pe(501,"Image generation is not supported by Copilot.","not_implemented","images_not_supported"):i.pathname.startsWith("/v1/audio")?new pe(501,"Audio processing is not supported by Copilot.","not_implemented","audio_not_supported"):new pe(404,`No route for ${e.method??"UNKNOWN"} ${i.pathname}`,"not_found")}async processStreamingGoogleGenerateContent(e,r,n,o,i,s){let a=[];if(r.systemInstruction){let p=r.systemInstruction.parts.map(f=>f.text).join(" ");a.push(A.LanguageModelChatMessage.User(this.redactPromptString(p)))}for(let p of r.contents){let f=p.role==="model"?A.LanguageModelChatMessageRole.Assistant:A.LanguageModelChatMessageRole.User,h=p.parts.map(y=>y.text).join(" "),m=this.redactPromptString(h);f===A.LanguageModelChatMessageRole.User?a.push(A.LanguageModelChatMessage.User(m)):a.push(A.LanguageModelChatMessage.Assistant(m))}let c=this.resolveModel(e),l=a.map(p=>typeof p.content=="string"?p.content:p.content.map(f=>"text"in f?f.text:"").join(" ")).join(`
`);o.writeHead(200,{"Content-Type":"application/json","X-HTTP-Content-Type-Options":"nosniff","Transfer-Encoding":"chunked"});let u="",d=new A.CancellationTokenSource;n.on("close",()=>{d.cancel(),console.log(`[Google] Client disconnected, cancelling request ${i||""}`)});try{let p=await A.lm.selectChatModels({vendor:"copilot"});if(!p||p.length===0)throw new pe(503,"No Copilot language model available.","service_unavailable","copilot_unavailable");let f=p[0],h=await f.sendRequest(a,{},d.token);o.write(`[
`);let m=!0;for await(let w of h.stream){if(d.token.isCancellationRequested)break;if(w instanceof A.LanguageModelTextPart){u+=w.value,m||o.write(`,
`);let $={candidates:[{content:{role:"model",parts:[{text:w.value}]},finishReason:"STOP",index:0}],usageMetadata:{promptTokenCount:0,candidatesTokenCount:0,totalTokenCount:0}};o.write(JSON.stringify($)),m=!1}}d.token.isCancellationRequested||(o.write(`
]
`),o.end());let y=0,v=0;try{y=await f.countTokens(l,d.token),v=await f.countTokens(u,d.token)}catch{}i&&this.logRequest(i,"POST",`/v1beta/models/${e}:streamGenerateContent`,200,Date.now()-(s||0),{requestPayload:r,responsePayload:{candidates:[{content:{parts:[{text:u}]}}]},tokensIn:y,tokensOut:v,model:c})}catch(p){if(d.token.isCancellationRequested)return;console.error("Google streaming error:",p);let f=p instanceof pe?p:new pe(500,p.message||"Internal Server Error","server_error");o.write(JSON.stringify({error:{code:f.status,message:f.message,status:f.code}})),o.end()}finally{d.dispose()}}async processStreamingAnthropicMessages(e,r,n,o,i){let s=[];e.system&&s.push(A.LanguageModelChatMessage.User(this.redactPromptString(e.system)));for(let f of e.messages){let h=f.role==="user"?A.LanguageModelChatMessageRole.User:A.LanguageModelChatMessageRole.Assistant,m=typeof f.content=="string"?f.content:f.content.map(v=>v.text).join(" "),y=this.redactPromptString(m);h===A.LanguageModelChatMessageRole.User?s.push(A.LanguageModelChatMessage.User(y)):s.push(A.LanguageModelChatMessage.Assistant(y))}let a=this.resolveModel(e.model),c=s.map(f=>typeof f.content=="string"?f.content:f.content.map(h=>"text"in h?h.text:"").join(" ")).join(`
`);n.writeHead(200,{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive","Access-Control-Allow-Origin":"*"});let l="ant-"+(0,Yr.randomUUID)(),u="",d=new A.CancellationTokenSource;r.on("close",()=>{d.cancel(),console.log(`[Anthropic] Client disconnected, cancelling request ${o||""}`)});let p=setInterval(()=>{n.writableEnded||n.write(`: ping

`)},15e3);try{let f=await A.lm.selectChatModels({vendor:"copilot"});if(!f||f.length===0)throw new pe(503,"No Copilot language model available.","service_unavailable","copilot_unavailable");let h=f[0],m=await h.sendRequest(s,{},d.token);n.write(`event: message_start
data: ${JSON.stringify({type:"message_start",message:{id:l,type:"message",role:"assistant",content:[],model:a,stop_reason:null,stop_sequence:null,usage:{input_tokens:0,output_tokens:0}}})}

`),n.write(`event: content_block_start
data: ${JSON.stringify({type:"content_block_start",index:0,content_block:{type:"text",text:""}})}

`);for await(let w of m.stream){if(d.token.isCancellationRequested)break;w instanceof A.LanguageModelTextPart&&(u+=w.value,n.write(`event: content_block_delta
data: ${JSON.stringify({type:"content_block_delta",index:0,delta:{type:"text_delta",text:w.value}})}

`))}d.token.isCancellationRequested||(n.write(`event: content_block_stop
data: ${JSON.stringify({type:"content_block_stop",index:0})}

`),n.write(`event: message_delta
data: ${JSON.stringify({type:"message_delta",delta:{stop_reason:"end_turn",stop_sequence:null},usage:{output_tokens:0}})}

`),n.write(`event: message_stop
data: ${JSON.stringify({type:"message_stop"})}

`),n.end());let y=0,v=0;try{y=await h.countTokens(c,d.token),v=await h.countTokens(u,d.token)}catch{}o&&this.logRequest(o,"POST","/v1/messages",200,Date.now()-(i||0),{requestPayload:e,responsePayload:{id:l,type:"message",content:[{type:"text",text:u}]},tokensIn:y,tokensOut:v,model:a})}catch(f){if(d.token.isCancellationRequested)return;console.error("Anthropic streaming error:",f);let h=f instanceof pe?f:new pe(500,f.message||"Internal Server Error","server_error");n.write(`event: error
data: ${JSON.stringify({type:"error",error:{type:h.code||"api_error",message:h.message}})}

`),n.end()}finally{clearInterval(p),d.dispose()}}async getAvailableModels(){let e=Math.floor(Date.now()/1e3);return(await A.lm.selectChatModels({vendor:"copilot"})).map(o=>({id:o.id,object:"model",created:e,owned_by:o.vendor||"github-copilot",name:o.name,family:o.family,version:o.version,max_input_tokens:o.maxInputTokens,capabilities:{chat_completion:!0,text_completion:!0,streaming:!0,token_counting:!0}}))}async processStreamingChatCompletion(e,r,n,o,i){let s=this.normalizeChatMessages(e);s=this.redactMessagesContent(s);let a=this.resolveModel(e?.model),c=this.normalizeTools(e?.tools||e?.functions),l=e?.tool_choice||e?.function_call,u=`chatcmpl-${(0,Yr.randomUUID)()}`,d=Math.floor(Date.now()/1e3),p="";n.writeHead(200,{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive","Access-Control-Allow-Origin":"*"});try{let f=await A.lm.selectChatModels({vendor:"copilot"});if(!f||f.length===0)throw new pe(503,"No Copilot language model available.","service_unavailable","copilot_unavailable");let h=f[0],m=[];for(let be of s){let et=typeof be.content=="string"?be.content:JSON.stringify(be.content);switch(be.role){case"system":m.push(A.LanguageModelChatMessage.User(`[System]: ${et}`));break;case"user":m.push(A.LanguageModelChatMessage.User(et));break;case"assistant":if(be.tool_calls&&be.tool_calls.length>0){let ar=be.tool_calls.map(Xr=>`[Called function: ${Xr.function?.name||Xr.name}(${Xr.function?.arguments||JSON.stringify(Xr.arguments)})]`).join(`
`);m.push(A.LanguageModelChatMessage.Assistant(ar))}else m.push(A.LanguageModelChatMessage.Assistant(et));break;case"tool":let Ge=`[Tool result for ${be.tool_call_id||"unknown"}]: ${et}`;m.push(A.LanguageModelChatMessage.User(Ge));break;default:m.push(A.LanguageModelChatMessage.User(et))}}let y={};c&&c.length>0&&(y.tools=c,l==="required"||l==="any"?y.toolMode=A.LanguageModelChatToolMode.Required:y.toolMode=A.LanguageModelChatToolMode.Auto);let v=await h.sendRequest(m,y,new A.CancellationTokenSource().token),w=[],$=0;for await(let be of v.stream)if(be instanceof A.LanguageModelTextPart){p+=be.value;let et={id:u,object:"chat.completion.chunk",created:d,model:a,choices:[{index:0,delta:{content:be.value},finish_reason:null}]};n.write(`data: ${JSON.stringify(et)}

`)}else if(be instanceof A.LanguageModelToolCallPart){let et=`call_${(0,Yr.randomUUID)().slice(0,24)}`,Ge=typeof be.input=="string"?be.input:JSON.stringify(be.input);w.push({id:et,name:be.name,arguments:Ge});let ar={id:u,object:"chat.completion.chunk",created:d,model:a,choices:[{index:0,delta:{tool_calls:[{index:$,id:et,type:"function",function:{name:be.name,arguments:Ge}}]},finish_reason:null}]};n.write(`data: ${JSON.stringify(ar)}

`),$++}let R=w.length>0?"tool_calls":"stop",P={id:u,object:"chat.completion.chunk",created:d,model:a,choices:[{index:0,delta:{},finish_reason:R}]};n.write(`data: ${JSON.stringify(P)}

`),n.write(`data: [DONE]

`),n.end();let ce=0,Te=0;try{let be=m.map(et=>typeof et.content=="string"?et.content:JSON.stringify(et.content)).join(`
`);ce=await h.countTokens(be,new A.CancellationTokenSource().token),Te=await h.countTokens(p,new A.CancellationTokenSource().token)}catch(be){console.error("Failed to count tokens:",be)}o&&i&&this.logRequest(o,"POST","/v1/chat/completions",200,Date.now()-i,{requestPayload:e,responsePayload:{streamed:!0,content_preview:p.slice(0,500),tool_calls:w},model:e?.model,requestHeaders:r.headers,responseHeaders:n.getHeaders(),tokensIn:ce,tokensOut:Te})}catch(f){let h={error:{message:f instanceof Error?f.message:"Unknown error",type:"server_error"}};n.write(`data: ${JSON.stringify(h)}

`),n.end(),o&&i&&this.logRequest(o,"POST","/v1/chat/completions",500,Date.now()-i,{requestPayload:e,error:f instanceof Error?f.message:String(f),model:e?.model,requestHeaders:r.headers})}}async processTokenize(e){let r=e?.text||e?.input||"",n=this.resolveModel(e?.model),o=await A.lm.selectChatModels({vendor:"copilot"});if(!o||o.length===0)throw new pe(503,"No Copilot language model available.","service_unavailable","copilot_unavailable");let s=await o[0].countTokens(r);return{object:"token_count",model:n,token_count:s,text_length:r.length}}async processResponsesApi(e){let r=e?.input,n=[];typeof r=="string"?n=[{role:"user",content:r}]:Array.isArray(r)&&(n=r.map(l=>typeof l=="string"?{role:"user",content:l}:{role:l.role||"user",content:typeof l.content=="string"?l.content:JSON.stringify(l.content)}));let o=this.composePrompt(n);o=this.redactPromptString(o);let i=this.resolveModel(e?.model),s=await this.runWithConcurrency(()=>this.invokeCopilot(o)),a=0,c=0;try{let l=await A.lm.selectChatModels({vendor:"copilot"});if(l&&l.length>0){let u=l[0];a=await u.countTokens(o),c=await u.countTokens(s||"")}}catch(l){console.error("Token counting failed:",l)}return{id:`resp-${(0,Yr.randomUUID)()}`,object:"response",created_at:Math.floor(Date.now()/1e3),model:i,output:[{type:"message",id:`msg-${(0,Yr.randomUUID)()}`,role:"assistant",content:[{type:"output_text",text:s}]}],usage:{prompt_tokens:a,completion_tokens:c,total_tokens:a+c}}}async processAnthropicMessages(e){let r=[];e.system&&r.push(A.LanguageModelChatMessage.User(this.redactPromptString(e.system)));for(let c of e.messages){let l=c.role==="user"?A.LanguageModelChatMessageRole.User:A.LanguageModelChatMessageRole.Assistant,u=typeof c.content=="string"?c.content:c.content.map(p=>p.text).join(" "),d=this.redactPromptString(u);l===A.LanguageModelChatMessageRole.User?r.push(A.LanguageModelChatMessage.User(d)):r.push(A.LanguageModelChatMessage.Assistant(d))}let n=this.resolveModel(e.model),o=r.map(c=>typeof c.content=="string"?c.content:c.content.map(l=>"text"in l?l.text:"").join(" ")).join(`
`),i=await this.runWithConcurrency(()=>this.invokeCopilot(o)),s=0,a=0;try{let c=r.map(u=>u.content).join(" "),l=await A.lm.selectChatModels({vendor:"copilot"});if(l&&l.length>0){let u=l[0];s=await u.countTokens(c),a=await u.countTokens(i||"")}}catch(c){console.error("Anthropic token counting failed:",c)}return{id:"ant-"+(0,Yr.randomUUID)(),type:"message",role:"assistant",content:[{type:"text",text:i||""}],model:n,stop_reason:"end_turn",stop_sequence:null,usage:{input_tokens:s,output_tokens:a}}}async processGoogleGenerateContent(e,r){let n=[];if(r.systemInstruction){let l=r.systemInstruction.parts.map(u=>u.text).join(" ");n.push(A.LanguageModelChatMessage.User(this.redactPromptString(l)))}for(let l of r.contents){let u=l.role==="model"?A.LanguageModelChatMessageRole.Assistant:A.LanguageModelChatMessageRole.User,d=l.parts.map(f=>f.text).join(" "),p=this.redactPromptString(d);u===A.LanguageModelChatMessageRole.User?n.push(A.LanguageModelChatMessage.User(p)):n.push(A.LanguageModelChatMessage.Assistant(p))}let o=this.resolveModel(e),i=n.map(l=>typeof l.content=="string"?l.content:l.content.map(u=>"text"in u?u.text:"").join(" ")).join(`
`),s=await this.runWithConcurrency(()=>this.invokeCopilot(i)),a=0,c=0;try{let l=n.map(d=>d.content).join(" "),u=await A.lm.selectChatModels({vendor:"copilot"});if(u&&u.length>0){let d=u[0];a=await d.countTokens(l),c=await d.countTokens(s||"")}}catch(l){console.error("Google token counting failed:",l)}return{candidates:[{content:{role:"model",parts:[{text:s||""}]},finishReason:"STOP",index:0}],usageMetadata:{promptTokenCount:a,candidatesTokenCount:c,totalTokenCount:a+c}}}async processChatCompletion(e,r){let n=this.normalizeChatMessages(e);n=this.injectSystemPrompt(n),n=this.redactMessagesContent(n);let o=this.resolveModel(e?.model),i=this.normalizeTools(e?.tools||e?.functions)||[],a=(await this.mcpService.getAllTools()).map(v=>({name:`mcp_${v.serverName}_${v.name}`,description:v.description||`Tool from MCP server ${v.serverName}`,inputSchema:v.inputSchema})),c=[...i,...a],l=e?.tool_choice||e?.function_call;if(e?.response_format?.type==="json_object"){let v=n.map(w=>w.role).lastIndexOf("user");if(v>=0){let w=n[v].content;n[v]={...n[v],content:`${w}

IMPORTANT: You MUST respond with valid JSON only.No markdown, no explanation, just pure JSON.`}}}let d=0,p=5,f;for(;d<p;){if(f=await this.runWithConcurrency(()=>this.invokeCopilotWithTools(n,c,l)),f.toolCalls&&f.toolCalls.length>0){let v=f.toolCalls.filter(w=>w.name.startsWith("mcp_"));if(v.length>0){n.push({role:"assistant",content:f.content||null,tool_calls:f.toolCalls.map(w=>({id:`call_${(0,Yr.randomUUID)().slice(0,24)}`,type:"function",function:{name:w.name,arguments:typeof w.arguments=="string"?w.arguments:JSON.stringify(w.arguments)}}))});for(let w of v){let $=w.name.split("_"),R=$[1],P=$.slice(2).join("_");try{let ce=await this.mcpService.callTool(R,P,w.arguments);n.push({role:"tool",tool_call_id:`call_${(0,Yr.randomUUID)().slice(0,24)}`,content:JSON.stringify(ce)})}catch(ce){n.push({role:"tool",tool_call_id:`call_${(0,Yr.randomUUID)().slice(0,24)}`,content:`Error executing MCP tool: ${ce.message}`})}}d++;continue}}break}let h=Math.floor(Date.now()/1e3),m=0,y=0;try{let v=await A.lm.selectChatModels({vendor:"copilot"});if(v&&v.length>0){let w=v[0],$=n.map(ce=>typeof ce.content=="string"?ce.content:JSON.stringify(ce.content)).join(`
`);m=await w.countTokens($);let R=f.content||"",P=f.toolCalls?JSON.stringify(f.toolCalls):"";y=await w.countTokens(R+P)}}catch(v){console.error("Token counting failed:",v)}return f.toolCalls&&f.toolCalls.length>0?{id:`chatcmpl- ${(0,Yr.randomUUID)()}`,object:"chat.completion",created:h,model:o,choices:[{index:0,message:{role:"assistant",content:f.content||null,tool_calls:f.toolCalls.map((v,w)=>({id:`call_${(0,Yr.randomUUID)().slice(0,24)}`,type:"function",function:{name:v.name,arguments:typeof v.arguments=="string"?v.arguments:JSON.stringify(v.arguments)}}))},finish_reason:"tool_calls"}],usage:{prompt_tokens:m,completion_tokens:y,total_tokens:m+y},system_fingerprint:null}:{id:`chatcmpl - ${(0,Yr.randomUUID)()}`,object:"chat.completion",created:h,model:o,choices:[{index:0,message:{role:"assistant",content:f.content},finish_reason:"stop"}],usage:{prompt_tokens:m,completion_tokens:y,total_tokens:m+y},system_fingerprint:null}}normalizeTools(e){if(!(!e||!Array.isArray(e)||e.length===0))return e.map(r=>{let n=r.type==="function"?r.function:r;return{name:n.name,description:n.description||"",inputSchema:n.parameters||n.inputSchema||void 0}})}async invokeCopilotWithTools(e,r,n){let o=await this.getCopilotHealth();if(!o.installed)throw new pe(503,"GitHub Copilot extension is not installed.","service_unavailable","copilot_not_installed");if(!o.chatInstalled)throw new pe(503,"GitHub Copilot Chat extension is not installed.","service_unavailable","copilot_chat_not_installed");if(!o.signedIn)throw new pe(401,"Not signed in to GitHub Copilot. Please sign in in VS Code.","unauthorized","copilot_not_signed_in");let i=await A.lm.selectChatModels({vendor:"copilot"});if(!i||i.length===0)throw new pe(503,"No Copilot language model available.","service_unavailable","copilot_unavailable");let s=i[0],a=[];for(let d of e){let p=typeof d.content=="string"?d.content:JSON.stringify(d.content);switch(d.role){case"system":a.push(A.LanguageModelChatMessage.User(`[System]: ${p}`));break;case"user":a.push(A.LanguageModelChatMessage.User(p));break;case"assistant":if(d.tool_calls&&d.tool_calls.length>0){let h=d.tool_calls.map(m=>`[Called function: $ { tc.function?.name || tc.name }(${m.function?.arguments||JSON.stringify(m.arguments)})]`).join(`
`);a.push(A.LanguageModelChatMessage.Assistant(h))}else a.push(A.LanguageModelChatMessage.Assistant(p));break;case"tool":let f=`[Tool result for ${d.tool_call_id||"unknown"}]: ${p} `;a.push(A.LanguageModelChatMessage.User(f));break;default:a.push(A.LanguageModelChatMessage.User(p))}}let c={};r&&r.length>0&&(c.tools=r,n==="required"||n==="any"?c.toolMode=A.LanguageModelChatToolMode.Required:c.toolMode=A.LanguageModelChatToolMode.Auto);let l=new A.CancellationTokenSource,u=setTimeout(()=>l.cancel(),(this.config.requestTimeoutSeconds||180)*1e3);try{let d=await s.sendRequest(a,c,l.token),p="",f=[];for await(let h of d.stream){if(l.token.isCancellationRequested)throw new pe(504,"Request timed out waiting for Copilot response.","gateway_timeout","request_timeout");h instanceof A.LanguageModelTextPart?p+=h.value:h instanceof A.LanguageModelToolCallPart&&f.push({name:h.name,arguments:h.input})}return{content:p.trim(),toolCalls:f.length>0?f:void 0}}catch(d){throw d instanceof pe?d:l.token.isCancellationRequested?new pe(504,"Request timed out waiting for Copilot response.","gateway_timeout","request_timeout"):new pe(502,`Failed to retrieve Copilot response: ${Ll(d)} `,"bad_gateway","command_failed",{cause:d})}finally{clearTimeout(u),l.dispose()}}async processCompletion(e){let r=this.normalizePromptInput(e?.prompt);if(!r)throw new pe(400,"prompt is required","invalid_request_error","missing_prompt");r=this.redactPromptString(r);let n=this.resolveModel(e?.model),o=await this.runWithConcurrency(()=>this.invokeCopilot(r)),i=Math.floor(Date.now()/1e3),s=0,a=0;try{let c=await A.lm.selectChatModels({vendor:"copilot"});if(c&&c.length>0){let l=c[0],u=r;s=await l.countTokens(u);let d=o||"";a=await l.countTokens(d)}}catch(c){console.error("Token counting failed:",c)}return{id:`cmpl - ${(0,Yr.randomUUID)()} `,object:"text_completion",created:i,model:n,choices:[{index:0,text:o,finish_reason:"stop",logprobs:null}],usage:{prompt_tokens:s,completion_tokens:a,total_tokens:s+a}}}async handleWebSocketMessage(e,r){let n=typeof r=="string"?r:r.toString("utf8"),o;try{o=JSON.parse(n)}catch{throw new pe(400,"WebSocket payload must be valid JSON.","invalid_request_error","invalid_json")}let i=o?.type??o?.event??o?.action;if(i==="ping"){e.send(JSON.stringify({type:"pong",timestamp:Date.now()}));return}if(!i||i==="chat.completions.create"){let s=o?.data??o?.request??o,a=await this.processChatCompletion(s,{source:"websocket",endpoint:"/v1/chat/completions"});e.send(JSON.stringify({type:"chat.completion.result",data:a}));return}if(i==="completions.create"){let s=o?.data??o?.request??o,a=await this.processCompletion(s);e.send(JSON.stringify({type:"completion.result",data:a}));return}throw new pe(400,`Unsupported message type: ${i} `,"invalid_request_error","unsupported_ws_message")}handleWebSocketConnection(e){e.send(JSON.stringify({type:"session.created",session:{id:(0,Yr.randomUUID)(),model:this.config.defaultModel,created:Math.floor(Date.now()/1e3)}})),e.on("message",r=>{this.handleWebSocketMessage(e,r).catch(n=>{n instanceof pe?this.sendWsError(e,n):(this.logError("Unhandled WebSocket error",n),this.sendWsError(e,new pe(500,"An unexpected error occurred.","server_error")))})}),e.on("error",r=>{this.logError("WebSocket client error",r)})}async runWithConcurrency(e){if(this.activeRequests>=this.config.maxConcurrentRequests)throw new pe(429,"Too many concurrent requests. Try again shortly.","rate_limit_exceeded","concurrency_limit");this.activeRequests+=1;try{return await e()}finally{this.activeRequests-=1}}async invokeCopilot(e){let r=await A.lm.selectChatModels({vendor:"copilot"});if(!r||r.length===0)throw new pe(503,"No Copilot language model available. Make sure GitHub Copilot is installed and signed in.","service_unavailable","copilot_unavailable");let n=r[0],o=[A.LanguageModelChatMessage.User(e)],i=new A.CancellationTokenSource,s=setTimeout(()=>i.cancel(),(this.config.requestTimeoutSeconds||180)*1e3);try{let a=await n.sendRequest(o,{},i.token),c="";for await(let l of a.text){if(i.token.isCancellationRequested)throw new pe(504,"Request timed out waiting for Copilot response.","gateway_timeout","request_timeout");c+=l}if(!c.trim())throw new pe(502,"Copilot did not return any content.","bad_gateway","empty_response");return c.trim()}catch(a){throw a instanceof pe?a:i.token.isCancellationRequested?new pe(504,"Request timed out waiting for Copilot response.","gateway_timeout","request_timeout"):new pe(502,`Failed to retrieve Copilot response: ${Ll(a)} `,"bad_gateway","command_failed",{cause:a})}finally{clearTimeout(s),i.dispose()}}extractTextFromChatResult(e){if(e){if(typeof e=="string")return e.trim()||void 0;if(Array.isArray(e))return e.map(r=>typeof r=="string"?r:"").join(" ").trim()||void 0;if(typeof e=="object"){let r=e,n=r.response??r.result??r.body;if(typeof n=="string")return n.trim()||void 0;if(n&&typeof n=="object"){let o=n.text??n.message;if(typeof o=="string"&&o.trim())return o.trim();let i=n.responseContent;if(Array.isArray(i)){let s=i.map(a=>typeof a=="string"?a:a&&typeof a=="object"&&typeof a.text=="string"?String(a.text):"").join("").trim();if(s)return s}}if(Array.isArray(r.choices)&&r.choices.length>0){let o=r.choices[0];if(typeof o?.text=="string"&&o.text.trim())return o.text.trim();let i=o?.message;if(i&&typeof i.content=="string"&&i.content.trim())return i.content.trim()}}}}normalizeChatMessages(e){let r=e?.messages;if(Array.isArray(r)&&r.length>0)return r.map((o,i)=>({role:typeof o?.role=="string"?o.role:i===r.length-1?"user":"system",content:o?.content,tool_calls:o?.tool_calls,tool_call_id:o?.tool_call_id}));let n=this.normalizePromptInput(e?.prompt??e?.input);if(n)return[{role:"user",content:n}];throw new pe(400,"messages must be a non-empty array or prompt must be provided.","invalid_request_error","missing_messages")}normalizePromptInput(e){if(typeof e=="string")return e.trim()||void 0;if(Array.isArray(e))return e.map(n=>typeof n=="string"?n:"").join(`
`).trim()||void 0}composePrompt(e){return e.map(({role:r,content:n})=>{let o=r||"user",i=this.flattenMessageContent(n);return`[${o}]
${i} `}).join(`

`)}flattenMessageContent(e){return typeof e=="string"?e:e==null?"":Array.isArray(e)?e.map(r=>typeof r=="string"?r:r&&typeof r=="object"&&typeof r.text=="string"?String(r.text):"").join(`
`):String(e)}resolveModel(e){if(typeof e=="string"&&e.trim()){let r=e.trim().toLowerCase(),n=Ihe[r];return n||e.trim()}return this.config.defaultModel}injectSystemPrompt(e){return!this.config.defaultSystemPrompt||e.some(n=>n.role==="system")?e:[{role:"system",content:this.config.defaultSystemPrompt},...e]}async readJsonBody(e){let r=[],n=0;if(await new Promise((i,s)=>{e.on("data",a=>{let c=typeof a=="string"?Buffer.from(a):a;n+=c.length;let l=(this.config.maxPayloadSizeMb||1)*1024*1024;if(n>l){e.destroy(),s(new pe(413,`Request body too large.Maximum size is ${Math.round(l/1024)} KB.`,"invalid_request_error","payload_too_large"));return}r.push(c)}),e.on("end",()=>i()),e.on("error",a=>s(a))}),r.length===0)return{};let o=Buffer.concat(r).toString("utf8");if(!o.trim())return{};try{return JSON.parse(o)}catch(i){throw new pe(400,"Request body must be valid JSON.","invalid_request_error","invalid_json",{cause:i})}}sendJson(e,r,n){e.headersSent||(e.statusCode=r,e.setHeader("Content-Type","application/json")),e.end(JSON.stringify(n))}sendSwaggerUi(e){let r=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot API - Swagger UI</title>
    <link rel="stylesheet" href="/swagger-ui/swagger-ui.css">
    <style>
        body { margin: 0; background: #fafafa; }
        .swagger-ui .topbar { display: none; }
        .swagger-ui .info { margin: 30px 0; }
        .swagger-ui .info .title { font-size: 2em; }
    </style>
</head>
<body>
    <div id="swagger-ui"></div>
    <script src="/swagger-ui/swagger-ui-bundle.js"></script>
    <script src="/swagger-ui/swagger-ui-standalone-preset.js"></script>
    <script>
        window.onload = function() {
            SwaggerUIBundle({
                url: '/openapi.json',
                dom_id: '#swagger-ui',
                presets: [SwaggerUIBundle.presets.apis, SwaggerUIBundle.SwaggerUIStandalonePreset],
                layout: 'BaseLayout',
                deepLinking: true,
                showExtensions: true,
                showCommonExtensions: true
            });
        };
    </script>
</body>
</html>`;e.statusCode=200,e.setHeader("Content-Type","text/html"),e.end(r)}serveStaticFile(e,r,n){let o=qr.basename(n),i=[];if(this.context)try{i.push(this.context.asAbsolutePath(qr.join("dist","swagger-ui",o)))}catch{}i.push(qr.join(__dirname,"swagger-ui",o),qr.join(__dirname,"..","swagger-ui",o),qr.join(__dirname,"dist","swagger-ui",o));let s="";for(let a of i)if(_r.existsSync(a)){s=a;break}if(s){let a=_r.statSync(s),c=qr.extname(s),l="text/plain";c===".css"?l="text/css":c===".js"&&(l="application/javascript"),r.writeHead(200,{"Content-Type":l,"Content-Length":a.size}),_r.createReadStream(s).pipe(r)}else{let a=`[Static] File not found: ${o}. Checked: ${JSON.stringify(i)}`;if(console.error(a),this.output.appendLine(`[${new Date().toISOString()}] ERROR ${a}`),this.context)try{let c=this.context.asAbsolutePath(qr.join("dist","swagger-ui"));_r.existsSync(c)?this.output.appendLine(`Contents of ${c}: ${_r.readdirSync(c).join(", ")}`):this.output.appendLine(`Directory not found: ${c}`)}catch(c){this.output.appendLine(`Error listing directory: ${c}`)}r.statusCode=404,r.end("Not found")}}sendDebugPaths(e){let r={dirname:__dirname,cwd:process.cwd(),contextExtensionUri:this.context?.extensionUri.fsPath??"undefined",candidates_css:[],dist_swagger_contents:"N/A"},n="swagger-ui.css",o=[];if(this.context)try{let i=this.context.asAbsolutePath(qr.join("dist","swagger-ui",n)),s=qr.dirname(i),a="N/A";_r.existsSync(s)&&(a=_r.readdirSync(s).join(", ")),o.push({type:"context.asAbsolutePath",path:i,exists:_r.existsSync(i),dir_exists:_r.existsSync(s),dir_contents:a}),r.dist_swagger_contents=a}catch(i){o.push({error:String(i)})}o.push({type:"fallback_dirname",path:qr.join(__dirname,"swagger-ui",n),exists:_r.existsSync(qr.join(__dirname,"swagger-ui",n))}),r.candidates_css=o,e.statusCode=200,e.setHeader("Content-Type","application/json"),e.end(JSON.stringify(r,null,2))}getOpenApiSpec(){let e=`http://${this.config.host}:${this.config.port}`;return{openapi:"3.1.0",info:{title:"Copilot API Gateway",description:"Local OpenAI-compatible API server powered by GitHub Copilot. Provides REST and WebSocket endpoints for chat completions, text completions, tokenization, and more.",version:"1.0.0",contact:{name:"GitHub Copilot API VS Code Extension"},license:{name:"MIT"}},servers:[{url:e,description:"Local Copilot API Server"}],tags:[{name:"Chat",description:"Chat completion endpoints"},{name:"Completions",description:"Text completion endpoints"},{name:"Anthropic",description:"Anthropic Messages API compatible endpoints"},{name:"Google",description:"Google Generative AI API compatible endpoints"},{name:"Models",description:"Model information"},{name:"Utilities",description:"Utility endpoints"}],paths:{"/v1/chat/completions":{post:{tags:["Chat"],summary:"Create chat completion",description:"Creates a chat completion for the given messages. Supports streaming, function calling (tools), JSON mode, and more.",operationId:"createChatCompletion",requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/ChatCompletionRequest"},examples:{basic:{summary:"Basic chat",value:{model:this.config.defaultModel,messages:[{role:"user",content:"Hello!"}]}},streaming:{summary:"Streaming response",value:{model:this.config.defaultModel,messages:[{role:"user",content:"Tell me a story"}],stream:!0}},tools:{summary:"With tools/functions",value:{model:this.config.defaultModel,messages:[{role:"user",content:"What is the weather?"}],tools:[{type:"function",function:{name:"get_weather",description:"Get weather for a location",parameters:{type:"object",properties:{location:{type:"string"}},required:["location"]}}}]}}}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{$ref:"#/components/schemas/ChatCompletionResponse"}},"text/event-stream":{description:"Server-sent events for streaming responses"}}},400:{description:"Bad request",content:{"application/json":{schema:{$ref:"#/components/schemas/Error"}}}},401:{description:"Unauthorized",content:{"application/json":{schema:{$ref:"#/components/schemas/Error"}}}},429:{description:"Rate limited",content:{"application/json":{schema:{$ref:"#/components/schemas/Error"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/completions":{post:{tags:["Completions"],summary:"Create text completion",description:"Creates a text completion for the given prompt.",operationId:"createCompletion",requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/CompletionRequest"},example:{model:this.config.defaultModel,prompt:"Once upon a time",max_tokens:100}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{$ref:"#/components/schemas/CompletionResponse"}}}},400:{description:"Bad request"},401:{description:"Unauthorized"}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/responses":{post:{tags:["Chat"],summary:"Create response (simplified API)",description:"Simplified OpenAI Responses API format for easier integration.",operationId:"createResponse",requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/ResponsesRequest"},example:{model:this.config.defaultModel,input:"What is 2+2?"}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{$ref:"#/components/schemas/ResponsesResponse"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/models":{get:{tags:["Models"],summary:"List models",description:"Lists all available models from GitHub Copilot.",operationId:"listModels",responses:{200:{description:"List of models",content:{"application/json":{schema:{$ref:"#/components/schemas/ModelList"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/models/{model_id}":{get:{tags:["Models"],summary:"Get model",description:"Retrieves details about a specific model.",operationId:"getModel",parameters:[{name:"model_id",in:"path",required:!0,schema:{type:"string"},description:"The ID of the model"}],responses:{200:{description:"Model details",content:{"application/json":{schema:{$ref:"#/components/schemas/Model"}}}},404:{description:"Model not found"}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/tokenize":{post:{tags:["Utilities"],summary:"Count tokens",description:"Counts the number of tokens in the given text.",operationId:"tokenize",requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/TokenizeRequest"},example:{model:this.config.defaultModel,text:"Hello, world!"}}}},responses:{200:{description:"Token count",content:{"application/json":{schema:{$ref:"#/components/schemas/TokenizeResponse"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/usage":{get:{tags:["Utilities"],summary:"Get usage statistics",description:"Returns usage statistics including request counts, token usage, and uptime.",operationId:"getUsage",responses:{200:{description:"Usage statistics",content:{"application/json":{schema:{$ref:"#/components/schemas/UsageResponse"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1/messages":{post:{tags:["Anthropic"],summary:"Anthropic Messages API",description:"Create a message using the Anthropic-compatible API format.",operationId:"anthropicMessages",requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/AnthropicMessageRequest"}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{$ref:"#/components/schemas/AnthropicMessageResponse"}},"text/event-stream":{description:"Anthropic-style event stream"}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1beta/models/{model}:generateContent":{post:{tags:["Google"],summary:"Google Generative AI generateContent",description:"Generate content using the Google-compatible API format.",operationId:"googleGenerateContent",parameters:[{name:"model",in:"path",required:!0,schema:{type:"string"}}],requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/GoogleGenerateContentRequest"}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{$ref:"#/components/schemas/GoogleGenerateContentResponse"}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/v1beta/models/{model}:streamGenerateContent":{post:{tags:["Google"],summary:"Google Generative AI streamGenerateContent",description:"Stream content generation using the Google-compatible API format.",operationId:"googleStreamGenerateContent",parameters:[{name:"model",in:"path",required:!0,schema:{type:"string"}}],requestBody:{required:!0,content:{"application/json":{schema:{$ref:"#/components/schemas/GoogleGenerateContentRequest"}}}},responses:{200:{description:"Successful response",content:{"application/json":{schema:{type:"array",items:{$ref:"#/components/schemas/GoogleGenerateContentResponse"}}}}}},security:this.config.apiKey?[{bearerAuth:[]}]:[]}},"/health":{get:{tags:["Utilities"],summary:"Health check",description:"Simple health check endpoint for monitoring.",operationId:"healthCheck",responses:{200:{description:"Service is healthy",content:{"application/json":{schema:{type:"object",properties:{status:{type:"string",example:"ok"},service:{type:"string",example:"github-copilot-api-vscode"}}}}}}}}}},components:{securitySchemes:{bearerAuth:{type:"http",scheme:"bearer",description:"API key authentication (optional, configure in extension settings)"}},schemas:{ChatCompletionRequest:{type:"object",required:["model","messages"],properties:{model:{type:"string",description:"Model ID to use",example:this.config.defaultModel},messages:{type:"array",items:{$ref:"#/components/schemas/Message"},description:"List of messages in the conversation"},stream:{type:"boolean",default:!1,description:"Enable streaming responses"},temperature:{type:"number",minimum:0,maximum:2,description:"Sampling temperature"},max_tokens:{type:"integer",description:"Maximum tokens to generate"},tools:{type:"array",items:{$ref:"#/components/schemas/Tool"},description:"List of tools/functions available"},tool_choice:{type:"string",description:"How to select tools: auto, none, or specific"},response_format:{type:"object",properties:{type:{type:"string",enum:["text","json_object"]}},description:"Response format (json_object for JSON mode)"}}},Message:{type:"object",required:["role","content"],properties:{role:{type:"string",enum:["system","user","assistant","tool"],description:"Role of the message sender"},content:{type:"string",description:"Message content"},name:{type:"string",description:"Name of the sender (optional)"},tool_calls:{type:"array",items:{$ref:"#/components/schemas/ToolCall"}},tool_call_id:{type:"string",description:"ID of tool call this message responds to"}}},Tool:{type:"object",required:["type","function"],properties:{type:{type:"string",enum:["function"]},function:{type:"object",required:["name"],properties:{name:{type:"string"},description:{type:"string"},parameters:{type:"object",description:"JSON Schema for function parameters"}}}}},ToolCall:{type:"object",properties:{id:{type:"string"},type:{type:"string",enum:["function"]},function:{type:"object",properties:{name:{type:"string"},arguments:{type:"string"}}}}},ChatCompletionResponse:{type:"object",properties:{id:{type:"string"},object:{type:"string",example:"chat.completion"},created:{type:"integer"},model:{type:"string"},choices:{type:"array",items:{type:"object",properties:{index:{type:"integer"},message:{$ref:"#/components/schemas/Message"},finish_reason:{type:"string",enum:["stop","length","tool_calls"]}}}},usage:{$ref:"#/components/schemas/Usage"}}},CompletionRequest:{type:"object",required:["model","prompt"],properties:{model:{type:"string"},prompt:{type:"string",description:"Text prompt to complete"},max_tokens:{type:"integer",default:100},temperature:{type:"number"}}},CompletionResponse:{type:"object",properties:{id:{type:"string"},object:{type:"string",example:"text_completion"},created:{type:"integer"},model:{type:"string"},choices:{type:"array",items:{type:"object",properties:{text:{type:"string"},index:{type:"integer"},finish_reason:{type:"string"}}}},usage:{$ref:"#/components/schemas/Usage"}}},ResponsesRequest:{type:"object",required:["input"],properties:{model:{type:"string"},input:{type:"string",description:"User input/question"},instructions:{type:"string",description:"System instructions"}}},ResponsesResponse:{type:"object",properties:{id:{type:"string"},object:{type:"string"},created_at:{type:"integer"},output:{type:"array",items:{type:"object",properties:{type:{type:"string"},content:{type:"array",items:{type:"object",properties:{type:{type:"string"},text:{type:"string"}}}}}}},usage:{$ref:"#/components/schemas/Usage"}}},TokenizeRequest:{type:"object",required:["text"],properties:{model:{type:"string"},text:{type:"string",description:"Text to tokenize"}}},TokenizeResponse:{type:"object",properties:{model:{type:"string"},token_count:{type:"integer"}}},ModelList:{type:"object",properties:{object:{type:"string",example:"list"},data:{type:"array",items:{$ref:"#/components/schemas/Model"}}}},Model:{type:"object",properties:{id:{type:"string"},object:{type:"string",example:"model"},created:{type:"integer"},owned_by:{type:"string"}}},UsageResponse:{type:"object",properties:{object:{type:"string",example:"usage"},total_requests:{type:"integer"},total_tokens:{type:"object",properties:{input:{type:"integer"},output:{type:"integer"},total:{type:"integer"}}},uptime_seconds:{type:"integer"},active_requests:{type:"integer"}}},Usage:{type:"object",properties:{prompt_tokens:{type:"integer"},completion_tokens:{type:"integer"},total_tokens:{type:"integer"}}},Error:{type:"object",properties:{error:{type:"object",properties:{message:{type:"string"},type:{type:"string"},code:{type:"string"}}}}},AnthropicMessageRequest:{type:"object",required:["model","messages"],properties:{model:{type:"string"},messages:{type:"array",items:{type:"object",required:["role","content"],properties:{role:{type:"string",enum:["user","assistant"]},content:{type:"string"}}}},system:{type:"string"},max_tokens:{type:"integer"},stream:{type:"boolean"}}},AnthropicMessageResponse:{type:"object",properties:{id:{type:"string"},type:{type:"string",example:"message"},role:{type:"string",example:"assistant"},content:{type:"array",items:{type:"object",properties:{type:{type:"string",example:"text"},text:{type:"string"}}}},model:{type:"string"},stop_reason:{type:"string"},usage:{type:"object",properties:{input_tokens:{type:"integer"},output_tokens:{type:"integer"}}}}},GoogleGenerateContentRequest:{type:"object",required:["contents"],properties:{contents:{type:"array",items:{type:"object",required:["parts"],properties:{role:{type:"string",enum:["user","model"]},parts:{type:"array",items:{type:"object",properties:{text:{type:"string"}}}}}}},systemInstruction:{type:"object",properties:{parts:{type:"array",items:{type:"object",properties:{text:{type:"string"}}}}}},generationConfig:{type:"object"}}},GoogleGenerateContentResponse:{type:"object",properties:{candidates:{type:"array",items:{type:"object",properties:{content:{type:"object",properties:{role:{type:"string"},parts:{type:"array",items:{type:"object",properties:{text:{type:"string"}}}}}},finishReason:{type:"string"}}}},usageMetadata:{type:"object",properties:{promptTokenCount:{type:"integer"},candidatesTokenCount:{type:"integer"},totalTokenCount:{type:"integer"}}}}}}}}}sendError(e,r){let n=r.status??500,o={error:{message:r.message,type:r.type,code:r.code??null,param:null}};this.sendJson(e,n,o)}sendWsError(e,r){e.send(JSON.stringify({type:"error",error:{message:r.message,type:r.type,code:r.code??null}}))}setCorsHeaders(e){e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Headers","authorization, content-type, x-requested-with"),e.setHeader("Access-Control-Allow-Methods","GET,POST,OPTIONS")}checkRateLimit(){if(this.config.rateLimitPerMinute<=0)return!0;let e=Date.now(),r=e-6e4;return this.rateLimitBucket=this.rateLimitBucket.filter(n=>n>r),this.rateLimitBucket.length>=this.config.rateLimitPerMinute?!1:(this.rateLimitBucket.push(e),!0)}getClientIp(e){let r=e.headers["x-forwarded-for"];if(r){let i=(typeof r=="string"?r:r[0])?.split(",")[0]?.trim();if(i)return i}let n=e.socket.remoteAddress||"unknown";return n.startsWith("::ffff:")?n.substring(7):n}checkIpAllowlist(e){let r=this.config.ipAllowlist;if(!r||r.length===0)return!0;let n=e.socket.remoteAddress;if(!n)return!1;let o=n.startsWith("::ffff:")?n.substring(7):n;for(let i of r)if(i.includes("/")){if(this.isIpInCidr(o,i))return!0}else if(/^[\d\.]+$|^[\da-fA-F:]+$/.test(i)){if(i===o)return!0}else{let s=this.domainCache.get(i);if(s&&s.includes(o))return!0}return!1}async refreshDomainCache(){let e=await import("dns").then(r=>r.promises);for(let r of this.config.ipAllowlist)if(/[a-zA-Z]/.test(r)&&!r.includes("/"))try{let n=await e.resolve4(r).catch(()=>[]),o=await e.resolve6(r).catch(()=>[]),i=[...n,...o];i.length>0&&this.domainCache.set(r,i)}catch{}}isIpInCidr(e,r){try{let[n,o]=r.split("/"),i=~(2**(32-parseInt(o,10))-1),s=e.split(".").map(Number),a=n.split(".").map(Number),c=s[0]<<24|s[1]<<16|s[2]<<8|s[3],l=a[0]<<24|a[1]<<16|a[2]<<8|a[3];return(c&i)===(l&i)}catch{return!1}}logRequest(e,r,n,o,i,s){let a=o>=400,c=s?.tokensIn??0,l=s?.tokensOut??0;this.recordRequestStats(i,c,l,a);let u={timestamp:new Date().toISOString(),requestId:e,method:r,path:n,status:o,durationMs:i,tokensIn:s?.tokensIn,tokensOut:s?.tokensOut,error:s?.error,model:s?.model,requestBody:s?.requestPayload,responseBody:s?.responsePayload,requestHeaders:s?.requestHeaders,responseHeaders:s?.responseHeaders},d=this.redactSensitiveData(u);if(this.auditService.logRequest(d),this._onDidLogRequest.fire(d),this.wsServer){let p=JSON.stringify({type:"log",data:d});this.wsServer.clients.forEach(f=>{f.readyState===1&&f.send(p)})}if(this.config.enableLogging){let p=a?"\u274C":o>=300?"\u26A0\uFE0F":"\u2705";this.output.appendLine(`[${new Date().toLocaleTimeString()}] ${p} ${r} ${n} ${o} (${i}ms)`),s?.error&&this.output.appendLine(`  Error: ${s.error}`)}}getCacheKey(e){return JSON.stringify({model:e?.model,messages:e?.messages,prompt:e?.prompt,tools:e?.tools,stream:e?.stream})}getFromCache(e){let r=this.requestCache.get(e);if(r&&Date.now()-r.timestamp<this.CACHE_TTL_MS)return r.response;this.requestCache.delete(e)}setCache(e,r){if(this.requestCache.size>100){let n=Date.now();for(let[o,i]of this.requestCache.entries())n-i.timestamp>this.CACHE_TTL_MS&&this.requestCache.delete(o)}this.requestCache.set(e,{response:r,timestamp:Date.now()})}buildUrl(e){let r=`http://${this.config.host}:${this.config.port}`;return new URL(e??"/",r)}async updateServerConfig(e){this.config={...this.config,...e},this._onDidChangeStatus.fire();let r=A.workspace.getConfiguration("githubCopilotApi"),n=[];e.enabled!==void 0&&n.push(Promise.resolve(r.update("server.enabled",e.enabled,A.ConfigurationTarget.Global))),e.enableHttp!==void 0&&n.push(Promise.resolve(r.update("server.enableHttp",e.enableHttp,A.ConfigurationTarget.Global))),e.enableWebSocket!==void 0&&n.push(Promise.resolve(r.update("server.enableWebSocket",e.enableWebSocket,A.ConfigurationTarget.Global))),e.enableHttps!==void 0&&n.push(Promise.resolve(r.update("server.enableHttps",e.enableHttps,A.ConfigurationTarget.Global))),e.host!==void 0&&n.push(Promise.resolve(r.update("server.host",e.host,A.ConfigurationTarget.Global))),e.port!==void 0&&n.push(Promise.resolve(r.update("server.port",e.port,A.ConfigurationTarget.Global))),e.maxConcurrentRequests!==void 0&&n.push(Promise.resolve(r.update("server.maxConcurrentRequests",e.maxConcurrentRequests,A.ConfigurationTarget.Global))),e.defaultModel!==void 0&&n.push(Promise.resolve(r.update("server.defaultModel",e.defaultModel,A.ConfigurationTarget.Global))),e.enableLogging!==void 0&&n.push(Promise.resolve(r.update("server.enableLogging",e.enableLogging,A.ConfigurationTarget.Global))),e.apiKey!==void 0&&n.push(Promise.resolve(r.update("server.apiKey",e.apiKey,A.ConfigurationTarget.Global))),e.rateLimitPerMinute!==void 0&&n.push(Promise.resolve(r.update("server.rateLimitPerMinute",e.rateLimitPerMinute,A.ConfigurationTarget.Global))),e.requestTimeoutSeconds!==void 0&&n.push(Promise.resolve(r.update("server.requestTimeoutSeconds",e.requestTimeoutSeconds,A.ConfigurationTarget.Global))),e.maxPayloadSizeMb!==void 0&&n.push(Promise.resolve(r.update("server.maxPayloadSizeMb",e.maxPayloadSizeMb,A.ConfigurationTarget.Global))),e.maxConnectionsPerIp!==void 0&&n.push(Promise.resolve(r.update("server.maxConnectionsPerIp",e.maxConnectionsPerIp,A.ConfigurationTarget.Global))),e.redactionPatterns!==void 0&&n.push(Promise.resolve(r.update("server.redactionPatterns",e.redactionPatterns,A.ConfigurationTarget.Global))),e.ipAllowlist!==void 0&&n.push(Promise.resolve(r.update("server.ipAllowlist",e.ipAllowlist,A.ConfigurationTarget.Global))),this.suppressRestart=!0;try{await Promise.all(n)}finally{this.suppressRestart=!1}await this.restart()}updateStatusBar(e,r){let n=`${this.config.enableHttp?"HTTP":""}${this.config.enableHttp&&this.config.enableWebSocket?"+":""}${this.config.enableWebSocket?"WS":""}`||"disabled";if(e==="starting"){this.statusItem.text="$(broadcast) Copilot API: Starting\u2026",this.statusItem.tooltip="Starting Copilot API gateway",this.statusItem.show();return}if(e==="running"){this.statusItem.text=`$(broadcast) Copilot API: On (${n})`;let o=`${this.config.host}:${this.config.port}`;this.statusItem.tooltip=r||`Copilot API is running on ${o}`,this.statusItem.show();return}this.statusItem.text="$(broadcast) Copilot API: Off",this.statusItem.tooltip=r??"Copilot API gateway is stopped",this.statusItem.hide()}async showControlPalette(){let e=A.workspace.getConfiguration("githubCopilotApi"),r=[{label:"$(check) Start HTTP + WebSocket",description:"Enable and start all endpoints"},{label:"$(primitive-square) Stop Server",description:"Disable all endpoints"},{label:`${this.config.enableHttp?"$(circle-slash)":"$(play)"} Toggle HTTP`,description:this.config.enableHttp?"Disable HTTP REST endpoints":"Enable HTTP REST endpoints"},{label:`${this.config.enableWebSocket?"$(circle-slash)":"$(play)"} Toggle WebSocket`,description:this.config.enableWebSocket?"Disable WebSocket realtime endpoint":"Enable WebSocket realtime endpoint"},{label:"$(globe) Listen on localhost",description:"Bind to 127.0.0.1"},{label:"$(rss) Listen on all interfaces",description:"Bind to 0.0.0.0 for LAN access"},{label:"$(plug) Change port",description:`Current: ${this.config.port}`},{label:"$(settings) Open settings",description:"Open Copilot API settings"}],n=await A.window.showQuickPick(r,{placeHolder:"Copilot API controls"});if(n){if(n.label.includes("Start")){await e.update("server.enabled",!0,A.ConfigurationTarget.Global),await e.update("server.enableHttp",!0,A.ConfigurationTarget.Global),await e.update("server.enableWebSocket",!0,A.ConfigurationTarget.Global);return}if(n.label.includes("Stop")){await e.update("server.enabled",!1,A.ConfigurationTarget.Global);return}if(n.label.includes("Toggle HTTP")){await e.update("server.enableHttp",!this.config.enableHttp,A.ConfigurationTarget.Global),await e.update("server.enabled",!0,A.ConfigurationTarget.Global);return}if(n.label.includes("Toggle WebSocket")){await e.update("server.enableWebSocket",!this.config.enableWebSocket,A.ConfigurationTarget.Global),await e.update("server.enabled",!0,A.ConfigurationTarget.Global);return}if(n.label.includes("localhost")){await e.update("server.host","127.0.0.1",A.ConfigurationTarget.Global),await e.update("server.enabled",!0,A.ConfigurationTarget.Global);return}if(n.label.includes("all interfaces")){await e.update("server.host","0.0.0.0",A.ConfigurationTarget.Global),await e.update("server.enabled",!0,A.ConfigurationTarget.Global);return}if(n.label.includes("Change port")){let o=await A.window.showInputBox({title:"Set API server port",value:String(this.config.port),validateInput:i=>{let s=Number(i);return!Number.isFinite(s)||s<=0||s>65535?"Enter a valid port between 1 and 65535":null}});o&&(await e.update("server.port",Number(o),A.ConfigurationTarget.Global),await e.update("server.enabled",!0,A.ConfigurationTarget.Global));return}n.label.includes("settings")&&await A.commands.executeCommand("workbench.action.openSettings","githubCopilotApi.server")}}logInfo(e){this.output.appendLine(`[${new Date().toISOString()}] INFO ${e}`)}logError(e,r){this.output.appendLine(`[${new Date().toISOString()}] ERROR ${e}: ${Ll(r)}`)}};async function Ck(){let t=A.extensions.getExtension(Ahe);if(!t)return await A.window.showWarningMessage("GitHub Copilot Chat extension is required. Install it from the Marketplace to continue.","Open Marketplace","Cancel")==="Open Marketplace"&&await A.commands.executeCommand("workbench.extensions.search",Phe),!1;if(!t.isActive)try{await t.activate()}catch(e){return A.window.showErrorMessage(`Failed to activate GitHub Copilot Chat: ${Ll(e)}`),!1}return!0}function eM(t){if(typeof t=="string")return t.trim()||void 0;if(Array.isArray(t))return t.map(e=>typeof e=="string"?e:"").join(" ").trim()||void 0}function q8(){let t=A.workspace.getConfiguration("githubCopilotApi"),e=t.get("server.enabled",!1),r=t.get("server.enableHttp",!0),n=t.get("server.enableWebSocket",!0),o=t.get("server.enableHttps",!1),i=t.get("server.tlsCertPath","").trim(),s=t.get("server.tlsKeyPath","").trim(),a=t.get("server.host","127.0.0.1").trim()||"127.0.0.1",c=t.get("server.port",3030),l=Number.isFinite(c)?Math.max(1,Math.floor(c)):3030,u=t.get("server.maxConcurrentRequests",4),d=Number.isFinite(u)?Math.max(1,Math.floor(u)):4,p=(t.get("server.defaultModel","gpt-4o-copilot")??"gpt-4o-copilot").trim()||"gpt-4o-copilot",f=t.get("server.apiKey","").trim(),h=t.get("server.enableLogging",!1),m=t.get("server.rateLimitPerMinute",60),y=Number.isFinite(m)?Math.max(0,Math.floor(m)):60,v=t.get("server.defaultSystemPrompt","").trim(),$=t.get("server.redactionPatterns",[]).map((Ge,ar)=>typeof Ge=="string"?{id:`migrated-${ar}`,name:`Custom Pattern ${ar+1}`,pattern:Ge,enabled:!0,isBuiltin:!1}:Ge),R=[];for(let Ge of Che){let ar=$.find(Xr=>Xr.id===Ge.id);ar?R.push({...Ge,enabled:ar.enabled}):R.push(Ge)}for(let Ge of $)Ge.isBuiltin||R.push(Ge);let P=t.get("server.ipAllowlist",[]),ce=t.get("server.requestTimeoutSeconds",180),Te=t.get("server.maxPayloadSizeMb",1),be=t.get("server.maxConnectionsPerIp",10),et=A.workspace.getConfiguration("githubCopilotApi.mcp").get("enabled",!0);return{enabled:e,enableHttp:r,enableWebSocket:n,enableHttps:o,tlsCertPath:i,tlsKeyPath:s,host:a,port:l,maxConcurrentRequests:d,defaultModel:p,apiKey:f,enableLogging:h,rateLimitPerMinute:y,defaultSystemPrompt:v,redactionPatterns:R,ipAllowlist:P,requestTimeoutSeconds:ce,maxPayloadSizeMb:Te,maxConnectionsPerIp:be,mcpEnabled:et}}function Ll(t){return t instanceof Error&&t.message?t.message:String(t)}var sr=it(require("vscode")),za=class t{constructor(e,r){this._extensionUri=e;this._gateway=r;this._gateway.onDidChangeStatus(async()=>{this._view&&(this._view.webview.html=await this._getSidebarHtml(this._view.webview)),t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,this._gateway))}),this._gateway.onDidLogRequest(n=>{this._view&&this._view.webview.postMessage({type:"liveLog",value:n}),t.currentPanel&&t.currentPanel.webview.postMessage({type:"liveLog",value:n})})}static viewType="copilotApiControls";_view;static currentPanel;static panelDisposables=[];static async createOrShow(e,r,n){let o=sr.window.activeTextEditor?.viewColumn??sr.ViewColumn.One;if(t.currentPanel){t.currentPanel.reveal(o),t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r),n&&t.currentPanel.webview.postMessage({type:"scrollTo",target:n});return}let i=sr.window.createWebviewPanel("copilotApiDashboard","Copilot API Dashboard",o,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[e]});t.currentPanel=i,i.webview.html=await t.getPanelHtml(i.webview,r),n&&setTimeout(()=>{i.webview.postMessage({type:"scrollTo",target:n})},300),i.webview.onDidReceiveMessage(s=>{t.handleMessage(s,r)},void 0,t.panelDisposables),i.onDidDispose(()=>{t.currentPanel=void 0;for(let s of t.panelDisposables)s.dispose();t.panelDisposables=[]},null,t.panelDisposables)}static handleMessage(e,r){switch(e.type){case"openChat":sr.commands.executeCommand("github-copilot-api-vscode.openCopilotChat");break;case"askCopilot":sr.commands.executeCommand("github-copilot-api-vscode.askCopilot");break;case"showControls":sr.commands.executeCommand("github-copilot-api-vscode.showServerControls");break;case"startServer":r.startServer();break;case"stopServer":r.stopServer();break;case"toggleHttp":r.toggleHttp();break;case"toggleWs":r.toggleWebSocket();break;case"toggleLogging":r.toggleLogging();break;case"toggleHttps":r.toggleHttps();break;case"setApiKey":typeof e.value=="string"&&r.setApiKey(e.value);break;case"setRateLimit":typeof e.value=="number"&&r.setRateLimit(e.value);break;case"hostLocal":r.setHost("127.0.0.1");break;case"hostLan":r.setHost("0.0.0.0");break;case"setHost":typeof e.value=="string"&&r.setHost(e.value);break;case"setPort":typeof e.value=="number"&&r.setPort(e.value);break;case"setModel":typeof e.value=="string"&&r.setDefaultModel(e.value);break;case"clearHistory":r.clearHistory();break;case"toggleMcp":typeof e.value=="boolean"&&r.toggleMcp(e.value);break;case"addRedactionPattern":if(e.value&&typeof e.value=="object"){let{name:o,pattern:i}=e.value;r.addRedactionPattern(o,i).then(async s=>{s?t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r)):sr.window.showErrorMessage("Invalid regex pattern")})}break;case"removeRedactionPattern":typeof e.value=="string"&&r.removeRedactionPattern(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"toggleRedactionPattern":if(e.value&&typeof e.value=="object"){let{id:o,enabled:i}=e.value;r.toggleRedactionPattern(o,i)}break;case"addIpAllowlistEntry":typeof e.value=="string"&&r.addIpAllowlistEntry(e.value).then(async o=>{o?t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r)):sr.window.showErrorMessage("Invalid IP address or CIDR range")});break;case"removeIpAllowlistEntry":typeof e.value=="string"&&r.removeIpAllowlistEntry(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"setRequestTimeout":typeof e.value=="number"&&r.setRequestTimeout(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"setMaxPayloadSize":typeof e.value=="number"&&r.setMaxPayloadSize(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"setMaxConnectionsPerIp":typeof e.value=="number"&&r.setMaxConnectionsPerIp(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"setMaxConcurrency":typeof e.value=="number"&&r.setMaxConcurrency(e.value).then(async()=>{t.currentPanel&&(t.currentPanel.webview.html=await t.getPanelHtml(t.currentPanel.webview,r))});break;case"getHistory":if(t.currentPanel){let o=r.getHistory(50);t.currentPanel.webview.postMessage({type:"historyData",data:o})}break;case"getStats":t.currentPanel&&t.currentPanel.webview.postMessage({type:"statsData",data:r.getStats()});break;case"getAuditStats":t.currentPanel&&r.getDailyStats(30).then(o=>{t.currentPanel?.webview.postMessage({type:"auditStatsData",data:o})});break;case"getAuditLogs":if(console.log("[CopilotPanel] Received getAuditLogs request"),t.currentPanel){let o=e.value||{},i=o.page||1,s=o.pageSize||10;r.getAuditLogs(i,s).then(a=>{console.log("[CopilotPanel] Got audit logs:",a.total,"total,",a.entries.length,"entries"),t.currentPanel?.webview.postMessage({type:"auditLogData",data:a.entries,page:i,total:a.total,pageSize:s})}).catch(a=>{console.error("[CopilotPanel] Error getting audit logs:",a),t.currentPanel?.webview.postMessage({type:"auditLogData",data:[],page:i,total:0,pageSize:s})})}else console.warn("[CopilotPanel] No currentPanel available for getAuditLogs response");break;case"openLogFolder":let n=r.getLogFolderPath();n?sr.commands.executeCommand("revealFileInOS",sr.Uri.file(n)):sr.window.showErrorMessage("Log folder not found");break;case"generatePrompt":case"enhancePrompt":if(e.data&&typeof e.data=="object"){let o=e.data,s=e.type==="enhancePrompt"?`You are an expert prompt engineer. Enhance and improve the following prompt to make it more detailed, specific, and effective:

${o.existingPrompt||o.context}

Make it more comprehensive with clear objectives, constraints, and expected deliverables.`:`You are an expert prompt engineer. Create a comprehensive, high-quality prompt for an AI coding assistant based on these specifications:

${o.projectType?`**Project Type:** ${o.projectType}`:""}
${o.techStack?`**Tech Stack:** ${o.techStack}`:""}
${o.goal?`**Goal:** ${o.goal}`:""}
${o.complexity?`**Complexity Level:** ${o.complexity}`:""}
${o.context?`**User Description:** ${o.context}`:""}

Generate a detailed, actionable prompt that includes:
1. Clear project objective and scope
2. Specific technical requirements
3. Step-by-step implementation plan
4. Best practices and considerations
5. Expected deliverables and success criteria

Format the output as a ready-to-use prompt that the user can copy and paste into an AI assistant.`;r.invokeCopilot(s).then(a=>{t.currentPanel&&t.currentPanel.webview.postMessage({type:"promptResult",data:a})}).catch(a=>{t.currentPanel&&t.currentPanel.webview.postMessage({type:"promptError",error:a.message})})}break}}async _getSidebarHtml(e){let r=B8(),n=await this._gateway.getStatus(),o=n.running,i=o?"var(--vscode-testing-iconPassed)":"var(--vscode-testing-iconFailed)",s=o?"Running":"Stopped",c=`${n.isHttps?"https":"http"}://${n.config.host}:${n.config.port}`,l=n.stats||{totalRequests:0,totalTokensIn:0,totalTokensOut:0,requestsPerMinute:0,avgLatencyMs:0},u=n.realtimeStats||{requestsPerMinute:0,avgLatencyMs:0,errorRate:0},d=await this._gateway.getDailyStats(7),p=Math.max(...d.map(w=>w.totalRequests),1),f=20,h=6,m=50,y=(f+h)*7,v=d.map((w,$)=>{let R=Math.max(2,w.totalRequests/p*m),P=$*(f+h),ce=m-R,Te=new Date(w.date).toLocaleDateString("en",{weekday:"short"}).charAt(0);return`
                <rect x="${P}" y="${ce}" width="${f}" height="${R}" rx="3" fill="var(--vscode-charts-blue)" opacity="0.8"/>
                <text x="${P+f/2}" y="${m+12}" font-size="8" fill="var(--vscode-descriptionForeground)" text-anchor="middle">${Te}</text>
            `}).join("");return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${e.cspSource} 'unsafe-inline'; script-src 'nonce-${r}';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; padding: 0; font-family: var(--vscode-font-family); color: var(--vscode-foreground); background: var(--vscode-sideBar-background); }
        .section { padding: 12px; border-bottom: 1px solid var(--vscode-widget-border); }
        .section:last-child { border-bottom: none; }
        .section-title { font-size: 10px; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; margin-bottom: 10px; font-weight: 600; }
        .status-row { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; background: ${i}; box-shadow: 0 0 6px ${i}; }
        .url { font-family: var(--vscode-editor-font-family); font-size: 10px; opacity: 0.7; word-break: break-all; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px; }
        .stat-card { background: var(--vscode-editor-background); border-radius: 6px; padding: 8px 10px; text-align: center; border: 1px solid var(--vscode-widget-border); }
        .stat-value { font-size: 18px; font-weight: 700; color: var(--vscode-foreground); }
        .stat-label { font-size: 9px; text-transform: uppercase; opacity: 0.6; margin-top: 2px; }
        .chart-container { background: var(--vscode-editor-background); border-radius: 8px; padding: 12px; border: 1px solid var(--vscode-widget-border); }
        .chart-title { font-size: 11px; font-weight: 600; margin-bottom: 8px; opacity: 0.9; }
        button { width: 100%; padding: 8px 12px; margin-bottom: 6px; background: var(--vscode-button-background); color: var(--vscode-button-foreground); border: none; border-radius: 4px; cursor: pointer; font-family: var(--vscode-font-family); font-weight: 500; font-size: 12px; }
        button:hover { background: var(--vscode-button-hoverBackground); }
        button.secondary { background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
        button.secondary:hover { background: var(--vscode-button-secondaryHoverBackground); }
        .btn-row { display: flex; gap: 6px; margin-bottom: 6px; }
        .btn-row button { flex: 1; padding: 6px 8px; font-size: 11px; margin-bottom: 0; }
        .copilot-status { font-size: 10px; opacity: 0.7; display: flex; align-items: center; gap: 5px; margin-top: 4px; }
        .copilot-dot { width: 6px; height: 6px; border-radius: 50%; }
    </style>
</head>
<body>
    <!-- Status Section (at top) -->
    <div class="section">
        <div class="section-title">Server Status</div>
        <div class="status-row">
            <div class="dot"></div>
            <strong>${s}</strong>
        </div>
        <div class="url">${c}</div>
        <div class="copilot-status">
            <div class="copilot-dot" style="background: ${n.copilot.ready?"var(--vscode-testing-iconPassed)":"var(--vscode-editorWarning-foreground)"}"></div>
            Copilot: ${n.copilot.ready?"Ready":n.copilot.signedIn?"Checking":"Sign-in Needed"}
        </div>
    </div>

    <!-- Actions Section -->
    <div class="section">
        <div class="section-title">\u26A1 Actions</div>
        <button id="btn-dashboard">Open Dashboard</button>
        <button id="btn-apps" style="background: linear-gradient(135deg, #38bdf8, #a78bfa); border: none;">\u{1F4E6} Open Apps Hub</button>
        <button id="btn-toggle" class="secondary">${o?"\u23F9 Stop Server":"\u25B6 Start Server"}</button>
        <button id="btn-swagger" class="secondary">\u{1F4DD} Swagger API</button>
        <button id="btn-metrics" class="secondary">\u{1F4CA} Prometheus Metrics</button>
        <button id="btn-wiki" class="secondary">\u{1F4DA} Wiki</button>
        <button id="btn-prompt" class="secondary">\u2728 Prompt Generator</button>
    </div>

    <!-- Analytics Section -->
    <div class="section">
        <div class="section-title">\u{1F4CA} Live Stats</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="stat-rpm">${u.requestsPerMinute}</div>
                <div class="stat-label">Req/Min</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-latency">${u.avgLatencyMs}<span style="font-size: 10px; opacity: 0.6;">ms</span></div>
                <div class="stat-label">Latency</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-total">${l.totalRequests}</div>
                <div class="stat-label">Total Reqs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-errors">${u.errorRate}<span style="font-size: 10px; opacity: 0.6;">%</span></div>
                <div class="stat-label">Errors</div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">Requests (Last 7 Days)</div>
            <svg width="${y}" height="${m+16}" style="display: block; margin: 0 auto;">
                ${v}
            </svg>
        </div>
    </div>

    <!-- Token Usage Section -->
    <div class="section">
        <div class="section-title">\u{1F3AB} Token Usage</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" style="font-size: 14px; color: var(--vscode-charts-green);">${this.formatNumber(l.totalTokensIn)}</div>
                <div class="stat-label">Tokens In</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="font-size: 14px; color: var(--vscode-charts-orange);">${this.formatNumber(l.totalTokensOut)}</div>
                <div class="stat-label">Tokens Out</div>
            </div>
        </div>
    </div>

    <script nonce="${r}">
        const vscode = acquireVsCodeApi();
        document.getElementById('btn-dashboard').addEventListener('click', () => vscode.postMessage({ type: 'openDashboard' }));
        document.getElementById('btn-apps').addEventListener('click', () => vscode.postMessage({ type: 'openAppsHub' }));
        document.getElementById('btn-toggle').addEventListener('click', () => vscode.postMessage({ type: '${o?"stopServer":"startServer"}' }));
        document.getElementById('btn-swagger').addEventListener('click', () => vscode.postMessage({ type: 'openSwagger' }));
        document.getElementById('btn-metrics').addEventListener('click', () => vscode.postMessage({ type: 'openMetrics' }));
        document.getElementById('btn-wiki').addEventListener('click', () => vscode.postMessage({ type: 'openWiki' }));
        document.getElementById('btn-prompt').addEventListener('click', () => vscode.postMessage({ type: 'openPromptGenerator' }));
    </script>
</body>
</html>`}formatNumber(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}static async getPanelHtml(e,r){let n=B8(),o=await r.getStatus(),i=o.config,s=o.running,a=s?"var(--vscode-testing-iconPassed)":"var(--vscode-testing-iconFailed)",c=s?"Running":"Stopped",u=`${o.isHttps?"https":"http"}://${i.host}:${i.port}`,d=o.networkInfo;return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${e.cspSource} 'unsafe-inline'; script-src 'nonce-${n}' https://cdn.jsdelivr.net; connect-src http: https:;">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot API Dashboard</title>
    <title>Copilot API Dashboard</title>
    <!-- Removed Chart.js for reliability -->
    <style>
        :root { color-scheme: var(--vscode-color-scheme); }
        body {
            margin: 0; padding: 0; min-height: 100vh;
            background: radial-gradient(120% 120% at 20% 20%, rgba(56,189,248,0.05), transparent),
                        radial-gradient(120% 120% at 80% 0%, rgba(147,197,253,0.05), transparent),
                        var(--vscode-editor-background);
            font-family: var(--vscode-font-family); color: var(--vscode-foreground);
        }
        .page { max-width: 1400px; margin: 0 auto; padding: 32px 32px 64px; display: flex; flex-direction: column; gap: 24px; }
        .hero { display: flex; justify-content: space-between; align-items: flex-start; gap: 20px; padding-bottom: 8px; }
        .hero h1 { margin: 0; font-size: 26px; letter-spacing: -0.4px; font-weight: 700; }
        .hero p { margin: 6px 0 0 0; opacity: 0.7; font-size: 14px; max-width: 600px; line-height: 1.5; }
        .badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 999px; background: var(--vscode-badge-background); color: var(--vscode-badge-foreground); font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; }
        .card { background-color: var(--vscode-editorWidget-background); border: 1px solid var(--vscode-widget-border); border-radius: 12px; padding: 24px; box-shadow: 0 4px 24px rgba(0,0,0,0.06); transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,0,0,0.12); border-color: var(--vscode-focusBorder); }
        .card.full-width { grid-column: 1 / -1; }
        h3 { margin-top: 0; margin-bottom: 10px; font-size: 12px; text-transform: uppercase; letter-spacing: 0.4px; opacity: 0.8; }
        .status-row { display: flex; align-items: center; gap: 10px; font-weight: 600; }
        .status-dot { width: 12px; height: 12px; border-radius: 50%; background-color: ${a}; box-shadow: 0 0 10px ${a}; }
        .info-grid { display: grid; grid-template-columns: 120px 1fr; gap: 6px 12px; font-size: 12px; align-items: center; }
        .label { opacity: 0.7; text-transform: uppercase; letter-spacing: 0.3px; font-size: 11px; }
        .value { font-family: var(--vscode-editor-font-family); word-break: break-all; }
        .actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 8px; }
        button { display: inline-flex; justify-content: center; align-items: center; gap: 6px; width: 100%; padding: 10px 12px; background-color: var(--vscode-button-background); color: var(--vscode-button-foreground); border: 1px solid color-mix(in srgb, var(--vscode-button-background) 50%, transparent); border-radius: 6px; cursor: pointer; font-family: var(--vscode-font-family); font-weight: 600; transition: transform 120ms ease, background-color 120ms ease; }
        button:hover { background-color: var(--vscode-button-hoverBackground); transform: translateY(-1px); }
        button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        button.secondary { background-color: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
        button.secondary:hover { background-color: var(--vscode-button-secondaryHoverBackground); }
        button.success { background-color: var(--vscode-testing-iconPassed); }
        button.danger { background-color: var(--vscode-testing-iconFailed); }
        .toggle-row { display: flex; align-items: center; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--vscode-widget-border); }
        .toggle-row:last-child { border-bottom: none; }
        .switch { position: relative; width: 36px; height: 20px; }
        .switch input { display: none; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: var(--vscode-input-background); border: 1px solid var(--vscode-widget-border); transition: .2s; border-radius: 999px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 2px; bottom: 2px; background-color: var(--vscode-foreground); transition: .2s; border-radius: 50%; }
        input:checked + .slider { background: var(--vscode-testing-iconPassed); border-color: var(--vscode-testing-iconPassed); }
        input:checked + .slider:before { transform: translateX(16px); background: var(--vscode-editor-background); }
        .muted { opacity: 0.75; font-size: 12px; }
        .inline-form { display: grid; grid-template-columns: 140px 1fr; gap: 16px; align-items: center; }
        .stacked { display: flex; flex-direction: column; gap: 12px; }
        input, select, textarea { width: 100%; padding: 8px 10px; font-size: 13px; border-radius: 6px; border: 1px solid var(--vscode-input-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-family: var(--vscode-font-family); box-sizing: border-box; }
        textarea { font-family: var(--vscode-editor-font-family); font-size: 12px; resize: vertical; min-height: 120px; }
        select { cursor: pointer; }
        .pill-row { display: flex; gap: 8px; flex-wrap: wrap; }
        .pill { padding: 6px 10px; border-radius: 999px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-editor-background); cursor: pointer; }
        .pill:hover { border-color: var(--vscode-testing-iconPassed); color: var(--vscode-testing-iconPassed); }
        .docs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 10px; }
        .doc-card { border: 1px dashed var(--vscode-widget-border); border-radius: 8px; padding: 10px; background: color-mix(in srgb, var(--vscode-editor-background) 90%, transparent); cursor: pointer; transition: border-color 0.15s, background 0.15s; }
        .doc-card:hover { border-color: var(--vscode-focusBorder); background: color-mix(in srgb, var(--vscode-editor-background) 70%, transparent); }
        .doc-card h4 { margin: 0 0 6px 0; font-size: 13px; display: flex; gap: 8px; align-items: center; }
        .doc-card code { display: inline-block; padding: 3px 6px; border-radius: 6px; background: var(--vscode-textBlockQuote-background); font-family: var(--vscode-editor-font-family); }
        .doc-card p { margin: 6px 0 0 0; opacity: 0.85; font-size: 12px; }
        pre { background: var(--vscode-textBlockQuote-background); border-radius: 8px; padding: 10px; font-size: 12px; overflow-x: auto; margin: 0; white-space: pre-wrap; word-break: break-word; }
        a { color: var(--vscode-textLink-foreground); }
        
        .spinner { display: inline-block; width: 14px; height: 14px; border: 2px solid currentColor; border-radius: 50%; border-top-color: transparent; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Live Log Tail Styles */
        .log-container {
            background: var(--vscode-textBlockQuote-background);
            color: var(--vscode-editor-foreground);
            font-family: var(--vscode-editor-font-family);
            font-size: 11px;
            padding: 12px;
            border-radius: 8px;
            height: 300px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2px;
            border: 1px solid var(--vscode-widget-border);
            margin-top: 8px;
        }
        .log-line {
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-all;
            display: flex;
            gap: 8px;
        }
        .log-time { color: var(--vscode-descriptionForeground); min-width: 75px; flex-shrink: 0; }
        .log-method { font-weight: 600; color: var(--vscode-terminal-ansiBlue); min-width: 50px; flex-shrink: 0; }
        .log-path { color: var(--vscode-terminal-ansiMagenta); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .log-status { font-weight: 600; min-width: 35px; flex-shrink: 0; }
        .log-status.success { color: var(--vscode-testing-iconPassed); }
        .log-status.error { color: var(--vscode-testing-iconFailed); }
        .log-latency { color: var(--vscode-descriptionForeground); min-width: 60px; text-align: right; flex-shrink: 0; }
        
        #log-status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.3s ease;
        }
        #log-status-indicator.active { background-color: var(--vscode-testing-iconPassed); box-shadow: 0 0 8px var(--vscode-testing-iconPassed); }
        #log-status-indicator.inactive { background-color: var(--vscode-disabledForeground); }

    </style>
</head>
<body>
    <div class="page">
        <div class="hero">
            <div>
                <h1>Copilot API Dashboard</h1>
                <p>Monitor and control your local Copilot API Gateway.</p>
                <div style="margin-top: 8px; font-size: 13px; opacity: 0.9; font-family: var(--vscode-editor-font-family);">
                    <span style="opacity: 0.6;">Running on:</span> 
                    <strong>http://${i.host}:${i.port}</strong>
                </div>
            </div>
            <div style="display: flex; gap: 8px;">
                <button id="btn-toggle-server" class="${o.running?"danger":"success"}" data-running="${o.running}" style="min-width: 140px;">
                    ${o.running?"Stop Server":"Start Server"}
                </button>
                <button class="secondary" id="btn-open-chat" title="Open Copilot Chat" style="min-width: 90px;">\u{1F4AC} Chat</button>
                <button class="secondary" id="btn-ask-copilot" title="Ask Copilot" style="min-width: 90px;">\u2753 Ask</button>
                <button class="secondary" id="btn-settings" title="Settings">\u2699\uFE0F</button>
            </div>
        </div>

        <!-- Copilot Health Banner -->
        ${o.copilot.ready?"":`
        <div style="background: var(--vscode-statusBarItem-warningBackground); color: var(--vscode-statusBarItem-warningForeground); padding: 12px 16px; border-radius: 8px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px; font-weight: 500; border: 1px solid rgba(0,0,0,0.1);">
            <span style="font-size: 20px;">\u26A0\uFE0F</span>
            <div style="flex: 1;">
                <div style="font-size: 14px;">GitHub Copilot is not fully ready</div>
                <div style="font-size: 12px; opacity: 0.9; font-weight: 400;">
                    ${o.copilot.installed?"":"\u2022 GitHub Copilot extension is missing. "}
                    ${o.copilot.chatInstalled?"":"\u2022 GitHub Copilot Chat extension is missing. "}
                    ${o.copilot.signedIn?"":"\u2022 You are not signed in to GitHub Copilot. "}
                </div>
            </div>
            <button class="secondary" onclick="vscode.postMessage({ type: 'askCopilot' })" style="width: auto; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: inherit;">Resolve</button>
        </div>
        `}

        <!-- Server Status Card -->
        <div class="card full-width">
            <div class="status-row" style="justify-content: space-between; margin-bottom: 24px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div id="status-dot" class="status-dot"></div>
                    <span id="server-status-text" style="font-size: 16px;">${c}</span>
                </div>
                <div class="muted">
                    v${r.getVersion()}
                </div>
            </div>

            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 24px;">
                <div class="card" style="padding: 16px;">
                    <div class="label">Requests</div>
                    <div class="value" style="font-size: 20px;" id="stat-requests">${o.stats?.totalRequests??0}</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Req/Min</div>
                    <div class="value" style="font-size: 20px;" id="stat-rpm">0</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Latency</div>
                    <div class="value" style="font-size: 20px;" id="stat-latency">0ms</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Error Rate</div>
                    <div class="value" style="font-size: 20px;" id="stat-errors">0%</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Tokens In</div>
                    <div class="value" style="font-size: 20px;" id="stat-tokens-in">${o.stats?.totalTokensIn??0}</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Tokens Out</div>
                    <div class="value" style="font-size: 20px;" id="stat-tokens-out">${o.stats?.totalTokensOut??0}</div>
                </div>
                <div class="card" style="padding: 16px;">
                    <div class="label">Uptime</div>
                    <div class="value" style="font-size: 20px;" id="stat-uptime">0m</div>
                </div>
            </div>

            <div class="info-grid">
                <div class="label">Connection</div>
                <div class="value">
                    ${i.enableHttp?"HTTP ":""}
                    ${i.enableWebSocket?"WebSocket ":""}
                </div>
                <div class="label">Auth Mode</div>
                <div class="value">${i.apiKey?"API Key (Protected)":"Open (No Auth)"}</div>
                <div class="label">Default Model</div>
                <div class="value">${i.defaultModel}</div>
                <div class="label">Copilot Health</div>
                <div class="value" style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <span class="badge" style="background: ${o.copilot.chatInstalled?"var(--vscode-charts-green)":o.copilot.signedIn?"var(--vscode-charts-yellow)":"var(--vscode-charts-red)"}; color: ${o.copilot.chatInstalled||o.copilot.signedIn?"var(--vscode-editor-background)":"white"}; padding: 1px 6px; border-radius: 4px; font-size: 10px;">Chat: ${o.copilot.chatInstalled?"Installed":o.copilot.signedIn?"Not Detected":"Missing"}</span>
                    <span class="badge" style="background: ${o.copilot.signedIn?"var(--vscode-charts-green)":"var(--vscode-charts-red)"}; color: ${o.copilot.signedIn?"var(--vscode-editor-background)":"white"}; padding: 1px 6px; border-radius: 4px; font-size: 10px;">Auth: ${o.copilot.signedIn?"Signed In":"Signed Out"}</span>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- Configuration Card -->
            <div class="card">
                <h3>\u2699\uFE0F Server Configuration</h3>
                <div class="stacked">
                    <div class="toggle-row">
                        <span>Enable HTTP Server</span>
                        <label class="switch">
                            <input type="checkbox" id="toggle-http" ${i.enableHttp?"checked":""}>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span>Enable WebSocket</span>
                        <label class="switch">
                            <input type="checkbox" id="toggle-ws" ${i.enableWebSocket?"checked":""}>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <div style="display: flex; gap: 4px; align-items: center;">
                            <span>Detailed Logging</span>
                            <span title="Enables verbose output to the VS Code Output channel. Useful for debugging." style="cursor: help; opacity: 0.6; font-size: 14px;">\u2139\uFE0F</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="toggle-logging" ${i.enableLogging?"checked":""}>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <div style="display: flex; gap: 4px; align-items: center;">
                            <span>Enable HTTPS</span>
                            <span title="Use HTTPS/TLS encryption. Falls back to HTTP if certificates are not configured." style="cursor: help; opacity: 0.6; font-size: 14px;">\u{1F512}</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="toggle-https" ${i.enableHttps?"checked":""}>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 16px;">
                        <div style="display: flex; gap: 16px; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <span style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 6px;">HOST</span>
                                <input type="text" id="custom-host" value="${i.host}" placeholder="127.0.0.1" style="width: 100% !important;">
                            </div>
                            <div style="width: 100px;">
                                <span style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 6px;">PORT</span>
                                <input type="number" id="custom-port" value="${i.port}" style="width: 100% !important;">
                            </div>
                            <div style="display: flex; align-items: flex-end;">
                                <button class="secondary" id="btn-set-host" style="height: 36px; padding: 0 16px;">Apply</button>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="secondary" id="btn-host-local" style="flex: 1;">Bind Localhost</button>
                            <button class="secondary" id="btn-host-lan" style="flex: 1;">Bind LAN (0.0.0.0)</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Card -->
            <div class="card">
                <h3>\u{1F512} Security</h3>
                <div class="stacked">
                    <div class="toggle-row">
                        <span>Enable Authentication</span>
                        <label class="switch">
                            <input type="checkbox" id="toggle-auth" ${i.apiKey?"checked":""}>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 12px;">
                        <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                            <input type="password" id="api-key-input" value="${i.apiKey||""}" placeholder="sk-..." style="flex: 1;">
                            <button class="secondary" id="btn-show-key" style="width: 40px;" title="Show/Hide Key">\u{1F441}</button>
                            <button class="secondary" id="btn-copy-key" style="width: 40px;" title="Copy Key">\u{1F4CB}</button>
                        </div>
                        <div class="actions">
                            <button class="secondary" id="btn-generate-key">Generate New Key</button>
                            <button class="secondary" id="btn-set-apikey">Set Manual Key</button>
                        </div>
                    </div>

                    <div style="margin-top: 16px; border-top: 1px solid var(--vscode-widget-border); padding-top: 16px;">
                        <span style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 8px;">RATE LIMIT</span>
                        <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                            <input type="number" id="rate-limit-input" value="${i.rateLimitPerMinute||0}" placeholder="0 = unlimited" style="width: 100px !important;">
                            <span class="muted">req/min</span>
                            <button class="secondary" id="btn-set-ratelimit" style="width: auto; padding: 6px 16px;">Set</button>
                        </div>
                    </div>

                    <div style="margin-top: 16px; border-top: 1px solid var(--vscode-widget-border); padding-top: 16px;">
                        <div class="inline-form" style="margin-bottom: 8px;">
                            <span style="font-size: 12px; font-weight: 600;">ALLOW IP / DOMAIN</span>
                            <div style="display: flex; gap: 8px;">
                                <input type="text" id="ip-allowlist-input" placeholder="e.g. 192.168.1.5, 10.0.0.0/24, or example.com">
                                <button class="secondary" id="btn-add-ip" style="width: auto;">Add</button>
                            </div>
                        </div>
                        <div class="pill-row" id="ip-list">
                            ${(i.ipAllowlist||[]).map(p=>`<span class="pill" style="font-size: 11px; display: flex; align-items: center; gap: 4px;">${p} <span class="btn-remove-ip" data-value="${p}" style="cursor: pointer; opacity: 0.6;">\xD7</span></span>`).join("")}
                            ${!i.ipAllowlist||i.ipAllowlist.length===0?'<span class="muted">No access restrictions (all IPs allowed)</span>':""}
                        </div>
                    </div>

                    <div style="margin-top: 16px; border-top: 1px solid var(--vscode-widget-border); padding-top: 16px;">
                        <span style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 8px;">HARDENING & LIMITS</span>
                        
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                                <span class="muted" style="width: 120px; font-size: 11px;">Request Timeout</span>
                                <input type="number" id="timeout-input" value="${i.requestTimeoutSeconds||60}" style="width: 80px !important;">
                                <span class="muted">sec</span>
                                <button class="secondary" id="btn-set-timeout" style="width: auto; padding: 4px 12px; font-size: 11px;">Set</button>
                            </div>

                            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                                <span class="muted" style="width: 120px; font-size: 11px;">Max Payload</span>
                                <input type="number" id="payload-input" value="${i.maxPayloadSizeMb||1}" style="width: 80px !important;">
                                <span class="muted">MB</span>
                                <button class="secondary" id="btn-set-payload" style="width: auto; padding: 4px 12px; font-size: 11px;">Set</button>
                            </div>

                            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                                <span class="muted" style="width: 120px; font-size: 11px;">Max Connections/IP</span>
                                <input type="number" id="connections-input" value="${i.maxConnectionsPerIp||10}" style="width: 80px !important;">
                                <span class="muted">conn</span>
                                <button class="secondary" id="btn-set-connections" style="width: auto; padding: 4px 12px; font-size: 11px;">Set</button>
                            </div>

                            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                                <span class="muted" style="width: 120px; font-size: 11px;">Total Concurrency</span>
                                <input type="number" id="concurrency-input" value="${i.maxConcurrentRequests||4}" style="width: 80px !important;">
                                <span class="muted">req</span>
                                <button class="secondary" id="btn-set-concurrency" style="width: auto; padding: 4px 12px; font-size: 11px;">Set</button>
                            </div>
                            <div class="muted" style="font-size: 10px; margin-top: 2px; opacity: 0.9; line-height: 1.4;">
                                <div style="display: flex; gap: 4px; margin-bottom: 2px;">
                                    <span style="font-weight: 600; color: var(--vscode-charts-blue); min-width: 105px;">Connections/IP:</span>
                                    <span>Limits simultaneous requests from a <b>single</b> user/client.</span>
                                </div>
                                <div style="display: flex; gap: 4px;">
                                    <span style="font-weight: 600; color: var(--vscode-charts-orange); min-width: 105px;">Total Concurrency:</span>
                                    <span>Global limit across <b>all</b> users to protect the Copilot backend.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MCP Status -->
        <div class="card full-width" id="mcp-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3 style="margin: 0; display: flex; align-items: center; gap: 8px;">\u{1F50C} MCP Status <span id="mcp-status-badge" class="badge">Checking...</span></h3>
                <div style="display: flex; gap: 12px; align-items: center;">
                    <label style="font-size: 11px; display: flex; align-items: center; gap: 6px; cursor: pointer; opacity: 0.8;">
                        <input type="checkbox" id="mcp-enabled-toggle" style="width: 14px; height: 14px; margin: 0;"> Enabled
                    </label>
                </div>
            </div>
            
            <div id="mcp-content-area">
                <div class="muted" style="text-align: center; padding: 20px;">Loading tools...</div>
            </div>
        </div>

        <!-- Live Log Tail -->
        <div class="card full-width">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0; display: flex; align-items: center; gap: 8px;">\u{1F4DF} Live Log Tail <div id="log-status-indicator" class="active"></div></h3>
                <div style="display: flex; gap: 12px; align-items: center;">
                    <label style="font-size: 11px; display: flex; align-items: center; gap: 6px; cursor: pointer; opacity: 0.8;">
                        <input type="checkbox" id="log-autoscroll" checked style="width: 14px; height: 14px; margin: 0;"> Auto-scroll
                    </label>
                    <button class="secondary" id="btn-clear-logs" style="width: auto; padding: 4px 12px; font-size: 11px; font-weight: 500;">\u{1F9F9} Clear</button>
                </div>
            </div>
            <div id="live-log-container" class="log-container">
                <div class="muted" style="text-align: center; padding-top: 120px; opacity: 0.5;">Waiting for API requests...</div>
            </div>
        </div>

        <!-- Audit & Analytics -->
        <div class="card full-width">
            
            <!-- Charts removed per user request -->
            <div style="margin-bottom: 24px;"></div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <h4 style="margin: 0; font-size: 13px; opacity: 0.9;">Recent Activity</h4>
                <span id="refresh-timer" class="muted" style="font-weight: normal; font-size: 11px; opacity: 0.6;"></span>
                <div style="display: flex; gap: 8px;">
                    <button class="secondary" id="btn-refresh-audit" style="padding: 4px 10px; font-size: 11px;">\u{1F504} Refresh</button>
                    <button class="secondary" id="btn-open-logs" style="padding: 4px 10px; font-size: 11px;">\u{1F4C2} Open Log Folder</button>
                </div>
            </div>

            <div style="overflow-x: auto;">
                <table id="audit-table" style="width: 100%; border-collapse: collapse; font-size: 12px;">
                    <thead>
                        <tr style="text-align: left; border-bottom: 1px solid var(--vscode-widget-border);">
                            <th style="padding: 8px 12px; opacity: 0.7;">Time</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Method</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Path</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Status</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Latency</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Tokens</th>
                            <th style="padding: 8px 12px; opacity: 0.7;">Action</th>
                        </tr>
                    </thead>
                    <tbody id="audit-table-body">
                        <tr style="border-bottom: 1px solid var(--vscode-widget-border);">
                            <td style="padding: 8px 12px; opacity: 0.6; font-style: italic;" colspan="7">Loading audit logs...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--vscode-widget-border);">
                <div class="muted" style="font-size: 11px;" id="page-info">Showing 0-0 of 0</div>
                <div style="display: flex; gap: 8px;">
                    <button class="secondary" id="btn-prev-page" disabled>Previous</button>
                    <button class="secondary" id="btn-next-page" disabled>Next</button>
                </div>
            </div>
        </div>
        
        <div class="card full-width">
            <h3>\u{1F6E1}\uFE0F Data Redaction</h3>
            <p class="muted" style="margin-bottom: 16px;">
                Toggle patterns to automatically redact sensitive data from logs. All patterns are applied in real-time.
            </p>
            
            <!-- Built-in Patterns -->
            <div style="margin-bottom: 20px;">
                <h4 style="font-size: 13px; margin-bottom: 12px; opacity: 0.9;">Built-in Patterns</h4>
                <div id="builtin-patterns-list" style="display: flex; flex-direction: column; gap: 8px;">
                    ${(i.redactionPatterns||[]).filter(p=>p.isBuiltin).map(p=>`
                        <div class="toggle-row" style="padding: 8px 12px; background: var(--vscode-editor-background); border-radius: 6px; border: 1px solid var(--vscode-widget-border);">
                            <div style="display: flex; flex-direction: column; gap: 2px;">
                                <span style="font-weight: 600; font-size: 12px;">${p.name}</span>
                                <code style="font-size: 10px; opacity: 0.6; word-break: break-all;">${p.pattern.length>40?p.pattern.substring(0,40)+"...":p.pattern}</code>
                            </div>
                            <label class="switch">
                                <input type="checkbox" class="toggle-redaction" data-id="${p.id}" ${p.enabled?"checked":""}>
                                <span class="slider"></span>
                            </label>
                        </div>
                    `).join("")}
                </div>
            </div>
            
            <!-- Custom Patterns -->
            <div style="border-top: 1px solid var(--vscode-widget-border); padding-top: 16px;">
                <h4 style="font-size: 13px; margin-bottom: 12px; opacity: 0.9;">Custom Patterns</h4>
                
                <div id="custom-patterns-list" style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px;">
                    ${(i.redactionPatterns||[]).filter(p=>!p.isBuiltin).map(p=>`
                        <div class="toggle-row" style="padding: 8px 12px; background: var(--vscode-editor-background); border-radius: 6px; border: 1px solid var(--vscode-widget-border);">
                            <div style="display: flex; flex-direction: column; gap: 2px; flex: 1;">
                                <span style="font-weight: 600; font-size: 12px;">${p.name}</span>
                                <code style="font-size: 10px; opacity: 0.6; word-break: break-all;">${p.pattern}</code>
                            </div>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <label class="switch">
                                    <input type="checkbox" class="toggle-redaction" data-id="${p.id}" ${p.enabled?"checked":""}>
                                    <span class="slider"></span>
                                </label>
                                <button class="secondary btn-remove-redaction" data-id="${p.id}" style="width: 28px; height: 28px; padding: 0; font-size: 14px;" title="Remove">\xD7</button>
                            </div>
                        </div>
                    `).join("")}
                    ${(i.redactionPatterns||[]).filter(p=>!p.isBuiltin).length===0?'<span class="muted" style="text-align: center; padding: 12px;">No custom patterns added yet</span>':""}
                </div>
                
                <!-- Add Custom Pattern Form -->
                <div style="display: flex; flex-direction: column; gap: 8px; padding: 12px; background: var(--vscode-textBlockQuote-background); border-radius: 8px;">
                    <span style="font-size: 11px; font-weight: 600; opacity: 0.8;">ADD CUSTOM PATTERN</span>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <input type="text" id="redaction-name-input" placeholder="Pattern name (e.g. 'Bank Account')" style="flex: 1; min-width: 150px;">
                        <input type="text" id="redaction-pattern-input" placeholder="Regex pattern" style="flex: 2; min-width: 200px;">
                    </div>
                    <div style="display: flex; gap: 8px; justify-content: flex-end;">
                        <button class="secondary" id="btn-test-redaction" style="width: auto;">\u{1F9EA} Test</button>
                        <button class="secondary" id="btn-add-redaction" style="width: auto;">\u2795 Add Pattern</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card full-width">
            <h3>\u{1F4DA} API Documentation</h3>
            <p class="muted" style="margin-bottom: 16px;">
                The gateway supports multiple API formats. Use the endpoints below with your favorite SDKs.
            </p>
            <div class="docs-grid">
                <div class="doc-card">
                    <h4><span>\u{1F916}</span> OpenAI <code>/v1</code></h4>
                    <p>Compatible with OpenAI SDKs. Supports <code>chat/completions</code>, <code>completions</code>, and <code>models</code>.</p>
                </div>
                <div class="doc-card">
                    <h4><span>\u{1F9EA}</span> Anthropic <code>/v1</code></h4>
                    <p>Compatible with Claude SDKs. Supports <code>/v1/messages</code> with full streaming (SSE).</p>
                </div>
                <div class="doc-card">
                    <h4><span>\u{1F31F}</span> Google <code>/v1beta</code></h4>
                    <p>Compatible with Gemini SDKs. Supports <code>generateContent</code> and <code>streamGenerateContent</code>.</p>
                </div>
                <div class="doc-card">
                    <h4><span>\u{1F50C}</span> MCP Tools</h4>
                    <p>MCP tools are automatically prefixed with <code>mcp_{server}_{tool}</code>. The gateway handles execution automatically in non-streaming mode.</p>
                </div>
            </div>
            <div class="actions" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); margin-top: 16px;">
                <a href="http://${i.host}:${i.port}/docs" target="_blank" class="secondary" style="display: inline-flex; justify-content: center; align-items: center; gap: 6px; padding: 10px 12px; background-color: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); border: 1px solid color-mix(in srgb, var(--vscode-button-secondaryBackground) 50%, transparent); border-radius: 6px; text-decoration: none; font-weight: 600;">\u{1F4DD} Swagger UI</a>
                <a href="http://${i.host}:${i.port}/openapi.json" target="_blank" class="secondary" style="display: inline-flex; justify-content: center; align-items: center; gap: 6px; padding: 10px 12px; background-color: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); border: 1px solid color-mix(in srgb, var(--vscode-button-secondaryBackground) 50%, transparent); border-radius: 6px; text-decoration: none; font-weight: 600;">\u{1F4C4} OpenAPI JSON</a>
            </div>
        </div>

        <div class="card full-width" style="background: linear-gradient(135deg, color-mix(in srgb, var(--vscode-editor-background) 90%, #3b82f6 10%), color-mix(in srgb, var(--vscode-editor-background) 95%, #8b5cf6 5%));">
            <h3>\u{1F468}\u200D\u{1F4BB} About</h3>
            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <div style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Suhaib Bin Younis</div>
                    <div class="muted" style="margin-bottom: 8px;">Developer & Creator</div>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        <a href="https://suhaibbinyounis.com" target="_blank" style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background: var(--vscode-button-secondaryBackground); border-radius: 4px; text-decoration: none; font-size: 12px;">\u{1F310} Website</a>
                        <a href="https://suhaib.in" target="_blank" style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background: var(--vscode-button-secondaryBackground); border-radius: 4px; text-decoration: none; font-size: 12px;">\u{1F517} suhaib.in</a>
                        <a href="mailto:vscode@suhaib.in" style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background: var(--vscode-button-secondaryBackground); border-radius: 4px; text-decoration: none; font-size: 12px;">\u{1F4E7} Email</a>
                        <a href="https://github.com/pmbyt/github-copilot-api-vscode" target="_blank" style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background: var(--vscode-button-secondaryBackground); border-radius: 4px; text-decoration: none; font-size: 12px;">\u2B50 Star on GitHub</a>
                    </div>
                </div>
                <div class="muted" style="font-size: 11px; text-align: right;">
                    GitHub Copilot API Gateway v${r.getVersion()}<br>
                    Made with \u2764\uFE0F and \u2615
                </div>
            </div>
        </div>

        <!-- Prompt Generator Section -->
        <div id="prompt-generator-section" class="card full-width" style="background: linear-gradient(135deg, color-mix(in srgb, var(--vscode-editor-background) 95%, #8b5cf6 5%), color-mix(in srgb, var(--vscode-editor-background) 98%, #7c3aed 2%));">
            <h3>\u2728 Prompt Generator</h3>
            <p class="muted" style="margin-bottom: 16px;">Create high-quality, detailed prompts for AI assistants. Select options or describe what you need. <span style="opacity: 0.7; font-size: 10px;">\u{1F4A1} Uses Copilot directly - server not required</span></p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 16px;">
                <!-- Project Type -->
                <div>
                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; opacity: 0.8;">\u{1F3AF} Project Type</label>
                    <select id="prompt-project-type" style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-size: 12px;">
                        <option value="">Select type...</option>
                        <option value="web-app">Web Application</option>
                        <option value="mobile-app">Mobile App</option>
                        <option value="api">REST API / Backend</option>
                        <option value="cli">CLI Tool</option>
                        <option value="library">Library / Package</option>
                        <option value="automation">Automation Script</option>
                        <option value="data">Data Processing</option>
                        <option value="ml">Machine Learning</option>
                        <option value="devops">DevOps / Infrastructure</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <!-- Tech Stack -->
                <div>
                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; opacity: 0.8;">\u{1F6E0}\uFE0F Tech Stack</label>
                    <select id="prompt-tech-stack" style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-size: 12px;">
                        <option value="">Select stack...</option>
                        <option value="typescript-node">TypeScript + Node.js</option>
                        <option value="python">Python</option>
                        <option value="react">React + TypeScript</option>
                        <option value="nextjs">Next.js</option>
                        <option value="vue">Vue.js</option>
                        <option value="rust">Rust</option>
                        <option value="go">Go</option>
                        <option value="java">Java / Spring</option>
                        <option value="csharp">.NET / C#</option>
                        <option value="swift">Swift / iOS</option>
                        <option value="kotlin">Kotlin / Android</option>
                        <option value="flutter">Flutter / Dart</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <!-- Goal -->
                <div>
                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; opacity: 0.8;">\u{1F3AA} Goal</label>
                    <select id="prompt-goal" style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-size: 12px;">
                        <option value="">Select goal...</option>
                        <option value="build-new">Build from scratch</option>
                        <option value="add-feature">Add new feature</option>
                        <option value="refactor">Refactor / Improve</option>
                        <option value="debug">Debug / Fix issues</option>
                        <option value="optimize">Optimize performance</option>
                        <option value="test">Write tests</option>
                        <option value="document">Write documentation</option>
                        <option value="review">Code review</option>
                        <option value="migrate">Migrate / Upgrade</option>
                        <option value="learn">Learn / Explain</option>
                    </select>
                </div>
                
                <!-- Complexity -->
                <div>
                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; opacity: 0.8;">\u{1F4CA} Complexity</label>
                    <select id="prompt-complexity" style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-size: 12px;">
                        <option value="">Select level...</option>
                        <option value="simple">Simple / Quick task</option>
                        <option value="medium">Medium complexity</option>
                        <option value="complex">Complex / Multi-step</option>
                        <option value="enterprise">Enterprise-grade</option>
                    </select>
                </div>
            </div>
            
            <!-- Custom Context -->
            <div style="margin-bottom: 16px;">
                <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; opacity: 0.8;">\u{1F4DD} Describe what you want to build</label>
                <textarea id="prompt-context" placeholder="E.g., 'A user authentication system with OAuth, password reset, and role-based access control...'" style="width: 100%; min-height: 80px; padding: 10px; border-radius: 6px; border: 1px solid var(--vscode-widget-border); background: var(--vscode-input-background); color: var(--vscode-input-foreground); font-size: 12px; resize: vertical; font-family: inherit; box-sizing: border-box;"></textarea>
            </div>
            
            <!-- Generate Button -->
            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                <button id="btn-generate-prompt" style="flex: 1; padding: 10px 16px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px; display: flex; align-items: center; justify-content: center; gap: 6px;">
                    \u2728 Generate Prompt
                </button>
                <button id="btn-enhance-prompt" class="secondary" style="padding: 10px 16px; background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); border: none; border-radius: 6px; cursor: pointer; font-size: 12px;" title="Enhance with AI suggestions">
                    \u{1F680} Enhance
                </button>
            </div>
            
            <!-- Output Area -->
            <div id="prompt-output-container" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <label style="font-size: 11px; font-weight: 600; opacity: 0.8;">\u{1F4CB} Generated Prompt</label>
                    <div style="display: flex; gap: 4px;">
                        <button id="btn-copy-prompt" class="secondary" style="padding: 4px 10px; font-size: 10px; border-radius: 4px; cursor: pointer; border: none; background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground);">\u{1F4CB} Copy</button>
                        <button id="btn-export-prompt" class="secondary" style="padding: 4px 10px; font-size: 10px; border-radius: 4px; cursor: pointer; border: none; background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground);">\u{1F4BE} Export</button>
                    </div>
                </div>
                <div id="prompt-output" style="background: var(--vscode-editor-background); border: 1px solid var(--vscode-widget-border); border-radius: 8px; padding: 16px; font-size: 12px; line-height: 1.6; white-space: pre-wrap; max-height: 400px; overflow-y: auto; font-family: var(--vscode-editor-font-family);"></div>
            </div>
            
            <!-- Loading State -->
            <div id="prompt-loading" style="display: none; text-align: center; padding: 20px;">
                <div style="display: inline-block; animation: spin 1s linear infinite; font-size: 24px;">\u2699\uFE0F</div>
                <div class="muted" style="margin-top: 8px;">Generating your prompt with AI...</div>
            </div>
        </div>

        <!-- Mini Wiki Section -->
        <div id="wiki-section" class="card full-width" style="background: linear-gradient(135deg, color-mix(in srgb, var(--vscode-editor-background) 92%, #10b981 8%), color-mix(in srgb, var(--vscode-editor-background) 96%, #059669 4%));">
            <h3>\u{1F4DA} API Usage Guide</h3>
            <p class="muted" style="margin-bottom: 16px;">Complete reference for connecting to the Copilot API Gateway from various languages, with installation instructions and real-world examples.</p>
            
            <!-- Tab Navigation -->
            <div id="wiki-tabs" style="display: flex; gap: 4px; margin-bottom: 16px; flex-wrap: wrap;">
                <button class="wiki-tab active" data-tab="python" style="padding: 8px 16px; border: none; border-radius: 6px 6px 0 0; cursor: pointer; font-size: 12px; font-weight: 600;">\u{1F40D} Python</button>
                <button class="wiki-tab" data-tab="javascript" style="padding: 8px 16px; border: none; border-radius: 6px 6px 0 0; cursor: pointer; font-size: 12px; font-weight: 600;">\u{1F4DC} JavaScript</button>
                <button class="wiki-tab" data-tab="curl" style="padding: 8px 16px; border: none; border-radius: 6px 6px 0 0; cursor: pointer; font-size: 12px; font-weight: 600;">\u{1F527} cURL</button>
                <button class="wiki-tab" data-tab="mcp" style="padding: 8px 16px; border: none; border-radius: 6px 6px 0 0; cursor: pointer; font-size: 12px; font-weight: 600;">\u{1F50C} MCP Tools</button>
            </div>

            <!-- Tab Content -->
            <div id="wiki-content" style="background: var(--vscode-editor-background); border-radius: 0 8px 8px 8px; padding: 16px; max-height: 600px; overflow-y: auto;">
                
                <!-- Python Tab -->
                <div class="wiki-panel" data-panel="python">
                    <h4 style="margin-top: 0; color: var(--vscode-textLink-foreground);">\u{1F4E6} Installation</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;"># Install the OpenAI Python library
pip install openai

# Or with Anthropic support
pip install anthropic</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F680} Quick Start - OpenAI SDK</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">from openai import OpenAI

# Point to your local Copilot API Gateway
client = OpenAI(
    base_url="http://${i.host}:${i.port}/v1",
    api_key="not-needed"  # API key not required unless configured
)

# Simple chat completion
response = client.chat.completions.create(
    model="gpt-4o",  # or "claude-3.5-sonnet", "o1-mini", etc.
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Explain quantum computing in simple terms"}
    ],
    temperature=0.7,
    max_tokens=500
)

print(response.choices[0].message.content)</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F4E1} Streaming Responses</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">from openai import OpenAI

client = OpenAI(
    base_url="http://${i.host}:${i.port}/v1",
    api_key="not-needed"
)

# Stream the response in real-time
stream = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": "Write a haiku about coding"}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="", flush=True)
print()  # Newline at end</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F527} Function Calling (Tool Use)</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">from openai import OpenAI
import json

client = OpenAI(
    base_url="http://${i.host}:${i.port}/v1",
    api_key="not-needed"
)

# Define tools/functions
tools = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "Get current weather for a location",
            "parameters": {
                "type": "object",
                "properties": {
                    "location": {"type": "string", "description": "City name"},
                    "unit": {"type": "string", "enum": ["celsius", "fahrenheit"]}
                },
                "required": ["location"]
            }
        }
    }
]

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": "What's the weather in Tokyo?"}],
    tools=tools,
    tool_choice="auto"
)

# Check if model wants to call a function
if response.choices[0].message.tool_calls:
    tool_call = response.choices[0].message.tool_calls[0]
    print(f"Function: {tool_call.function.name}")
    print(f"Arguments: {tool_call.function.arguments}")</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F3AD} Using with Anthropic SDK</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">import anthropic

client = anthropic.Anthropic(
    base_url="http://${i.host}:${i.port}",
    api_key="not-needed"
)

message = client.messages.create(
    model="claude-3.5-sonnet",
    max_tokens=1024,
    system="You are a helpful coding assistant.",
    messages=[
        {"role": "user", "content": "Write a Python function to calculate fibonacci"}
    ]
)

print(message.content[0].text)</pre>
                </div>

                <!-- JavaScript Tab -->
                <div class="wiki-panel" data-panel="javascript" style="display: none;">
                    <h4 style="margin-top: 0; color: var(--vscode-textLink-foreground);">\u{1F4E6} Installation</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;"># Node.js - Install OpenAI SDK
npm install openai

# Or with yarn
yarn add openai</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F680} Quick Start - Node.js</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">import OpenAI from 'openai';

const openai = new OpenAI({
  baseURL: 'http://${i.host}:${i.port}/v1',
  apiKey: 'not-needed'
});

async function chat() {
  const completion = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [
      { role: 'system', content: 'You are a helpful assistant.' },
      { role: 'user', content: 'Hello!' }
    ]
  });

  console.log(completion.choices[0].message.content);
}

chat();</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F4E1} Streaming Responses</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">import OpenAI from 'openai';

const openai = new OpenAI({
  baseURL: 'http://${i.host}:${i.port}/v1',
  apiKey: 'not-needed'
});

async function streamChat() {
  const stream = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [{ role: 'user', content: 'Tell me a story' }],
    stream: true
  });

  for await (const chunk of stream) {
    const content = chunk.choices[0]?.delta?.content || '';
    process.stdout.write(content);
  }
}

streamChat();</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F310} Browser - Fetch API</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">async function chat(message) {
  const response = await fetch('http://${i.host}:${i.port}/v1/chat/completions', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      model: 'gpt-4o',
      messages: [{ role: 'user', content: message }]
    })
  });

  const data = await response.json();
  return data.choices[0].message.content;
}

// Usage
const answer = await chat('What is the capital of France?');
console.log(answer);</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F527} Function Calling</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">import OpenAI from 'openai';

const openai = new OpenAI({
  baseURL: 'http://${i.host}:${i.port}/v1',
  apiKey: 'not-needed'
});

const tools = [{
  type: 'function',
  function: {
    name: 'search_database',
    description: 'Search for records in database',
    parameters: {
      type: 'object',
      properties: {
        query: { type: 'string', description: 'Search query' },
        limit: { type: 'number', description: 'Max results' }
      },
      required: ['query']
    }
  }
}];

const response = await openai.chat.completions.create({
  model: 'gpt-4o',
  messages: [{ role: 'user', content: 'Find all users named John' }],
  tools: tools
});

console.log(response.choices[0].message.tool_calls);</pre>
                </div>

                <!-- cURL Tab -->
                <div class="wiki-panel" data-panel="curl" style="display: none;">
                    <h4 style="margin-top: 0; color: var(--vscode-textLink-foreground);">\u{1F680} Basic Chat Completion</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -d '{
    "model": "gpt-4o",
    "messages": [
      {"role": "system", "content": "You are a helpful assistant."},
      {"role": "user", "content": "Hello!"}
    ]
  }'</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F4E1} Streaming Response</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -N \\
  -d '{
    "model": "gpt-4o",
    "stream": true,
    "messages": [{"role": "user", "content": "Write a poem about AI"}]
  }'</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F510} With API Key Authentication</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer your-secret-api-key" \\
  -d '{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F4CB} List Available Models</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/models</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F3AD} Anthropic Endpoint (Claude)</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/messages \\
  -H "Content-Type: application/json" \\
  -H "x-api-key: not-needed" \\
  -H "anthropic-version: 2023-06-01" \\
  -d '{
    "model": "claude-3.5-sonnet",
    "max_tokens": 1024,
    "messages": [{"role": "user", "content": "Hello Claude!"}]
  }'</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F527} Function Calling</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -d '{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "What time is it in London?"}],
    "tools": [{
      "type": "function",
      "function": {
        "name": "get_time",
        "description": "Get current time for a timezone",
        "parameters": {
          "type": "object",
          "properties": {
            "timezone": {"type": "string"}
          }
        }
      }
    }]
  }'</pre>
                </div>

                <!-- MCP Tools Tab -->
                <div class="wiki-panel" data-panel="mcp" style="display: none;">
                    <h4 style="margin-top: 0; color: var(--vscode-textLink-foreground);">\u2699\uFE0F Configure MCP Servers (settings.json)</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">// Add to your VS Code settings.json
"githubCopilotApi.mcp.servers": {
  // Filesystem access
  "filesystem": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-filesystem", "/path/to/folder"]
  },
  // Git operations
  "git": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-git"]
  },
  // Remote MCP server via SSE
  "remote-tools": {
    "url": "http://your-server:8000/sse"
  }
}</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F5A5}\uFE0F Built-in VS Code Tools</h4>
                    <p class="muted" style="font-size: 11px; margin-bottom: 12px;">These tools are automatically available without any configuration:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 12px;">
                        <div style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; border-left: 3px solid #10b981;">
                            <code style="font-size: 12px; color: var(--vscode-textPreformat-foreground); font-weight: 600;">vscode_read_file</code>
                            <div class="muted" style="font-size: 11px; margin-top: 4px;">Read the contents of any file in the workspace</div>
                            <pre style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; font-size: 10px; margin-top: 8px;">{ "uri": "file:///path/to/file.ts" }</pre>
                        </div>
                        
                        <div style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; border-left: 3px solid #3b82f6;">
                            <code style="font-size: 12px; color: var(--vscode-textPreformat-foreground); font-weight: 600;">vscode_list_files</code>
                            <div class="muted" style="font-size: 11px; margin-top: 4px;">List files in a directory with optional glob pattern</div>
                            <pre style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; font-size: 10px; margin-top: 8px;">{ "folder": "/src", "pattern": "**/*.ts" }</pre>
                        </div>
                        
                        <div style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; border-left: 3px solid #f59e0b;">
                            <code style="font-size: 12px; color: var(--vscode-textPreformat-foreground); font-weight: 600;">vscode_open_file</code>
                            <div class="muted" style="font-size: 11px; margin-top: 4px;">Open a file in VS Code editor, optionally at specific lines</div>
                            <pre style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; font-size: 10px; margin-top: 8px;">{ "uri": "file:///path/to/file.ts", "startLine": 10, "endLine": 20 }</pre>
                        </div>
                        
                        <div style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; border-left: 3px solid #ef4444;">
                            <code style="font-size: 12px; color: var(--vscode-textPreformat-foreground); font-weight: 600;">vscode_get_diagnostics</code>
                            <div class="muted" style="font-size: 11px; margin-top: 4px;">Get current errors and warnings from the Problems panel</div>
                            <pre style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; font-size: 10px; margin-top: 8px;">{ "maxResults": 50 }</pre>
                        </div>
                        
                        <div style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; border-left: 3px solid #8b5cf6;">
                            <code style="font-size: 12px; color: var(--vscode-textPreformat-foreground); font-weight: 600;">vscode_get_active_editor</code>
                            <div class="muted" style="font-size: 11px; margin-top: 4px;">Get content and cursor position of currently open file</div>
                            <pre style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px; font-size: 10px; margin-top: 8px;">{ } // No parameters needed</pre>
                        </div>
                    </div>

                    <h4 style="color: var(--vscode-textLink-foreground); margin-top: 20px;">\u{1F40D} Using VS Code Tools with Python</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">from openai import OpenAI

client = OpenAI(
    base_url="http://${i.host}:${i.port}/v1",
    api_key="not-needed"
)

# Define the VS Code tools
vscode_tools = [
    {
        "type": "function",
        "function": {
            "name": "vscode_read_file",
            "description": "Read the contents of a file",
            "parameters": {
                "type": "object",
                "properties": {
                    "uri": {"type": "string", "description": "File URI (file:///path/to/file)"}
                },
                "required": ["uri"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "vscode_get_diagnostics",
            "description": "Get current errors and warnings",
            "parameters": {
                "type": "object",
                "properties": {
                    "maxResults": {"type": "number", "description": "Max results to return"}
                }
            }
        }
    }
]

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {"role": "user", "content": "Read package.json and tell me the version"}
    ],
    tools=vscode_tools,
    tool_choice="auto"
)

# The gateway will automatically execute the tool and return results
if response.choices[0].message.tool_calls:
    for tool_call in response.choices[0].message.tool_calls:
        print(f"Tool: {tool_call.function.name}")
        print(f"Args: {tool_call.function.arguments}")</pre>

                    <h4 style="color: var(--vscode-textLink-foreground);">\u{1F527} cURL Example with MCP Tools</h4>
                    <pre style="background: var(--vscode-textBlockQuote-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">curl http://${i.host}:${i.port}/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -d '{
    "model": "gpt-4o",
    "messages": [
      {"role": "user", "content": "List all TypeScript files in /src and check for errors"}
    ],
    "tools": [
      {
        "type": "function",
        "function": {
          "name": "vscode_list_files",
          "description": "List files matching pattern",
          "parameters": {
            "type": "object",
            "properties": {
              "folder": {"type": "string"},
              "pattern": {"type": "string"}
            }
          }
        }
      },
      {
        "type": "function",
        "function": {
          "name": "vscode_get_diagnostics",
          "description": "Get errors and warnings",
          "parameters": {
            "type": "object",
            "properties": {
              "maxResults": {"type": "number"}
            }
          }
        }
      }
    ]
  }'</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detail-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: var(--vscode-sideBar-background); padding: 24px; border-radius: 12px; width: 80%; max-width: 800px; max-height: 80vh; display: flex; flex-direction: column; overflow: hidden; border: 1px solid var(--vscode-widget-border); box-shadow: 0 4px 24px rgba(0,0,0,0.25);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3 style="margin: 0;">Request Details</h3>
                <button class="secondary" id="btn-close-modal" style="width: auto; padding: 6px 12px;">Close</button>
            </div>
            <div style="overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 16px; padding-right: 8px;">
                <div style="position: relative;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <h4 style="margin: 0; opacity: 0.8;">Request</h4>
                        <button class="secondary btn-copy-modal" data-target="modal-request" style="width: auto; padding: 2px 8px; font-size: 10px;">\u{1F4CB} Copy</button>
                    </div>
                    <pre id="modal-request" style="font-size: 11px; max-height: 300px; overflow: auto; margin: 0;"></pre>
                </div>
                <div style="position: relative;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <h4 style="margin: 0; opacity: 0.8;">Response</h4>
                        <button class="secondary btn-copy-modal" data-target="modal-response" style="width: auto; padding: 2px 8px; font-size: 10px;">\u{1F4CB} Copy</button>
                    </div>
                    <pre id="modal-response" style="font-size: 11px; max-height: 300px; overflow: auto; margin: 0;"></pre>
                </div>
            </div>
        </div>
    </div>

    <script nonce="${n}">
        var vscode = acquireVsCodeApi();
        
        // Pagination state - declare at top to avoid hoisting issues
        var currentPage = 1;
        var pageSize = 10;
        var totalLogs = 0;
        var lastLogs = [];

        document.getElementById('btn-toggle-server').onclick = function() {
            var running = this.getAttribute('data-running') === 'true';
            vscode.postMessage({ type: running ? 'stopServer' : 'startServer' });
        };

        document.getElementById('btn-open-chat').onclick = function() {
            vscode.postMessage({ type: 'openChat' });
        };

        document.getElementById('btn-ask-copilot').onclick = function() {
            vscode.postMessage({ type: 'askCopilot' });
        };

        document.getElementById('btn-settings').onclick = function() {
            vscode.postMessage({ type: 'showControls' });
        };

        document.getElementById('toggle-http').onchange = function() {
            vscode.postMessage({ type: 'toggleHttp' });
        };

        document.getElementById('toggle-ws').onchange = function() {
            vscode.postMessage({ type: 'toggleWs' });
        };

        document.getElementById('toggle-logging').onchange = function() {
            vscode.postMessage({ type: 'toggleLogging' });
        };

        document.getElementById('toggle-https').onchange = function() {
            vscode.postMessage({ type: 'toggleHttps' });
        };

        // Store the current API key for copy functionality
        var currentApiKey = '${i.apiKey||""}';

        document.getElementById('toggle-auth').onchange = function() {
            if (!this.checked) {
                // Disable auth by clearing API key
                currentApiKey = '';
                vscode.postMessage({ type: 'setApiKey', value: '' });
            } else {
                // Generate a random key when enabling
                var key = 'sk-' + Array.from(crypto.getRandomValues(new Uint8Array(24))).map(b => b.toString(16).padStart(2, '0')).join('');
                document.getElementById('api-key-input').value = key;
                document.getElementById('api-key-input').type = 'text';
                currentApiKey = key;
                vscode.postMessage({ type: 'setApiKey', value: key });
            }
        };

        document.getElementById('btn-set-apikey').onclick = function() {
            var v = document.getElementById('api-key-input').value.trim();
            currentApiKey = v;
            vscode.postMessage({ type: 'setApiKey', value: v });
            if (v) {
                document.getElementById('toggle-auth').checked = true;
            }
        };

        document.getElementById('btn-generate-key').onclick = function() {
            var key = 'sk-' + Array.from(crypto.getRandomValues(new Uint8Array(24))).map(b => b.toString(16).padStart(2, '0')).join('');
            document.getElementById('api-key-input').value = key;
            document.getElementById('api-key-input').type = 'text';
            currentApiKey = key;
            vscode.postMessage({ type: 'setApiKey', value: key });
            document.getElementById('toggle-auth').checked = true;
        };

        document.getElementById('btn-copy-key').onclick = function() {
            var input = document.getElementById('api-key-input');
            var keyToCopy = input.value.trim() || currentApiKey;
            if (keyToCopy) {
                navigator.clipboard.writeText(keyToCopy).then(function() {
                    var btn = document.getElementById('btn-copy-key');
                    btn.textContent = '\u2713';
                    setTimeout(function() { btn.textContent = '\u{1F4CB}'; }, 1500);
                });
            }
        };

        document.getElementById('btn-show-key').onclick = function() {
            var input = document.getElementById('api-key-input');
            var btn = document.getElementById('btn-show-key');
            if (input.type === 'password') {
                input.type = 'text';
                if (!input.value && currentApiKey) {
                    input.value = currentApiKey;
                }
                btn.textContent = '\u{1F648}';
            } else {
                input.type = 'password';
                btn.textContent = '\u{1F441}';
            }
        };

        document.getElementById('btn-set-ratelimit').onclick = function() {
            var v = document.getElementById('rate-limit-input').value;
            vscode.postMessage({ type: 'setRateLimit', value: Number(v) || 0 });
        };

        // Initialize on load
        // try { initCharts(); } catch (e) { console.error('Failed to init charts', e); }
        
        // Request initial data
        setTimeout(() => vscode.postMessage({ type: 'getAuditStats' }), 500);

        document.getElementById('btn-refresh-audit').onclick = function() {
            startCountdown(); // Reset timer
            vscode.postMessage({ type: 'getAuditStats' });
            vscode.postMessage({ type: 'getAuditLogs', value: { page: currentPage, pageSize: pageSize } });
            this.textContent = '\u{1F504} Loading...';
            setTimeout(() => { this.textContent = '\u{1F504} Refresh'; }, 1000);
        };

        document.getElementById('btn-open-logs').onclick = function() {
            vscode.postMessage({ type: 'openLogFolder' });
        };

        // Modal Logic
        // Modal Logic
        const modal = document.getElementById('detail-modal');
        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = ''; // Restore scrolling
        }

        document.getElementById('btn-close-modal').onclick = closeModal;
        
        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }

        // Global function for View button
        window.showDetails = function(index) {
            if (!lastLogs || !lastLogs[index]) return;
            const log = lastLogs[index];
            
            const reqContent = {
                headers: log.requestHeaders,
                body: log.requestBody
            };
            const resContent = {
                headers: log.responseHeaders,
                body: log.responseBody,
                error: log.error
            };

            document.getElementById('modal-request').textContent = JSON.stringify(reqContent, null, 2);
            document.getElementById('modal-response').textContent = JSON.stringify(resContent, null, 2);
            
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Lock scrolling
        };

        // Copy content from modal
        document.querySelectorAll('.btn-copy-modal').forEach(btn => {
            btn.onclick = function() {
                const targetId = this.getAttribute('data-target');
                const content = document.getElementById(targetId).textContent;
                if (content) {
                    navigator.clipboard.writeText(content).then(() => {
                        const originalText = this.textContent;
                        this.textContent = '\u2713 Copied';
                        setTimeout(() => { this.textContent = originalText; }, 1500);
                    });
                }
            };
        });

        // Wiki tab switching
        document.querySelectorAll('.wiki-tab').forEach(function(tab) {
            tab.onclick = function() {
                var targetPanel = this.getAttribute('data-tab');
                // Update active tab styling
                document.querySelectorAll('.wiki-tab').forEach(function(t) {
                    t.classList.remove('active');
                    t.style.background = 'var(--vscode-button-secondaryBackground)';
                    t.style.color = 'var(--vscode-button-secondaryForeground)';
                });
                this.classList.add('active');
                this.style.background = 'var(--vscode-editor-background)';
                this.style.color = 'var(--vscode-foreground)';
                // Show corresponding panel
                document.querySelectorAll('.wiki-panel').forEach(function(p) {
                    p.style.display = 'none';
                });
                var panel = document.querySelector('.wiki-panel[data-panel="' + targetPanel + '"]');
                if (panel) panel.style.display = 'block';
            };
            // Initialize styling
            if (tab.classList.contains('active')) {
                tab.style.background = 'var(--vscode-editor-background)';
                tab.style.color = 'var(--vscode-foreground)';
            } else {
                tab.style.background = 'var(--vscode-button-secondaryBackground)';
                tab.style.color = 'var(--vscode-button-secondaryForeground)';
            }
        });

        // Prompt Generator handlers
        document.getElementById('btn-generate-prompt').onclick = function() {
            var projectType = document.getElementById('prompt-project-type').value;
            var techStack = document.getElementById('prompt-tech-stack').value;
            var goal = document.getElementById('prompt-goal').value;
            var complexity = document.getElementById('prompt-complexity').value;
            var context = document.getElementById('prompt-context').value;
            
            if (!context && !projectType && !techStack && !goal) {
                alert('Please select at least one option or describe what you want to build.');
                return;
            }
            
            document.getElementById('prompt-output-container').style.display = 'none';
            document.getElementById('prompt-loading').style.display = 'block';
            
            vscode.postMessage({
                type: 'generatePrompt',
                data: { projectType: projectType, techStack: techStack, goal: goal, complexity: complexity, context: context }
            });
        };
        
        document.getElementById('btn-enhance-prompt').onclick = function() {
            var context = document.getElementById('prompt-context').value;
            var currentOutput = document.getElementById('prompt-output').textContent;
            
            if (!context && !currentOutput) {
                alert('Please enter a description or generate a prompt first.');
                return;
            }
            
            document.getElementById('prompt-loading').style.display = 'block';
            
            vscode.postMessage({
                type: 'enhancePrompt',
                data: { context: context, existingPrompt: currentOutput }
            });
        };
        
        document.getElementById('btn-copy-prompt').onclick = function() {
            var content = document.getElementById('prompt-output').textContent;
            navigator.clipboard.writeText(content).then(function() {
                var btn = document.getElementById('btn-copy-prompt');
                btn.textContent = '\u2713 Copied';
                setTimeout(function() { btn.textContent = '\u{1F4CB} Copy'; }, 1500);
            });
        };
        
        document.getElementById('btn-export-prompt').onclick = function() {
            var content = document.getElementById('prompt-output').textContent;
            var blob = new Blob([content], { type: 'text/plain' });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'generated-prompt.txt';
            a.click();
            URL.revokeObjectURL(url);
        };

        // Auto-refresh Countdown Logic
        let refreshTimer = 10;
        let refreshIntervalVal = null;
        const refreshSpan = document.getElementById('refresh-timer');
        
        function startCountdown() {
            if (refreshIntervalVal) clearInterval(refreshIntervalVal);
            
            refreshTimer = 10;
            updateTimerDisplay();
            
            refreshIntervalVal = setInterval(() => {
                refreshTimer--;
                updateTimerDisplay();
                
                if (refreshTimer <= 0) {
                    refreshTimer = 10;
                    vscode.postMessage({ type: 'getAuditStats' });
                    // Also refresh current page of logs
                    vscode.postMessage({ type: 'getAuditLogs', value: { page: currentPage, pageSize: pageSize } });
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            if (refreshSpan) {
                refreshSpan.textContent = \`Refreshing in \${refreshTimer}s...\`;
            }
        }

        startCountdown();

        // IP Allowlist handlers
        document.getElementById('btn-add-ip').onclick = function() {
            var ip = document.getElementById('ip-allowlist-input').value.trim();
            if (ip) {
                vscode.postMessage({ type: 'addIpAllowlistEntry', value: ip });
                document.getElementById('ip-allowlist-input').value = '';
            }
        };

        document.querySelectorAll('.btn-remove-ip').forEach(function(btn) {
            btn.onclick = function() {
                var ip = btn.getAttribute('data-value');
                if (ip) {
                    vscode.postMessage({ type: 'removeIpAllowlistEntry', value: ip });
                }
            };
        });

        document.getElementById('btn-host-local').onclick = function() {
            vscode.postMessage({ type: 'hostLocal' });
        };

        document.getElementById('btn-host-lan').onclick = function() {
            vscode.postMessage({ type: 'hostLan' });
        };

        // Copy URL buttons for shareable LAN URLs
        document.querySelectorAll('.btn-copy-url').forEach(function(btn) {
            btn.onclick = function() {
                var url = btn.getAttribute('data-url');
                if (url) {
                    navigator.clipboard.writeText(url).then(function() {
                        var originalText = btn.textContent;
                        btn.textContent = '\u2713 Copied!';
                        setTimeout(function() { btn.textContent = originalText; }, 1500);
                    });
                }
            };
        });

        // MCP Toggle
        var mcpToggle = document.getElementById('mcp-enabled-toggle');
        if (mcpToggle) {
            mcpToggle.onchange = function() {
                vscode.postMessage({ type: 'toggleMcp', value: mcpToggle.checked });
            };
        }

        document.getElementById('btn-set-host').onclick = function() {
            var host = document.getElementById('custom-host').value;
            var port = document.getElementById('custom-port').value;
            if (host) vscode.postMessage({ type: 'setHost', value: host });
            if (port) vscode.postMessage({ type: 'setPort', value: Number(port) });
        };

        // btn-set-port removed - consolidated with btn-set-host Apply button

        document.getElementById('btn-set-timeout').onclick = function() {
            var val = document.getElementById('timeout-input').value;
            vscode.postMessage({ type: 'setRequestTimeout', value: Number(val) });
        };

        document.getElementById('btn-set-payload').onclick = function() {
            var val = document.getElementById('payload-input').value;
            vscode.postMessage({ type: 'setMaxPayloadSize', value: Number(val) });
        };

        document.getElementById('btn-set-connections').onclick = function() {
            var val = document.getElementById('connections-input').value;
            vscode.postMessage({ type: 'setMaxConnectionsPerIp', value: Number(val) });
        };

        document.getElementById('btn-set-concurrency').onclick = function() {
            var val = document.getElementById('concurrency-input').value;
            vscode.postMessage({ type: 'setMaxConcurrency', value: Number(val) });
        };

        // btn-set-model removed - element doesn't exist in current UI

        // Redaction pattern handlers
        document.getElementById('btn-add-redaction').onclick = function() {
            var name = document.getElementById('redaction-name-input').value.trim();
            var pattern = document.getElementById('redaction-pattern-input').value.trim();
            if (!name) {
                alert('Please enter a pattern name');
                return;
            }
            if (!pattern) {
                alert('Please enter a regex pattern');
                return;
            }
            try {
                new RegExp(pattern); // Validate
                vscode.postMessage({ type: 'addRedactionPattern', value: { name: name, pattern: pattern } });
                document.getElementById('redaction-name-input').value = '';
                document.getElementById('redaction-pattern-input').value = '';
            } catch (e) {
                alert('Invalid regex pattern: ' + e.message);
            }
        };

        document.getElementById('btn-test-redaction').onclick = function() {
            var pattern = document.getElementById('redaction-pattern-input').value.trim();
            if (!pattern) {
                alert('Enter a pattern first');
                return;
            }
            try {
                var regex = new RegExp(pattern, 'gi');
                var testStr = prompt('Enter test string to check redaction:', 'my-api-key-12345 or test@email.com');
                if (testStr) {
                    var result = testStr.replace(regex, '[REDACTED]');
                    alert('Result: ' + result);
                }
            } catch (e) {
                alert('Invalid regex pattern: ' + e.message);
            }
        };

        // Toggle redaction pattern on/off
        document.querySelectorAll('.toggle-redaction').forEach(function(toggle) {
            toggle.onchange = function() {
                var id = toggle.getAttribute('data-id');
                var enabled = toggle.checked;
                vscode.postMessage({ type: 'toggleRedactionPattern', value: { id: id, enabled: enabled } });
            };
        });

        // Remove redaction pattern buttons
        document.querySelectorAll('.btn-remove-redaction').forEach(function(btn) {
            btn.onclick = function() {
                var id = btn.getAttribute('data-id');
                if (id && confirm('Remove this pattern?')) {
                    vscode.postMessage({ type: 'removeRedactionPattern', value: id });
                }
            };
        });

        // Handle messages from extension
        window.addEventListener('message', function(event) {
            var message = event.data;
            console.log('[Dashboard] Received message:', message.type, message);
            if (message.type === 'historyData') {
                // Legacy support if needed
            } else if (message.type === 'statsData') {
                updateStats(message.data);
            } else if (message.type === 'auditStatsData') {
                updateCharts(message.data);
            } else if (message.type === 'auditLogData') {
                console.log('[Dashboard] Updating log table with', message.data?.length || 0, 'entries');
                updateLogTable(message.data, message.page, message.total, message.pageSize);
            } else if (message.type === 'liveLog') {
                appendLog(message.value);
            } else if (message.type === 'scrollTo') {
                // Scroll to a specific section
                var target = message.target;
                if (target === 'wiki') {
                    var wikiSection = document.getElementById('wiki-section');
                    if (wikiSection) {
                        wikiSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                } else if (target === 'prompt-generator') {
                    var promptSection = document.getElementById('prompt-generator-section');
                    if (promptSection) {
                        promptSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }
            } else if (message.type === 'promptResult') {
                document.getElementById('prompt-loading').style.display = 'none';
                document.getElementById('prompt-output-container').style.display = 'block';
                document.getElementById('prompt-output').textContent = message.data;
            } else if (message.type === 'promptError') {
                document.getElementById('prompt-loading').style.display = 'none';
                alert('Error generating prompt: ' + message.error);
            }
        });

        // Pagination state variables moved to top of script

        document.getElementById('btn-prev-page').onclick = function() {
            if (currentPage > 1) {
                currentPage--;
                vscode.postMessage({ type: 'getAuditLogs', value: { page: currentPage, pageSize: pageSize } });
                document.getElementById('audit-table-body').innerHTML = '<tr><td colspan="7" style="padding: 20px; text-align: center; opacity: 0.7;">Loading...</td></tr>';
            }
        };

        document.getElementById('btn-next-page').onclick = function() {
            if (currentPage * pageSize < totalLogs) {
                currentPage++;
                vscode.postMessage({ type: 'getAuditLogs', value: { page: currentPage, pageSize: pageSize } });
                document.getElementById('audit-table-body').innerHTML = '<tr><td colspan="7" style="padding: 20px; text-align: center; opacity: 0.7;">Loading...</td></tr>';
            }
        };

        function updateCharts(stats) {
            // Charts removed per user request
        }

        // lastLogs declared at top of script

        function formatNumber(num) {
            if (num === undefined || num === null) return '0';
            if (num >= 1e12) return (num / 1e12).toFixed(1) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
            return num.toString();
        }

// Live Log Tail Logic
        const logContainer = document.getElementById('live-log-container');
        const autoScroll = document.getElementById('log-autoscroll');
        const logStatus = document.getElementById('log-status-indicator');
        let linesCount = 0;

        function appendLog(log) {
            if (!logContainer) return;
            if (linesCount === 0) logContainer.innerHTML = '';
            
            const line = document.createElement('div');
            line.className = 'log-line';
            
            const isError = log.status >= 400;
            const statusClass = isError ? 'error' : 'success';
            
            const time = new Date(log.timestamp).toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
            
            line.innerHTML = '<span class="log-time">[' + time + ']</span>' +
                             '<span class="log-method">' + (log.method || 'UNK') + '</span>' +
                             '<span class="log-path">' + (log.path || '/') + '</span>' +
                             '<span class="log-status ' + statusClass + '">' + (log.status || 0) + '</span>' +
                             '<span class="log-latency">' + (log.durationMs || 0) + 'ms</span>';

            
            logContainer.appendChild(line);
            linesCount++;
            
            // Pulse status indicator
            if (logStatus) {
                logStatus.classList.remove('active');
                void logStatus.offsetWidth; // Trigger reflow
                logStatus.classList.add('active');
            }
            
            // Limit shown lines to 100 for performance
            if (linesCount > 100) {
                logContainer.removeChild(logContainer.firstChild);
                linesCount--;
            }
            
            if (autoScroll && autoScroll.checked) {
                logContainer.scrollTop = logContainer.scrollHeight;
            }
        }

        document.getElementById('btn-clear-logs').onclick = function() {
            if (logContainer) {
                logContainer.innerHTML = '<div class="muted" style="text-align: center; padding-top: 120px; opacity: 0.5;">Waiting for API requests...</div>';
                linesCount = 0;
            }
        };

        function updateLogTable(logs, page, total, pSize) {
            lastLogs = logs;
            currentPage = page;
            totalLogs = total;
            pageSize = pSize || 10;

            const tbody = document.getElementById('audit-table-body');
            const pageInfo = document.getElementById('page-info');
            const btnPrev = document.getElementById('btn-prev-page');
            const btnNext = document.getElementById('btn-next-page');

            if (pageInfo) {
                const start = (page - 1) * pageSize + 1;
                const end = Math.min(page * pageSize, total);
                pageInfo.textContent = \`Showing \${total === 0 ? 0 : start}-\${end} of \${total}\`;
            }
            if (btnPrev) btnPrev.disabled = page <= 1;
            if (btnNext) btnNext.disabled = page * pageSize >= total;

            if (!tbody) return;
            
            // Clear checks to force refresh
            tbody.innerHTML = '';
            
            if (!logs || logs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="padding: 24px; text-align: center; opacity: 0.6; font-style: italic;">No audit logs found.<br><span style="font-size: 11px; opacity: 0.8; margin-top: 4px; display: block;">Make a request to generate logs.</span></td></tr>';
                return;
            }

            tbody.innerHTML = logs.map((log, index) => {
                const date = new Date(log.timestamp);
                const time = date.toLocaleTimeString();
                const statusColor = log.status >= 400 ? 'var(--vscode-testing-iconFailed)' : (log.status >= 300 ? 'var(--vscode-charts-yellow)' : 'var(--vscode-testing-iconPassed)');
                
                return \`
                <tr style="border-bottom: 1px solid var(--vscode-widget-border);">
                    <td style="padding: 8px 12px; white-space: nowrap; opacity: 0.8;">\${time}</td>
                    <td style="padding: 8px 12px; white-space: nowrap;"><span style="padding: 2px 6px; border-radius: 4px; background: var(--vscode-textCodeBlock-background); font-size: 11px; font-family: var(--vscode-editor-font-family);">\${log.method || 'UNK'}</span></td>
                    <td style="padding: 8px 12px; word-break: break-all; font-family: var(--vscode-editor-font-family);">\${log.path || '/'}</td>
                    <td style="padding: 8px 12px; color: \${statusColor}; font-weight: 600;">\${log.status || 0}</td>
                    <td style="padding: 8px 12px;">\${log.durationMs || 0}ms</td>
                    <td style="padding: 8px 12px;" title="\${(log.tokensIn || 0) + (log.tokensOut || 0)} tokens">\${formatNumber ? formatNumber((log.tokensIn || 0) + (log.tokensOut || 0)) : 0}</td>
                    <td style="padding: 8px 12px;">
                        <button class="secondary btn-view-details" data-index="\${index}" style="padding: 2px 8px; font-size: 10px; width: auto;">\u{1F50D}</button>
                    </td>
                </tr>\`;
    }).join('');

    // Add event listeners for view buttons (CSP safe)
    document.querySelectorAll('.btn-view-details').forEach(btn => {
        btn.addEventListener('click', () => {
             const index = parseInt(btn.getAttribute('data-index') || '0');
             showDetails(index);
        });
    });
}

function updateStats(stats) {
    if (stats.totalRequests !== undefined) {
        document.getElementById('stat-requests').textContent = formatNumber(stats.totalRequests);
        document.getElementById('stat-requests').title = stats.totalRequests + ' requests';
    }
    if (stats.requestsPerMinute !== undefined) document.getElementById('stat-rpm').textContent = stats.requestsPerMinute;
    if (stats.avgLatencyMs !== undefined) document.getElementById('stat-latency').innerHTML = stats.avgLatencyMs + '<span style="font-size: 12px;">ms</span>';
    if (stats.totalTokensIn !== undefined) {
        document.getElementById('stat-tokens-in').textContent = formatNumber(stats.totalTokensIn);
        document.getElementById('stat-tokens-in').title = stats.totalTokensIn;
    }
    if (stats.totalTokensOut !== undefined) {
        document.getElementById('stat-tokens-out').textContent = formatNumber(stats.totalTokensOut);
        document.getElementById('stat-tokens-out').title = stats.totalTokensOut;
    }
    if (stats.errorRate !== undefined) document.getElementById('stat-errors').innerHTML = stats.errorRate + '<span style="font-size: 12px;">%</span>';
    if (stats.uptimeMs !== undefined) {
        var minutes = Math.floor(stats.uptimeMs / 60000);
        var hours = Math.floor(minutes / 60);
        var display = hours > 0 ? hours + 'h ' + (minutes % 60) + 'm' : minutes + 'm';
        document.getElementById('stat-uptime').textContent = display;
    }
    
    // Update MCP Status
    if (stats.mcp) {
        var mcpEnabled = stats.mcp.enabled;
        var statusBadge = document.getElementById('mcp-status-badge');
        if (statusBadge) {
            statusBadge.textContent = mcpEnabled ? (stats.mcp.servers.length > 0 ? 'Connected' : 'Ready') : 'Disabled';
            statusBadge.style.background = mcpEnabled ? (stats.mcp.servers.length > 0 ? 'var(--vscode-charts-green)' : 'var(--vscode-charts-blue)') : 'var(--vscode-charts-red)';
            statusBadge.style.color = 'white';
            statusBadge.style.padding = '2px 8px';
            statusBadge.style.borderRadius = '10px';
            statusBadge.style.fontSize = '10px';
        }

        var toggle = document.getElementById('mcp-enabled-toggle');
        if (toggle) toggle.checked = mcpEnabled;

        // Render Tools Grouped by Server
        var contentArea = document.getElementById('mcp-content-area');
        if (contentArea && stats.mcp.tools) {
            if (!mcpEnabled) {
                contentArea.innerHTML = '<div class="muted" style="text-align: center; padding: 20px;">MCP is disabled. Enable it in settings or toggle above.</div>';
                return;
            }

            if (stats.mcp.tools.length === 0) {
                 contentArea.innerHTML = '<div class="muted" style="text-align: center; padding: 20px;">No tools available. Connect a server or enable built-in tools.</div>';
                 return;
            }

            // Group tools
            var groups = {};
            stats.mcp.tools.forEach(function(tool) {
                if (!groups[tool.serverName]) { groups[tool.serverName] = []; }
                groups[tool.serverName].push(tool);
            });

            var html = '<div style="display: flex; flex-direction: column; gap: 24px;">';
            
            Object.keys(groups).sort().forEach(function(serverName) {
                var serverTools = groups[serverName];
                html += '<div>';
                html += '<div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">';
                html += '<span class="badge" style="background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); font-size: 10px;">' + serverName + '</span>';
                html += '<div style="height: 1px; flex: 1; background: var(--vscode-widget-border); opacity: 0.5;"></div>';
                html += '</div>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px;">';
                serverTools.forEach(function(t) {
                    html += '<div style="padding: 12px; border: 1px solid var(--vscode-widget-border); border-radius: 8px; background: rgba(0,0,0,0.02);">';
                    html += '<div style="font-family: var(--vscode-editor-font-family); font-weight: 600; font-size: 12px; margin-bottom: 4px; color: var(--vscode-textPreformat-foreground);">' + t.name + '</div>';
                    html += '<div style="font-size: 11px; opacity: 0.7; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;" title="' + (t.description || '') + '">' + (t.description || 'No description') + '</div>';
                    html += '</div>';
                });
                html += '</div>';
                html += '</div>';
            });

html += '</div>';

// Only update if changed to avoid flicker (hashing would be better but simple string comparison works for now)
// Actually, innerHTML rewrite is fine for this dashboard frequency
contentArea.innerHTML = html;
}
    }
}

// Auto-refresh stats every 5 seconds
setInterval(function () {
    vscode.postMessage({ type: 'getStats' });
}, 5000);

// Load audit data on page load
// Load audit data on page load
vscode.postMessage({ type: 'getAuditStats' });
vscode.postMessage({ type: 'getAuditLogs', value: { page: 1, pageSize: 10 } });
</script>
    </body>
    </html>`}async resolveWebviewView(e,r,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},e.webview.html=await this._getSidebarHtml(e.webview),e.webview.onDidReceiveMessage(async o=>{switch(o.type){case"openDashboard":await t.createOrShow(this._extensionUri,this._gateway);break;case"startServer":this._gateway.startServer();break;case"stopServer":this._gateway.stopServer();break;case"openSwagger":{let i=await this._gateway.getStatus(),s=`http://${i.config.host}:${i.config.port}/docs`;sr.env.openExternal(sr.Uri.parse(s));break}case"openMetrics":{let i=await this._gateway.getStatus(),s=`http://${i.config.host}:${i.config.port}/metrics`;sr.env.openExternal(sr.Uri.parse(s));break}case"openWiki":await t.createOrShow(this._extensionUri,this._gateway,"wiki");break;case"openPromptGenerator":await t.createOrShow(this._extensionUri,this._gateway,"prompt-generator");break;case"openAppsHub":sr.commands.executeCommand("github-copilot-api-vscode.openAppsHub");break}})}};function B8(){let t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<32;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}var se=it(require("vscode"));var U8=it(require("vscode")),L8=it(require("path")),Ik=it(require("fs")),F8=require("child_process"),V8=require("util"),Vv=(0,V8.promisify)(F8.exec),tM=class t{static instance;context;constructor(){}static getInstance(){return t.instance||(t.instance=new t),t.instance}initialize(e){this.context=e}getSavedProjects(){return this.context?this.context.globalState.get("apps.savedProjects",[]):[]}async addProject(e){if(!this.context||!Ik.existsSync(e)||!Ik.statSync(e).isDirectory())return null;let r=this.getSavedProjects(),n=r.find(i=>i.path===e);if(n)return n.lastUsed=Date.now(),await this.context.globalState.update("apps.savedProjects",r),n;let o={id:`proj_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,path:e,name:L8.basename(e),lastUsed:Date.now(),favorite:!1};return r.push(o),await this.context.globalState.update("apps.savedProjects",r),o}async removeProject(e){if(!this.context)return;let n=this.getSavedProjects().filter(o=>o.id!==e);await this.context.globalState.update("apps.savedProjects",n)}async toggleFavorite(e){if(!this.context)return;let r=this.getSavedProjects(),n=r.find(o=>o.id===e);n&&(n.favorite=!n.favorite,await this.context.globalState.update("apps.savedProjects",r))}async pickProjectFolder(){let e=await U8.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:"Select Project Folder",openLabel:"Select Project"});if(e&&e.length>0)return e[0].fsPath}async isGitRepository(e){try{return await Vv("git rev-parse --git-dir",{cwd:e}),!0}catch{return!1}}async getGitDiff(e,r){try{if(!await this.isGitRepository(e))return{diff:"",error:"Not a git repository"};let n;switch(r.type){case"staged":n="git diff --cached";break;case"unstaged":n="git diff";break;case"commits":n=`git diff HEAD~${r.commits||5}..HEAD`;break;case"branches":let a=r.baseBranch||"main",c=r.targetBranch||"HEAD";n=`git diff ${a}...${c}`;break;default:n="git diff"}n+=" --no-color";let{stdout:o,stderr:i}=await Vv(n,{cwd:e,maxBuffer:10*1024*1024});return i&&!o?{diff:"",error:i}:{diff:o}}catch(n){return{diff:"",error:n instanceof Error?n.message:String(n)}}}async getBranches(e){try{let{stdout:r}=await Vv('git branch -a --format="%(refname:short)"',{cwd:e});return r.split(`
`).filter(n=>n.trim()).map(n=>n.trim())}catch{return[]}}async getCurrentBranch(e){try{let{stdout:r}=await Vv("git branch --show-current",{cwd:e});return r.trim()||null}catch{return null}}async getRecentCommits(e,r=10){try{let{stdout:n}=await Vv(`git log -${r} --format="%H|%s|%an|%ad" --date=short`,{cwd:e});return n.split(`
`).filter(o=>o.trim()).map(o=>{let[i,s,a,c]=o.split("|");return{hash:i,message:s,author:a,date:c}})}catch{return[]}}async getCombinedDiff(e){return await Promise.all(e.map(async n=>{let o=await this.getGitDiff(n.path,{type:n.diffType,...n.options});return{projectPath:n.path,...o}}))}},Vl=tM.getInstance();var Z8={id:"code-review",name:"Code Review",description:"Full project code review using git diff",icon:"\u{1F50D}",category:"developer",inputs:[{id:"projectPaths",label:"Project Folders",type:"project-picker",placeholder:"Add project folders to review...",required:!0,hint:"You can add multiple projects for a combined review"},{id:"diffType",label:"What to Review",type:"radio",required:!0,defaultValue:"unstaged",options:[{value:"staged",label:"Staged Changes",icon:"\u{1F4E6}",description:"Changes added to git staging"},{value:"unstaged",label:"Unstaged Changes",icon:"\u{1F4DD}",description:"Current working directory changes"},{value:"commits",label:"Last N Commits",icon:"\u{1F4DC}",description:"Review recent commits"},{value:"branches",label:"Branch Comparison",icon:"\u{1F500}",description:"Compare between branches"}]},{id:"numCommits",label:"Number of Commits",type:"text",defaultValue:"5",placeholder:"5",hint:"How many recent commits to include",showIf:{field:"diffType",equals:"commits"}},{id:"baseBranch",label:"Base Branch",type:"text",defaultValue:"main",placeholder:"main",hint:"The branch to compare against",showIf:{field:"diffType",equals:"branches"}},{id:"targetBranch",label:"Target Branch",type:"text",defaultValue:"HEAD",placeholder:"HEAD or branch name",hint:"The branch with your changes",showIf:{field:"diffType",equals:"branches"}},{id:"reviewFocus",label:"Review Focus (optional)",type:"textarea",placeholder:"e.g., Focus on security vulnerabilities, performance issues, and error handling...",hint:"Specific areas you want the reviewer to focus on",rows:2},{id:"reviewType",label:"Review Depth",type:"select",defaultValue:"thorough",options:[{value:"quick",label:"\u26A1 Quick Scan",description:"High-level overview, critical issues only"},{value:"thorough",label:"\u{1F50D} Thorough Review",description:"Comprehensive analysis"},{value:"security",label:"\u{1F512} Security Focus",description:"Deep security analysis"},{value:"performance",label:"\u26A1 Performance Focus",description:"Performance and optimization"}]}],primaryAction:"Start Code Review",systemPrompt:`You are a senior software engineer conducting a thorough, constructive code review.
Your goal is to help improve code quality while being respectful and educational.

## Review Guidelines

1. **Be Constructive**: Frame feedback as suggestions, not criticisms
2. **Explain Why**: Always explain the reason behind each suggestion
3. **Prioritize**: Focus on issues that matter most
4. **Be Specific**: Reference exact files and line numbers when possible
5. **Acknowledge Good Work**: Mention well-written code too

## Output Format

Structure your review using these sections:

### \u{1F4CB} Summary
- Brief overview of changes reviewed
- Overall assessment (1-2 sentences)

### \u{1F534} Critical Issues (Must Fix)
Issues that could cause bugs, security vulnerabilities, or data loss.
Format each as:
- **[File:Line]** Issue title
  - What: Description of the issue
  - Why: Why this is critical
  - Fix: Specific recommendation

### \u{1F7E1} Warnings (Should Fix)
Issues that could cause problems or are bad practices.
Same format as above.

### \u{1F4A1} Suggestions (Nice to Have)
Improvements for code quality, readability, or maintainability.
Same format as above.

### \u2705 What's Good
Acknowledge well-written code, good patterns, or improvements.

### \u{1F4CA} Summary Stats
- Files changed: X
- Critical: X | Warnings: X | Suggestions: X

If the diff is empty or there are no changes, say so clearly and suggest the user check their git status.`,buildUserPrompt:(t,e)=>{let r=[];t.reviewFocus&&r.push(`## Review Focus
${t.reviewFocus}
`);let n={quick:"Perform a quick scan focusing only on critical issues and obvious bugs.",thorough:"Perform a comprehensive review covering all aspects of code quality.",security:"Focus heavily on security vulnerabilities, input validation, authentication, authorization, and data protection.",performance:"Focus on performance issues, memory leaks, inefficient algorithms, and optimization opportunities."};return t.reviewType&&n[t.reviewType]&&r.push(`## Review Type
${n[t.reviewType]}
`),e?.gitDiff?r.push(`## Git Diff to Review
\`\`\`diff
${e.gitDiff}
\`\`\``):e?.errors&&e.errors.length>0?r.push(`## Errors
Could not retrieve git diff:
${e.errors.join(`
`)}`):r.push(`## Note
No diff content available. The diff may be empty or there may be no changes to review.`),e?.projectPaths&&e.projectPaths.length>0&&r.push(`
## Projects Reviewed
${e.projectPaths.join(`
`)}`),r.join(`

`)},fetchContext:async t=>{let e={projectPaths:[],errors:[]},r=[];try{t.projectPaths.startsWith("[")?r=JSON.parse(t.projectPaths):r=t.projectPaths.split(",").map(o=>o.trim()).filter(Boolean)}catch{r=[t.projectPaths]}if(r.length===0)return e.errors.push("No project paths provided"),e;e.projectPaths=r;let n=[];for(let o of r){let i=await Vl.getGitDiff(o,{type:t.diffType,commits:t.numCommits?parseInt(t.numCommits,10):5,baseBranch:t.baseBranch||"main",targetBranch:t.targetBranch||"HEAD"});i.error&&e.errors.push(`${o}: ${i.error}`),i.diff&&n.push(`# Project: ${o}
${i.diff}`)}return e.gitDiff=n.join(`

---

`),e.gitDiff.length>5e4&&(e.gitDiff=e.gitDiff.substring(0,5e4)+`

[... diff truncated due to size. Showing first 50,000 characters ...]`),e},parseResponse:(t,e)=>{let r=[],n=t.match(/###  Critical Issues[\s\S]*?(?=###|$)/i);n&&!n[0].includes("None")&&n[0].length>50&&r.push({title:"\u{1F534} Critical Issues",content:n[0].replace(/###  Critical Issues[^\n]*\n/,"").trim(),severity:"critical",collapsible:!0,collapsed:!1});let o=t.match(/###  Warnings[\s\S]*?(?=###|$)/i);o&&!o[0].includes("None")&&o[0].length>50&&r.push({title:"\u{1F7E1} Warnings",content:o[0].replace(/###  Warnings[^\n]*\n/,"").trim(),severity:"warning",collapsible:!0,collapsed:!1});let i=t.match(/###  Suggestions[\s\S]*?(?=###|$)/i);return i&&!i[0].includes("None")&&i[0].length>50&&r.push({title:"\u{1F4A1} Suggestions",content:i[0].replace(/###  Suggestions[^\n]*\n/,"").trim(),severity:"info",collapsible:!0,collapsed:!0}),r.length===0?{type:"markdown",content:t,actions:[{label:"Copy Review",icon:"\u{1F4CB}",action:"copy"},{label:"Save as Markdown",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md",suggestedFilename:"code-review.md"}]}:{type:"structured",content:t,sections:r,summary:`Found ${r.filter(s=>s.severity==="critical").length} critical, ${r.filter(s=>s.severity==="warning").length} warnings`,actions:[{label:"Copy Review",icon:"\u{1F4CB}",action:"copy"},{label:"Save as Markdown",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md",suggestedFilename:"code-review.md"}]}},defaultActions:[{label:"Copy Review",icon:"\u{1F4CB}",action:"copy"},{label:"Save as Markdown",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md",suggestedFilename:"code-review.md"}],requirements:{git:!0,copilot:!0},examples:[{name:"Review staged changes",inputs:{diffType:"staged",reviewType:"thorough",reviewFocus:"Focus on security and error handling"}},{name:"Security review of recent commits",inputs:{diffType:"commits",numCommits:"10",reviewType:"security"}}]};var H8={id:"test-case-generator",name:"Test Case Generator",description:"Generate test cases from requirements/user stories",icon:"\u{1F9EA}",category:"qa",inputs:[{id:"requirement",label:"Requirement / User Story",type:"textarea",placeholder:`Example:
As a user, I want to reset my password so that I can regain access to my account if I forget it.

Acceptance Criteria:
- User can request password reset via email
- Reset link expires after 24 hours
- Password must meet complexity requirements`,required:!0,rows:8,hint:"Paste the user story, requirement, or feature description"},{id:"testTypes",label:"Test Types to Include",type:"multi-select",options:[{value:"functional",label:"\u2705 Functional",description:"Happy path scenarios"},{value:"edge",label:"\u{1F532} Edge Cases",description:"Boundary conditions"},{value:"negative",label:"\u274C Negative",description:"Error scenarios"},{value:"security",label:"\u{1F512} Security",description:"Security test cases"},{value:"performance",label:"\u26A1 Performance",description:"Performance considerations"},{value:"accessibility",label:"\u267F Accessibility",description:"A11y test cases"}],defaultValue:"functional,edge,negative"},{id:"outputFormat",label:"Output Format",type:"select",required:!0,defaultValue:"gherkin",options:[{value:"gherkin",label:"\u{1F952} Gherkin (BDD)",description:"Given/When/Then format"},{value:"traditional",label:"\u{1F4CB} Traditional",description:"ID, Steps, Expected Results"},{value:"checklist",label:"\u2714\uFE0F Checklist",description:"Simple test checklist"},{value:"xunit",label:"\u{1F9EA} xUnit Style",description:"Test method structure"}]},{id:"priority",label:"Include Priority Levels",type:"checkbox",defaultValue:"true"},{id:"additionalContext",label:"Additional Context (optional)",type:"textarea",placeholder:"Any additional technical details, constraints, or context...",rows:3}],primaryAction:"Generate Test Cases",systemPrompt:`You are an expert QA engineer specializing in test case design.
Generate comprehensive, actionable test cases based on the given requirements.

## Guidelines

1. **Coverage**: Ensure all acceptance criteria are covered
2. **Completeness**: Each test case should be standalone and complete
3. **Clarity**: Use clear, unambiguous language
4. **Testability**: Each test must have a clear pass/fail criteria
5. **Prioritization**: Order tests by importance/risk

## Output Formats

### Gherkin (BDD) Format
\`\`\`gherkin
Feature: [Feature Name]

  Scenario: [Scenario Name]
    Given [precondition]
    When [action]
    Then [expected result]
    And [additional expectation]
\`\`\`

### Traditional Format
| Test ID | Test Case | Priority | Preconditions | Steps | Expected Result |
|---------|-----------|----------|---------------|-------|-----------------|

### Checklist Format
- [ ] [P1] Test case description
  - Step 1
  - Step 2
  - \u2713 Expected: result

### xUnit Style Format
\`\`\`
Test: testFeatureName_WhenCondition_ShouldExpectedBehavior
Arrange: [setup]
Act: [action]
Assert: [verification]
\`\`\`

Always include:
- Happy path scenarios (functional)
- Edge cases and boundary conditions
- Negative/error scenarios
- Any specific test types requested`,buildUserPrompt:t=>{let e=[];e.push(`## Requirement to Test
${t.requirement}`),t.additionalContext&&e.push(`## Additional Context
${t.additionalContext}`);let r=t.testTypes?t.testTypes.split(","):["functional","edge","negative"],n={functional:"Functional (happy path)",edge:"Edge Cases (boundaries)",negative:"Negative (error scenarios)",security:"Security",performance:"Performance",accessibility:"Accessibility"},o=r.map(s=>n[s]||s).join(", ");e.push(`## Test Types Required
${o}`);let i={gherkin:"Gherkin (BDD) - Given/When/Then format",traditional:"Traditional table format with Test ID, Steps, Expected Results",checklist:"Simple checklist format",xunit:"xUnit test method structure (Arrange/Act/Assert)"};return e.push(`## Output Format
${i[t.outputFormat]||t.outputFormat}`),t.priority==="true"&&e.push(`## Include Priority
Yes - mark each test case with priority (P1=Critical, P2=High, P3=Medium, P4=Low)`),e.push(`
Please generate comprehensive test cases covering all the requested types in the specified format.`),e.join(`

`)},parseResponse:(t,e)=>{let n={gherkin:".feature",traditional:".md",checklist:".md",xunit:".txt"}[e.outputFormat]||".md",o=`test-cases${n}`;return{type:e.outputFormat==="gherkin"?"code":"markdown",content:t,language:e.outputFormat==="gherkin"?"gherkin":void 0,actions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:n,suggestedFilename:o},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"}]}},defaultActions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md"}],requirements:{copilot:!0},examples:[{name:"Login Feature",inputs:{requirement:`As a user, I want to log in with my email and password so that I can access my account.

Acceptance Criteria:
- Valid email format required
- Password minimum 8 characters
- Show error for invalid credentials
- Lock account after 5 failed attempts
- Remember me option for 30 days`,testTypes:"functional,edge,negative,security",outputFormat:"gherkin"}},{name:"Shopping Cart",inputs:{requirement:"Users can add items to cart, update quantities, and remove items. Cart persists across sessions.",testTypes:"functional,edge",outputFormat:"traditional"}}]};var G8={id:"bug-report-writer",name:"Bug Report Writer",description:"Create structured bug reports with repro steps",icon:"\u{1F41B}",category:"qa",inputs:[{id:"whatHappened",label:"What happened? (brief description)",type:"textarea",placeholder:"Describe the bug in a few sentences...",required:!0,rows:3,hint:"Describe what went wrong"},{id:"expected",label:"What did you expect to happen?",type:"textarea",placeholder:"What should have happened instead...",required:!0,rows:2},{id:"steps",label:"Steps you took (optional)",type:"textarea",placeholder:`1. Opened the login page
2. Entered email and password
3. Clicked login button
4. Nothing happened`,rows:5,hint:"We'll enhance these into proper repro steps"},{id:"url",label:"URL / Page (optional)",type:"text",placeholder:"https://app.example.com/login"},{id:"browser",label:"Browser",type:"select",defaultValue:"chrome",options:[{value:"chrome",label:"Chrome"},{value:"firefox",label:"Firefox"},{value:"safari",label:"Safari"},{value:"edge",label:"Edge"},{value:"mobile-ios",label:"Mobile Safari (iOS)"},{value:"mobile-android",label:"Chrome (Android)"},{value:"other",label:"Other"}]},{id:"os",label:"Operating System",type:"select",defaultValue:"macos",options:[{value:"macos",label:"macOS"},{value:"windows",label:"Windows"},{value:"linux",label:"Linux"},{value:"ios",label:"iOS"},{value:"android",label:"Android"},{value:"other",label:"Other"}]},{id:"severity",label:"Severity",type:"radio",defaultValue:"high",options:[{value:"critical",label:"\u{1F534} Critical",description:"System down, data loss, security issue"},{value:"high",label:"\u{1F7E0} High",description:"Major feature broken, no workaround"},{value:"medium",label:"\u{1F7E1} Medium",description:"Feature impaired, workaround exists"},{value:"low",label:"\u{1F7E2} Low",description:"Minor issue, cosmetic"}]},{id:"additionalInfo",label:"Additional Information (optional)",type:"textarea",placeholder:"Console errors, screenshots description, account details (non-sensitive)...",rows:3},{id:"outputFormat",label:"Output Format",type:"select",defaultValue:"markdown",options:[{value:"markdown",label:"\u{1F4DD} Markdown",description:"GitHub/GitLab issues"},{value:"jira",label:"\u{1F3AB} JIRA",description:"JIRA ticket format"},{value:"plain",label:"\u{1F4C4} Plain Text",description:"Simple text format"}]}],primaryAction:"Generate Bug Report",systemPrompt:`You are an expert QA engineer who writes clear, comprehensive bug reports.
Create a well-structured bug report that developers can easily understand and act upon.

## Guidelines

1. **Clear Title**: Concise, descriptive title that summarizes the issue
2. **Reproducible Steps**: Detailed, numbered steps anyone can follow
3. **Expected vs Actual**: Clear distinction between expected and actual behavior
4. **Environment Details**: Browser, OS, and relevant versions
5. **Root Cause Hints**: If obvious, suggest possible causes
6. **Attachments Note**: Mention what screenshots/logs would help

## Output Formats

### Markdown Format
Use standard markdown with headers, bullet points, and code blocks.

### JIRA Format
Use JIRA wiki markup:
- h2. for headers
- * for bullets
- {code} blocks
- {color:red}text{color} for emphasis

### Plain Text
Simple structured text without markdown.

## Structure

1. **Title**: Bug: [Concise description]
2. **Summary**: 1-2 sentence overview
3. **Environment**: Browser, OS, URL
4. **Severity**: With justification
5. **Steps to Reproduce**: Detailed numbered steps
6. **Expected Behavior**: What should happen
7. **Actual Behavior**: What actually happens
8. **Additional Notes**: Possible causes, workarounds
9. **Attachments Needed**: What would help investigation`,buildUserPrompt:t=>{let e=[];e.push(`## Bug Description
${t.whatHappened}`),e.push(`## Expected Behavior
${t.expected}`),t.steps&&e.push(`## Steps Taken (to enhance)
${t.steps}`),e.push("## Environment"),e.push(`- Browser: ${t.browser||"Not specified"}`),e.push(`- OS: ${t.os||"Not specified"}`),t.url&&e.push(`- URL: ${t.url}`);let r={critical:"Critical - System down, data loss, or security issue",high:"High - Major feature broken, no workaround",medium:"Medium - Feature impaired, workaround exists",low:"Low - Minor issue, cosmetic"};return e.push(`
## Severity
${r[t.severity]||t.severity}`),t.additionalInfo&&e.push(`## Additional Information
${t.additionalInfo}`),e.push(`
## Output Format
${t.outputFormat||"markdown"}`),e.push(`
Please generate a comprehensive, professional bug report.`),e.join(`
`)},parseResponse:(t,e)=>{let r={markdown:".md",jira:".txt",plain:".txt"};return{type:"markdown",content:t,actions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:r[e.outputFormat]||".md",suggestedFilename:"bug-report"+(r[e.outputFormat]||".md")},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"}]}},defaultActions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md"}],requirements:{copilot:!0},examples:[{name:"Login Button Issue",inputs:{whatHappened:"Login button does not respond when clicked after entering credentials",expected:"Should redirect to dashboard after successful login",steps:`1. Go to login page
2. Enter email
3. Enter password
4. Click login
5. Nothing happens`,browser:"chrome",os:"macos",severity:"critical",outputFormat:"markdown"}}]};var W8={id:"meeting-notes-to-actions",name:"Meeting Notes \u2192 Actions",description:"Extract action items from meeting notes",icon:"\u{1F4DD}",category:"leadership",inputs:[{id:"meetingNotes",label:"Paste Meeting Notes",type:"textarea",placeholder:`Example:
Sprint planning call - Dec 21
Attendees: John, Sarah, Mike

Discussed the new auth feature. John said we should use OAuth2.
Sarah mentioned we need to update the docs by Friday.
Mike will handle the frontend integration.

We agreed to ship by next Friday. Need to check with legal about 
the privacy policy changes. Budget approved for new tools.`,required:!0,rows:12,hint:"Paste raw meeting notes, transcript, or summary"},{id:"extractTypes",label:"What to Extract",type:"multi-select",defaultValue:"actions,decisions,followups",options:[{value:"actions",label:"\u2705 Action Items",description:"Tasks assigned to people"},{value:"decisions",label:"\u{1F4CC} Decisions",description:"Decisions that were made"},{value:"followups",label:"\u{1F504} Follow-ups",description:"Items needing follow-up"},{value:"questions",label:"\u2753 Open Questions",description:"Unresolved questions"},{value:"risks",label:"\u26A0\uFE0F Risks",description:"Risks or concerns raised"},{value:"deadlines",label:"\u{1F4C5} Deadlines",description:"Important dates mentioned"}]},{id:"meetingTitle",label:"Meeting Title (optional)",type:"text",placeholder:"e.g., Sprint Planning - Week 51"},{id:"outputFormat",label:"Output Format",type:"select",defaultValue:"markdown",options:[{value:"markdown",label:"\u{1F4DD} Markdown",description:"Formatted with tables and sections"},{value:"slack",label:"\u{1F4AC} Slack-Ready",description:"Formatted for Slack posting"},{value:"email",label:"\u{1F4E7} Email",description:"Ready to send as follow-up email"},{value:"jira",label:"\u{1F3AB} JIRA Tasks",description:"Formatted as JIRA task descriptions"}]},{id:"includeOwners",label:"Identify Owners",type:"checkbox",defaultValue:"true",hint:"Attempt to identify who is responsible for each action"}],primaryAction:"Extract Actions",systemPrompt:`You are an expert at analyzing meeting notes and extracting actionable information.
Your goal is to transform unstructured meeting notes into clear, organized action items.

## Guidelines

1. **Be Thorough**: Extract ALL action items, even implied ones
2. **Identify Owners**: Assign owners when mentioned or implied
3. **Add Due Dates**: Extract or infer reasonable deadlines
4. **Capture Context**: Preserve important context for each item
5. **Highlight Decisions**: Clearly mark decisions that were made
6. **Flag Uncertainties**: Note when ownership or details are unclear

## Output Structure

### Meeting Summary
Brief 2-3 sentence summary of the meeting.

### \u{1F4CC} Decisions Made
Numbered list of decisions with context.

### \u2705 Action Items
| Owner | Task | Due Date | Priority |
|-------|------|----------|----------|
Use "TBD" for unknown owners, "ASAP" or specific date for due dates.

### \u{1F504} Follow-ups Required
Items that need follow-up but aren't specific tasks.

### \u2753 Open Questions
Questions that weren't answered in the meeting.

### \u26A0\uFE0F Risks & Concerns
Any risks or concerns that were raised.

### \u{1F4C5} Key Dates
Important deadlines or milestones mentioned.

## Format-Specific Instructions

### Slack Format
- Use *bold* for headers
- Use bullet points with emojis
- Keep it concise

### Email Format
- Professional tone
- Include greeting and sign-off structure
- Numbered action items

### JIRA Format
- Each action as a separate task
- Include acceptance criteria where possible
- Use JIRA wiki markup`,buildUserPrompt:t=>{let e=[];t.meetingTitle&&e.push(`## Meeting: ${t.meetingTitle}`),e.push(`## Meeting Notes
${t.meetingNotes}`);let r=t.extractTypes?t.extractTypes.split(","):["actions","decisions","followups"],n={actions:"Action Items (tasks with owners)",decisions:"Decisions Made",followups:"Follow-ups Required",questions:"Open Questions",risks:"Risks and Concerns",deadlines:"Key Dates and Deadlines"},o=r.map(i=>n[i]||i);return e.push(`## Extract These Items
${o.map(i=>`- ${i}`).join(`
`)}`),e.push(`## Output Format
${t.outputFormat||"markdown"}`),t.includeOwners==="true"&&e.push(`
IMPORTANT: Identify and assign owners for each action item based on the notes. Use "TBD" if unclear.`),e.push(`
Analyze the meeting notes and extract all requested information in a clear, organized format.`),e.join(`

`)},parseResponse:(t,e)=>{let r=[],n=t.match(/###?\s*?\s*Action Items[\s\S]*?(?=###|$)/i);n&&r.push({title:"\u2705 Action Items",content:n[0].replace(/###?\s*?\s*Action Items[^\n]*\n/,"").trim(),severity:"info",collapsible:!1});let o=t.match(/###?\s*?\s*Decisions[\s\S]*?(?=###|$)/i);o&&r.push({title:"\u{1F4CC} Decisions",content:o[0].replace(/###?\s*?\s*Decisions[^\n]*\n/,"").trim(),severity:"success",collapsible:!0,collapsed:!1});let i=t.match(/###?\s*?\s*Follow-ups[\s\S]*?(?=###|$)/i);return i&&r.push({title:"\u{1F504} Follow-ups",content:i[0].replace(/###?\s*?\s*Follow-ups[^\n]*\n/,"").trim(),severity:"warning",collapsible:!0,collapsed:!0}),{type:r.length>0?"structured":"markdown",content:t,sections:r.length>0?r:void 0,actions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md",suggestedFilename:"meeting-actions.md"},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"}]}},defaultActions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md"}],requirements:{copilot:!0},examples:[{name:"Sprint Planning Notes",inputs:{meetingNotes:`Sprint planning - Week 51
Team: John (BE), Sarah (FE), Mike (QA), Lisa (PM)

Discussed Q1 priorities. Auth feature is top priority.
John will implement OAuth2 backend by end of week.
Sarah to update UI components, needs design specs from Lisa.
Mike mentioned we need more test coverage.
Lisa to check with legal about GDPR requirements.
Deadline: Launch by Jan 15th.`,extractTypes:"actions,decisions,deadlines",outputFormat:"markdown",includeOwners:"true"}}]};var K8={id:"standup-summary",name:"Standup Summary",description:"Format your daily standup update",icon:"\u{1F4CA}",category:"productivity",inputs:[{id:"thoughts",label:"What's on your mind? (stream of consciousness is fine)",type:"textarea",placeholder:`Just type what you're thinking, e.g.:

yesterday fixed that auth bug that was blocking QA, also reviewed 3 PRs for the team. today gonna work on the payment integration, need to figure out stripe webhooks. blocked on getting API keys from finance team, sent email but no response yet. also need to sync with Sarah about the design...`,required:!0,rows:8,hint:"Don't worry about formatting - we'll organize it for you"},{id:"outputFormat",label:"Output Format",type:"select",defaultValue:"slack",options:[{value:"slack",label:"\u{1F4AC} Slack-Ready",description:"With emojis, formatted for Slack"},{value:"teams",label:"\u{1F465} Microsoft Teams",description:"Teams-compatible formatting"},{value:"jira",label:"\u{1F3AB} JIRA Comment",description:"For JIRA standup notes"},{value:"plain",label:"\u{1F4C4} Plain Text",description:"Simple, no formatting"},{value:"email",label:"\u{1F4E7} Email",description:"Professional email format"},{value:"bullet",label:"\u2022 Bullet Points",description:"Simple bullet list"}]},{id:"includeDate",label:"Include Date",type:"checkbox",defaultValue:"true"},{id:"tone",label:"Tone",type:"select",defaultValue:"professional",options:[{value:"casual",label:"\u{1F60E} Casual",description:"Relaxed, friendly"},{value:"professional",label:"\u{1F454} Professional",description:"Clear and business-like"},{value:"brief",label:"\u26A1 Ultra-Brief",description:"Minimal words, just the essentials"}]},{id:"teamContext",label:"Team/Project (optional)",type:"text",placeholder:"e.g., Platform Team, Project Phoenix",hint:"Adds context if posting to shared channels"}],primaryAction:"Generate Summary",systemPrompt:`You are an expert at turning informal thoughts into clear, professional standup updates.
Transform the user's stream of consciousness into a well-organized standup summary.

## Standard Standup Structure

1. **Yesterday/Done** - What was completed
2. **Today/Doing** - What's planned for today
3. **Blockers** - Any blockers or impediments (if any)

## Guidelines

1. **Be Concise**: Keep each item to one line when possible
2. **Use Action Verbs**: "Fixed", "Completed", "Working on", "Reviewing"
3. **Highlight Impact**: Mention who benefits or why it matters
4. **Be Specific**: Include ticket numbers, feature names, etc. if mentioned
5. **Group Related Items**: Combine related work into single points
6. **Blockers are Important**: Always highlight blockers clearly

## Format-Specific Instructions

### Slack Format
\`\`\`
\u{1F504} *Standup Update - [Date]*

*Yesterday:*
\u2705 [Completed item 1]
\u2705 [Completed item 2]

*Today:*
\u{1F3AF} [Planned item 1]
\u{1F3AF} [Planned item 2]

*Blockers:*
\u{1F6A7} [Blocker if any] (or \u2728 No blockers!)
\`\`\`

### Teams Format
Use **bold** for headers, standard bullets.

### JIRA Format
Use h4. for headers, * for bullets.

### Email Format
Professional tone, proper greeting, signature placeholder.

### Plain/Bullet
Simple, clean formatting.

## Tone Guidelines

- **Casual**: Use contractions, friendly language, more emojis
- **Professional**: Clear, business-like, minimal emojis
- **Ultra-Brief**: Just the facts, no fluff, telegram style`,buildUserPrompt:t=>{let e=[];if(e.push(`## My Thoughts/Notes
${t.thoughts}`),e.push(`## Output Format: ${t.outputFormat||"slack"}`),e.push(`## Tone: ${t.tone||"professional"}`),t.includeDate==="true"){let r=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});e.push(`## Date: ${r}`)}return t.teamContext&&e.push(`## Context: ${t.teamContext}`),e.push(`
Please transform my notes into a clean, organized standup update following the format and tone specified.`),e.join(`

`)},parseResponse:(t,e)=>({type:"markdown",content:t,actions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"}]}),defaultActions:[{label:"Copy",icon:"\u{1F4CB}",action:"copy"}],requirements:{copilot:!0},examples:[{name:"Typical Developer Day",inputs:{thoughts:"yesterday fixed the auth bug in the login flow, the one that was causing 500 errors. also reviewed prs from john and sarah. today going to start on the new dashboard feature, need to check requirements with PM first. might be blocked on design mocks, asked in slack but havent heard back",outputFormat:"slack",tone:"professional",includeDate:"true"}},{name:"Quick Update",inputs:{thoughts:"finished api integration, starting frontend now, no blockers",outputFormat:"bullet",tone:"brief",includeDate:"false"}}]};var J8={id:"playwright-generator",name:"Playwright Script Generator",description:"Generate automation scripts from test steps",icon:"\u{1F3AD}",category:"qa",inputs:[{id:"attachedFiles",label:"Attach Files (optional)",type:"file-picker",placeholder:"Attach Excel, DOCX, TXT, or MD files with test steps/locators",hint:"Upload test scripts from Excel, Word docs, or text files. File contents will be extracted and used.",rows:0},{id:"testSteps",label:"Test Steps",type:"textarea",placeholder:`Paste your test steps here, e.g.:

1. Navigate to https://example.com/login
2. Enter "testuser@email.com" in email field
3. Enter "password123" in password field
4. Click the Login button
5. Verify dashboard page loads
6. Click on Settings menu
7. Verify Settings page title is visible`,required:!1,rows:10,hint:"Paste test steps directly, or use the file attachment above"},{id:"locators",label:"Element Locators (optional)",type:"textarea",placeholder:`Provide locators if you have them:

email field: #email-input
password field: input[name="password"]
Login button: button.login-btn
Settings menu: [data-testid="settings-link"]`,rows:6,hint:"CSS selectors, data-testid, or other locators for elements"},{id:"requirements",label:"Additional Requirements (optional)",type:"textarea",placeholder:`Any special requirements:
- Wait for network idle after login
- Handle cookie consent popup
- Test should work for mobile viewport
- Need to handle 2FA if prompted`,rows:4},{id:"baseUrl",label:"Base URL",type:"text",placeholder:"https://your-app.com",hint:"The starting URL for your test"},{id:"language",label:"Programming Language",type:"radio",defaultValue:"typescript",options:[{value:"typescript",label:"\u{1F537} TypeScript",description:"Recommended - Type safety & better IDE support"},{value:"javascript",label:"\u{1F7E8} JavaScript",description:"Simple and widely used"},{value:"python",label:"\u{1F40D} Python",description:"Great for data-driven testing"}]},{id:"browser",label:"Browser",type:"select",defaultValue:"chrome",options:[{value:"chrome",label:"\u{1F310} Google Chrome"},{value:"msedge",label:"\u{1F537} Microsoft Edge"}]},{id:"headless",label:"Run Mode",type:"radio",defaultValue:"headed",options:[{value:"headed",label:"\u{1F441}\uFE0F Headed (Visible browser)",description:"Watch the test run"},{value:"headless",label:"\u26A1 Headless (No UI)",description:"Faster, for CI/CD"}]},{id:"features",label:"Additional Features",type:"multi-select",defaultValue:"screenshots,report,retry",options:[{value:"screenshots",label:"\u{1F4F8} Screenshots per step",description:"Capture screenshot after each action"},{value:"video",label:"\u{1F3A5} Video recording",description:"Record full test execution"},{value:"report",label:"\u{1F4CA} HTML Report",description:"Generate visual test report"},{value:"retry",label:"\u{1F504} Auto-retry on failure",description:"Retry failed tests automatically"},{value:"trace",label:"\u{1F50D} Trace on failure",description:"Capture trace for debugging"},{value:"parallel",label:"\u26A1 Parallel execution",description:"Run tests in parallel"}]},{id:"testName",label:"Test Name",type:"text",placeholder:"Login Flow Test",defaultValue:"Automated Test",hint:"Name for your test suite (also used as folder name)"},{id:"targetFolder",label:"Target Folder",type:"project-picker",required:!0,placeholder:"Select where to create the test project",hint:"A folder named after your test will be created here with all files"},{id:"model",label:"AI Model",type:"model-picker",defaultValue:"auto",hint:"Select which AI model to use for generating the script"}],primaryAction:"Generate & Create Project",systemPrompt:`You are an expert Playwright automation engineer. Generate production-ready, enterprise-grade Playwright test scripts.

## Guidelines

1. **Robust Locators**: Use resilient selectors (data-testid > role > text > css)
2. **Proper Waits**: Use auto-waiting, avoid hardcoded delays
3. **Error Handling**: Include try-catch for critical steps
4. **Screenshots**: Capture screenshots at key points for debugging
5. **Assertions**: Add meaningful assertions after each significant action
6. **Comments**: Add clear comments explaining each step
7. **Best Practices**: Follow Playwright best practices

## Output Structure

Generate the script in THREE sections:

### SECTION 1: SETUP FILES
First, provide package.json and config files needed.

### SECTION 2: MAIN TEST FILE
The complete test script with:
- Proper imports
- Test setup/teardown
- Step-by-step actions with comments
- Screenshots after key steps
- Assertions to verify behavior
- Error handling

### SECTION 3: COMMANDS
Provide exact terminal commands to:
1. Install dependencies
2. Run the test
3. View the report

## Code Quality Requirements

- No syntax errors
- Proper async/await usage
- Type safety (for TypeScript)
- Descriptive variable names
- Modular helper functions where appropriate

## Screenshot Convention

For each step, capture screenshot with descriptive name:
await page.screenshot({ path: 'screenshots/01-login-page.png' });
await page.screenshot({ path: 'screenshots/02-after-credentials.png' });

## Report Configuration

Include HTML reporter configuration for visual reports.`,buildUserPrompt:t=>{let e=[];e.push("## Configuration"),e.push(`- **Language**: ${t.language||"typescript"}`),e.push(`- **Browser**: ${t.browser||"chrome"}`),e.push(`- **Mode**: ${t.headless==="headless"?"Headless":"Headed"}`);let r=(t.features||"screenshots,report").split(",");if(e.push(`- **Features**: ${r.join(", ")}`),t.testName&&e.push(`- **Test Name**: ${t.testName}`),t.baseUrl&&e.push(`- **Base URL**: ${t.baseUrl}`),t.attachedFiles&&t.attachedFiles.trim()&&t.attachedFiles!=="[]")try{let n=JSON.parse(t.attachedFiles);if(n.length>0){e.push(`
## Attached Files`);for(let o of n)e.push(`
### File: ${o.name}`),e.push("```"),e.push(o.content),e.push("```")}}catch{}return t.testSteps&&t.testSteps.trim()&&e.push(`
## Test Steps to Automate
${t.testSteps}`),t.locators&&t.locators.trim()?e.push(`
## Element Locators Provided
${t.locators}`):e.push(`
## Locators
No specific locators provided. Please use best practices to identify elements (prefer data-testid, role, text, then CSS selectors).`),t.requirements&&t.requirements.trim()&&e.push(`
## Additional Requirements
${t.requirements}`),e.push(`
## Instructions
Generate a complete, ready-to-run Playwright test script. Include:
1. All necessary setup files (package.json, playwright.config)
2. The main test file with proper structure
3. Exact commands to install and run

Make sure the code has NO ERRORS and follows best practices.`),e.join(`
`)},parseResponse:(t,e)=>{let r=e.language||"typescript",n={typescript:".ts",javascript:".js",python:".py"},o=[],i=t.match(/###?\s*(?:SECTION 1|SETUP|Setup Files)[\s\S]*?(?=###?\s*(?:SECTION 2|MAIN|Main Test)|$)/i);i&&o.push({title:"\u{1F4E6} Setup Files",content:i[0].replace(/###?\s*(?:SECTION 1|SETUP|Setup Files)[^\n]*\n/i,"").trim(),severity:"info",collapsible:!0,collapsed:!1});let s=t.match(/###?\s*(?:SECTION 2|MAIN|Main Test)[\s\S]*?(?=###?\s*(?:SECTION 3|COMMANDS|Commands)|$)/i);s&&o.push({title:"\u{1F3AD} Main Test File",content:s[0].replace(/###?\s*(?:SECTION 2|MAIN|Main Test)[^\n]*\n/i,"").trim(),severity:"success",collapsible:!1});let a=t.match(/###?\s*(?:SECTION 3|COMMANDS|Commands)[\s\S]*/i);a&&o.push({title:"\u{1F4BB} Run Commands",content:a[0].replace(/###?\s*(?:SECTION 3|COMMANDS|Commands)[^\n]*\n/i,"").trim(),severity:"info",collapsible:!0,collapsed:!1,actions:[{label:"Copy Commands",icon:"\u{1F4CB}",action:"copy"}]});let c=t.match(/```(?:typescript|javascript|python|ts|js|py)\n([\s\S]*?)\n```/),l=c?c[1]:"",u=`test${n[r]}`;return{type:o.length>0?"structured":"markdown",content:t,sections:o.length>0?o:void 0,summary:`Generated ${r.toUpperCase()} Playwright script`,actions:[{label:`Download ${u}`,icon:"\u2B07\uFE0F",action:"newFile",fileExtension:n[r],suggestedFilename:u,data:l||t},{label:"Copy All",icon:"\u{1F4CB}",action:"copy"},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"}]}},defaultActions:[{label:"Download Script",icon:"\u2B07\uFE0F",action:"newFile",fileExtension:".ts"},{label:"Copy",icon:"\u{1F4CB}",action:"copy"}],requirements:{copilot:!0},examples:[{name:"Login Flow Test",inputs:{testSteps:`1. Navigate to https://example.com/login
2. Enter "testuser@email.com" in the email field
3. Enter "password123" in the password field
4. Click the Login button
5. Verify the dashboard page loads successfully
6. Check that the welcome message shows the username`,locators:`email field: #email
password field: #password
Login button: button[type="submit"]
welcome message: .welcome-text`,language:"typescript",browser:"chromium",headless:"headed",features:"screenshots,report,retry",testName:"Login Flow Test"}},{name:"E-commerce Checkout",inputs:{testSteps:`1. Go to the product page
2. Select size "Medium"
3. Click Add to Cart
4. Go to Cart
5. Click Checkout
6. Fill shipping details
7. Select payment method
8. Complete purchase
9. Verify order confirmation`,language:"python",browser:"all",features:"screenshots,video,report",testName:"Checkout Flow Test"}}]};var Y8=[Z8,H8,G8,W8,K8,J8];function Tk(t){return Y8.find(e=>e.id===t)}function X8(){let t={developer:[],qa:[],leadership:[],productivity:[]};for(let e of Y8)t[e.category].push(e);return t}var Ek={developer:{label:"Developer",icon:"\u{1F468}\u200D\u{1F4BB}",description:"Tools for software developers"},qa:{label:"QA & Testing",icon:"\u{1F9EA}",description:"Tools for quality assurance"},leadership:{label:"Leadership",icon:"\u{1F4CA}",description:"Tools for tech leads and managers"},productivity:{label:"Productivity",icon:"\u26A1",description:"General productivity tools"}};var Rn=it(require("vscode")),rM=class t{static instance;constructor(){}static getInstance(){return t.instance||(t.instance=new t),t.instance}async checkCopilotAvailability(){try{let e=await Rn.lm.selectChatModels({vendor:"copilot"});return!e||e.length===0?{available:!1,message:"GitHub Copilot is not available. Please ensure GitHub Copilot and Copilot Chat extensions are installed and you are signed in."}:{available:!0}}catch(e){return{available:!1,message:`Failed to access Copilot: ${e instanceof Error?e.message:String(e)}`}}}async executeApp(e,r,n,o){let i=Date.now();try{let s=await this.checkCopilotAvailability();if(!s.available)return{success:!1,error:s.message,durationMs:Date.now()-i};let a;if(e.fetchContext){n?.("Gathering context...");try{a=await e.fetchContext(r),a.errors&&a.errors.length>0&&console.warn("[AppService] Context fetch warnings:",a.errors)}catch(d){return{success:!1,error:`Failed to gather context: ${d instanceof Error?d.message:String(d)}`,durationMs:Date.now()-i}}}n?.("Building prompt...");let c=e.buildUserPrompt(r,a);n?.("Analyzing with AI...");let l=await this.invokeLLM(e.systemPrompt,c,o);if(!l.success)return{success:!1,error:l.error,durationMs:Date.now()-i,tokens:l.tokens};n?.("Formatting output...");let u;return e.parseResponse?u=e.parseResponse(l.content,r):u={type:"markdown",content:l.content,actions:e.defaultActions||this.getDefaultActions()},{success:!0,output:u,durationMs:Date.now()-i,tokens:l.tokens}}catch(s){return{success:!1,error:s instanceof Error?s.message:String(s),durationMs:Date.now()-i}}}async invokeLLM(e,r,n){try{let o=await Rn.lm.selectChatModels({vendor:"copilot"});if(!o||o.length===0)return{success:!1,error:"No Copilot language model available"};let i=o[0],s=[Rn.LanguageModelChatMessage.User(`[System Instructions]
${e}`),Rn.LanguageModelChatMessage.User(r)],a=n?{token:n,dispose:()=>{}}:new Rn.CancellationTokenSource,c=setTimeout(()=>{"cancel"in a&&a.cancel()},18e4);try{let l=await i.sendRequest(s,{},a.token),u="";for await(let f of l.text){if(a.token.isCancellationRequested)return{success:!1,error:"Request was cancelled"};u+=f}let d=0,p=0;try{d=await i.countTokens(e+r),p=await i.countTokens(u)}catch{}return{success:!0,content:u.trim(),tokens:{input:d,output:p}}}finally{clearTimeout(c),n||a.dispose()}}catch(o){return o instanceof Rn.CancellationError?{success:!1,error:"Request was cancelled"}:{success:!1,error:o instanceof Error?o.message:String(o)}}}getDefaultActions(){return[{label:"Copy",icon:"\u{1F4CB}",action:"copy"},{label:"Insert at Cursor",icon:"\u{1F4DD}",action:"insert"},{label:"Save as File",icon:"\u{1F4BE}",action:"newFile",fileExtension:".md"}]}async*executeAppStreaming(e,r,n){let o=Date.now();try{let i=await this.checkCopilotAvailability();if(!i.available){yield{type:"error",data:i.message};return}let s;e.fetchContext&&(yield{type:"progress",data:"Gathering context..."},s=await e.fetchContext(r)),yield{type:"progress",data:"Building prompt..."};let a=e.buildUserPrompt(r,s),c=await Rn.lm.selectChatModels({vendor:"copilot"});if(!c||c.length===0){yield{type:"error",data:"No Copilot model available"};return}let l=c[0],u=[Rn.LanguageModelChatMessage.User(`[System Instructions]
${e.systemPrompt}`),Rn.LanguageModelChatMessage.User(a)];yield{type:"progress",data:"Analyzing..."};let d=n?{token:n}:new Rn.CancellationTokenSource,p=await l.sendRequest(u,{},d.token);for await(let f of p.text){if(d.token.isCancellationRequested){yield{type:"error",data:"Cancelled"};return}yield{type:"chunk",data:f}}yield{type:"done",data:`Completed in ${Date.now()-o}ms`}}catch(i){yield{type:"error",data:i instanceof Error?i.message:String(i)}}}},Q8=rM.getInstance();var Zv=class t{static hubPanel;static appPanels=new Map;static context;static initialize(e){t.context=e,Vl.initialize(e)}static openAppsHub(){let e=se.window.activeTextEditor?.viewColumn??se.ViewColumn.One;if(t.hubPanel){t.hubPanel.reveal(e);return}let r=se.window.createWebviewPanel("copilotAppsHub","\u{1F4E6} Copilot Apps",e,{enableScripts:!0,retainContextWhenHidden:!0});t.hubPanel=r,r.webview.html=t.getHubHtml(r.webview),r.webview.onDidReceiveMessage(async n=>{switch(n.type){case"openApp":t.openApp(n.appId);break;case"toggleFavorite":await t.toggleFavorite(n.appId),t.hubPanel&&(t.hubPanel.webview.html=t.getHubHtml(t.hubPanel.webview));break}}),r.onDidDispose(()=>{t.hubPanel=void 0})}static openApp(e){let r=Tk(e);if(!r){se.window.showErrorMessage(`App "${e}" not found`);return}let n=se.window.activeTextEditor?.viewColumn??se.ViewColumn.One,o=t.appPanels.get(e);if(o){o.reveal(n);return}let i=se.window.createWebviewPanel(`copilotApp-${e}`,`${r.icon} ${r.name}`,n,{enableScripts:!0,retainContextWhenHidden:!0});t.appPanels.set(e,i);let s=Vl.getSavedProjects();i.webview.html=t.getAppHtml(i.webview,r,s),i.webview.onDidReceiveMessage(async a=>{await t.handleAppMessage(a,r,i)}),i.onDidDispose(()=>{t.appPanels.delete(e)}),t.addRecentApp(e)}static async handleAppMessage(e,r,n){switch(e.type){case"executeApp":n.webview.postMessage({type:"processingStart"});try{let u=await Q8.executeApp(r,e.inputs,d=>{n.webview.postMessage({type:"progress",message:d})});n.webview.postMessage({type:"result",result:u})}catch(u){n.webview.postMessage({type:"result",result:{success:!1,error:u instanceof Error?u.message:String(u),durationMs:0}})}break;case"pickProjectFolder":let o=await Vl.pickProjectFolder();o&&(await Vl.addProject(o),n.webview.postMessage({type:"projectAdded",project:{path:o,name:o.split("/").pop()}}));break;case"copyToClipboard":await se.env.clipboard.writeText(e.value),se.window.showInformationMessage("Copied to clipboard!");break;case"insertAtCursor":let i=se.window.activeTextEditor;i&&(await i.edit(u=>{u.insert(i.selection.active,e.value)}),se.window.showInformationMessage("Inserted at cursor!"));break;case"saveAsFile":let s=await se.window.showSaveDialog({defaultUri:se.Uri.file(e.filename),filters:{"All Files":["*"]}});if(s){await se.workspace.fs.writeFile(s,Buffer.from(e.content,"utf-8")),se.window.showInformationMessage(`Saved to ${s.fsPath}`);let u=await se.workspace.openTextDocument(s);await se.window.showTextDocument(u)}break;case"downloadPlaywrightProject":let a=await se.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:"Select folder to save Playwright project",openLabel:"Save Project Here"});if(a&&a[0])try{let u=a[0],d=e.files;for(let p of d){let f=se.Uri.joinPath(u,p.name);await se.workspace.fs.writeFile(f,Buffer.from(p.content,"utf-8"))}se.window.showInformationMessage(`Playwright project saved to ${u.fsPath}`),await se.commands.executeCommand("vscode.openFolder",u,{forceNewWindow:!1})}catch(u){se.window.showErrorMessage(`Failed to save project: ${u instanceof Error?u.message:String(u)}`)}break;case"runTerminalCommand":let c=se.window.createTerminal({name:`${e.name||"Playwright Test"}`,cwd:e.cwd});c.show(),c.sendText(e.command);break;case"pickFiles":let l=await se.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!0,filters:{"Test Documents":["xlsx","xls","docx","doc","txt","md"],"Excel Files":["xlsx","xls"],"Word Documents":["docx","doc"],"Text Files":["txt","md"]},title:"Select files with test steps or locators"});if(l&&l.length>0){let u=[];for(let d of l){let p=d.fsPath.split("/").pop()||"",f=p.split(".").pop()?.toLowerCase()||"";try{let h="";if(f==="txt"||f==="md"){let m=await se.workspace.fs.readFile(d);h=Buffer.from(m).toString("utf-8")}else if(f==="xlsx"||f==="xls"){let m=await se.workspace.fs.readFile(d);h=`[Excel File: ${p}]
Note: Excel file attached. The content will be processed.
Base64 preview (first 500 chars): ${Buffer.from(m).toString("base64").slice(0,500)}...`}else if(f==="docx"||f==="doc"){let m=await se.workspace.fs.readFile(d);h=`[Word Document: ${p}]
Note: Word document attached. The content will be processed.
Size: ${m.length} bytes`}u.push({name:p,content:h,type:f})}catch{se.window.showWarningMessage(`Could not read file: ${p}`)}}u.length>0&&n.webview.postMessage({type:"filesReceived",fieldId:e.fieldId,files:u})}break;case"getAvailableModels":try{let d=(await se.lm.selectChatModels({})).map(p=>({id:p.id,name:p.name,vendor:p.vendor,family:p.family}));n.webview.postMessage({type:"modelsReceived",fieldId:e.fieldId,models:d})}catch{se.window.showWarningMessage("Could not fetch available models")}break;case"extractAndCreateProject":try{let u=e.rawContent,d=e.language||"typescript",p=[],h={typescript:"ts",javascript:"js",python:"py"}[d]||"ts",m=/```(\w+)?\n([\s\S]*?)```/g,y,v=[];for(;(y=m.exec(u))!==null;){let w=(y[1]||"").toLowerCase(),$=y[2].trim();$.length>20&&v.push({lang:w,code:$})}for(let w of v)if(w.lang==="json"&&w.code.includes('"name"')&&w.code.includes('"devDependencies"'))p.push({name:"package.json",content:w.code});else if((w.lang==="typescript"||w.lang==="ts"||w.lang==="javascript"||w.lang==="js")&&w.code.includes("defineConfig"))p.push({name:`playwright.config.${h}`,content:w.code});else if((w.lang==="typescript"||w.lang==="ts"||w.lang==="javascript"||w.lang==="js"||w.lang==="python"||w.lang==="py")&&(w.code.includes("test(")||w.code.includes("def test_"))){let $=d==="python"?"tests/test_spec.py":`tests/test.spec.${h}`;p.push({name:$,content:w.code})}if(p.length>0){let w=e.targetFolder,R=(e.testName||"playwright-test").replace(/[^a-zA-Z0-9-_]/g,"-").toLowerCase(),P=se.Uri.file(`${w}/${R}`);await se.workspace.fs.createDirectory(P);for(let ce of p){let Te=se.Uri.joinPath(P,ce.name),be=ce.name.split("/").slice(0,-1).join("/");be&&await se.workspace.fs.createDirectory(se.Uri.joinPath(P,be)),await se.workspace.fs.writeFile(Te,Buffer.from(ce.content,"utf-8"))}se.window.showInformationMessage(`\u2705 Created ${p.length} files in: ${R}`,"Open Folder","Run npm install").then(ce=>{if(ce==="Open Folder")se.commands.executeCommand("vscode.openFolder",P);else if(ce==="Run npm install"){let Te=se.window.createTerminal({name:"\u{1F3AD} Playwright Setup",cwd:P.fsPath});Te.show(),Te.sendText("npm install && npx playwright install")}}),n.webview.postMessage({type:"projectCreated",path:P.fsPath,files:p.map(ce=>ce.name)})}else n.webview.postMessage({type:"projectError",error:"Could not extract files from the AI response. Please try again or check the output format."})}catch(u){n.webview.postMessage({type:"projectError",error:u instanceof Error?u.message:String(u)})}break;case"createPlaywrightProject":try{let u=e.targetFolder,p=(e.testName||"playwright-test").replace(/[^a-zA-Z0-9-_]/g,"-").toLowerCase(),f=se.Uri.file(`${u}/${p}`);await se.workspace.fs.createDirectory(f);let h=e.files;for(let m of h){let y=se.Uri.joinPath(f,m.name),v=m.name.split("/").slice(0,-1).join("/");v&&await se.workspace.fs.createDirectory(se.Uri.joinPath(f,v)),await se.workspace.fs.writeFile(y,Buffer.from(m.content,"utf-8"))}se.window.showInformationMessage(`\u2705 Created project: ${p}`,"Open Folder","Run npm install").then(m=>{if(m==="Open Folder")se.commands.executeCommand("vscode.openFolder",f);else if(m==="Run npm install"){let y=se.window.createTerminal({name:"\u{1F3AD} Playwright Setup",cwd:f.fsPath});y.show(),y.sendText("npm install && npx playwright install")}}),n.webview.postMessage({type:"projectCreated",path:f.fsPath})}catch(u){se.window.showErrorMessage(`Failed to create project: ${u instanceof Error?u.message:String(u)}`),n.webview.postMessage({type:"projectError",error:u instanceof Error?u.message:String(u)})}break;case"goBack":n.dispose(),t.openAppsHub();break}}static getPreferences(){return t.context.globalState.get("appsHub.preferences",{favoriteApps:[],recentApps:[],savedProjects:[],appSettings:{}})}static async toggleFavorite(e){let r=t.getPreferences(),n=r.favoriteApps.indexOf(e);n>=0?r.favoriteApps.splice(n,1):r.favoriteApps.push(e),await t.context.globalState.update("appsHub.preferences",r)}static async addRecentApp(e){let r=t.getPreferences(),n=r.recentApps.indexOf(e);n>=0&&r.recentApps.splice(n,1),r.recentApps.unshift(e),r.recentApps=r.recentApps.slice(0,5),await t.context.globalState.update("appsHub.preferences",r)}static getHubHtml(e){let r=eG(),n=t.getPreferences(),o=X8(),i=n.favoriteApps.map(a=>Tk(a)).filter(Boolean),s=n.recentApps.map(a=>Tk(a)).filter(Boolean);return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${e.cspSource} 'unsafe-inline'; script-src 'nonce-${r}';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot Apps</title>
    <style>
        :root { color-scheme: var(--vscode-color-scheme); }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: var(--vscode-font-family);
            color: var(--vscode-foreground);
            background: var(--vscode-editor-background);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 32px;
        }
        .header {
            text-align: center;
            margin-bottom: 48px;
        }
        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #38bdf8, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p {
            font-size: 16px;
            opacity: 0.7;
        }
        .search-container {
            max-width: 500px;
            margin: 32px auto;
        }
        .search-box {
            width: 100%;
            padding: 14px 20px;
            border-radius: 12px;
            border: 1px solid var(--vscode-input-border);
            background: var(--vscode-input-background);
            color: var(--vscode-input-foreground);
            font-size: 15px;
            transition: all 0.2s ease;
        }
        .search-box:focus {
            outline: none;
            border-color: var(--vscode-focusBorder);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--vscode-focusBorder) 20%, transparent);
        }
        .section {
            margin-bottom: 40px;
        }
        .section-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.6;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }
        .app-card {
            position: relative;
            padding: 24px;
            border-radius: 16px;
            background: var(--vscode-editorWidget-background);
            border: 1px solid var(--vscode-widget-border);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .app-card:hover {
            border-color: var(--vscode-focusBorder);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        .app-icon {
            font-size: 40px;
            margin-bottom: 16px;
        }
        .app-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .app-desc {
            font-size: 13px;
            opacity: 0.7;
            line-height: 1.5;
        }
        .app-category {
            display: inline-block;
            margin-top: 12px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 500;
            background: color-mix(in srgb, var(--vscode-focusBorder) 15%, transparent);
            color: var(--vscode-foreground);
        }
        .favorite-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            opacity: 0.3;
            transition: all 0.15s ease;
        }
        .favorite-btn:hover { opacity: 0.8; transform: scale(1.1); }
        .favorite-btn.active { opacity: 1; }
        .category-section {
            margin-top: 32px;
        }
        .empty-state {
            text-align: center;
            padding: 40px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>\u{1F4E6} Copilot Apps Hub</h1>
            <p>AI-powered tools for developers, QA, and leadership</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-box" placeholder="\u{1F50D} Search apps..." id="search-input">
        </div>

        ${i.length>0?`
        <div class="section" id="favorites-section">
            <div class="section-title">\u2B50 Favorites</div>
            <div class="apps-grid">
                ${i.map(a=>t.renderAppCard(a,!0)).join("")}
            </div>
        </div>
        `:""}

        ${s.length>0?`
        <div class="section" id="recent-section">
            <div class="section-title">\u{1F550} Recently Used</div>
            <div class="apps-grid">
                ${s.slice(0,4).map(a=>t.renderAppCard(a,n.favoriteApps.includes(a.id))).join("")}
            </div>
        </div>
        `:""}

        <div class="section" id="all-apps-section">
            <div class="section-title">\u{1F4E6} All Apps</div>
            ${Object.entries(o).filter(([a,c])=>c.length>0).map(([a,c])=>`
                <div class="category-section">
                    <div class="section-title" style="font-size: 12px; margin-bottom: 16px;">
                        ${Ek[a]?.icon||"\u{1F4C1}"} 
                        ${Ek[a]?.label||a}
                    </div>
                    <div class="apps-grid">
                        ${c.map(l=>t.renderAppCard(l,n.favoriteApps.includes(l.id))).join("")}
                    </div>
                </div>
            `).join("")}
        </div>
    </div>

    <script nonce="${r}">
        const vscode = acquireVsCodeApi();
        
        // App click handlers
        document.querySelectorAll('.app-card').forEach(card => {
            card.addEventListener('click', (e) => {
                if (e.target.closest('.favorite-btn')) return;
                vscode.postMessage({ type: 'openApp', appId: card.dataset.appId });
            });
        });
        
        // Favorite handlers
        document.querySelectorAll('.favorite-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                vscode.postMessage({ type: 'toggleFavorite', appId: btn.dataset.appId });
            });
        });
        
        // Search
        document.getElementById('search-input').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.app-card').forEach(card => {
                const name = card.querySelector('.app-name').textContent.toLowerCase();
                const desc = card.querySelector('.app-desc').textContent.toLowerCase();
                card.style.display = (name.includes(query) || desc.includes(query)) ? 'block' : 'none';
            });
        });
    </script>
</body>
</html>`}static renderAppCard(e,r){return`
            <div class="app-card" data-app-id="${e.id}">
                <button class="favorite-btn ${r?"active":""}" data-app-id="${e.id}">
                    ${r?"\u2B50":"\u2606"}
                </button>
                <div class="app-icon">${e.icon}</div>
                <div class="app-name">${e.name}</div>
                <div class="app-desc">${e.description}</div>
                <div class="app-category">${Ek[e.category]?.label||e.category}</div>
            </div>
        `}static getAppHtml(e,r,n){let o=eG();return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${e.cspSource} 'unsafe-inline'; script-src 'nonce-${o}';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${r.icon} ${r.name}</title>
    <style>
        :root { color-scheme: var(--vscode-color-scheme); }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: var(--vscode-font-family);
            color: var(--vscode-foreground);
            background: var(--vscode-editor-background);
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 32px;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid var(--vscode-widget-border);
            background: transparent;
            color: var(--vscode-foreground);
            cursor: pointer;
            font-size: 13px;
            margin-bottom: 24px;
            transition: all 0.15s ease;
        }
        .back-btn:hover {
            background: var(--vscode-button-secondaryBackground);
            border-color: var(--vscode-focusBorder);
        }
        .header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 32px;
        }
        .header-icon {
            font-size: 56px;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(56,189,248,0.15), rgba(167,139,250,0.1));
            border: 1px solid var(--vscode-widget-border);
        }
        .header-text h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .header-text p {
            font-size: 15px;
            opacity: 0.7;
        }
        .form-section {
            background: var(--vscode-editorWidget-background);
            border: 1px solid var(--vscode-widget-border);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 24px;
        }
        .form-group {
            margin-bottom: 24px;
        }
        .form-group:last-child { margin-bottom: 0; }
        .form-label {
            display: block;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .form-hint {
            font-size: 12px;
            opacity: 0.6;
            margin-top: 6px;
        }
        input[type="text"], textarea, select {
            width: 100%;
            padding: 12px 14px;
            border-radius: 10px;
            border: 1px solid var(--vscode-input-border);
            background: var(--vscode-input-background);
            color: var(--vscode-input-foreground);
            font-family: var(--vscode-font-family);
            font-size: 14px;
            transition: all 0.15s ease;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--vscode-focusBorder);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--vscode-focusBorder) 15%, transparent);
        }
        textarea {
            font-family: var(--vscode-editor-font-family);
            resize: vertical;
            min-height: 140px;
            line-height: 1.5;
        }
        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .radio-option, .checkbox-option {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px 16px;
            border-radius: 10px;
            background: var(--vscode-editor-background);
            border: 1px solid var(--vscode-widget-border);
            cursor: pointer;
            transition: all 0.15s ease;
        }
        .radio-option:hover, .checkbox-option:hover {
            border-color: var(--vscode-focusBorder);
        }
        .radio-option.selected, .checkbox-option.selected {
            border-color: var(--vscode-focusBorder);
            background: color-mix(in srgb, var(--vscode-focusBorder) 8%, var(--vscode-editor-background));
        }
        .radio-option input, .checkbox-option input {
            margin: 3px 0 0 0;
        }
        .option-content { flex: 1; }
        .option-label {
            font-weight: 500;
            font-size: 14px;
        }
        .option-desc {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 3px;
        }
        .project-picker {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .project-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            border-radius: 10px;
            background: var(--vscode-editor-background);
            border: 1px solid var(--vscode-widget-border);
        }
        .project-item .name { flex: 1; font-weight: 500; }
        .project-item .path {
            font-size: 11px;
            opacity: 0.6;
            font-family: var(--vscode-editor-font-family);
        }
        .project-item .remove-btn {
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.5;
            font-size: 16px;
        }
        .project-item .remove-btn:hover { opacity: 1; }
        .add-project-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px;
            border-radius: 10px;
            border: 2px dashed var(--vscode-widget-border);
            background: transparent;
            color: var(--vscode-foreground);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.15s ease;
        }
        .add-project-btn:hover {
            border-color: var(--vscode-focusBorder);
            background: color-mix(in srgb, var(--vscode-focusBorder) 5%, transparent);
        }
        .submit-btn {
            width: 100%;
            padding: 16px 28px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--vscode-button-background), color-mix(in srgb, var(--vscode-button-background) 80%, black));
            color: var(--vscode-button-foreground);
            font-family: var(--vscode-font-family);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .spinner {
            width: 18px;
            height: 18px;
            border: 2px solid currentColor;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .result-section {
            margin-top: 32px;
        }
        .result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .result-header h3 {
            font-size: 18px;
        }
        .result-actions {
            display: flex;
            gap: 10px;
        }
        .action-btn {
            padding: 10px 16px;
            border-radius: 8px;
            border: 1px solid var(--vscode-widget-border);
            background: var(--vscode-button-secondaryBackground);
            color: var(--vscode-button-secondaryForeground);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.15s ease;
        }
        .action-btn:hover {
            background: var(--vscode-button-secondaryHoverBackground);
            border-color: var(--vscode-focusBorder);
        }
        .result-content {
            background: var(--vscode-editorWidget-background);
            border: 1px solid var(--vscode-widget-border);
            border-radius: 12px;
            padding: 24px;
            font-family: var(--vscode-editor-font-family);
            font-size: 13px;
            line-height: 1.7;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }
        .result-content.error {
            background: color-mix(in srgb, var(--vscode-testing-iconFailed) 10%, var(--vscode-editor-background));
            border-color: var(--vscode-testing-iconFailed);
            color: var(--vscode-testing-iconFailed);
        }
        .progress-msg {
            text-align: center;
            font-size: 14px;
            opacity: 0.7;
            padding: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        .hidden { display: none !important; }
        .conditional-field { display: none; }
        .conditional-field.visible { display: block; }
        .file-picker-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .file-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            border-radius: 8px;
            background: var(--vscode-editor-background);
            border: 1px solid var(--vscode-widget-border);
        }
        .file-item .file-icon { font-size: 20px; }
        .file-item .file-info { flex: 1; }
        .file-item .file-name { font-weight: 500; font-size: 13px; }
        .file-item .file-size { font-size: 11px; opacity: 0.6; }
        .file-item .remove-file-btn {
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.5;
            font-size: 16px;
            padding: 4px;
        }
        .file-item .remove-file-btn:hover { opacity: 1; }
        .add-file-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px;
            border-radius: 10px;
            border: 2px dashed var(--vscode-widget-border);
            background: transparent;
            color: var(--vscode-foreground);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.15s ease;
        }
        .add-file-btn:hover {
            border-color: var(--vscode-focusBorder);
            background: color-mix(in srgb, var(--vscode-focusBorder) 5%, transparent);
        }
        .model-picker-container {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .model-select {
            flex: 1;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid var(--vscode-input-border);
            background: var(--vscode-input-background);
            color: var(--vscode-input-foreground);
            font-size: 13px;
        }
        .refresh-models-btn {
            padding: 10px 14px;
            border-radius: 8px;
            border: 1px solid var(--vscode-widget-border);
            background: var(--vscode-button-secondaryBackground);
            color: var(--vscode-button-secondaryForeground);
            cursor: pointer;
            font-size: 14px;
        }
        .refresh-models-btn:hover {
            background: var(--vscode-button-secondaryHoverBackground);
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-btn" id="back-btn">\u2190 Back to Apps</button>
        
        <div class="header">
            <div class="header-icon">${r.icon}</div>
            <div class="header-text">
                <h1>${r.name}</h1>
                <p>${r.description}</p>
            </div>
        </div>

        <form id="app-form">
            <div class="form-section">
                ${r.inputs.map(i=>t.renderInputField(i,n)).join("")}
            </div>

            <button type="submit" class="submit-btn" id="submit-btn">
                ${r.primaryAction}
            </button>
        </form>

        <div class="result-section hidden" id="result-section">
            <div class="result-header">
                <h3>\u{1F4CB} Result</h3>
                <div class="result-actions">
                    <button class="action-btn" id="copy-btn">\u{1F4CB} Copy</button>
                    <button class="action-btn" id="insert-btn">\u{1F4DD} Insert</button>
                    <button class="action-btn" id="save-btn">\u{1F4BE} Save</button>
                </div>
            </div>
            <div class="progress-msg hidden" id="progress-msg">
                <div class="spinner"></div>
                <span id="progress-text">Processing...</span>
            </div>
            <div class="result-content hidden" id="result-content"></div>
        </div>
    </div>

    <script nonce="${o}">
        const vscode = acquireVsCodeApi();
        const appId = '${r.id}';
        let currentResult = '';
        let selectedProjects = ${JSON.stringify(n.map(i=>i.path))};

        // Back button
        document.getElementById('back-btn').addEventListener('click', () => {
            vscode.postMessage({ type: 'goBack' });
        });

        // Form submission
        document.getElementById('app-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const inputs = {};
            
            for (const [key, value] of formData.entries()) {
                inputs[key] = value;
            }
            
            // Handle multi-select
            document.querySelectorAll('.checkbox-group').forEach(group => {
                const name = group.dataset.name;
                const checked = Array.from(group.querySelectorAll('input:checked')).map(cb => cb.value);
                inputs[name] = checked.join(',');
            });
            
            // Handle project picker
            if (selectedProjects.length > 0) {
                inputs['projectPaths'] = JSON.stringify(selectedProjects);
            }
            
            // Show loading
            const btn = document.getElementById('submit-btn');
            btn.disabled = true;
            btn.innerHTML = '<div class="spinner"></div> Processing...';
            
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('progress-msg').classList.remove('hidden');
            document.getElementById('result-content').classList.add('hidden');
            
            vscode.postMessage({ type: 'executeApp', inputs });
        });

        // Handle messages
        window.addEventListener('message', (event) => {
            const message = event.data;
            
            switch (message.type) {
                case 'progress':
                    document.getElementById('progress-text').textContent = message.message;
                    break;
                    
                case 'result':
                    const submitBtn = document.getElementById('submit-btn');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '${r.primaryAction}';
                    
                    document.getElementById('progress-msg').classList.add('hidden');
                    const content = document.getElementById('result-content');
                    content.classList.remove('hidden', 'error');
                    
                    if (message.result.success) {
                        currentResult = message.result.output.content;
                        
                        // Check if this is Playwright app - auto-create project
                        const isPlaywrightApp = '${r.id}' === 'playwright-generator';
                        const targetFolder = selectedProjects[0];
                        
                        if (isPlaywrightApp && targetFolder) {
                            content.innerHTML = '<div style="text-align:center;padding:20px;"><div class="spinner"></div><p>Creating project files...</p></div>';
                            
                            const testName = document.querySelector('input[name="testName"]')?.value || 'playwright-test';
                            vscode.postMessage({
                                type: 'extractAndCreateProject',
                                targetFolder: targetFolder,
                                testName: testName,
                                rawContent: currentResult,
                                language: document.querySelector('input[name="language"]:checked')?.value || 'typescript'
                            });
                        } else if (isPlaywrightApp && !targetFolder) {
                            content.innerHTML = '<div style="color:orange;padding:20px;text-align:center;">\u26A0\uFE0F Please select a target folder first!</div>';
                        } else {
                            content.textContent = currentResult;
                        }
                    } else {
                        content.classList.add('error');
                        content.textContent = 'Error: ' + message.result.error;
                    }
                    break;
                    
                case 'projectAdded':
                    if (!selectedProjects.includes(message.project.path)) {
                        selectedProjects.push(message.project.path);
                        updateProjectList();
                    }
                    break;
                    
                case 'filesReceived':
const fieldId = message.fieldId;
if (!attachedFiles[fieldId]) {
    attachedFiles[fieldId] = [];
}
message.files.forEach(f => {
    if (!attachedFiles[fieldId].some(existing => existing.name === f.name)) {
        attachedFiles[fieldId].push(f);
    }
});
updateFileList(fieldId);
break;
                    
                case 'modelsReceived':
const modelFieldId = message.fieldId;
const select = document.getElementById('model-select-' + modelFieldId);
if (select) {
    // Keep auto option, add models
    select.innerHTML = '<option value="auto">\u{1F916} Auto (Best Available)</option>' +
        message.models.map(m =>
            \`<option value="\${m.id}">\${m.vendor} - \${m.name}</option>\`
                            ).join('');
                    }
                    break;
                    
                case 'projectCreated':
                    document.getElementById('result-section').classList.remove('hidden');
                    document.getElementById('progress-msg').classList.add('hidden');
                    document.getElementById('submit-btn').disabled = false;
                    const createdContent = document.getElementById('result-content');
                    createdContent.classList.remove('hidden', 'error');
                    createdContent.innerHTML = \`
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 48px; margin-bottom: 16px;">\u2705</div>
                            <h3 style="margin-bottom: 8px;">Project Created Successfully!</h3>
                            <p style="opacity: 0.7; margin-bottom: 16px;">Location: \${message.path}</p>
                            <p style="font-size: 13px; margin-bottom: 16px;">Files: \${message.files ? message.files.join(', ') : 'package.json, config, test'}</p>
                        </div>
                        <div style="text-align: left; background: var(--vscode-terminal-background, #1e1e1e); border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <p style="font-weight: 600; margin-bottom: 12px; color: var(--vscode-terminal-foreground, #ccc);">\u{1F4E6} Install & Run Commands:</p>
                            <pre style="background: var(--vscode-editor-background); padding: 12px; border-radius: 6px; overflow-x: auto; font-family: monospace; font-size: 13px; line-height: 1.6;"><code># Navigate to project folder
cd "\${message.path}"

# Install dependencies
npm install

# Install Playwright browsers
npx playwright install

# Run the tests
npx playwright test

# View HTML report
npx playwright show-report</code></pre>
                        </div>
                    \`;
                    break;
                    
                case 'projectError':
                    document.getElementById('result-section').classList.remove('hidden');
                    document.getElementById('progress-msg').classList.add('hidden');
                    document.getElementById('submit-btn').disabled = false;
                    const errorContent = document.getElementById('result-content');
                    errorContent.classList.remove('hidden');
                    errorContent.classList.add('error');
                    errorContent.textContent = 'Error creating project: ' + message.error;
                    break;
            }
        });

        // Action buttons
        document.getElementById('copy-btn').addEventListener('click', () => {
            vscode.postMessage({ type: 'copyToClipboard', value: currentResult });
        });

        document.getElementById('insert-btn').addEventListener('click', () => {
            vscode.postMessage({ type: 'insertAtCursor', value: currentResult });
        });

        document.getElementById('save-btn').addEventListener('click', () => {
            vscode.postMessage({ 
                type: 'saveAsFile', 
                content: currentResult, 
                filename: '${r.id}-output.md'
            });
        });

        // Project management
        document.querySelectorAll('.add-project-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                vscode.postMessage({ type: 'pickProjectFolder' });
            });
        });

        function removeProject(path) {
            selectedProjects = selectedProjects.filter(p => p !== path);
            updateProjectList();
        }
        window.removeProject = removeProject;

        function updateProjectList() {
            const container = document.querySelector('.project-picker');
            if (!container) return;
            
            const items = selectedProjects.map(path => {
                const name = path.split('/').pop();
                return \`
                    <div class="project-item">
                        <span>\u{1F4C1}</span>
                        <div class="name">\${name}</div>
                        <div class="path">\${path}</div>
                        <button type="button" class="remove-btn" onclick="removeProject('\${path}')">\u2715</button>
                    </div>
                \`;
            }).join('');
            
            container.innerHTML = items + '<button type="button" class="add-project-btn">+ Add Project Folder</button>';
            container.querySelector('.add-project-btn').addEventListener('click', () => {
                vscode.postMessage({ type: 'pickProjectFolder' });
            });
        }

        // File picker handling
        const attachedFiles = {};
        
        document.querySelectorAll('.add-file-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const fieldId = btn.dataset.fieldId;
                vscode.postMessage({ type: 'pickFiles', fieldId });
            });
        });

        function removeFile(fieldId, fileName) {
            if (attachedFiles[fieldId]) {
                attachedFiles[fieldId] = attachedFiles[fieldId].filter(f => f.name !== fileName);
                updateFileList(fieldId);
            }
        }
        window.removeFile = removeFile;

        function updateFileList(fieldId) {
            const container = document.getElementById('file-list-' + fieldId);
            const hiddenInput = document.getElementById('files-data-' + fieldId);
            if (!container) return;
            
            const files = attachedFiles[fieldId] || [];
            const fileIcons = { xlsx: '\u{1F4CA}', docx: '\u{1F4C4}', txt: '\u{1F4DD}', md: '\u{1F4D1}' };
            
            container.innerHTML = files.map(file => {
                const ext = file.name.split('.').pop().toLowerCase();
                const icon = fileIcons[ext] || '\u{1F4CE}';
                return \`
                    <div class="file-item">
                        <span class="file-icon">\${icon}</span>
                        <div class="file-info">
                            <div class="file-name">\${file.name}</div>
                            <div class="file-size">\${file.content.length > 1000 ? (file.content.length / 1024).toFixed(1) + ' KB' : file.content.length + ' bytes'}</div>
                        </div>
                        <button type="button" class="remove-file-btn" onclick="removeFile('\${fieldId}', '\${file.name}')">\u2715</button>
                    </div>
                \`;
            }).join('');
            
            // Update hidden input with file contents
            hiddenInput.value = JSON.stringify(files);
        }

        // Model picker handling
        document.querySelectorAll('.refresh-models-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const fieldId = btn.dataset.fieldId;
                vscode.postMessage({ type: 'getAvailableModels', fieldId });
            });
        });
        
        // Auto-fetch models on load for all model pickers
        document.querySelectorAll('.model-select').forEach(select => {
            const fieldId = select.id.replace('model-select-', '');
            vscode.postMessage({ type: 'getAvailableModels', fieldId });
        });

        // Radio/checkbox handling
        document.querySelectorAll('.radio-option').forEach(option => {
            option.addEventListener('click', () => {
                const group = option.closest('.radio-group');
                group.querySelectorAll('.radio-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                option.querySelector('input').checked = true;
                handleConditionalFields(option.querySelector('input').name, option.querySelector('input').value);
            });
        });

        document.querySelectorAll('.checkbox-option').forEach(option => {
            option.addEventListener('click', () => {
                option.classList.toggle('selected');
                const cb = option.querySelector('input');
                cb.checked = !cb.checked;
            });
        });

        function handleConditionalFields(fieldName, value) {
            document.querySelectorAll('.conditional-field').forEach(field => {
                const showIf = field.dataset.showIf;
                if (showIf) {
                    const [condField, condValue] = showIf.split('=');
                    if (condField === fieldName) {
                        field.classList.toggle('visible', condValue.includes(',') 
                            ? condValue.split(',').includes(value) 
                            : condValue === value);
                    }
                }
            });
        }

        // Initialize conditional fields
        document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
            handleConditionalFields(radio.name, radio.value);
        });
    </script>
</body>
</html>`}static renderInputField(e,r){let n=e.showIf?`data-show-if="${e.showIf.field}=${Array.isArray(e.showIf.equals)?e.showIf.equals.join(","):e.showIf.equals}"`:"",o=e.showIf?"conditional-field":"";switch(e.type){case"textarea":case"code":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <textarea 
                            name="${e.id}" 
                            placeholder="${e.placeholder||""}"
                            rows="${e.rows||5}"
                            ${e.required?"required":""}
                        >${e.defaultValue||""}</textarea>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"select":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <select name="${e.id}" ${e.required?"required":""}>
                            ${(e.options||[]).map(a=>`
                                <option value="${a.value}" ${e.defaultValue===a.value?"selected":""}>
                                    ${a.label}
                                </option>
                            `).join("")}
                        </select>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"radio":let i=e.defaultValue||e.options?.[0]?.value;return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <div class="radio-group">
                            ${(e.options||[]).map(a=>`
                                <label class="radio-option ${i===a.value?"selected":""}">
                                    <input type="radio" name="${e.id}" value="${a.value}" 
                                           ${i===a.value?"checked":""}>
                                    <div class="option-content">
                                        <div class="option-label">${a.icon||""} ${a.label}</div>
                                        ${a.description?`<div class="option-desc">${a.description}</div>`:""}
                                    </div>
                                </label>
                            `).join("")}
                        </div>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"multi-select":let s=(e.defaultValue||"").split(",");return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}</label>
                        <div class="checkbox-group" data-name="${e.id}">
                            ${(e.options||[]).map(a=>`
                                <label class="checkbox-option ${s.includes(a.value)?"selected":""}">
                                    <input type="checkbox" name="${e.id}" value="${a.value}" 
                                           ${s.includes(a.value)?"checked":""}>
                                    <div class="option-content">
                                        <div class="option-label">${a.label}</div>
                                        ${a.description?`<div class="option-desc">${a.description}</div>`:""}
                                    </div>
                                </label>
                            `).join("")}
                        </div>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"project-picker":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <div class="project-picker">
                            ${r.map(a=>`
                                <div class="project-item">
                                    <span>\u{1F4C1}</span>
                                    <div class="name">${a.name}</div>
                                    <div class="path">${a.path}</div>
                                    <button type="button" class="remove-btn" onclick="removeProject('${a.path}')">\u2715</button>
                                </div>
                            `).join("")}
                            <button type="button" class="add-project-btn">+ Add Project Folder</button>
                        </div>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"file-picker":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <div class="file-picker-container" data-field-id="${e.id}">
                            <div class="file-list" id="file-list-${e.id}"></div>
                            <button type="button" class="add-file-btn" data-field-id="${e.id}">
                                \u{1F4CE} Attach Files (.xlsx, .docx, .txt, .md)
                            </button>
                            <input type="hidden" name="${e.id}" id="files-data-${e.id}" value="">
                        </div>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"model-picker":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}</label>
                        <div class="model-picker-container">
                            <select name="${e.id}" id="model-select-${e.id}" class="model-select">
                                <option value="auto">\u{1F916} Auto (Best Available)</option>
                            </select>
                            <button type="button" class="refresh-models-btn" data-field-id="${e.id}">\u{1F504}</button>
                        </div>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;case"checkbox":return`
                    <div class="form-group ${o}" ${n}>
                        <label class="checkbox-option ${e.defaultValue==="true"?"selected":""}" style="display: inline-flex;">
                            <input type="checkbox" name="${e.id}" value="true" 
                                   ${e.defaultValue==="true"?"checked":""}>
                            <div class="option-content">
                                <div class="option-label">${e.label}</div>
                            </div>
                        </label>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `;default:return`
                    <div class="form-group ${o}" ${n}>
                        <label class="form-label">${e.label}${e.required?" *":""}</label>
                        <input type="text" 
                               name="${e.id}" 
                               placeholder="${e.placeholder||""}"
                               value="${e.defaultValue||""}"
                               ${e.required?"required":""}>
                        ${e.hint?`<div class="form-hint">${e.hint}</div>`:""}
                    </div>
                `}}};function eG(){let t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<32;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}var Ok=it(require("vscode")),jk=it(require("os")),nM=it(require("path")),oM=it(require("fs"));async function tG(){if(console.log("Creating desktop shortcut..."),jk.platform()!=="darwin"){Ok.window.showErrorMessage("Desktop shortcut creation is currently only supported on macOS.");return}try{let e=jk.homedir(),r=nM.join(e,"Desktop"),o=`#!/bin/bash
open "vscode://suhaibbinyounis.github-copilot-api-vscode/dashboard"
`,i=nM.join(r,"Copilot Dashboard.command");await oM.promises.writeFile(i,o,"utf8"),await oM.promises.chmod(i,493),Ok.window.showInformationMessage('SHORTCUT CREATED: "Copilot Dashboard.command" has been added to your Desktop.'),console.log(`Shortcut created at ${i}`)}catch(e){console.error("Failed to create shortcut:",e),Ok.window.showErrorMessage(`Failed to create desktop shortcut: ${e instanceof Error?e.message:String(e)}`)}}function The(t){let e=$e.window.createOutputChannel("GitHub Copilot API Server");t.subscriptions.push(e);let r=$e.window.createStatusBarItem($e.StatusBarAlignment.Left,100);r.command="github-copilot-api-vscode.showServerControls",t.subscriptions.push(r);let n=new Pk(e,r,t);t.subscriptions.push(n);let o=new za(t.extensionUri,n);t.subscriptions.push($e.window.registerWebviewViewProvider(za.viewType,o)),Zv.initialize(t),t.subscriptions.push($e.commands.registerCommand("github-copilot-api-vscode.openAppsHub",()=>{Zv.openAppsHub()}));let i=async()=>{let y=await n.getStatus();if(y.running){let v=y.stats.requestsPerMinute,w=y.stats.avgLatencyMs,$="$(broadcast) Copilot API: ON";(v>0||y.activeRequests>0)&&($+=`  $(graph) ${v} RPM`),w>0&&($+=`  $(pulse) ${w}ms`),y.activeRequests>0?(r.text=`$(sync~spin) Processing (${y.activeRequests}) | ${v} RPM`,r.backgroundColor=new $e.ThemeColor("statusBarItem.warningBackground")):(r.text=$,r.backgroundColor=void 0),r.tooltip=new $e.MarkdownString(`
**Copilot API Gateway**
- **Status**: Active
- **Host**: ${y.config.host}:${y.config.port}
- **Requests/min**: ${v}
- **Avg Latency**: ${w}ms
- **Total Requests**: ${y.stats.totalRequests}
			`),r.show()}else r.text="$(circle-slash) Copilot API: OFF",r.tooltip="Copilot API server is stopped. Click to manage.",r.backgroundColor=new $e.ThemeColor("statusBarItem.errorBackground"),r.show()},s=!1;t.subscriptions.push(n.onDidChangeStatus(async()=>{await i();let y=await n.getStatus();y.running&&!s&&$e.workspace.getConfiguration("githubCopilotApi.server").get("showNotifications",!0)&&await $e.window.showInformationMessage(`GitHub Copilot API Server started at http://${y.config.host}:${y.config.port}`,"Open Dashboard")==="Open Dashboard"&&$e.commands.executeCommand("github-copilot-api-vscode.openDashboard"),s=y.running}));let a=$e.commands.registerCommand("github-copilot-api-vscode.showServerControls",async()=>{let y=await n.getStatus(),v=[];y.running?(v.push({label:"$(check) Server is Running",description:`http://${y.config.host}:${y.config.port}`,detail:`Requests/min: ${y.stats.requestsPerMinute} | Avg Latency: ${y.stats.avgLatencyMs}ms | Errors: ${y.stats.errorRate}%`,kind:$e.QuickPickItemKind.Separator}),v.push({label:"$(stop-circle) Stop Server",description:"Stop the API gateway"}),v.push({label:"$(refresh) Restart Server",description:"Reload configuration and restart"})):(v.push({label:"$(x) Server is Stopped",kind:$e.QuickPickItemKind.Separator}),v.push({label:"$(play-circle) Start Server",description:"Start the API gateway"})),v.push({label:"",kind:$e.QuickPickItemKind.Separator}),v.push({label:"$(dashboard) Open Full Dashboard",description:"View detailed charts, logs, and configuration"}),v.push({label:"$(output) Show Logs",description:"Open the output channel"});let w=await $e.window.showQuickPick(v,{placeHolder:"Manage Copilot API Gateway",title:"Copilot API Controls"});w&&(w.label.includes("Stop Server")?await n.stopServer():w.label.includes("Start Server")?await n.startServer():w.label.includes("Restart Server")?await n.restart():w.label.includes("Open Full Dashboard")?za.createOrShow(t.extensionUri,n):w.label.includes("Show Logs")&&e.show())});i();let c=$e.workspace.getConfiguration("githubCopilotApi.server"),l=c.get("enabled",!1),u=c.get("autoStart",!1);e.appendLine(`[DEBUG] Activation. Enabled: ${l}, AutoStart: ${u}`),(l||u)&&n.start().catch(y=>{e.appendLine(`[${new Date().toISOString()}] ERROR Failed to start API server: ${Ll(y)}`),$e.window.showErrorMessage(`Failed to start Copilot API server: ${Ll(y)}`)});let d=$e.commands.registerCommand("github-copilot-api-vscode.openCopilotChat",async()=>{await Ck()&&await $e.commands.executeCommand("workbench.action.chat.open")}),p=$e.commands.registerCommand("github-copilot-api-vscode.askCopilot",async y=>{if(!await Ck())return;let v=eM(y)??await $e.window.showInputBox({title:"Ask GitHub Copilot Chat",prompt:"What do you want to ask Copilot?",ignoreFocusOut:!0});v&&await $e.commands.executeCommand("workbench.action.chat.open",{query:v,isPartialQuery:!1})}),f=$e.commands.registerTextEditorCommand("github-copilot-api-vscode.askSelectionWithCopilot",async(y,v,w)=>{if(!await Ck())return;let $=y.selection;if($.isEmpty){$e.window.showWarningMessage("Select some code before asking Copilot about it.");return}let R=eM(w)??await $e.window.showInputBox({title:"Ask Copilot About Selection",prompt:"Describe what you want to know about the selected code.",value:"Explain this code.",ignoreFocusOut:!0});R&&await $e.commands.executeCommand("workbench.action.chat.open",{query:R,isPartialQuery:!1,attachFiles:[{uri:y.document.uri,range:new $e.Range($.start,$.end)}],blockOnResponse:!1})}),h=$e.commands.registerCommand("github-copilot-api-vscode.openDashboard",()=>{za.createOrShow(t.extensionUri,n)}),m=$e.commands.registerCommand("github-copilot-api-vscode.createDesktopShortcut",async()=>{await tG()});t.subscriptions.push($e.window.registerUriHandler({handleUri(y){let v=y.path;e.appendLine(`[URI Handler] Received URI: ${y.toString()} (path: ${v})`),v==="/dashboard"?za.createOrShow(t.extensionUri,n):v==="/start"?n.startServer().then(()=>{$e.window.showInformationMessage("Copilot API Server started via shortcut")}):v==="/stop"?n.stopServer().then(()=>{$e.window.showInformationMessage("Copilot API Server stopped via shortcut")}):$e.window.showWarningMessage(`Unknown shortcut path: ${v}`)}})),t.subscriptions.push(d,p,f,m,h)}function Ehe(){}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

pvtsutils/build/index.js:
  (*!
   * MIT License
   * 
   * Copyright (c) 2017-2024 Peculiar Ventures, LLC
   * 
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   * 
   * The above copyright notice and this permission notice shall be included in all
   * copies or substantial portions of the Software.
   * 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   * SOFTWARE.
   * 
   *)

pvutils/build/utils.js:
  (*!
   Copyright (c) Peculiar Ventures, LLC
  *)

asn1js/build/index.js:
  (*!
   * Copyright (c) 2014, GMO GlobalSign
   * Copyright (c) 2015-2022, Peculiar Ventures
   * All rights reserved.
   * 
   * Author 2014-2019, Yury Strozhevsky
   * 
   * Redistribution and use in source and binary forms, with or without modification,
   * are permitted provided that the following conditions are met:
   * 
   * * Redistributions of source code must retain the above copyright notice, this
   *   list of conditions and the following disclaimer.
   * 
   * * Redistributions in binary form must reproduce the above copyright notice, this
   *   list of conditions and the following disclaimer in the documentation and/or
   *   other materials provided with the distribution.
   * 
   * * Neither the name of the copyright holder nor the names of its
   *   contributors may be used to endorse or promote products derived from
   *   this software without specific prior written permission.
   * 
   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
   * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
   * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
   * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   * 
   *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

@peculiar/x509/build/x509.cjs.js:
  (*!
   * MIT License
   * 
   * Copyright (c) Peculiar Ventures. All rights reserved.
   * 
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   * 
   * The above copyright notice and this permission notice shall be included in all
   * copies or substantial portions of the Software.
   * 
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   * SOFTWARE.
   * 
   *)
*/
